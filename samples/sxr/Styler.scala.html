<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Styler.scala</title>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* sxr -- Scala X-Ray
 * Copyright 2009 Mark Harrah
 */</span>

<span class="keyword">package</span> sxr

<span class="keyword">import</span> scala.collection.jcl.TreeSet
<span class="keyword">import</span> scala.tools.nsc.ast.parser.Tokens

<span class="keyword">private</span> <span class="keyword">trait</span> <span class="typed"><span class="type">trait Styler extends java.lang.Object with NotNull</span><a id="6226">Styler</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">NotNull</span><a id="180">NotNull</a></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="20143">head</a></span>: <span class="typed"><span class="type">String</span><a id="1836">String</a></span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(sxr.Token)List[sxr.Annotation]</span><a id="20144">apply</a></span>(<span class="typed"><span class="type">sxr.Token</span><a id="21446">token</a></span>: <span class="typed"><span class="type">sxr.Token</span><a href="Token.scala.html#6215">Token</a></span>): <span class="typed"><span class="type">List[sxr.Annotation]</span><a id="501">List</a></span>[Annotation]
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="20145">tail</a></span>: <span class="typed"><span class="type">String</span><a id="1836">String</a></span>
}
<span class="keyword">private</span> <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Annotation extends java.lang.Object with NotNull with ScalaObject with Product</span><span id="3484"><span id="21460"><span id="21462"><span id="21363"><span id="21467"><span id="283"><span id="21463"><span id="21477"><span id="16985"><span id="21478"><span id="21461"><span id="5760"><span id="3475"><span id="2725"><span id="21473"><span id="6228"><span id="3476"><span id="2726"><span id="21476"><span id="21472"><span id="21401"><span id="21465"><span id="20399"><span id="21364"><span id="21466"><span id="6227"><span id="21479"><a id="1354">Annotation</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">String</span><span id="21451"><span id="21450"><span id="21458"><a id="22172">open</a></span></span></span></span>: <span class="typed"><span class="type">String</span><a id="1836">String</a></span>, <span class="typed"><span class="type">String</span><span id="21453"><span id="21452"><span id="21459"><a id="22173">close</a></span></span></span></span>: <span class="typed"><span class="type">String</span><a id="1836">String</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">NotNull</span><a id="180">NotNull</a></span>

<span class="keyword">object</span> <span class="typed"><span class="type">object sxr.Classes</span><a id="6230">Classes</a></span>
{
	<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="21483"><a id="21482">Keyword</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;keyword&quot;)</span><span class="string">&quot;keyword&quot;</span></span>
}
<span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class BasicStyler extends java.lang.Object with sxr.Styler with ScalaObject</span><a id="6232">BasicStyler</a></span>(<span class="typed"><span class="type">scala.collection.jcl.TreeSet[sxr.Token]</span><span id="20150"><a id="20162">tokens</a></span></span>: <span class="typed"><span class="type">scala.collection.jcl.TreeSet[sxr.Token]</span><a id="11010">TreeSet</a></span>[Token], <span class="typed"><span class="type">String</span><span id="20151"><a id="20163">title</a></span></span>: <span class="typed"><span class="type">String</span><a id="1836">String</a></span>, <span class="typed"><span class="type">String</span><span id="20152"><a id="20164">baseStyle</a></span></span>: <span class="typed"><span class="type">String</span><a id="1836">String</a></span>, <span class="typed"><span class="type">String</span><span id="20153"><a id="20165">baseJs</a></span></span>: <span class="typed"><span class="type">String</span><a id="1836">String</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">sxr.Styler</span><a href="#6226">Styler</a></span>
{
	<span class="keyword">import</span> Classes._
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="20156">head</a></span> =
		(<span class="typed"><span class="type">java.lang.String(&quot;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\012\011\011\011|&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;\012\011\011\011|    &lt;head&gt;\012\011\011\011|        &lt;title&gt;&quot;)</span><span class="string">&quot;&quot;&quot;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
			|&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
			|    &lt;head&gt;
			|        &lt;title&gt;&quot;&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">String</span><a href="#20151">title</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&lt;/title&gt;\012\011\011\011|        &lt;script type=&quot;text/javascript&quot; src=&quot;)</span><span class="string">&quot;&quot;&quot;&lt;/title&gt;
			|        &lt;script type=&quot;text/javascript&quot; src=&quot;&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">String</span><a href="#20153">baseJs</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&gt;&lt;/script&gt;\012\011\011\011|        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;)</span><span class="string">&quot;&quot;&quot;&gt;&lt;/script&gt;
			|        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">String</span><a href="#20152">baseStyle</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span> <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6098"><span id="796"><a id="5768">+</a></span></span></span> <span class="typed"><span class="type">java.lang.String(&quot; title=&quot;Style&quot;&gt;\012\011\011\011|    &lt;/head&gt;\012\011\011\011|    &lt;body onload=&quot;initializeLinked()&quot;&gt;\012\011\011\011|        &lt;pre&gt;\012\011\011\011|&quot;)</span><span class="string">&quot;&quot;&quot; title=&quot;Style&quot;&gt;
			|    &lt;/head&gt;
			|    &lt;body onload=&quot;initializeLinked()&quot;&gt;
			|        &lt;pre&gt;
			|&quot;&quot;&quot;</span></span>).<span class="typed"><span class="type">=&gt; String</span><a id="17134">stripMargin</a></span>
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="20157">tail</a></span> =
		<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6098"><a id="796" class="string">&quot;&quot;&quot;|
			|        &lt;/pre&gt;
			|    &lt;/body&gt;
		    |&lt;/html&gt;&quot;&quot;&quot;</a></span></span>.<span class="typed"><span class="type">=&gt; String</span><a id="17134">stripMargin</a></span>
	
	<span class="keyword">def</span> <span class="typed"><span class="type">(sxr.Token)List[sxr.Annotation]</span><a id="20158">apply</a></span>(<span class="typed"><span class="type">sxr.Token</span><a id="21509">token</a></span>: <span class="typed"><span class="type">sxr.Token</span><a href="Token.scala.html#6215">Token</a></span>) =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">List[java.lang.String]</span><a id="21511">styleClasses</a></span> = <span class="typed"><span class="type">(Int)List[java.lang.String]</span><a href="#20161">classes</a></span>(<span class="typed"><span class="type">sxr.Token</span><a href="#21509">token</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="Token.scala.html#19069">code</a></span>)
		<span class="typed"><span class="type">List[sxr.Annotation]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">sxr.Token</span><a href="#21509">token</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="Token.scala.html#19083">isPlain</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2726">&amp;&amp;</a></span> <span class="typed"><span class="type">List[java.lang.String]</span><a href="#21511">styleClasses</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="12099">isEmpty</a></span>)
			<span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
		<span class="keyword">else</span>
			<span class="typed"><span class="type">(sxr.Token,List[String])List[sxr.Annotation]</span><a href="#20159">annotateToken</a></span>(<span class="typed"><span class="type">sxr.Token</span><a href="#21509">token</a></span>, <span class="typed"><span class="type">List[java.lang.String]</span><a href="#21511">styleClasses</a></span>)
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(sxr.Token,List[String])List[sxr.Annotation]</span><a id="20159">annotateToken</a></span>(<span class="typed"><span class="type">sxr.Token</span><a id="21542">token</a></span>: <span class="typed"><span class="type">sxr.Token</span><a href="Token.scala.html#6215">Token</a></span>, <span class="typed"><span class="type">List[String]</span><a id="21543">styleClasses</a></span>: <span class="typed"><span class="type">List[String]</span><a id="501">List</a></span>[String]) =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="21545">tagName</a></span> = <span class="typed"><span class="type">java.lang.String</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">sxr.Token</span><a href="#21542">token</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="Token.scala.html#19082">isSimple</a></span>) <span class="typed"><span class="type">java.lang.String(&quot;span&quot;)</span><span class="string">&quot;span&quot;</span></span> <span class="keyword">else</span> <span class="typed"><span class="type">java.lang.String(&quot;a&quot;)</span><span class="string">&quot;a&quot;</span></span>
		<span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.immutable.Set[Int]</span><a id="21546">definitions</a></span> = <span class="typed"><span class="type">(Int*)scala.collection.immutable.Set[Int]</span><span id="22136"><span id="5956"><a id="796">Set</a></span></span></span>(<span class="typed"><span class="type">sxr.Token</span><a href="#21542">token</a></span>.<span class="typed"><span class="type">=&gt; List[Int]</span><a href="Token.scala.html#19081">definitions</a></span> : _*)
		<span class="keyword">val</span> <span class="typed"><span class="type">Option[sxr.Link]</span><a id="21547">reference</a></span> = <span class="typed"><span class="type">sxr.Token</span><a href="#21542">token</a></span>.<span class="typed"><span class="type">=&gt; Option[sxr.Link]</span><a href="Token.scala.html#19080">reference</a></span>.<span class="typed"><span class="type">((sxr.Link) =&gt; Boolean)Option[sxr.Link]</span><a id="12368">filter</a></span>
			{ <span class="typed"><span class="type">sxr.Link</span><a id="22140">link</a></span> =&gt;
				<span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">sxr.Link</span><a href="#22140">link</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3484">==</a></span> <span class="typed"><span class="type">object sxr.BlockLink</span><a href="Token.scala.html#6213">BlockLink</a></span>)
					<span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
				<span class="keyword">else</span>
				{
					<span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="22142">refID</a></span> = <span class="typed"><span class="type">sxr.Link</span><a href="#22140">link</a></span>.<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6098"><a href="Token.scala.html#20907" id="796">target</a></span></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="17400">toInt</a></span>
					<span class="typed"><span class="type">=&gt; Boolean</span><a id="2722">!</a></span><span class="typed"><span class="type">scala.collection.immutable.Set[Int]</span><a href="#21546">definitions</a></span>.<span class="typed"><span class="type">(Int)Boolean</span><a id="18373">contains</a></span>(<span class="typed"><span class="type">Int</span><a href="#22142">refID</a></span>)
				}
			}
		<span class="keyword">val</span> <span class="typed"><span class="type">List[Int]</span><a id="21548">definitionsList</a></span> = <span class="typed"><span class="type">scala.collection.immutable.Set[Int]</span><a href="#21546">definitions</a></span>.<span class="typed"><span class="type">=&gt; List[Int]</span><a id="12269">toList</a></span>
		<span class="keyword">val</span> <span class="typed"><span class="type">List[String]</span><a id="21549">attributes</a></span> = <span class="typed"><span class="type">Option[sxr.Link]</span><a href="#21547">reference</a></span>.<span class="typed"><span class="type">((sxr.Link) =&gt; java.lang.String)Option[java.lang.String]</span><a id="12364">map</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;href=&quot;&quot;)</span><span class="string">&quot;href=\&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">sxr.Link</span><a href="#22150">_</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;&quot;)</span><span class="string">&quot;\&quot;&quot;</span></span>).<span class="typed"><span class="type">=&gt; List[java.lang.String]</span><a id="12373">toList</a></span> <span class="typed"><span class="type">(List[String])List[String]</span><a href="#22147" id="11793">:::</a></span>
			<span class="comment">//token.tpe.map(t =&gt; &quot;title=\&quot;&quot; + Escape(t.name) + &quot;\&quot;&quot;).toList :::</span>
			<span class="typed"><span class="type">List[Int]</span><a href="#21548">definitionsList</a></span>.<span class="typed"><span class="type">=&gt; Option[Int]</span><a id="12105">firstOption</a></span>.<span class="typed"><span class="type">((Int) =&gt; java.lang.String)Option[java.lang.String]</span><a id="12364">map</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;id=&quot;&quot;)</span><span class="string">&quot;id=\&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">Int</span><a href="#22154">_</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;&quot;)</span><span class="string">&quot;\&quot;&quot;</span></span>).<span class="typed"><span class="type">=&gt; List[java.lang.String]</span><a id="12373">toList</a></span> <span class="typed"><span class="type">(List[String])List[String]</span><a href="#22151" id="11793">:::</a></span>
			( <span class="typed"><span class="type">List[String]</span><a href="#21543">styleClasses</a></span> <span class="typed"><span class="type">List[String]</span><span class="keyword">match</span></span>
			{
				<span class="typed"><span class="type">Nil.type</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span> =&gt; <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
				<span class="typed"><span class="type">List[String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">List[String]</span><a id="22155">c</a></span> =&gt; <span class="typed"><span class="type">List[String]</span><a href="#22155">c</a></span>.<span class="typed"><span class="type">(String,String,String)String</span><a id="12272">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;class=&quot;&quot;)</span><span class="string">&quot;class=\&quot;&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;,&quot;)</span><span class="string">&quot;,&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;&quot;&quot;)</span><span class="string">&quot;\&quot;&quot;</span></span>) <span class="typed"><span class="type">(String)List[String]</span><a href="#22156" id="11789">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
			})
		<span class="keyword">val</span> <span class="typed"><span class="type">List[sxr.Annotation]</span><a id="21550">extraIDs</a></span> = <span class="typed"><span class="type">List[sxr.Annotation]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">List[Int]</span><a href="#21548">definitionsList</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="12099">isEmpty</a></span>) <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">List[Int]</span><a href="#21548">definitionsList</a></span>.<span class="typed"><span class="type">=&gt; List[Int]</span><a id="11788">tail</a></span>.<span class="typed"><span class="type">((Int) =&gt; sxr.Annotation)List[sxr.Annotation]</span><a id="11816">map</a></span>(<span class="typed"><span class="type">Int</span><a id="22171">id</a></span> =&gt; <span class="typed"><span class="type">(String,String)sxr.Annotation</span><a href="#21465">Annotation</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt;span id=&quot;&quot;)</span><span class="string">&quot;&lt;span id=\&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">Int</span><a href="#22171">id</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;&gt;&quot;)</span><span class="string">&quot;\&quot;&gt;&quot;</span></span>,<span class="typed"><span class="type">java.lang.String(&quot;&lt;/span&gt;&quot;)</span><span class="string">&quot;&lt;/span&gt;&quot;</span></span>))
		<span class="keyword">val</span> <span class="typed"><span class="type">sxr.Annotation</span><a id="21551">main</a></span> = <span class="typed"><span class="type">(String,String)sxr.Annotation</span><a href="#21465">Annotation</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt;&quot;)</span><span class="string">&quot;&lt;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#21545">tagName</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">List[String]</span><a href="#21549">attributes</a></span>.<span class="typed"><span class="type">(String)String</span><a id="12273">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&gt;&quot;)</span><span class="string">&quot;&gt;&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;&lt;/&quot;)</span><span class="string">&quot;&lt;/&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#21545">tagName</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&gt;&quot;)</span><span class="string">&quot;&gt;&quot;</span></span>)
		<span class="comment">//(main :: extraIDs).reverse // ensure that the a is always the most nested</span>
		<span class="typed"><span class="type">(sxr.Token,List[sxr.Annotation])List[sxr.Annotation]</span><a href="#20160">addType</a></span>(<span class="typed"><span class="type">sxr.Token</span><a href="#21542">token</a></span>, (<span class="typed"><span class="type">sxr.Annotation</span><a href="#21551">main</a></span> <span class="typed"><span class="type">(sxr.Annotation)List[sxr.Annotation]</span><a href="#22194" id="11789">::</a></span> <span class="typed"><span class="type">List[sxr.Annotation]</span><a href="#21550">extraIDs</a></span>).<span class="typed"><span class="type">=&gt; List[sxr.Annotation]</span><a id="11839">reverse</a></span>)
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(sxr.Token,List[sxr.Annotation])List[sxr.Annotation]</span><a id="20160">addType</a></span>(<span class="typed"><span class="type">sxr.Token</span><a id="22175">token</a></span>: <span class="typed"><span class="type">sxr.Token</span><a href="Token.scala.html#6215">Token</a></span>, <span class="typed"><span class="type">List[sxr.Annotation]</span><a id="22176">baseAnnotations</a></span>: <span class="typed"><span class="type">List[sxr.Annotation]</span><a id="501">List</a></span>[Annotation]) =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="22178">typeSpan</a></span> = <span class="typed"><span class="type">sxr.Token</span><a href="#22175">token</a></span>.<span class="typed"><span class="type">=&gt; Option[sxr.TypeAttribute]</span><a href="Token.scala.html#19079">tpe</a></span>.<span class="typed"><span class="type">((sxr.TypeAttribute) =&gt; java.lang.String)Option[java.lang.String]</span><a id="12364">map</a></span>(<span class="typed"><span class="type">sxr.TypeAttribute</span><a id="22181">t</a></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;&lt;span class=&quot;type&quot;&gt;&quot;)</span><span class="string">&quot;&lt;span class=\&quot;type\&quot;&gt;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">(String)String</span><a href="Escape.scala.html#21092">Escape</a></span>(<span class="typed"><span class="type">sxr.TypeAttribute</span><a href="#22181">t</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Token.scala.html#20894">name</a></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&lt;/span&gt;&quot;)</span><span class="string">&quot;&lt;/span&gt;&quot;</span></span>).<span class="typed"><span class="type">(=&gt; java.lang.String)java.lang.String</span><a id="12362">getOrElse</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>)
		<span class="typed"><span class="type">List[sxr.Annotation]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6098"><a href="#22178" id="796">typeSpan</a></span></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="12099">isEmpty</a></span>)
			<span class="typed"><span class="type">List[sxr.Annotation]</span><a href="#22176">baseAnnotations</a></span>
		<span class="keyword">else</span>
			<span class="typed"><span class="type">(String,String)sxr.Annotation</span><a href="#21465">Annotation</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt;span class=&quot;typed&quot;&gt;&quot;)</span><span class="string">&quot;&quot;&quot;&lt;span class=&quot;typed&quot;&gt;&quot;&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5768">+</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#22178">typeSpan</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;&lt;/span&gt;&quot;)</span><span class="string">&quot;&lt;/span&gt;&quot;</span></span>) <span class="typed"><span class="type">(sxr.Annotation)List[sxr.Annotation]</span><a href="#22191" id="11789">::</a></span> <span class="typed"><span class="type">List[sxr.Annotation]</span><a href="#22176">baseAnnotations</a></span>
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int)List[java.lang.String]</span><a id="20161">classes</a></span>(<span class="typed"><span class="type">Int</span><a id="21512">code</a></span>: <span class="typed"><span class="type">Int</span><a id="2369">Int</a></span>) =
	{
		<span class="keyword">import</span> Tokens._
		<span class="typed"><span class="type">Int</span><a href="#21512">code</a></span> <span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">match</span></span>
		{
			<span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(1)</span><span >CHARLIT</span></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;char&quot;)</span><span class="string">&quot;char&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#21515" id="11789">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
			<span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(2)</span><span >INTLIT</span></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;int&quot;)</span><span class="string">&quot;int&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#21518" id="11789">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
			<span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(3)</span><span >LONGLIT</span></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;long&quot;)</span><span class="string">&quot;long&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#21521" id="11789">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
			<span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(4)</span><span >FLOATLIT</span></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;float&quot;)</span><span class="string">&quot;float&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#21524" id="11789">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
			<span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(5)</span><span >DOUBLELIT</span></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;double&quot;)</span><span class="string">&quot;double&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#21527" id="11789">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
			<span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(6)</span><span >STRINGLIT</span></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;string&quot;)</span><span class="string">&quot;string&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#21530" id="11789">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
			<span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(7)</span><span >SYMBOLLIT</span></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;symbol&quot;)</span><span class="string">&quot;symbol&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#21533" id="11789">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
			<span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(97)</span><span >COMMENT</span></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;comment&quot;)</span><span class="string">&quot;comment&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#21536" id="11789">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
			<span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">case</span></span> _ =&gt;
				<span class="typed"><span class="type">List[java.lang.String]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">(Int)Boolean</span><span id="20068"><a id="8682">isKeyword</a></span></span>(<span class="typed"><span class="type">Int</span><a href="#21512">code</a></span>))
					<span class="typed"><span class="type">java.lang.String(&quot;keyword&quot;)</span><span class="string">&quot;keyword&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#21539" id="11789">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
				<span class="keyword">else</span>
					<span class="typed"><span class="type">object Nil</span><a id="310">Nil</a></span>
		}
	}
}
        </pre>
    </body>
</html>