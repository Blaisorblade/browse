<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>sbt/WebApp.scala</title>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008 Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> java.net.{URL, URLClassLoader}
<span class="keyword">import</span> scala.xml.NodeSeq

<span class="keyword">object</span> <span class="typed"><span class="type">object sbt.JettyRun</span><a id="6782">JettyRun</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">sbt.ExitHook</span><a href="ExitHook.scala.html#6694">ExitHook</a></span>
{
	<span class="typed"><span class="type">object sbt.ExitHooks</span><a href="ExitHook.scala.html#6695">ExitHooks</a></span>.<span class="typed"><span class="type">(sbt.ExitHook)Unit</span><a href="ExitHook.scala.html#53549">register</a></span>(<span class="keyword">this</span>)
	
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; java.lang.String</span><a id="60625">name</a></span> = <span class="typed"><span class="type">java.lang.String(&quot;jetty-shutdown&quot;)</span><span class="string">&quot;jetty-shutdown&quot;</span></span>
	<span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="60626">runBeforeExiting</a></span>() { <span class="typed"><span class="type">()Unit</span><a href="#60631">stop</a></span>() }
	<span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Option[sbt.Stoppable]</span><span id="60629"><span id="60627"><span id="60628"><a id="60640">running</a></span></span></span></span>: <span class="typed"><span class="type">Option[sbt.Stoppable]</span><a id="915">Option</a></span>[Stoppable] = <span class="typed"><span class="type">object None</span><a id="517">None</a></span>
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(sbt.Stoppable)Unit</span><a id="60630">started</a></span>(<span class="typed"><span class="type">sbt.Stoppable</span><a id="60644">s</a></span>: <span class="typed"><span class="type">sbt.Stoppable</span><a href="#6784">Stoppable</a></span>) { <span class="typed"><span class="type">(Option[sbt.Stoppable])Unit</span><a href="#60628">running</a></span> = <span class="typed"><span class="type">(sbt.Stoppable)Some[sbt.Stoppable]</span><span id="10375"><a id="289">Some</a></span></span>(<span class="typed"><span class="type">sbt.Stoppable</span><a href="#60644">s</a></span>) }
	<span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="60631">stop</a></span>()
	{
		<span class="typed"><span class="type">(Unit)Unit</span><a id="5768">synchronized</a></span>
		{
			<span class="typed"><span class="type">=&gt; Option[sbt.Stoppable]</span><a href="#60627">running</a></span>.<span class="typed"><span class="type">((sbt.Stoppable) =&gt; Unit)Unit</span><a id="10271">foreach</a></span>(<span class="typed"><span class="type">sbt.Stoppable</span><a href="#60648">_</a></span>.<span class="typed"><span class="type">()Unit</span><a href="#60643">stop</a></span>())
			<span class="typed"><span class="type">(Option[sbt.Stoppable])Unit</span><a href="#60628">running</a></span> = <span class="typed"><span class="type">object None</span><a id="517">None</a></span>
		}
	}
	<span class="keyword">def</span> <span class="typed"><span class="type">(Iterable[sbt.Path],String,sbt.Path,String,scala.xml.NodeSeq,Seq[java.io.File],sbt.Logger)Option[String]</span><a id="60632">apply</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="60649">classpath</a></span>: <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="384">Iterable</a></span>[Path], <span class="typed"><span class="type">String</span><a id="60650">classpathName</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">sbt.Path</span><a id="60651">war</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="typed"><span class="type">String</span><a id="60652">defaultContextPath</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">scala.xml.NodeSeq</span><a id="60653">jettyConfigurationXML</a></span>: <span class="typed"><span class="type">scala.xml.NodeSeq</span><a id="26253">NodeSeq</a></span>,
		<span class="typed"><span class="type">Seq[java.io.File]</span><a id="60654">jettyConfigurationFiles</a></span>: <span class="typed"><span class="type">Seq[java.io.File]</span><a id="744">Seq</a></span>[File], <span class="typed"><span class="type">sbt.Logger</span><a id="60655">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>): <span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String] =
			<span class="typed"><span class="type">(String,sbt.JettyRunConfiguration,sbt.Logger)Option[String]</span><a href="#60635">run</a></span>(<span class="typed"><span class="type">String</span><a href="#60650">classpathName</a></span>, <span class="typed"><span class="type">sbt.JettyRunConfiguration</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.JettyRunConfiguration</span><a href="#6786">JettyRunConfiguration</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#60651">war</a></span>, <span class="typed"><span class="type">String</span><a href="#60652">defaultContextPath</a></span>, <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="#60653">jettyConfigurationXML</a></span>,
				<span class="typed"><span class="type">Seq[java.io.File]</span><a href="#60654">jettyConfigurationFiles</a></span>, <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="typed"><span class="type">(Iterable[sbt.Path])Seq[java.net.URL]</span><a href="#60634">toURLs</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#60649">classpath</a></span>)), <span class="typed"><span class="type">sbt.Logger</span><a href="#60655">log</a></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(Iterable[sbt.Path],String,sbt.Path,String,Seq[java.io.File],Int,sbt.Logger)Option[String]</span><a id="60633">apply</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="60693">classpath</a></span>: <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="384">Iterable</a></span>[Path], <span class="typed"><span class="type">String</span><a id="60694">classpathName</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">sbt.Path</span><a id="60695">war</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="typed"><span class="type">String</span><a id="60696">defaultContextPath</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">Seq[java.io.File]</span><a id="60697">scanDirectories</a></span>: <span class="typed"><span class="type">Seq[java.io.File]</span><a id="744">Seq</a></span>[File],
		<span class="typed"><span class="type">Int</span><a id="60698">scanPeriod</a></span>: <span class="typed"><span class="type">Int</span><a id="2375">Int</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a id="60699">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>): <span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String] =
			<span class="typed"><span class="type">(String,sbt.JettyRunConfiguration,sbt.Logger)Option[String]</span><a href="#60635">run</a></span>(<span class="typed"><span class="type">String</span><a href="#60694">classpathName</a></span>, <span class="typed"><span class="type">sbt.JettyRunConfiguration</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.JettyRunConfiguration</span><a href="#6786">JettyRunConfiguration</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#60695">war</a></span>, <span class="typed"><span class="type">String</span><a href="#60696">defaultContextPath</a></span>, <span class="typed"><span class="type">object scala.xml.NodeSeq</span><a id="26254">NodeSeq</a></span>.<span class="typed"><span class="type">=&gt; &lt;refinement&gt; extends scala.xml.NodeSeq</span><a id="31181">Empty</a></span>, <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Seq[java.io.File]</span><a href="#60697">scanDirectories</a></span>, <span class="typed"><span class="type">Int</span><a href="#60698">scanPeriod</a></span>, <span class="typed"><span class="type">(Iterable[sbt.Path])Seq[java.net.URL]</span><a href="#60634">toURLs</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#60693">classpath</a></span>)), <span class="typed"><span class="type">sbt.Logger</span><a href="#60699">log</a></span>)
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Iterable[sbt.Path])Seq[java.net.URL]</span><a id="60634">toURLs</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="60688">paths</a></span>: <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="384">Iterable</a></span>[Path]) = <span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#60688">paths</a></span>.<span class="typed"><span class="type">((sbt.Path) =&gt; java.net.URL)Iterable[java.net.URL]</span><a id="7355">map</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#60692">_</a></span>.<span class="typed"><span class="type">=&gt; java.net.URL</span><a href="Path.scala.html#9639">asURL</a></span>).<span class="typed"><span class="type">=&gt; Seq[java.net.URL]</span><a id="7389">toSeq</a></span>
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String,sbt.JettyRunConfiguration,sbt.Logger)Option[String]</span><a id="60635">run</a></span>(<span class="typed"><span class="type">String</span><a id="60656">classpathName</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">sbt.JettyRunConfiguration</span><a id="60657">configuration</a></span>: <span class="typed"><span class="type">sbt.JettyRunConfiguration</span><a href="#6786">JettyRunConfiguration</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a id="60658">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>): <span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String] =
		<span class="typed"><span class="type">(Option[String])Option[String]</span><a id="5768">synchronized</a></span>
		{
			<span class="keyword">import</span> configuration._
			<span class="keyword">def</span> <span class="typed"><span class="type">()sbt.Stoppable</span><a id="60702">runJetty</a></span>() =
			{
				<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="60703">baseLoader</a></span> = <span class="keyword">this</span>.<span class="typed"><span class="type">()java.lang.Class[_ &lt;: java.lang.Object]</span><a id="3492">getClass</a></span>.<span class="typed"><span class="type">()java.lang.ClassLoader</span><a id="3930">getClassLoader</a></span>
				<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="60704">loader</a></span>: <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="1707">ClassLoader</a></span> = <span class="typed"><span class="type">(Array[java.net.URL],java.lang.ClassLoader,Iterable[String])sbt.FilteredLoader</span><a href="ClasspathUtilities.scala.html#46400" class="keyword">new</a></span> <span class="typed"><span class="type">sbt.FilteredLoader</span><a href="ClasspathUtilities.scala.html#6471">FilteredLoader</a></span>(<span class="typed"><span class="type">=&gt; Seq[java.net.URL]</span><a href="#60678">classpathURLs</a></span>.<span class="typed"><span class="type">Array[java.net.URL]</span><a id="7248">toArray</a></span>, <span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#60703">baseLoader</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;org.mortbay.&quot;)</span><span class="string">&quot;org.mortbay.&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#60713" id="6908">::</a></span> <span class="typed"><span class="type">java.lang.String(&quot;javax.servlet.&quot;)</span><span class="string">&quot;javax.servlet.&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#60714" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>)
				<span class="keyword">val</span> <span class="typed"><span class="type">sbt.LazyFrameworkLoader</span><a id="60705">lazyLoader</a></span> = <span class="typed"><span class="type">sbt.LazyFrameworkLoader</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.LazyFrameworkLoader</span><a href="ClasspathUtilities.scala.html#6473">LazyFrameworkLoader</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#60636">implClassName</a></span>, <span class="typed"><span class="type">(java.net.URL*)Array[java.net.URL]</span><span id="7103"><a id="1054">Array</a></span></span>(<span class="typed"><span class="type">object sbt.FileUtilities</span><a href="FileUtilities.scala.html#6450">FileUtilities</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="FileUtilities.scala.html#9594">sbtJar</a></span>.<span class="typed"><span class="type">()java.net.URI</span><a id="9665">toURI</a></span>.<span class="typed"><span class="type">()java.net.URL</span><a id="22211">toURL</a></span>), <span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#60704">loader</a></span>, <span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#60703">baseLoader</a></span>)
				<span class="keyword">val</span> <span class="typed"><span class="type">sbt.JettyRun</span><a id="60706">runner</a></span> = <span class="typed"><span class="type">object sbt.ModuleUtilities</span><a href="ModuleUtilities.scala.html#6606">ModuleUtilities</a></span>.<span class="typed"><span class="type">(String,java.lang.ClassLoader)java.lang.Object</span><a href="ModuleUtilities.scala.html#39251">getObject</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#60636">implClassName</a></span>, <span class="typed"><span class="type">sbt.LazyFrameworkLoader</span><a href="#60705">lazyLoader</a></span>).<span class="typed"><span class="type">sbt.JettyRun</span><a id="3484">asInstanceOf</a></span>[<span class="typed"><span class="type">sbt.JettyRun</span><a href="#6785">JettyRun</a></span>]
				<span class="typed"><span class="type">(sbt.JettyRunConfiguration,sbt.Logger)sbt.Stoppable</span><a href="#60904">runner</a></span>(<span class="typed"><span class="type">sbt.JettyRunConfiguration</span><a href="#60657">configuration</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#60658">log</a></span>)
			}
			
			<span class="typed"><span class="type">Option[String]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">=&gt; Option[sbt.Stoppable]</span><a href="#60627">running</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="10260">isDefined</a></span>)
				<span class="typed"><span class="type">(java.lang.String)Some[java.lang.String]</span><span id="10375"><a id="289">Some</a></span></span>(<span class="typed"><span class="type">java.lang.String(&quot;Jetty is already running.&quot;)</span><span class="string">&quot;Jetty is already running.&quot;</span></span>)
			<span class="keyword">else</span>
			{
				<span class="keyword">try</span>
				{
					<span class="typed"><span class="type">(sbt.Stoppable)Unit</span><a href="#60630">started</a></span>(<span class="typed"><span class="type">()sbt.Stoppable</span><a href="#60702">runJetty</a></span>())
					<span class="typed"><span class="type">object None</span><a id="517">None</a></span>
				}
				<span class="keyword">catch</span>
				{
					<span class="typed"><span class="type">Some[java.lang.String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.NoClassDefFoundError</span><a id="60908">e</a></span>: <span class="typed"><span class="type">java.lang.NoClassDefFoundError</span><a id="1914">NoClassDefFoundError</a></span> =&gt; <span class="typed"><span class="type">(Throwable,String,sbt.Logger)Some[java.lang.String]</span><a href="#60638">runError</a></span>(<span class="typed"><span class="type">java.lang.NoClassDefFoundError</span><a href="#60908">e</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;Jetty and its dependencies must be on the &quot;)</span><span class="string">&quot;Jetty and its dependencies must be on the &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">String</span><a href="#60656">classpathName</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; classpath: &quot;)</span><span class="string">&quot; classpath: &quot;</span></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#60658">log</a></span>)
					<span class="typed"><span class="type">Some[java.lang.String]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.Throwable</span><a id="60914">e</a></span> =&gt; <span class="typed"><span class="type">(Throwable,String,sbt.Logger)Some[java.lang.String]</span><a href="#60638">runError</a></span>(<span class="typed"><span class="type">java.lang.Throwable</span><a href="#60914">e</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;Error running Jetty: &quot;)</span><span class="string">&quot;Error running Jetty: &quot;</span></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#60658">log</a></span>)
				}
			}
		}
	<span class="keyword">private</span> <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="60637"><a id="60636">implClassName</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;sbt.LazyJettyRun&quot;)</span><span class="string">&quot;sbt.LazyJettyRun&quot;</span></span>
	
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Throwable,String,sbt.Logger)Some[java.lang.String]</span><a id="60638">runError</a></span>(<span class="typed"><span class="type">Throwable</span><a id="60909">e</a></span>: <span class="typed"><span class="type">Throwable</span><a id="2124">Throwable</a></span>, <span class="typed"><span class="type">String</span><a id="60910">messageBase</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a id="60911">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>) =
	{
		<span class="typed"><span class="type">sbt.Logger</span><a href="#60911">log</a></span>.<span class="typed"><span class="type">(=&gt; Throwable)Unit</span><a href="Logger.scala.html#8465">trace</a></span>(<span class="typed"><span class="type">Throwable</span><a href="#60909">e</a></span>)
		<span class="typed"><span class="type">(java.lang.String)Some[java.lang.String]</span><span id="10375"><a id="289">Some</a></span></span>(<span class="typed"><span class="type">String</span><a href="#60910">messageBase</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">Throwable</span><a href="#60909">e</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="9387">toString</a></span>)
	}
}

<span class="keyword">private</span> <span class="keyword">trait</span> <span class="typed"><span class="type">trait Stoppable extends java.lang.Object</span><span id="6784"><a id="2146">Stoppable</a></span></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="60643">stop</a></span>(): <span class="typed"><span class="type">Unit</span><a id="2150">Unit</a></span>
}
<span class="keyword">private</span> <span class="keyword">trait</span> <span class="typed"><span class="type">trait JettyRun extends java.lang.Object</span><span id="6785"><a id="2146">JettyRun</a></span></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.JettyRunConfiguration,sbt.Logger)sbt.Stoppable</span><a id="60904">apply</a></span>(<span class="typed"><span class="type">sbt.JettyRunConfiguration</span><a id="60905">configuration</a></span>: <span class="typed"><span class="type">sbt.JettyRunConfiguration</span><a href="#6786">JettyRunConfiguration</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a id="60906">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>): <span class="typed"><span class="type">sbt.Stoppable</span><a href="#6784">Stoppable</a></span>
}
<span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class JettyRunConfiguration extends java.lang.Object with NotNull with ScalaObject</span><a id="6786">JettyRunConfiguration</a></span>(<span class="keyword">val</span> <span class="typed"><span class="type">sbt.Path</span><span id="60667"><span id="60666"><a id="60681">war</a></span></span></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="keyword">val</span> <span class="typed"><span class="type">String</span><span id="60669"><span id="60668"><a id="60682">defaultContextPath</a></span></span></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.NodeSeq</span><span id="60671"><span id="60670"><a id="60683">jettyConfigurationXML</a></span></span></span>: <span class="typed"><span class="type">scala.xml.NodeSeq</span><a id="26253">NodeSeq</a></span>, <span class="keyword">val</span> <span class="typed"><span class="type">Seq[java.io.File]</span><span id="60673"><span id="60672"><a id="60684">jettyConfigurationFiles</a></span></span></span>: <span class="typed"><span class="type">Seq[java.io.File]</span><a id="744">Seq</a></span>[File],
		<span class="keyword">val</span> <span class="typed"><span class="type">Seq[java.io.File]</span><span id="60675"><span id="60674"><a id="60685">scanDirectories</a></span></span></span>: <span class="typed"><span class="type">Seq[java.io.File]</span><a id="744">Seq</a></span>[File], <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><span id="60677"><span id="60676"><a id="60686">scanInterval</a></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2375">Int</a></span>, <span class="keyword">val</span> <span class="typed"><span class="type">Seq[java.net.URL]</span><span id="60679"><span id="60678"><a id="60687">classpathURLs</a></span></span></span>: <span class="typed"><span class="type">Seq[java.net.URL]</span><a id="744">Seq</a></span>[URL]) <span class="keyword">extends</span> <span class="typed"><span class="type">NotNull</span><a id="186">NotNull</a></span>

<span class="comment">/* This class starts Jetty.
* NOTE: DO NOT actively use this class.  You will see NoClassDefFoundErrors if you fail
*  to do so.Only use its name in JettyRun for reflective loading.  This allows using
*  the Jetty libraries provided on the project classpath instead of requiring them to be
*  available on sbt's classpath at startup.
*/</span>
<span class="keyword">private</span> <span class="keyword">object</span> <span class="typed"><span class="type">object sbt.LazyJettyRun</span><a id="6787">LazyJettyRun</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">sbt.JettyRun</span><a href="#6785">JettyRun</a></span>
{
	<span class="keyword">import</span> org.mortbay.jetty.{Handler, Server}
	<span class="keyword">import</span> org.mortbay.jetty.nio.SelectChannelConnector
	<span class="keyword">import</span> org.mortbay.jetty.webapp.WebAppContext
	<span class="keyword">import</span> org.mortbay.log.Log
	<span class="keyword">import</span> org.mortbay.util.Scanner
	<span class="keyword">import</span> org.mortbay.xml.XmlConfiguration
	
	<span class="keyword">import</span> java.lang.ref.{Reference, WeakReference}
	
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.JettyRunConfiguration,sbt.Logger)sbt.Stoppable</span><a id="60933">apply</a></span>(<span class="typed"><span class="type">sbt.JettyRunConfiguration</span><a id="61349">configuration</a></span>: <span class="typed"><span class="type">sbt.JettyRunConfiguration</span><a href="#6786">JettyRunConfiguration</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a id="61350">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>): <span class="typed"><span class="type">sbt.Stoppable</span><a href="#6784">Stoppable</a></span> =
	{
		<span class="keyword">import</span> configuration._
		<span class="keyword">val</span> <span class="typed"><span class="type">org.mortbay.log.Logger</span><a id="61352">oldLog</a></span> = <span class="typed"><span class="type">object org.mortbay.log.Log</span><a id="61204">Log</a></span>.<span class="typed"><span class="type">()org.mortbay.log.Logger</span><a id="61367">getLog</a></span>
		<span class="typed"><span class="type">object org.mortbay.log.Log</span><a id="61204">Log</a></span>.<span class="typed"><span class="type">(org.mortbay.log.Logger)Unit</span><a id="61366">setLog</a></span>(<span class="typed"><span class="type">sbt.LazyJettyRun.JettyLogger</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.LazyJettyRun.JettyLogger</span><a href="#60938">JettyLogger</a></span>(<span class="typed"><span class="type">sbt.Logger</span><a href="#61350">log</a></span>))
		<span class="keyword">val</span> <span class="typed"><span class="type">org.mortbay.jetty.Server</span><a id="61353">server</a></span> = <span class="typed"><span class="type">org.mortbay.jetty.Server</span><span class="keyword">new</span></span> <span class="typed"><span class="type">org.mortbay.jetty.Server</span><a id="61126">Server</a></span>
		<span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><a id="61354">useDefaults</a></span> = <span class="typed"><span class="type">=&gt; scala.xml.NodeSeq</span><a href="#60670">jettyConfigurationXML</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="7218">isEmpty</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2732">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Seq[java.io.File]</span><a href="#60672">jettyConfigurationFiles</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="7218">isEmpty</a></span>
		
		<span class="keyword">val</span> <span class="typed"><span class="type">Option[java.lang.Object with org.mortbay.util.Scanner.BulkListener]</span><a id="61355">listener</a></span> =
			<span class="typed"><span class="type">Option[java.lang.Object with org.mortbay.util.Scanner.BulkListener{ ... }]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Boolean</span><a href="#61354">useDefaults</a></span>)
			{
				<span class="typed"><span class="type">(org.mortbay.jetty.Server)Unit</span><a href="#60934">configureDefaultConnector</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#61353">server</a></span>)
				<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; java.net.URLClassLoader</span><a id="61903">createLoader</a></span> = <span class="typed"><span class="type">java.net.URLClassLoader</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.net.URLClassLoader</span><a id="4393">URLClassLoader</a></span>(<span class="typed"><span class="type">=&gt; Seq[java.net.URL]</span><a href="#60678">classpathURLs</a></span>.<span class="typed"><span class="type">Array[java.net.URL]</span><a id="7248">toArray</a></span>, <span class="keyword">this</span>.<span class="typed"><span class="type">()java.lang.Class[_ &lt;: java.lang.Object]</span><a id="3492">getClass</a></span>.<span class="typed"><span class="type">()java.lang.ClassLoader</span><a id="3930">getClassLoader</a></span>)
				<span class="keyword">val</span> <span class="typed"><span class="type">org.mortbay.jetty.webapp.WebAppContext</span><a id="61904">webapp</a></span> = <span class="typed"><span class="type">(java.lang.String,java.lang.String)org.mortbay.jetty.webapp.WebAppContext</span><a id="62057" class="keyword">new</a></span> <span class="typed"><span class="type">org.mortbay.jetty.webapp.WebAppContext</span><a id="61188">WebAppContext</a></span>(<span class="typed"><span class="type">=&gt; sbt.Path</span><a href="#60666">war</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="Path.scala.html#9638">asFile</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="9662">getCanonicalPath</a></span>, <span class="typed"><span class="type">=&gt; String</span><a href="#60668">defaultContextPath</a></span>)
				<span class="typed"><span class="type">org.mortbay.jetty.webapp.WebAppContext</span><a href="#61904">webapp</a></span>.<span class="typed"><span class="type">(java.lang.ClassLoader)Unit</span><a id="62070">setClassLoader</a></span>(<span class="typed"><span class="type">=&gt; java.net.URLClassLoader</span><a href="#61903">createLoader</a></span>)
				<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#61353">server</a></span>.<span class="typed"><span class="type">(org.mortbay.jetty.Handler)Unit</span><a id="61683">setHandler</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.webapp.WebAppContext</span><a href="#61904">webapp</a></span>)
				
				<span class="typed"><span class="type">(java.lang.Object with org.mortbay.util.Scanner.BulkListener{ ... })Some[java.lang.Object with org.mortbay.util.Scanner.BulkListener{ ... }]</span><span id="10375"><a id="289">Some</a></span></span>(<span class="typed"><span class="type">template $anon extends java.lang.Object with org.mortbay.util.Scanner.BulkListener</span><a id="62437" class="keyword">new</a></span> Scanner.<span class="typed"><span class="type">org.mortbay.util.Scanner.BulkListener</span><a id="62441">BulkListener</a></span> {
					<span class="keyword">def</span> <span class="typed"><span class="type">(java.util.List[_])Unit</span><a id="62478">filesChanged</a></span>(<span class="typed"><span class="type">java.util.List[_]</span><a id="62481">files</a></span>: <span class="typed"><span class="type">java.util.List[_]</span><a id="5382">java</a></span>.util.List[_]) {
						<span class="typed"><span class="type">(org.mortbay.jetty.Server,=&gt; Unit,sbt.Logger)Unit</span><a href="#60936">reload</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#61353">server</a></span>, <span class="typed"><span class="type">org.mortbay.jetty.webapp.WebAppContext</span><a href="#61904">webapp</a></span>.<span class="typed"><span class="type">(java.lang.ClassLoader)Unit</span><a id="62070">setClassLoader</a></span>(<span class="typed"><span class="type">=&gt; java.net.URLClassLoader</span><a href="#61903">createLoader</a></span>), <span class="typed"><span class="type">sbt.Logger</span><a href="#61350">log</a></span>)
					}
				})
			}
			<span class="keyword">else</span>
			{
				<span class="keyword">for</span>(<span class="typed"><span class="type">((scala.xml.Node) =&gt; Unit)Unit</span><span id="7365"><a id="62489">x</a></span></span> &lt;- <span class="typed"><span class="type">=&gt; scala.xml.NodeSeq</span><a href="#60670">jettyConfigurationXML</a></span>)
					(<span class="typed"><span class="type">(java.lang.String)org.mortbay.xml.XmlConfiguration</span><a id="62519" class="keyword">new</a></span> <span class="typed"><span class="type">org.mortbay.xml.XmlConfiguration</span><a id="61331">XmlConfiguration</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#62489">x</a></span>.<span class="typed"><span class="type">()String</span><a id="31714">toString</a></span>)).<span class="typed"><span class="type">(Any)Unit</span><a id="62533">configure</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#61353">server</a></span>)
				<span class="keyword">for</span>(<span class="typed"><span class="type">((java.io.File) =&gt; Unit)Unit</span><span id="7365"><a id="62543">file</a></span></span> &lt;- <span class="typed"><span class="type">=&gt; Seq[java.io.File]</span><a href="#60672">jettyConfigurationFiles</a></span>)
					(<span class="typed"><span class="type">org.mortbay.xml.XmlConfiguration</span><span class="keyword">new</span></span> <span class="typed"><span class="type">org.mortbay.xml.XmlConfiguration</span><a id="61331">XmlConfiguration</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#62543">file</a></span>.<span class="typed"><span class="type">()java.net.URI</span><a id="9665">toURI</a></span>.<span class="typed"><span class="type">()java.net.URL</span><a id="22211">toURL</a></span>)).<span class="typed"><span class="type">(Any)Unit</span><a id="62533">configure</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#61353">server</a></span>)
				<span class="typed"><span class="type">object None</span><a id="517">None</a></span>
			}
		
		<span class="keyword">def</span> <span class="typed"><span class="type">()Option[java.lang.ref.WeakReference[org.mortbay.util.Scanner]]</span><a id="61356">configureScanner</a></span>() =
		{
			<span class="typed"><span class="type">Option[java.lang.ref.WeakReference[org.mortbay.util.Scanner]]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Option[java.lang.Object with org.mortbay.util.Scanner.BulkListener]</span><a href="#61355">listener</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="10259">isEmpty</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2731">||</a></span> <span class="typed"><span class="type">=&gt; Seq[java.io.File]</span><a href="#60674">scanDirectories</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="7218">isEmpty</a></span>)
				<span class="typed"><span class="type">object None</span><a id="517">None</a></span>
			<span class="keyword">else</span>
			{
				<span class="typed"><span class="type">sbt.Logger</span><a href="#61350">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Scanning for changes to: &quot;)</span><span class="string">&quot;Scanning for changes to: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">=&gt; Seq[java.io.File]</span><a href="#60674">scanDirectories</a></span>.<span class="typed"><span class="type">(String)String</span><a id="7392">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;, &quot;)</span><span class="string">&quot;, &quot;</span></span>))
				<span class="keyword">val</span> <span class="typed"><span class="type">org.mortbay.util.Scanner</span><a id="62569">scanner</a></span> = <span class="typed"><span class="type">org.mortbay.util.Scanner</span><span class="keyword">new</span></span> <span class="typed"><span class="type">org.mortbay.util.Scanner</span><a id="61215">Scanner</a></span>
				<span class="keyword">import</span> scala.collection.jcl.Conversions._
				<span class="keyword">val</span> <span class="typed"><span class="type">java.util.ArrayList[java.io.File]</span><a id="62571">list</a></span> = <span class="typed"><span class="type">()java.util.ArrayList[java.io.File]</span><a id="24406" class="keyword">new</a></span> java.util.<span class="typed"><span class="type">java.util.ArrayList[java.io.File]</span><a id="5325">ArrayList</a></span>[File]
				<span class="typed"><span class="type">=&gt; Seq[java.io.File]</span><a href="#60674">scanDirectories</a></span>.<span class="typed"><span class="type">((java.io.File) =&gt; Unit)Unit</span><a id="7365">foreach</a></span>(<span class="typed"><span class="type">java.io.File</span><a id="62641">x</a></span> =&gt; <span class="typed"><span class="type">java.util.ArrayList[java.io.File]</span><a href="#62571">list</a></span>.<span class="typed"><span class="type">(java.io.File)Boolean</span><a id="24423">add</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#62641">x</a></span>))
				<span class="typed"><span class="type">org.mortbay.util.Scanner</span><a href="#62569">scanner</a></span>.<span class="typed"><span class="type">(java.util.List[_])Unit</span><a id="62453">setScanDirs</a></span>(<span class="typed"><span class="type">java.util.ArrayList[java.io.File]</span><a href="#62571">list</a></span>)
				<span class="typed"><span class="type">org.mortbay.util.Scanner</span><a href="#62569">scanner</a></span>.<span class="typed"><span class="type">(Boolean)Unit</span><a id="62456">setRecursive</a></span>(<span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
				<span class="typed"><span class="type">org.mortbay.util.Scanner</span><a href="#62569">scanner</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a id="62449">setScanInterval</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#60676">scanInterval</a></span>)
				<span class="typed"><span class="type">org.mortbay.util.Scanner</span><a href="#62569">scanner</a></span>.<span class="typed"><span class="type">(Boolean)Unit</span><a id="62460">setReportExistingFilesOnStartup</a></span>(<span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
				<span class="typed"><span class="type">org.mortbay.util.Scanner</span><a href="#62569">scanner</a></span>.<span class="typed"><span class="type">(org.mortbay.util.Scanner.Listener)Unit</span><a id="62461">addListener</a></span>(<span class="typed"><span class="type">Option[java.lang.Object with org.mortbay.util.Scanner.BulkListener]</span><a href="#61355">listener</a></span>.<span class="typed"><span class="type">=&gt; &lt;refinement&gt; extends java.lang.Object with org.mortbay.util.Scanner.BulkListener</span><a id="10261">get</a></span>)
				<span class="typed"><span class="type">org.mortbay.util.Scanner</span><a href="#62569">scanner</a></span>.<span class="typed"><span class="type">()Unit</span><a id="62463">start</a></span>()
				<span class="typed"><span class="type">(java.lang.ref.WeakReference[org.mortbay.util.Scanner])Some[java.lang.ref.WeakReference[org.mortbay.util.Scanner]]</span><span id="10375"><a id="289">Some</a></span></span>(<span class="typed"><span class="type">java.lang.ref.WeakReference[org.mortbay.util.Scanner]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.lang.ref.WeakReference[org.mortbay.util.Scanner]</span><a id="49617">WeakReference</a></span>(<span class="typed"><span class="type">org.mortbay.util.Scanner</span><a href="#62569">scanner</a></span>))
			}
		}
		
		<span class="keyword">try</span>
		{
			<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#61353">server</a></span>.<span class="typed"><span class="type">()Unit</span><a id="61865">start</a></span>()
			<span class="typed"><span class="type">sbt.LazyJettyRun.StopServer</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.LazyJettyRun.StopServer</span><a href="#60935">StopServer</a></span>(<span class="typed"><span class="type">java.lang.ref.WeakReference[org.mortbay.jetty.Server]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.lang.ref.WeakReference[org.mortbay.jetty.Server]</span><a id="49617">WeakReference</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#61353">server</a></span>), <span class="typed"><span class="type">()Option[java.lang.ref.WeakReference[org.mortbay.util.Scanner]]</span><a href="#61356">configureScanner</a></span>(), <span class="typed"><span class="type">org.mortbay.log.Logger</span><a href="#61352">oldLog</a></span>)
		}
		<span class="keyword">catch</span> { <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.Throwable</span><a id="62740">e</a></span> =&gt; <span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#61353">server</a></span>.<span class="typed"><span class="type">()Unit</span><a id="61866">stop</a></span>(); <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">java.lang.Throwable</span><a href="#62740">e</a></span> }
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(org.mortbay.jetty.Server)Unit</span><a id="60934">configureDefaultConnector</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a id="61905">server</a></span>: <span class="typed"><span class="type">org.mortbay.jetty.Server</span><a id="61126">Server</a></span>)
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">org.mortbay.jetty.nio.SelectChannelConnector</span><a id="62741">defaultConnector</a></span> = <span class="typed"><span class="type">org.mortbay.jetty.nio.SelectChannelConnector</span><span class="keyword">new</span></span> <span class="typed"><span class="type">org.mortbay.jetty.nio.SelectChannelConnector</span><a id="61158">SelectChannelConnector</a></span>
		<span class="typed"><span class="type">org.mortbay.jetty.nio.SelectChannelConnector</span><a href="#62741">defaultConnector</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a id="62973">setPort</a></span>(<span class="typed"><span class="type">Int(8080)</span><span class="int">8080</span></span>)
		<span class="typed"><span class="type">org.mortbay.jetty.nio.SelectChannelConnector</span><a href="#62741">defaultConnector</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a id="62877">setMaxIdleTime</a></span>(<span class="typed"><span class="type">Int(30000)</span><span class="int">30000</span></span>)
		<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#61905">server</a></span>.<span class="typed"><span class="type">(org.mortbay.jetty.Connector)Unit</span><a id="61504">addConnector</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.nio.SelectChannelConnector</span><a href="#62741">defaultConnector</a></span>)
	}
	<span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class StopServer extends java.lang.Object with sbt.Stoppable with ScalaObject</span><a id="60935">StopServer</a></span>(<span class="typed"><span class="type">java.lang.ref.Reference[org.mortbay.jetty.Server]</span><span id="62729"><a id="62734">serverReference</a></span></span>: <span class="typed"><span class="type">java.lang.ref.Reference[org.mortbay.jetty.Server]</span><a id="49623">Reference</a></span>[Server], <span class="typed"><span class="type">Option[java.lang.ref.Reference[org.mortbay.util.Scanner]]</span><span id="62730"><a id="62735">scannerReferenceOpt</a></span></span>: <span class="typed"><span class="type">Option[java.lang.ref.Reference[org.mortbay.util.Scanner]]</span><a id="915">Option</a></span>[Reference[Scanner]], <span class="typed"><span class="type">org.mortbay.log.Logger</span><span id="62731"><a id="62736">oldLog</a></span></span>: org.mortbay.log.<span class="typed"><span class="type">org.mortbay.log.Logger</span><a id="61200">Logger</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">sbt.Stoppable</span><a href="#6784">Stoppable</a></span>
	{
		<span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="62733">stop</a></span>()
		{
			<span class="keyword">val</span> <span class="typed"><span class="type">org.mortbay.jetty.Server</span><a id="63111">server</a></span> = <span class="typed"><span class="type">java.lang.ref.Reference[org.mortbay.jetty.Server]</span><a href="#62729">serverReference</a></span>.<span class="typed"><span class="type">()org.mortbay.jetty.Server</span><a id="62676">get</a></span>
			<span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#63111">server</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5765">!=</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)
				<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#63111">server</a></span>.<span class="typed"><span class="type">()Unit</span><a id="61866">stop</a></span>()
			<span class="keyword">for</span>(<span class="typed"><span class="type">((java.lang.ref.Reference[org.mortbay.util.Scanner]) =&gt; Unit)Unit</span><span id="10271"><a id="63114">scannerReference</a></span></span> &lt;- <span class="typed"><span class="type">Option[java.lang.ref.Reference[org.mortbay.util.Scanner]]</span><a href="#62730">scannerReferenceOpt</a></span>)
			{
				<span class="keyword">val</span> <span class="typed"><span class="type">org.mortbay.util.Scanner</span><a id="63115">scanner</a></span> = <span class="typed"><span class="type">java.lang.ref.Reference[org.mortbay.util.Scanner]</span><a href="#63114">scannerReference</a></span>.<span class="typed"><span class="type">()org.mortbay.util.Scanner</span><a id="62676">get</a></span>
				<span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">org.mortbay.util.Scanner</span><a href="#63115">scanner</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5765">!=</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)
					<span class="typed"><span class="type">org.mortbay.util.Scanner</span><a href="#63115">scanner</a></span>.<span class="typed"><span class="type">()Unit</span><a id="62467">stop</a></span>()
			}
			<span class="typed"><span class="type">object org.mortbay.log.Log</span><a id="61204">Log</a></span>.<span class="typed"><span class="type">(org.mortbay.log.Logger)Unit</span><a id="61366">setLog</a></span>(<span class="typed"><span class="type">org.mortbay.log.Logger</span><a href="#62731">oldLog</a></span>)
		}
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(org.mortbay.jetty.Server,=&gt; Unit,sbt.Logger)Unit</span><a id="60936">reload</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a id="62485">server</a></span>: <span class="typed"><span class="type">org.mortbay.jetty.Server</span><a id="61126">Server</a></span>, <span class="typed"><span class="type">=&gt; Unit</span><a id="62486">reconfigure</a></span>: =&gt; Unit, <span class="typed"><span class="type">sbt.Logger</span><a id="62487">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>)
	{
		<span class="typed"><span class="type">object sbt.JettyRun</span><a href="#6782">JettyRun</a></span>.<span class="typed"><span class="type">(Unit)Unit</span><a id="5768">synchronized</a></span>
		{
			<span class="typed"><span class="type">sbt.Logger</span><a href="#62487">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8467">info</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Reloading web application...&quot;)</span><span class="string">&quot;Reloading web application...&quot;</span></span>)
			<span class="keyword">val</span> <span class="typed"><span class="type">List[org.mortbay.jetty.Handler]</span><a id="63118">handlers</a></span> = <span class="typed"><span class="type">(Array[org.mortbay.jetty.Handler],org.mortbay.jetty.Handler)List[org.mortbay.jetty.Handler]</span><a href="#60937">wrapNull</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#62485">server</a></span>.<span class="typed"><span class="type">()Array[org.mortbay.jetty.Handler]</span><a id="61668">getHandlers</a></span>, <span class="typed"><span class="type">org.mortbay.jetty.Server</span><a href="#62485">server</a></span>.<span class="typed"><span class="type">()org.mortbay.jetty.Handler</span><a id="61682">getHandler</a></span>)
			<span class="typed"><span class="type">sbt.Logger</span><a href="#62487">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Stopping handlers: &quot;)</span><span class="string">&quot;Stopping handlers: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">List[org.mortbay.jetty.Handler]</span><a href="#63118">handlers</a></span>.<span class="typed"><span class="type">(String)String</span><a id="7392">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;, &quot;)</span><span class="string">&quot;, &quot;</span></span>))
			<span class="typed"><span class="type">List[org.mortbay.jetty.Handler]</span><a href="#63118">handlers</a></span>.<span class="typed"><span class="type">((org.mortbay.jetty.Handler) =&gt; Unit)Unit</span><a id="6939">foreach</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.Handler</span><a href="#63136">_</a></span>.<span class="typed"><span class="type">()Unit</span><a id="61850">stop</a></span>)
			<span class="typed"><span class="type">sbt.Logger</span><a href="#62487">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Reconfiguring...&quot;)</span><span class="string">&quot;Reconfiguring...&quot;</span></span>)
			<span class="typed"><span class="type">=&gt; Unit</span><a href="#62486">reconfigure</a></span>
			<span class="typed"><span class="type">sbt.Logger</span><a href="#62487">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Restarting handlers: &quot;)</span><span class="string">&quot;Restarting handlers: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">List[org.mortbay.jetty.Handler]</span><a href="#63118">handlers</a></span>.<span class="typed"><span class="type">(String)String</span><a id="7392">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;, &quot;)</span><span class="string">&quot;, &quot;</span></span>))
			<span class="typed"><span class="type">List[org.mortbay.jetty.Handler]</span><a href="#63118">handlers</a></span>.<span class="typed"><span class="type">((org.mortbay.jetty.Handler) =&gt; Unit)Unit</span><a id="6939">foreach</a></span>(<span class="typed"><span class="type">org.mortbay.jetty.Handler</span><a href="#63139">_</a></span>.<span class="typed"><span class="type">()Unit</span><a id="61849">start</a></span>)
			<span class="typed"><span class="type">sbt.Logger</span><a href="#62487">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8467">info</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Reload complete.&quot;)</span><span class="string">&quot;Reload complete.&quot;</span></span>)
		}
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Array[org.mortbay.jetty.Handler],org.mortbay.jetty.Handler)List[org.mortbay.jetty.Handler]</span><a id="60937">wrapNull</a></span>(<span class="typed"><span class="type">Array[org.mortbay.jetty.Handler]</span><a id="63119">a</a></span>: <span class="typed"><span class="type">Array[org.mortbay.jetty.Handler]</span><a id="1053">Array</a></span>[Handler], <span class="typed"><span class="type">org.mortbay.jetty.Handler</span><a id="63120">b</a></span>: <span class="typed"><span class="type">org.mortbay.jetty.Handler</span><a id="61084">Handler</a></span>) =
		<span class="typed"><span class="type">(Array[org.mortbay.jetty.Handler],org.mortbay.jetty.Handler)(Array[org.mortbay.jetty.Handler], org.mortbay.jetty.Handler)</span><span id="9362"><a id="1360">(</a></span></span><span class="typed"><span class="type">Array[org.mortbay.jetty.Handler]</span><a href="#63119">a</a></span>, <span class="typed"><span class="type">org.mortbay.jetty.Handler</span><a href="#63120">b</a></span>) <span class="typed"><span class="type">List[org.mortbay.jetty.Handler]</span><span class="keyword">match</span></span>
		{
			<span class="typed"><span class="type">Nil.type</span><span class="keyword">case</span></span> <a id="1">(</a><span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) =&gt; <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>
			<span class="typed"><span class="type">List[org.mortbay.jetty.Handler]</span><span class="keyword">case</span></span> <a id="1">(</a><span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">org.mortbay.jetty.Handler</span><a id="63124">notB</a></span>) =&gt; <span class="typed"><span class="type">org.mortbay.jetty.Handler</span><a href="#63124">notB</a></span> <span class="typed"><span class="type">(org.mortbay.jetty.Handler)List[org.mortbay.jetty.Handler]</span><a href="#63125" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>
			<span class="typed"><span class="type">List[org.mortbay.jetty.Handler]</span><span class="keyword">case</span></span> <a id="1">(</a><span class="typed"><span class="type">Array[org.mortbay.jetty.Handler]</span><a id="63128">notA</a></span>, <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) =&gt; <span class="typed"><span class="type">Array[org.mortbay.jetty.Handler]</span><a href="#63128">notA</a></span>.<span class="typed"><span class="type">=&gt; List[org.mortbay.jetty.Handler]</span><a id="7388">toList</a></span>
			<span class="typed"><span class="type">List[org.mortbay.jetty.Handler]</span><span class="keyword">case</span></span> <a id="1">(</a><span class="typed"><span class="type">Array[org.mortbay.jetty.Handler]</span><a id="63129">notA</a></span>, <span class="typed"><span class="type">org.mortbay.jetty.Handler</span><a id="63130">notB</a></span>) =&gt; <span class="typed"><span class="type">org.mortbay.jetty.Handler</span><a href="#63130">notB</a></span> <span class="typed"><span class="type">(org.mortbay.jetty.Handler)List[org.mortbay.jetty.Handler]</span><a href="#63131" id="6908">::</a></span> <span class="typed"><span class="type">Array[org.mortbay.jetty.Handler]</span><a href="#63129">notA</a></span>.<span class="typed"><span class="type">=&gt; List[org.mortbay.jetty.Handler]</span><a id="7388">toList</a></span>
		}
	<span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class JettyLogger extends java.lang.Object with org.mortbay.log.Logger with ScalaObject</span><a id="60938">JettyLogger</a></span>(<span class="typed"><span class="type">sbt.Logger</span><span id="61395"><a id="61406">delegate</a></span></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>) <span class="keyword">extends</span> org.mortbay.log.<span class="typed"><span class="type">org.mortbay.log.Logger</span><a id="61200">Logger</a></span>
	{
		<span class="keyword">def</span> <span class="typed"><span class="type">()Boolean</span><a id="61397">isDebugEnabled</a></span> = <span class="typed"><span class="type">sbt.Logger</span><a href="#61395">delegate</a></span>.<span class="typed"><span class="type">(sbt.Level.Value)Boolean</span><a href="Logger.scala.html#8464">atLevel</a></span>(<span class="typed"><span class="type">object sbt.Level</span><a href="Logger.scala.html#6774">Level</a></span>.<span class="typed"><span class="type">=&gt; sbt.Level.Value</span><a href="Logger.scala.html#21788">Debug</a></span>)
		<span class="keyword">def</span> <span class="typed"><span class="type">(Boolean)Unit</span><a id="61398">setDebugEnabled</a></span>(<span class="typed"><span class="type">Boolean</span><a id="63144">enabled</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2151">Boolean</a></span>) = <span class="typed"><span class="type">sbt.Logger</span><a href="#61395">delegate</a></span>.<span class="typed"><span class="type">(sbt.Level.Value)Unit</span><a href="Logger.scala.html#8461">setLevel</a></span>(<span class="typed"><span class="type">sbt.Level.Value</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Boolean</span><a href="#63144">enabled</a></span>) <span class="typed"><span class="type">object sbt.Level</span><a href="Logger.scala.html#6774">Level</a></span>.<span class="typed"><span class="type">=&gt; sbt.Level.Value</span><a href="Logger.scala.html#21788">Debug</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">object sbt.Level</span><a href="Logger.scala.html#6774">Level</a></span>.<span class="typed"><span class="type">=&gt; sbt.Level.Value</span><a href="Logger.scala.html#21790">Info</a></span>)
	
		<span class="keyword">def</span> <span class="typed"><span class="type">(String)sbt.LazyJettyRun.JettyLogger</span><a id="61399">getLogger</a></span>(<span class="typed"><span class="type">String</span><a id="63146">name</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) = <span class="typed"><span class="type">sbt.LazyJettyRun.JettyLogger</span><a href="#60938" class="keyword">this</a></span>
		<span class="keyword">def</span> <span class="typed"><span class="type">(String,AnyRef,AnyRef)Unit</span><a id="61400">info</a></span>(<span class="typed"><span class="type">String</span><a id="63148">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">AnyRef</span><a id="63149">arg0</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="1998">AnyRef</a></span>, <span class="typed"><span class="type">AnyRef</span><a id="63150">arg1</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="1998">AnyRef</a></span>) { <span class="typed"><span class="type">sbt.Logger</span><a href="#61395">delegate</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8467">info</a></span>(<span class="typed"><span class="type">(String,AnyRef,AnyRef)java.lang.String</span><a href="#61405">format</a></span>(<span class="typed"><span class="type">String</span><a href="#63148">msg</a></span>, <span class="typed"><span class="type">AnyRef</span><a href="#63149">arg0</a></span>, <span class="typed"><span class="type">AnyRef</span><a href="#63150">arg1</a></span>)) }
		<span class="keyword">def</span> <span class="typed"><span class="type">(String,AnyRef,AnyRef)Unit</span><a id="61401">debug</a></span>(<span class="typed"><span class="type">String</span><a id="63184">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">AnyRef</span><a id="63185">arg0</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="1998">AnyRef</a></span>, <span class="typed"><span class="type">AnyRef</span><a id="63186">arg1</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="1998">AnyRef</a></span>) { <span class="typed"><span class="type">sbt.Logger</span><a href="#61395">delegate</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">(String,AnyRef,AnyRef)java.lang.String</span><a href="#61405">format</a></span>(<span class="typed"><span class="type">String</span><a href="#63184">msg</a></span>, <span class="typed"><span class="type">AnyRef</span><a href="#63185">arg0</a></span>, <span class="typed"><span class="type">AnyRef</span><a href="#63186">arg1</a></span>)) }
		<span class="keyword">def</span> <span class="typed"><span class="type">(String,AnyRef,AnyRef)Unit</span><a id="61402">warn</a></span>(<span class="typed"><span class="type">String</span><a id="63187">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">AnyRef</span><a id="63188">arg0</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="1998">AnyRef</a></span>, <span class="typed"><span class="type">AnyRef</span><a id="63189">arg1</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="1998">AnyRef</a></span>) { <span class="typed"><span class="type">sbt.Logger</span><a href="#61395">delegate</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8468">warn</a></span>(<span class="typed"><span class="type">(String,AnyRef,AnyRef)java.lang.String</span><a href="#61405">format</a></span>(<span class="typed"><span class="type">String</span><a href="#63187">msg</a></span>, <span class="typed"><span class="type">AnyRef</span><a href="#63188">arg0</a></span>, <span class="typed"><span class="type">AnyRef</span><a href="#63189">arg1</a></span>)) }
		<span class="keyword">def</span> <span class="typed"><span class="type">(String,Throwable)Unit</span><a id="61403">warn</a></span>(<span class="typed"><span class="type">String</span><a id="63190">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">Throwable</span><a id="63191">th</a></span>: <span class="typed"><span class="type">Throwable</span><a id="2124">Throwable</a></span>)
		{
			<span class="typed"><span class="type">sbt.Logger</span><a href="#61395">delegate</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8468">warn</a></span>(<span class="typed"><span class="type">String</span><a href="#63190">msg</a></span>)
			<span class="typed"><span class="type">sbt.Logger</span><a href="#61395">delegate</a></span>.<span class="typed"><span class="type">(=&gt; Throwable)Unit</span><a href="Logger.scala.html#8465">trace</a></span>(<span class="typed"><span class="type">Throwable</span><a href="#63191">th</a></span>)
		}
		<span class="keyword">def</span> <span class="typed"><span class="type">(String,Throwable)Unit</span><a id="61404">debug</a></span>(<span class="typed"><span class="type">String</span><a id="63192">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">Throwable</span><a id="63193">th</a></span>: <span class="typed"><span class="type">Throwable</span><a id="2124">Throwable</a></span>)
		{
			<span class="typed"><span class="type">sbt.Logger</span><a href="#61395">delegate</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">String</span><a href="#63192">msg</a></span>)
			<span class="typed"><span class="type">sbt.Logger</span><a href="#61395">delegate</a></span>.<span class="typed"><span class="type">(=&gt; Throwable)Unit</span><a href="Logger.scala.html#8465">trace</a></span>(<span class="typed"><span class="type">Throwable</span><a href="#63193">th</a></span>)
		}
		<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String,AnyRef,AnyRef)java.lang.String</span><a id="61405">format</a></span>(<span class="typed"><span class="type">String</span><a id="63151">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">AnyRef</span><a id="63152">arg0</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="1998">AnyRef</a></span>, <span class="typed"><span class="type">AnyRef</span><a id="63153">arg1</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="1998">AnyRef</a></span>) =
		{
			<span class="keyword">def</span> <span class="typed"><span class="type">(AnyRef)java.lang.String</span><a id="63155">toString</a></span>(<span class="typed"><span class="type">AnyRef</span><a id="63157">arg</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="1998">AnyRef</a></span>) = <span class="typed"><span class="type">java.lang.String</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">AnyRef</span><a href="#63157">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3490">==</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span> <span class="keyword">else</span> <span class="typed"><span class="type">AnyRef</span><a href="#63157">arg</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="5757">toString</a></span>
			<span class="keyword">val</span> <span class="typed"><span class="type">Array[java.lang.String]</span><a id="63156">pieces</a></span> = <span class="typed"><span class="type">String</span><a href="#63151">msg</a></span>.<span class="typed"><span class="type">(java.lang.String,Int)Array[java.lang.String]</span><a id="5836">split</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;\{\}&quot;)</span><span class="string">&quot;&quot;&quot;\{\}&quot;&quot;&quot;</span></span>, <span class="typed"><span class="type">Int(3)</span><span class="int">3</span></span>)
			<span class="typed"><span class="type">java.lang.String</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Array[java.lang.String]</span><a href="#63156">pieces</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="7081">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3122">==</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
				<span class="typed"><span class="type">(Int)java.lang.String</span><a href="#63156" id="7082">pieces</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
			<span class="keyword">else</span>
			{
				<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="63172">base</a></span> = <span class="typed"><span class="type">(Int)java.lang.String</span><a href="#63156" id="7082">pieces</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">(AnyRef)java.lang.String</span><a href="#63155">toString</a></span>(<span class="typed"><span class="type">AnyRef</span><a href="#63152">arg0</a></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">(Int)java.lang.String</span><a href="#63156" id="7082">pieces</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
				<span class="typed"><span class="type">java.lang.String</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Array[java.lang.String]</span><a href="#63156">pieces</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="7081">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3122">==</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>)
					<span class="typed"><span class="type">java.lang.String</span><a href="#63172">base</a></span>
				<span class="keyword">else</span>
					<span class="typed"><span class="type">java.lang.String</span><a href="#63172">base</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">(AnyRef)java.lang.String</span><a href="#63155">toString</a></span>(<span class="typed"><span class="type">AnyRef</span><a href="#63153">arg1</a></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">(Int)java.lang.String</span><a href="#63156" id="7082">pieces</a></span>(<span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>)
			}
		}
	}
}

        </pre>
    </body>
</html>