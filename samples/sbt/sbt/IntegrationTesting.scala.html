<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>sbt/IntegrationTesting.scala</title>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2009  Steven Blundy, Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">trait</span> <a title="trait IntegrationTesting extends java.lang.Object with ScalaObject" id="6206">IntegrationTesting</a>
{
	<span class="comment">/** Override to provide pre-suite setup. */</span>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Option[String]" id="31955">pretests</a>: <a title="Option[String]" id="871">Option</a>[String] = <a title="object None" id="488">None</a>
	<span class="comment">/** Override to provide post-suite cleanup. */</span>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Option[String]" id="31956">posttests</a>: <a title="Option[String]" id="871">Option</a>[String] = <a title="object None" id="488">None</a>
}

<span class="keyword">trait</span> <a title="trait ScalaIntegrationTesting extends java.lang.Object with sbt.IntegrationTesting with ScalaObject" id="6207">ScalaIntegrationTesting</a> <span class="keyword">extends</span> <a href="#6206" title="sbt.IntegrationTesting">IntegrationTesting</a>
{
	self: ScalaProject =&gt;

	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(Iterable[sbt.TestFramework],sbt.PathFinder,sbt.CompileAnalysis,=&gt; Seq[ScalaIntegrationTesting.this.TestOption])ScalaIntegrationTesting.this.Task" id="31963">integrationTestTask</a>(<a title="Iterable[sbt.TestFramework]" id="32061">frameworks</a>: <a title="Iterable[sbt.TestFramework]" id="358">Iterable</a>[TestFramework], <a title="sbt.PathFinder" id="32062">classpath</a>: <a href="Path.scala.html#6703" title="sbt.PathFinder">PathFinder</a>, <a title="sbt.CompileAnalysis" id="32063">analysis</a>: <a href="Analysis.scala.html#6138" title="sbt.CompileAnalysis">CompileAnalysis</a>, <a title="=&gt; Seq[ScalaIntegrationTesting.this.TestOption]" id="32064">options</a>: =&gt; Seq[TestOption]) =
		<a href="TaskManager.scala.html#26162" title="(=&gt; Option[String])ScalaIntegrationTesting.this.Task">task</a>{
			<span class="keyword">import</span> Control._
			<a href="Control.scala.html#10189" title="(=&gt; String,sbt.Logger)(=&gt; Option[String])Option[String]">trapUnit</a>(<span title="java.lang.String(&quot;Setup failed: &quot;)" class="string">&quot;Setup failed: &quot;</span>, <a href="Project.scala.html#26169" title="=&gt; sbt.Logger">log</a>)(<a href="#31955" title="=&gt; Option[String]">pretests</a>) <span title="Option[String]" class="keyword">match</span>
			{
				<span title="Some[String]" class="keyword">case</span> <a id="1">Some</a>(<a title="String" id="32068">msg</a>) =&gt; <span id="10256"><a title="(String)Some[String]" id="275">Some</a></span>(<a href="#32068" title="String">msg</a>)
				<span title="Option[String]" class="keyword">case</span> <a title="object None" id="488">None</a> =&gt; <a href="Control.scala.html#10190" title="(=&gt; String,sbt.Logger)(=&gt; Option[String])(=&gt; Unit)Option[String]">trapUnitAndFinally</a>(<span title="java.lang.String(&quot;Exception in framework&quot;)" class="string">&quot;Exception in framework&quot;</span>, <a href="Project.scala.html#26169" title="=&gt; sbt.Logger">log</a>)(<a href="#31964" title="(Iterable[sbt.TestFramework],sbt.PathFinder,sbt.CompileAnalysis,=&gt; Seq[ScalaIntegrationTesting.this.TestOption])Option[String]">executeIntegrationTests</a>(<a href="#32061" title="Iterable[sbt.TestFramework]">frameworks</a>, <a href="#32062" title="sbt.PathFinder">classpath</a>, <a href="#32063" title="sbt.CompileAnalysis">analysis</a>, <a href="#32064" title="=&gt; Seq[ScalaIntegrationTesting.this.TestOption]">options</a>))(
					<a href="Control.scala.html#10189" title="(=&gt; String,sbt.Logger)(=&gt; Option[String])Option[String]">trapUnit</a>(<span title="java.lang.String(&quot;Cleanup failed: &quot;)" class="string">&quot;Cleanup failed: &quot;</span>, <a href="Project.scala.html#26169" title="=&gt; sbt.Logger">log</a>)(<a href="#31956" title="=&gt; Option[String]">posttests</a>) <span title="Unit" class="keyword">match</span>
					{
						<span title="Unit" class="keyword">case</span> <a id="1">Some</a>(<a title="String" id="32078">msg</a>) =&gt; <a href="Project.scala.html#26169" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8354" title="(=&gt; String)Unit">error</a>(<a href="#32078" title="String">msg</a>)
						<span title="Unit" class="keyword">case</span> <a title="object None" id="488">None</a> =&gt; <span title="Unit">{</span>}
					}
				)
			}
		}

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Iterable[sbt.TestFramework],sbt.PathFinder,sbt.CompileAnalysis,=&gt; Seq[ScalaIntegrationTesting.this.TestOption])Option[String]" id="31964">executeIntegrationTests</a>(<a title="Iterable[sbt.TestFramework]" id="32074">frameworks</a>: <a title="Iterable[sbt.TestFramework]" id="358">Iterable</a>[TestFramework], <a title="sbt.PathFinder" id="32075">classpath</a>: <a href="Path.scala.html#6703" title="sbt.PathFinder">PathFinder</a>, <a title="sbt.CompileAnalysis" id="32076">analysis</a>: <a href="Analysis.scala.html#6138" title="sbt.CompileAnalysis">CompileAnalysis</a>, <a title="=&gt; Seq[ScalaIntegrationTesting.this.TestOption]" id="32077">options</a>: =&gt; Seq[TestOption]): <a title="Option[String]" id="871">Option</a>[String] =
		<a href="ScalaProject.scala.html#32050" title="(Iterable[sbt.TestFramework],sbt.PathFinder,sbt.CompileAnalysis,=&gt; Seq[ScalaIntegrationTesting.this.TestOption])Option[String]">doTests</a>(<a href="#32074" title="Iterable[sbt.TestFramework]">frameworks</a>, <a href="#32075" title="sbt.PathFinder">classpath</a>, <a href="#32076" title="sbt.CompileAnalysis">analysis</a>, <a href="#32077" title="=&gt; Seq[ScalaIntegrationTesting.this.TestOption]">options</a>)
}

<span class="comment">/** A fully featured integration testing that may be mixed in with any subclass of &lt;code&gt;BasicScalaProject&lt;/code&gt;.
 * Pre-suite setup and post-suite cleanup are provide by overriding &lt;code&gt;pretests&lt;/code&gt; and &lt;code&gt;posttests&lt;/code&gt; respectively.*/</span>
<span class="keyword">trait</span> <a title="trait BasicScalaIntegrationTesting extends java.lang.Object with sbt.ScalaIntegrationTesting with sbt.IntegrationTestPaths with sbt.BasicDependencyProject with ScalaObject" id="6208">BasicScalaIntegrationTesting</a> <span class="keyword">extends</span> <a href="#6207" title="sbt.ScalaIntegrationTesting">ScalaIntegrationTesting</a> <span class="keyword">with</span> <a href="#6211" title="sbt.IntegrationTestPaths">IntegrationTestPaths</a> <span class="keyword">with</span> <a href="BasicProjectTypes.scala.html#6166" title="sbt.BasicDependencyProject">BasicDependencyProject</a>
{
	self: BasicScalaProject =&gt;

	<span class="keyword">import</span> BasicScalaIntegrationTesting._
	
	<span class="keyword">lazy</span> <span class="keyword">val</span> <a title="BasicScalaIntegrationTesting.this.Task" id="32094">integrationTestCompile</a> = <a href="#32100" title="=&gt; BasicScalaIntegrationTesting.this.Task">integrationTestCompileAction</a>
	<span class="keyword">lazy</span> <span class="keyword">val</span> <a title="BasicScalaIntegrationTesting.this.Task" id="32096">integrationTest</a> = <a href="#32099" title="=&gt; BasicScalaIntegrationTesting.this.Task">integrationTestAction</a>

	<span class="keyword">val</span> <span id="32098"><a title="sbt.CompileConditional" id="32097">integrationTestCompileConditional</a></span> = <span title="sbt.CompileConditional" class="keyword">new</span> <a href="Conditional.scala.html#6253" title="sbt.CompileConditional">CompileConditional</a>(<a href="#32108" title="=&gt; BasicScalaIntegrationTesting.this.IntegrationTestCompileConfig">integrationTestCompileConfiguration</a>)

	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; BasicScalaIntegrationTesting.this.Task" id="32099">integrationTestAction</a> = <a href="#31963" title="(Iterable[sbt.TestFramework],sbt.PathFinder,sbt.CompileAnalysis,=&gt; Seq[BasicScalaIntegrationTesting.this.TestOption])BasicScalaIntegrationTesting.this.Task">integrationTestTask</a>(<a href="#32109" title="=&gt; Iterable[sbt.TestFramework]">integrationTestFrameworks</a>, <a href="#32105" title="=&gt; sbt.PathFinder">integrationTestClasspath</a>, <a href="#32097" title="=&gt; sbt.CompileConditional">integrationTestCompileConditional</a>.<a href="Conditional.scala.html#32286" title="=&gt; BasicScalaIntegrationTesting.this.integrationTestCompileConditional.AnalysisType">analysis</a>, <a href="#32102" title="=&gt; Seq[BasicScalaIntegrationTesting.this.TestOption]">integrationTestOptions</a>) <a href="TaskManager.scala.html#28027" title="(BasicScalaIntegrationTesting.this.ManagedTask*)BasicScalaIntegrationTesting.this.Task">dependsOn</a> <a href="#32093" title="=&gt; BasicScalaIntegrationTesting.this.Task">integrationTestCompile</a> <a href="TaskManager.scala.html#28029" title="(String)BasicScalaIntegrationTesting.this.Task">describedAs</a> <a href="#32280" title="=&gt; java.lang.String">IntegrationTestCompileDescription</a>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; BasicScalaIntegrationTesting.this.Task" id="32100">integrationTestCompileAction</a> = <a href="#32101" title="()BasicScalaIntegrationTesting.this.Task">integrationTestCompileTask</a>() <a href="TaskManager.scala.html#28027" title="(BasicScalaIntegrationTesting.this.ManagedTask*)BasicScalaIntegrationTesting.this.Task">dependsOn</a> <a href="DefaultProject.scala.html#32187" title="=&gt; BasicScalaIntegrationTesting.this.Task">compile</a> <a href="TaskManager.scala.html#28029" title="(String)BasicScalaIntegrationTesting.this.Task">describedAs</a> <a href="#32282" title="=&gt; java.lang.String">IntegrationTestDescription</a>

	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="()BasicScalaIntegrationTesting.this.Task" id="32101">integrationTestCompileTask</a>() = <a href="TaskManager.scala.html#26162" title="(=&gt; Option[String])BasicScalaIntegrationTesting.this.Task">task</a>{ <a href="#32097" title="=&gt; sbt.CompileConditional">integrationTestCompileConditional</a>.<a href="Conditional.scala.html#32303" title="=&gt; Option[String]">run</a> }

	<span class="keyword">def</span> <a title="=&gt; Seq[BasicScalaIntegrationTesting.this.TestOption]" id="32102">integrationTestOptions</a>: <a title="Seq[BasicScalaIntegrationTesting.this.TestOption]" id="715">Seq</a>[TestOption] = <a title="object Nil" id="299">Nil</a>
	<span class="keyword">def</span> <a title="=&gt; Seq[BasicScalaIntegrationTesting.this.CompileOption]" id="32103">integrationTestCompileOptions</a> = <a href="DefaultProject.scala.html#32133" title="=&gt; Seq[BasicScalaIntegrationTesting.this.CompileOption]">testCompileOptions</a>
	
	<span class="keyword">def</span> <a title="=&gt; sbt.Configuration" id="32104">integrationTestConfiguration</a> = <span title="sbt.Configuration" class="keyword">if</span>(<a href="#32110" title="=&gt; Boolean">useIntegrationTestConfiguration</a>) <a href="ManageDependencies.scala.html#6486" title="object sbt.Configurations">Configurations</a>.<a href="ManageDependencies.scala.html#27397" title="=&gt; sbt.Configuration">IntegrationTest</a> <span class="keyword">else</span> <a href="ManageDependencies.scala.html#6486" title="object sbt.Configurations">Configurations</a>.<a href="ManageDependencies.scala.html#27405" title="=&gt; sbt.Configuration">Test</a>
	<span class="keyword">def</span> <a title="=&gt; sbt.PathFinder" id="32105">integrationTestClasspath</a> = <a href="BasicProjectTypes.scala.html#26235" title="(sbt.Configuration)sbt.PathFinder">fullClasspath</a>(<a href="#32104" title="=&gt; sbt.Configuration">integrationTestConfiguration</a>) <a href="Path.scala.html#9510" title="(sbt.PathFinder)sbt.PathFinder">+++</a> <a href="DefaultProject.scala.html#32150" title="=&gt; sbt.PathFinder">optionalClasspath</a>
	
	<span class="keyword">def</span> <a title="=&gt; sbt.PathFinder" id="32106">integrationTestSources</a> = <a href="Project.scala.html#26230" title="(sbt.PathFinder,sbt.FileFilter)sbt.PathFinder">descendents</a>(<a href="#32274" title="=&gt; sbt.Path">integrationTestScalaSourcePath</a>, <a href="Project.scala.html#26198" title="implicit sbt.Project.filter : (String)sbt.NameFilter" class="string">&quot;*.scala&quot;</a>)
	<span class="keyword">def</span> <a title="=&gt; java.lang.String" id="32107">integrationTestLabel</a> = <span title="java.lang.String(&quot;integration-test&quot;)" class="string">&quot;integration-test&quot;</span>
	<span class="keyword">def</span> <a title="=&gt; BasicScalaIntegrationTesting.this.IntegrationTestCompileConfig" id="32108">integrationTestCompileConfiguration</a> = <span title="BasicScalaIntegrationTesting.this.IntegrationTestCompileConfig" class="keyword">new</span> <a href="#32112" title="BasicScalaIntegrationTesting.this.IntegrationTestCompileConfig">IntegrationTestCompileConfig</a>

	<span class="keyword">def</span> <a title="=&gt; Iterable[sbt.TestFramework]" id="32109">integrationTestFrameworks</a> = <a href="DefaultProject.scala.html#32153" title="=&gt; Iterable[sbt.TestFramework]">testFrameworks</a>
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="32110">useIntegrationTestConfiguration</a> = <span title="Boolean(false)" class="keyword">false</span>
	<span class="keyword">abstract</span> <span class="keyword">override</span> <span class="keyword">def</span> <a title="(sbt.Configuration)sbt.PathFinder" id="32111">fullUnmanagedClasspath</a>(<a title="sbt.Configuration" id="32685">config</a>: <a href="ManageDependencies.scala.html#6485" title="sbt.Configuration">Configuration</a>) =
	{
		<span class="keyword">val</span> <a title="sbt.PathFinder" id="32687">superClasspath</a> = <span class="keyword">super</span>.<a href="BasicProjectTypes.scala.html#27358" title="(sbt.Configuration)sbt.PathFinder">fullUnmanagedClasspath</a>(<a href="#32685" title="sbt.Configuration">config</a>)
		<span title="sbt.PathFinder" class="keyword">if</span>(<a href="#32685" title="sbt.Configuration">config</a> <a title="(AnyRef)Boolean" id="3399">==</a> <a href="#32104" title="=&gt; sbt.Configuration">integrationTestConfiguration</a>)
			<a href="#32276" title="=&gt; sbt.Path">integrationTestCompilePath</a> <a href="Path.scala.html#9510" title="(sbt.PathFinder)sbt.PathFinder">+++</a> <a href="#32275" title="=&gt; sbt.Path">integrationTestResourcesPath</a> <a href="Path.scala.html#9510" title="(sbt.PathFinder)sbt.PathFinder">+++</a> <a href="#32687" title="sbt.PathFinder">superClasspath</a>
		<span class="keyword">else</span>
			<a href="#32687" title="sbt.PathFinder">superClasspath</a>
	}

	<span class="keyword">class</span> <a title="class IntegrationTestCompileConfig extends BasicScalaIntegrationTesting.this.BaseCompileConfig with ScalaObject" id="32112">IntegrationTestCompileConfig</a> <span class="keyword">extends</span> <a href="DefaultProject.scala.html#32158" title="BasicScalaIntegrationTesting.this.BaseCompileConfig">BaseCompileConfig</a>
	{
		<span class="keyword">def</span> <a title="=&gt; java.lang.String" id="32356">label</a> = <a href="#32107" title="=&gt; java.lang.String">integrationTestLabel</a>
		<span class="keyword">def</span> <a title="=&gt; sbt.PathFinder" id="32357">sources</a> = <a href="#32106" title="=&gt; sbt.PathFinder">integrationTestSources</a>
		<span class="keyword">def</span> <a title="=&gt; sbt.Path" id="32358">outputDirectory</a> = <a href="#32276" title="=&gt; sbt.Path">integrationTestCompilePath</a>
		<span class="keyword">def</span> <a title="=&gt; sbt.PathFinder" id="32359">classpath</a> = <a href="#32105" title="=&gt; sbt.PathFinder">integrationTestClasspath</a>
		<span class="keyword">def</span> <a title="=&gt; sbt.Path" id="32360">analysisPath</a> = <a href="#32277" title="=&gt; sbt.Path">integrationTestAnalysisPath</a>
		<span class="keyword">def</span> <a title="=&gt; Seq[String]" id="32361">options</a> = <a href="#32103" title="=&gt; Seq[BasicScalaIntegrationTesting.this.CompileOption]">integrationTestCompileOptions</a>.<a title="((BasicScalaIntegrationTesting.this.CompileOption) =&gt; String)Seq[String]" id="7124">map</a>(<a href="#32727" title="BasicScalaIntegrationTesting.this.CompileOption">_</a>.<a href="ScalaProject.scala.html#32729" title="=&gt; String">asString</a>)
		<span class="keyword">def</span> <a title="=&gt; Iterable[String]" id="32362">testDefinitionClassNames</a> = <a href="#32109" title="=&gt; Iterable[sbt.TestFramework]">integrationTestFrameworks</a>.<a title="((sbt.TestFramework) =&gt; String)Iterable[String]" id="7246">map</a>(<a href="#32737" title="sbt.TestFramework">_</a>.<a href="TestFramework.scala.html#32739" title="=&gt; String">testSuperClassName</a>)
	}
}

<span class="keyword">object</span> <a title="object sbt.BasicScalaIntegrationTesting" id="6209">BasicScalaIntegrationTesting</a>
{
	<span class="keyword">val</span> <span id="32281"><a title="java.lang.String" id="32280">IntegrationTestCompileDescription</a></span> = <span title="java.lang.String(&quot;Compiles integration test sources.&quot;)" class="string">&quot;Compiles integration test sources.&quot;</span>
	<span class="keyword">val</span> <span id="32283"><a title="java.lang.String" id="32282">IntegrationTestDescription</a></span> = <span title="java.lang.String(&quot;Runs all integration tests detected during compilation.&quot;)" class="string">&quot;Runs all integration tests detected during compilation.&quot;</span>
}

<span class="keyword">trait</span> <a title="trait IntegrationTestPaths extends java.lang.Object with sbt.BasicProjectPaths with ScalaObject" id="6211">IntegrationTestPaths</a> <span class="keyword">extends</span> <a href="DefaultProject.scala.html#6734" title="sbt.BasicProjectPaths">BasicProjectPaths</a>
{
	<span class="keyword">import</span> IntegrationTestPaths._

	<span class="keyword">def</span> <a title="=&gt; java.lang.String" id="32270">integrationTestDirectoryName</a> = <a href="#32672" title="=&gt; java.lang.String">DefaultIntegrationTestDirectoryName</a>
	<span class="keyword">def</span> <a title="=&gt; java.lang.String" id="32271">integrationTestCompileDirectoryName</a> = <a href="#32674" title="=&gt; java.lang.String">DefaultIntegrationTestCompileDirectoryName</a>
	<span class="keyword">def</span> <a title="=&gt; java.lang.String" id="32272">integrationTestAnalysisDirectoryName</a> = <a href="#32676" title="=&gt; java.lang.String">DefaultIntegrationTestAnalysisDirectoryName</a>

	<span class="keyword">def</span> <a title="=&gt; sbt.Path" id="32273">integrationTestSourcePath</a> = <a href="DefaultProject.scala.html#32252" title="=&gt; sbt.Path">sourcePath</a> <a href="Path.scala.html#9523" title="(String)sbt.Path">/</a> <a href="#32270" title="=&gt; java.lang.String">integrationTestDirectoryName</a>
	<span class="keyword">def</span> <a title="=&gt; sbt.Path" id="32274">integrationTestScalaSourcePath</a> = <a href="#32273" title="=&gt; sbt.Path">integrationTestSourcePath</a> <a href="Path.scala.html#9523" title="(String)sbt.Path">/</a> <a href="DefaultProject.scala.html#32242" title="=&gt; java.lang.String">scalaDirectoryName</a>
	<span class="keyword">def</span> <a title="=&gt; sbt.Path" id="32275">integrationTestResourcesPath</a> = <a href="#32273" title="=&gt; sbt.Path">integrationTestSourcePath</a> <a href="Path.scala.html#9523" title="(String)sbt.Path">/</a> <a href="DefaultProject.scala.html#32243" title="=&gt; java.lang.String">resourcesDirectoryName</a>

	<span class="keyword">def</span> <a title="=&gt; sbt.Path" id="32276">integrationTestCompilePath</a> = <a href="Project.scala.html#26213" title="=&gt; sbt.Path">outputPath</a> <a href="Path.scala.html#9523" title="(String)sbt.Path">/</a> <a href="#32271" title="=&gt; java.lang.String">integrationTestCompileDirectoryName</a>
	<span class="keyword">def</span> <a title="=&gt; sbt.Path" id="32277">integrationTestAnalysisPath</a> = <a href="Project.scala.html#26213" title="=&gt; sbt.Path">outputPath</a> <a href="Path.scala.html#9523" title="(String)sbt.Path">/</a> <a href="#32272" title="=&gt; java.lang.String">integrationTestAnalysisDirectoryName</a>
}

<span class="keyword">object</span> <a title="object sbt.IntegrationTestPaths" id="6212">IntegrationTestPaths</a>
{
	<span class="keyword">val</span> <span id="32673"><a title="java.lang.String" id="32672">DefaultIntegrationTestDirectoryName</a></span> = <span title="java.lang.String(&quot;it&quot;)" class="string">&quot;it&quot;</span>
	<span class="keyword">val</span> <span id="32675"><a title="java.lang.String" id="32674">DefaultIntegrationTestCompileDirectoryName</a></span> = <span title="java.lang.String(&quot;it-classes&quot;)" class="string">&quot;it-classes&quot;</span>
	<span class="keyword">val</span> <span id="32677"><a title="java.lang.String" id="32676">DefaultIntegrationTestAnalysisDirectoryName</a></span> = <span title="java.lang.String(&quot;it-analysis&quot;)" class="string">&quot;it-analysis&quot;</span>
}
        </pre>
    </body>
</html>