<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>sbt/Pack.scala</title>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2009 Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">import</span> java.io.{File, FileOutputStream}
<span class="keyword">import</span> java.util.jar.{JarEntry, JarFile, JarOutputStream, Pack200}
<span class="keyword">import</span> scala.collection.Map
<span class="keyword">import</span> scala.collection.jcl.Conversions
<span class="keyword">import</span> FileUtilities._

<span class="keyword">object</span> <span class="typed"><span class="type">object sbt.Pack</span><a id="6686">Pack</a></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.Path,sbt.Path,sbt.Logger)Option[String]</span><a id="51664">pack</a></span>(<span class="typed"><span class="type">sbt.Path</span><a id="51673">jarPath</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="typed"><span class="type">sbt.Path</span><a id="51674">out</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a id="51675">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>): <span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String] = <span class="typed"><span class="type">(sbt.Path,sbt.Path,scala.collection.Map[String,String],sbt.Logger)Option[String]</span><a href="#51665">pack</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#51673">jarPath</a></span>, <span class="typed"><span class="type">sbt.Path</span><a href="#51674">out</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.Map[String,String]</span><a href="#51667">defaultPackerOptions</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#51675">log</a></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.Path,sbt.Path,scala.collection.Map[String,String],sbt.Logger)Option[String]</span><a id="51665">pack</a></span>(<span class="typed"><span class="type">sbt.Path</span><a id="51669">jarPath</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="typed"><span class="type">sbt.Path</span><a id="51670">out</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="typed"><span class="type">scala.collection.Map[String,String]</span><a id="51671">options</a></span>: <span class="typed"><span class="type">scala.collection.Map[String,String]</span><a id="7472">Map</a></span>[String, String], <span class="typed"><span class="type">sbt.Logger</span><a id="51672">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>): <span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String] =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">java.util.jar.Pack200.Packer</span><a id="55850">packer</a></span> = <span class="typed"><span class="type">object java.util.jar.Pack200</span><a id="10177">Pack200</a></span>.<span class="typed"><span class="type">()java.util.jar.Pack200.Packer</span><a id="55858">newPacker</a></span>
		<span class="keyword">val</span> <span class="typed"><span class="type">&lt;refinement&gt; extends java.lang.Object with scala.collection.jcl.MapWrapper[java.lang.String,java.lang.String]</span><a id="55851">properties</a></span> = <span class="typed"><span class="type">object scala.collection.jcl.Conversions</span><a id="7785">Conversions</a></span>.<span class="typed"><span class="type">(java.util.Map[java.lang.String,java.lang.String])java.lang.Object with scala.collection.jcl.MapWrapper[java.lang.String,java.lang.String]</span><a id="24276">convertMap</a></span>(<span class="typed"><span class="type">java.util.jar.Pack200.Packer</span><a href="#55850">packer</a></span>.<span class="typed"><span class="type">()java.util.SortedMap[java.lang.String,java.lang.String]</span><a id="55881">properties</a></span>)
		<span class="typed"><span class="type">&lt;refinement&gt; extends java.lang.Object with scala.collection.jcl.MapWrapper[java.lang.String,java.lang.String]</span><a href="#55851">properties</a></span> <span class="typed"><span class="type">(Iterable[(java.lang.String, java.lang.String)])Unit</span><a id="47294">++=</a></span> <span class="typed"><span class="type">scala.collection.Map[String,String]</span><a href="#51671">options</a></span>
		 
		<span class="typed"><span class="type">object sbt.OpenResource</span><a href="FileUtilities.scala.html#6458">OpenResource</a></span>.<span class="typed"><span class="type">(Boolean)sbt.OpenFile[sbt.CloseableJarFile]</span><a href="FileUtilities.scala.html#22103">openJarFile</a></span>(<span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>).<span class="typed"><span class="type">(java.io.File,String,sbt.Logger)((sbt.CloseableJarFile) =&gt; Option[String])Option[String]</span><a href="FileUtilities.scala.html#45387">ioOption</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#51669">jarPath</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="Path.scala.html#9638">asFile</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;applying pack200 compression to jar&quot;)</span><span class="string">&quot;applying pack200 compression to jar&quot;</span></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#51672">log</a></span>) {
			<span class="typed"><span class="type">sbt.CloseableJarFile</span><a id="55895">f</a></span> =&gt; <span class="typed"><span class="type">(java.io.File,sbt.Logger)((java.io.OutputStream) =&gt; Option[String])Option[String]</span><a href="FileUtilities.scala.html#9575">writeStream</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#51670">out</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="Path.scala.html#9638">asFile</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#51672">log</a></span>) { <span class="typed"><span class="type">java.io.OutputStream</span><a id="55898">stream</a></span> =&gt; <span class="typed"><span class="type">java.util.jar.Pack200.Packer</span><a href="#55850">packer</a></span>.<span class="typed"><span class="type">(java.util.jar.JarFile,java.io.OutputStream)Unit</span><a id="55882">pack</a></span>(<span class="typed"><span class="type">sbt.CloseableJarFile</span><a href="#55895">f</a></span>, <span class="typed"><span class="type">java.io.OutputStream</span><a href="#55898">stream</a></span>); <span class="typed"><span class="type">object None</span><a id="517">None</a></span> }
		}
	}
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.Path,sbt.Path,sbt.Logger)Option[String]</span><a id="51666">unpack</a></span>(<span class="typed"><span class="type">sbt.Path</span><a id="51899">packedPath</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="typed"><span class="type">sbt.Path</span><a id="51900">toJarPath</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a id="51901">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>): <span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String] =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">java.util.jar.Pack200.Unpacker</span><a id="55907">unpacker</a></span> = <span class="typed"><span class="type">object java.util.jar.Pack200</span><a id="10177">Pack200</a></span>.<span class="typed"><span class="type">()java.util.jar.Pack200.Unpacker</span><a id="55859">newUnpacker</a></span>
		<span class="typed"><span class="type">(java.io.File,sbt.Logger)((java.io.OutputStream) =&gt; Option[String])Option[String]</span><a href="FileUtilities.scala.html#9575">writeStream</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#51900">toJarPath</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="Path.scala.html#9638">asFile</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#51901">log</a></span>) { <span class="typed"><span class="type">java.io.OutputStream</span><a id="55922">fileStream</a></span> =&gt;
			<span class="keyword">val</span> <span class="typed"><span class="type">java.util.jar.JarOutputStream</span><a id="55923">jarOut</a></span> = <span class="typed"><span class="type">(java.io.OutputStream)java.util.jar.JarOutputStream</span><a id="44739" class="keyword">new</a></span> <span class="typed"><span class="type">java.util.jar.JarOutputStream</span><a id="10143">JarOutputStream</a></span>(<span class="typed"><span class="type">java.io.OutputStream</span><a href="#55922">fileStream</a></span>)
			<span class="typed"><span class="type">object sbt.Control</span><a href="Control.scala.html#6704">Control</a></span>.<span class="typed"><span class="type">(=&gt; String,sbt.Logger)(=&gt; Option[String])(=&gt; Unit)Option[String]</span><a href="Control.scala.html#10299">trapUnitAndFinally</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Error unpacking '&quot;)</span><span class="string">&quot;Error unpacking '&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">sbt.Path</span><a href="#51899">packedPath</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;': &quot;)</span><span class="string">&quot;': &quot;</span></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#51901">log</a></span>)
				{ <span class="typed"><span class="type">java.util.jar.Pack200.Unpacker</span><a href="#55907">unpacker</a></span>.<span class="typed"><span class="type">(java.io.File,java.util.jar.JarOutputStream)Unit</span><a id="55917">unpack</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#51899">packedPath</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="Path.scala.html#9638">asFile</a></span>, <span class="typed"><span class="type">java.util.jar.JarOutputStream</span><a href="#55923">jarOut</a></span>); <span class="typed"><span class="type">object None</span><a id="517">None</a></span> }
				{ <span class="typed"><span class="type">java.util.jar.JarOutputStream</span><a href="#55923">jarOut</a></span>.<span class="typed"><span class="type">()Unit</span><a id="44499">close</a></span>() }
		}
	}
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.collection.Map[String,String]</span><a id="51667">defaultPackerOptions</a></span>: <span class="typed"><span class="type">scala.collection.Map[String,String]</span><a id="7472">Map</a></span>[String, String] = scala.collection.immutable.<span class="typed"><span class="type">((String, Nothing)*)scala.collection.immutable.Map[String,Nothing]</span><span id="40618"><a id="27119">Map</a></span></span>()
}

<span class="keyword">import</span> java.net.URL
<span class="comment">/** This is somewhat of a mess and is not entirely correct.  jarsigner doesn't work properly
* on scalaz and it is difficult to determine whether a jar is both signed and valid.  */</span>
<span class="keyword">object</span> <span class="typed"><span class="type">object sbt.SignJar</span><a id="6689">SignJar</a></span>
{
	<span class="keyword">final</span> <span class="keyword">class</span> <span class="typed"><span class="type">class SignOption extends java.lang.Object with NotNull with ScalaObject</span><a id="51402">SignOption</a></span> <span class="keyword">private</span>[SignJar](<span class="keyword">val</span> <span class="typed"><span class="type">List[String]</span><span id="51580"><span id="51579"><a id="51585">toList</a></span></span></span>: <span class="typed"><span class="type">List[String]</span><a id="507">List</a></span>[String], <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><span id="51582"><span id="51581"><a id="51586">signOnly</a></span></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2151">Boolean</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">NotNull</span><a id="186">NotNull</a></span>
	{
		<span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="51584">toString</a></span> = <span class="typed"><span class="type">=&gt; List[String]</span><a href="#51579">toList</a></span>.<span class="typed"><span class="type">(String)String</span><a id="7392">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span>)
	}
	<span class="keyword">def</span> <span class="typed"><span class="type">(java.net.URL)sbt.SignJar.SignOption</span><a id="51403">keyStore</a></span>(<span class="typed"><span class="type">java.net.URL</span><a id="55935">url</a></span>: <span class="typed"><span class="type">java.net.URL</span><a id="4372">URL</a></span>) = <span class="typed"><span class="type">sbt.SignJar.SignOption</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#51402">SignOption</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;-keystore&quot;)</span><span class="string">&quot;-keystore&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#55937" id="6908">::</a></span> <span class="typed"><span class="type">java.net.URL</span><a href="#55935">url</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="23807">toExternalForm</a></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#55938" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.Path)sbt.SignJar.SignOption</span><a id="51404">signedJar</a></span>(<span class="typed"><span class="type">sbt.Path</span><a id="51575">p</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>) = <span class="typed"><span class="type">sbt.SignJar.SignOption</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#51402">SignOption</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;-signedjar&quot;)</span><span class="string">&quot;-signedjar&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#51587" id="6908">::</a></span> <span class="typed"><span class="type">sbt.Path</span><a href="#51575">p</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="Path.scala.html#9638">asFile</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="9660">getAbsolutePath</a></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#51588" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; sbt.SignJar.SignOption</span><a id="51405">verbose</a></span> = <span class="typed"><span class="type">sbt.SignJar.SignOption</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#51402">SignOption</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;-verbose&quot;)</span><span class="string">&quot;-verbose&quot;</span></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#55945" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)sbt.SignJar.SignOption</span><a id="51406">sigFile</a></span>(<span class="typed"><span class="type">String</span><a id="55948">name</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) = <span class="typed"><span class="type">sbt.SignJar.SignOption</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#51402">SignOption</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;-sigfile&quot;)</span><span class="string">&quot;-sigfile&quot;</span></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55950" id="6908">::</a></span> <span class="typed"><span class="type">String</span><a href="#55948">name</a></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55951" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)sbt.SignJar.SignOption</span><a id="51407">storeType</a></span>(<span class="typed"><span class="type">String</span><a id="55956">t</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) = <span class="typed"><span class="type">sbt.SignJar.SignOption</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#51402">SignOption</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;-storetype&quot;)</span><span class="string">&quot;-storetype&quot;</span></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55958" id="6908">::</a></span> <span class="typed"><span class="type">String</span><a href="#55956">t</a></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55959" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)sbt.SignJar.SignOption</span><a id="51408">provider</a></span>(<span class="typed"><span class="type">String</span><a id="55964">p</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) = <span class="typed"><span class="type">sbt.SignJar.SignOption</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#51402">SignOption</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;-provider&quot;)</span><span class="string">&quot;-provider&quot;</span></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55966" id="6908">::</a></span> <span class="typed"><span class="type">String</span><a href="#55964">p</a></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55967" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)sbt.SignJar.SignOption</span><a id="51409">providerName</a></span>(<span class="typed"><span class="type">String</span><a id="55972">p</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) = <span class="typed"><span class="type">sbt.SignJar.SignOption</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#51402">SignOption</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;-providerName&quot;)</span><span class="string">&quot;-providerName&quot;</span></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55974" id="6908">::</a></span> <span class="typed"><span class="type">String</span><a href="#55972">p</a></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55975" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)sbt.SignJar.SignOption</span><a id="51410">storePassword</a></span>(<span class="typed"><span class="type">String</span><a id="55980">p</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) = <span class="typed"><span class="type">sbt.SignJar.SignOption</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#51402">SignOption</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;-storepass&quot;)</span><span class="string">&quot;-storepass&quot;</span></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55982" id="6908">::</a></span> <span class="typed"><span class="type">String</span><a href="#55980">p</a></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55983" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)sbt.SignJar.SignOption</span><a id="51411">keyPassword</a></span>(<span class="typed"><span class="type">String</span><a id="55988">p</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) = <span class="typed"><span class="type">sbt.SignJar.SignOption</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#51402">SignOption</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;-keypass&quot;)</span><span class="string">&quot;-keypass&quot;</span></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55990" id="6908">::</a></span> <span class="typed"><span class="type">String</span><a href="#55988">p</a></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#55991" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
	
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; java.lang.String</span><a id="51412">VerifyOption</a></span> = <span class="typed"><span class="type">java.lang.String(&quot;-verify&quot;)</span><span class="string">&quot;-verify&quot;</span></span>
	
	<span class="comment">/** Uses jarsigner to sign the given jar.  */</span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.Path,String,Seq[sbt.SignJar.SignOption],sbt.Logger)Option[String]</span><a id="51413">sign</a></span>(<span class="typed"><span class="type">sbt.Path</span><a id="51570">jarPath</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="typed"><span class="type">String</span><a id="51571">alias</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">Seq[sbt.SignJar.SignOption]</span><a id="51572">options</a></span>: <span class="typed"><span class="type">Seq[sbt.SignJar.SignOption]</span><a id="744">Seq</a></span>[SignOption], <span class="typed"><span class="type">sbt.Logger</span><a id="51573">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>): <span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String] =
	{
		<span class="typed"><span class="type">(Boolean,=&gt; Any)Unit</span><span id="5972"><a id="802">require</a></span></span>(<span class="typed"><span class="type">=&gt; Boolean</span><a id="2728">!</a></span><span class="typed"><span class="type">String</span><a href="#51571">alias</a></span>.<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6104"><span id="802"><a id="5842">trim</a></span></span></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="7218">isEmpty</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;Alias cannot be empty&quot;)</span><span class="string">&quot;Alias cannot be empty&quot;</span></span>)
		<span class="keyword">val</span> <span class="typed"><span class="type">List[String]</span><a id="55998">arguments</a></span> = <span class="typed"><span class="type">Seq[sbt.SignJar.SignOption]</span><a href="#51572">options</a></span>.<span class="typed"><span class="type">=&gt; List[sbt.SignJar.SignOption]</span><a id="7388">toList</a></span>.<span class="typed"><span class="type">((sbt.SignJar.SignOption) =&gt; Iterable[String])List[String]</span><a id="6956">flatMap</a></span>(<span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#56020">_</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a href="#51579">toList</a></span>) <span class="typed"><span class="type">(List[String])List[String]</span><a href="#56016" id="6912">:::</a></span> <span class="typed"><span class="type">sbt.Path</span><a href="#51570">jarPath</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="Path.scala.html#9638">asFile</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="9660">getAbsolutePath</a></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#56021" id="6908">::</a></span> <span class="typed"><span class="type">String</span><a href="#51571">alias</a></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#56022" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>
		<span class="keyword">val</span> <span class="typed"><span class="type">sbt.ProcessRunner</span><a id="55999">pr</a></span> = (<span class="typed"><span class="type">(String,Seq[String])sbt.ProcessRunner</span><a href="Process.scala.html#20003" class="keyword">new</a></span> <span class="typed"><span class="type">sbt.ProcessRunner</span><a href="Process.scala.html#6485">ProcessRunner</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#51415">CommandName</a></span>, <span class="typed"><span class="type">List[String]</span><a href="#55998">arguments</a></span>)).<span class="typed"><span class="type">(sbt.Logger)sbt.ProcessRunner</span><a href="Process.scala.html#20011">logIO</a></span>(<span class="typed"><span class="type">sbt.Logger</span><a href="#51573">log</a></span>)
		<span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="56000">exitCode</a></span> = <span class="typed"><span class="type">sbt.ProcessRunner</span><a href="#55999">pr</a></span>.<span class="typed"><span class="type">=&gt; sbt.SProcess</span><a href="Process.scala.html#20012">run</a></span>.<span class="typed"><span class="type">()Int</span><a href="Process.scala.html#20103">exitValue</a></span>()
		<span class="typed"><span class="type">Option[String]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Int</span><a href="#56000">exitCode</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3122">==</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
		{
			<span class="typed"><span class="type">sbt.Logger</span><a href="#51573">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Signed &quot;)</span><span class="string">&quot;Signed &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">sbt.Path</span><a href="#51570">jarPath</a></span>)
			<span class="typed"><span class="type">object None</span><a id="517">None</a></span>
		}
		<span class="keyword">else</span>
			<span class="typed"><span class="type">(java.lang.String)Some[java.lang.String]</span><span id="10375"><a id="289">Some</a></span></span>(<span class="typed"><span class="type">java.lang.String(&quot;Error signing jar (exit code was &quot;)</span><span class="string">&quot;Error signing jar (exit code was &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">Int</span><a href="#56000">exitCode</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;.)&quot;)</span><span class="string">&quot;.)&quot;</span></span>)
	}
	<span class="comment">/** Uses jarsigner to verify the given jar.*/</span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.Path,Seq[sbt.SignJar.SignOption],sbt.Logger)Option[String]</span><a id="51414">verify</a></span>(<span class="typed"><span class="type">sbt.Path</span><a id="51597">jarPath</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>, <span class="typed"><span class="type">Seq[sbt.SignJar.SignOption]</span><a id="51598">options</a></span>: <span class="typed"><span class="type">Seq[sbt.SignJar.SignOption]</span><a id="744">Seq</a></span>[SignOption], <span class="typed"><span class="type">sbt.Logger</span><a id="51599">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>): <span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String] =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">List[java.lang.String]</span><a id="56037">arguments</a></span> = <span class="typed"><span class="type">Seq[sbt.SignJar.SignOption]</span><a href="#51598">options</a></span>.<span class="typed"><span class="type">((sbt.SignJar.SignOption) =&gt; Boolean)Seq[sbt.SignJar.SignOption]</span><a id="7238">filter</a></span>(<span class="typed"><span class="type">=&gt; Boolean</span><a id="2728">!</a></span><span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#56042">_</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="#51581">signOnly</a></span>).<span class="typed"><span class="type">=&gt; List[sbt.SignJar.SignOption]</span><a id="7388">toList</a></span>.<span class="typed"><span class="type">((sbt.SignJar.SignOption) =&gt; Iterable[String])List[String]</span><a id="6956">flatMap</a></span>(<span class="typed"><span class="type">sbt.SignJar.SignOption</span><a href="#56046">_</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a href="#51579">toList</a></span>) <span class="typed"><span class="type">(List[java.lang.String])List[java.lang.String]</span><a href="#56040" id="6912">:::</a></span> <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#51412">VerifyOption</a></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#56047" id="6908">::</a></span> <span class="typed"><span class="type">sbt.Path</span><a href="#51597">jarPath</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="Path.scala.html#9638">asFile</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="9660">getAbsolutePath</a></span> <span class="typed"><span class="type">(java.lang.String)List[java.lang.String]</span><a href="#56048" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>
		<span class="keyword">val</span> <span class="typed"><span class="type">sbt.ProcessRunner</span><a id="56038">pr</a></span> = (<span class="typed"><span class="type">(String,Seq[String])sbt.ProcessRunner</span><a href="Process.scala.html#20003" class="keyword">new</a></span> <span class="typed"><span class="type">sbt.ProcessRunner</span><a href="Process.scala.html#6485">ProcessRunner</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#51415">CommandName</a></span>, <span class="typed"><span class="type">List[java.lang.String]</span><a href="#56037">arguments</a></span>)).<span class="typed"><span class="type">(sbt.Logger)sbt.ProcessRunner</span><a href="Process.scala.html#20011">logIO</a></span>(<span class="typed"><span class="type">sbt.Logger</span><a href="#51599">log</a></span>)
		<span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="56039">exitCode</a></span> = <span class="typed"><span class="type">sbt.ProcessRunner</span><a href="#56038">pr</a></span>.<span class="typed"><span class="type">=&gt; sbt.SProcess</span><a href="Process.scala.html#20012">run</a></span>.<span class="typed"><span class="type">()Int</span><a href="Process.scala.html#20103">exitValue</a></span>()
		<span class="typed"><span class="type">Option[String]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Int</span><a href="#56039">exitCode</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3122">==</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
		{
			<span class="typed"><span class="type">sbt.Logger</span><a href="#51599">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Verified &quot;)</span><span class="string">&quot;Verified &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">sbt.Path</span><a href="#51597">jarPath</a></span>)
			<span class="typed"><span class="type">object None</span><a id="517">None</a></span>
		}
		<span class="keyword">else</span>
			<span class="typed"><span class="type">(java.lang.String)Some[java.lang.String]</span><span id="10375"><a id="289">Some</a></span></span>(<span class="typed"><span class="type">java.lang.String(&quot;Error verifying jar (exit code was &quot;)</span><span class="string">&quot;Error verifying jar (exit code was &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">Int</span><a href="#56039">exitCode</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;.)&quot;)</span><span class="string">&quot;.)&quot;</span></span>)
	}
	
	<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="51416"><a id="51415">CommandName</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;jarsigner&quot;)</span><span class="string">&quot;jarsigner&quot;</span></span>
}
        </pre>
    </body>
</html>