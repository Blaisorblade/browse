<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>sbt/Conditional.scala</title>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008, 2009 Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">trait</span> <a title="trait Conditional[Source, Product, External] extends java.lang.Object with NotNull with ScalaObject" id="6247">Conditional</a>[<a title="&gt;: Nothing &lt;: Any" id="6248">Source</a>, <a title="&gt;: Nothing &lt;: Any" id="6249">Product</a>, <a title="&gt;: Nothing &lt;: Any" id="6250">External</a>] <span class="keyword">extends</span> <a title="NotNull" id="187">NotNull</a>
{
	<span class="keyword">type</span> <a title="&gt;: Nothing &lt;: sbt.TaskAnalysis[Source,Product,External]" id="32285">AnalysisType</a> &lt;: TaskAnalysis[Source, Product, External]
	<span class="keyword">val</span> <span id="32287"><a title="Conditional.this.AnalysisType" id="32286">analysis</a></span>: <a href="#32285" title="Conditional.this.AnalysisType">AnalysisType</a> = <a href="#32288" title="=&gt; Conditional.this.AnalysisType">loadAnalysis</a>
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Conditional.this.AnalysisType" id="32288">loadAnalysis</a>: <a href="#32285" title="Conditional.this.AnalysisType">AnalysisType</a>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; sbt.Logger" id="32289">log</a>: <a href="Logger.scala.html#6667" title="sbt.Logger">Logger</a>

	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; String" id="32290">productType</a>: <a title="String" id="1751">String</a>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; String" id="32291">productTypePlural</a>: <a title="String" id="1751">String</a>
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Iterable[Source]" id="32292">sourcesToProcess</a>: <a title="Iterable[Source]" id="358">Iterable</a>[Source]
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(Source)Boolean" id="32293">sourceExists</a>(<a title="Source" id="33178">source</a>: <a href="#6248" title="Source">Source</a>): <a title="Boolean" id="2060">Boolean</a>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(Source)Long" id="32294">sourceLastModified</a>(<a title="Source" id="32400">source</a>: <a href="#6248" title="Source">Source</a>): <a title="Long" id="2301">Long</a>
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(Product)Boolean" id="32295">productExists</a>(<a title="Product" id="32402">product</a>: <a href="#6249" title="Product">Product</a>): <a title="Boolean" id="2060">Boolean</a>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(Product)Long" id="32296">productLastModified</a>(<a title="Product" id="32405">product</a>: <a href="#6249" title="Product">Product</a>): <a title="Long" id="2301">Long</a>
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(Iterable[External])Iterable[(External, Conditional.this.ExternalInfo)]" id="32297">externalInfo</a>(<a title="Iterable[External]" id="32415">externals</a>: <a title="Iterable[External]" id="358">Iterable</a>[External]): <a title="Iterable[(External, Conditional.this.ExternalInfo)]" id="358">Iterable</a>[(External, ExternalInfo)]
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(Conditional.this.ConditionalAnalysis)Option[String]" id="32298">execute</a>(<a title="Conditional.this.ConditionalAnalysis" id="32373">cAnalysis</a>: <a href="#32302" title="Conditional.this.ConditionalAnalysis">ConditionalAnalysis</a>): <a title="Option[String]" id="871">Option</a>[String]
	
	<span class="keyword">final</span> <span class="keyword">case</span> <span class="keyword">class</span> <span id="2640"><span id="33188"><span id="3391"><span id="33204"><span id="33197"><span id="33186"><span id="10256"><span id="27624"><span id="27623"><span id="33198"><span id="33192"><span id="33185"><span id="33201"><span id="2641"><span id="33202"><span id="5675"><span id="32300"><span id="275"><span id="9252"><span id="1283"><span id="33191"><span id="32299"><span id="33203"><span id="33184"><span id="3390"><span id="33190"><span id="2638"><span id="3154"><span id="33187"><a title="class ExternalInfo extends java.lang.Object with NotNull with ScalaObject with Product" id="27651">ExternalInfo</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span id="32433"><span id="32432"><span id="33182"><a title="Boolean" id="33208">available</a></span></span></span>: <a title="Boolean" id="2060">Boolean</a>, <span id="32435"><span id="32434"><span id="33183"><a title="Long" id="33209">lastModified</a></span></span></span>: <a title="Long" id="2301">Long</a>) <span class="keyword">extends</span> <a title="NotNull" id="187">NotNull</a>
	<span class="keyword">trait</span> <a title="trait ConditionalAnalysis extends java.lang.Object with NotNull" id="32302">ConditionalAnalysis</a> <span class="keyword">extends</span> <a title="NotNull" id="187">NotNull</a>
	{
		<span class="keyword">def</span> <a title="=&gt; Iterable[Source]" id="32478">dirtySources</a>: <a title="Iterable[Source]" id="358">Iterable</a>[Source]
		<span class="keyword">def</span> <a title="=&gt; Iterable[Source]" id="32479">cleanSources</a>: <a title="Iterable[Source]" id="358">Iterable</a>[Source]
		<span class="keyword">def</span> <a title="=&gt; Int" id="32480">directlyModifiedSourcesCount</a>: <a title="Int" id="2296">Int</a>
		<span class="keyword">def</span> <a title="=&gt; Int" id="32481">invalidatedSourcesCount</a>: <a title="Int" id="2296">Int</a>
		<span class="keyword">def</span> <a title="=&gt; Int" id="32482">removedSourcesCount</a>: <a title="Int" id="2296">Int</a>
	}
	
	<span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Option[String]" id="32303">run</a> =
	{
		<span class="keyword">val</span> <a title="Option[String]" id="32372">result</a> = <a href="#32298" title="(Conditional.this.ConditionalAnalysis)Option[String]">execute</a>(<a href="#32304" title="=&gt; &lt;refinement&gt; extends java.lang.Object with Conditional.this.ConditionalAnalysis">analyze</a>)
		<a href="#32308" title="(Boolean)Unit">processingComplete</a>(<a href="#32372" title="Option[String]">result</a>.<a title="=&gt; Boolean" id="10150">isEmpty</a>)
		<a href="#32372" title="Option[String]">result</a>
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; &lt;refinement&gt; extends java.lang.Object with Conditional.this.ConditionalAnalysis" id="32304">analyze</a> =
	{
		<span class="keyword">import</span> scala.collection.mutable.HashSet
		
		<span class="keyword">val</span> <a title="Iterable[Source]" id="32377">sourcesSnapshot</a> = <a href="#32292" title="=&gt; Iterable[Source]">sourcesToProcess</a>
		<span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[Source]" id="32378">removedSources</a> = <span title="scala.collection.mutable.HashSet[Source]" class="keyword">new</span> <a title="scala.collection.mutable.HashSet[Source]" id="7909">HashSet</a>[Source]
		<a href="#32378" title="scala.collection.mutable.HashSet[Source]">removedSources</a> <a title="(Iterable[Source])Unit" id="21514">++=</a> <a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21417" title="=&gt; scala.collection.Set[Source]">allSources</a>
		<a href="#32378" title="scala.collection.mutable.HashSet[Source]">removedSources</a> <a title="(Iterable[Source])Unit" id="21523">--=</a> <a href="#32377" title="Iterable[Source]">sourcesSnapshot</a>
		<span class="keyword">val</span> <a title="Int" id="32379">removedCount</a> = <a href="#32378" title="scala.collection.mutable.HashSet[Source]">removedSources</a>.<a title="=&gt; Int" id="23716">size</a>
		<span class="keyword">for</span>(<span id="7256"><a title="((Source) =&gt; Unit)Unit" id="32391">removed</a></span> &lt;- <a href="#32378" title="scala.collection.mutable.HashSet[Source]">removedSources</a>)
			<a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21428" title="(Source)Unit">removeDependent</a>(<a href="#32391" title="Source">removed</a>)
		
		<span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[Source]" id="32380">unmodified</a> = <span title="scala.collection.mutable.HashSet[Source]" class="keyword">new</span> <a title="scala.collection.mutable.HashSet[Source]" id="7909">HashSet</a>[Source]
		<span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[Source]" id="32381">modified</a> = <span title="scala.collection.mutable.HashSet[Source]" class="keyword">new</span> <a title="scala.collection.mutable.HashSet[Source]" id="7909">HashSet</a>[Source]
		
		<span class="keyword">for</span>(<span id="7256"><a title="((Source) =&gt; Unit)Unit" id="32393">source</a></span> &lt;- <a href="#32377" title="Iterable[Source]">sourcesSnapshot</a>)
		{
			<span title="Unit" class="keyword">if</span>(<a href="#32307" title="(Source)Boolean">isSourceModified</a>(<a href="#32393" title="Source">source</a>))
			{
				<a href="#32289" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Source &quot;)" class="string">&quot;Source &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32393" title="Source">source</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; directly modified.&quot;)" class="string">&quot; directly modified.&quot;</span>)
				<a href="#32381" title="scala.collection.mutable.HashSet[Source]">modified</a> <a title="(Source)Unit" id="21760">+=</a> <a href="#32393" title="Source">source</a>
			}
			<span class="keyword">else</span>
			{
				<a href="#32289" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Source &quot;)" class="string">&quot;Source &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32393" title="Source">source</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; unmodified.&quot;)" class="string">&quot; unmodified.&quot;</span>)
				<a href="#32380" title="scala.collection.mutable.HashSet[Source]">unmodified</a> <a title="(Source)Unit" id="21760">+=</a> <a href="#32393" title="Source">source</a>
			}
		}
		<span class="keyword">val</span> <a title="Int" id="32382">directlyModifiedCount</a> = <a href="#32381" title="scala.collection.mutable.HashSet[Source]">modified</a>.<a title="=&gt; Int" id="23716">size</a>
		<span class="keyword">for</span>(<span id="7256"><a href="#32417" title="(((External, Conditional.this.ExternalInfo)) =&gt; Unit)Unit" id="7250">(</a></span><span id="32418"><a title="External" id="32422">external</a></span>, <span id="32419"><a title="Conditional.this.ExternalInfo" id="32423">info</a></span>) &lt;- <a href="#32297" title="(Iterable[External])Iterable[(External, Conditional.this.ExternalInfo)]">externalInfo</a>(<a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21419" title="=&gt; scala.collection.Set[External]">allExternals</a>))
		{
			<span class="keyword">val</span> <a title="scala.collection.Set[Source]" id="32424">dependentSources</a> = <a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21422" title="(External)Option[scala.collection.Set[Source]]">externalDependencies</a>(<a href="#32422" title="External">external</a>).<a title="=&gt; scala.collection.Set[Source]" id="10152">get</a>
			<span title="Unit" class="keyword">if</span>(<a href="#32423" title="Conditional.this.ExternalInfo">info</a>.<a href="#32432" title="=&gt; Boolean">available</a>)
			{
				<span class="keyword">val</span> <a title="Long" id="32437">dependencyLastModified</a> = <a href="#32423" title="Conditional.this.ExternalInfo">info</a>.<a href="#32434" title="=&gt; Long">lastModified</a>
				<span class="keyword">for</span>(<span id="7256"><a title="((Source) =&gt; Unit)Unit" id="32439">dependentSource</a></span> &lt;- <a href="#32424" title="scala.collection.Set[Source]">dependentSources</a>; <span id="10162"><a title="((scala.collection.Set[Product]) =&gt; Unit)Unit" id="32441">dependentProducts</a></span> &lt;- <a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21421" title="(Source)Option[scala.collection.Set[Product]]">products</a>(<a href="#32439" title="Source">dependentSource</a>))
				{
					<a href="#32441" title="scala.collection.Set[Product]">dependentProducts</a>.<a title="((Product) =&gt; Boolean)Option[Product]" id="7259">find</a>(<a title="Product" id="32443">p</a> =&gt; <a href="#32296" title="(Product)Long">productLastModified</a>(<a href="#32443" title="Product">p</a>) <a title="(Long)Boolean" id="3156">&lt;</a> <a href="#32437" title="Long">dependencyLastModified</a>) <span title="Unit" class="keyword">match</span>
					{
						<span title="Unit" class="keyword">case</span> <a id="1">Some</a>(<a title="Product" id="32445">modifiedProduct</a>) =&gt;
						{
							<a href="#32289" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<a href="#32290" title="=&gt; String">productType</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32445" title="Product">modifiedProduct</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; older than external dependency &quot;)" class="string">&quot; older than external dependency &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32422" title="External">external</a>)
							<a href="#32380" title="scala.collection.mutable.HashSet[Source]">unmodified</a> <a title="(Source)Unit" id="21761">-=</a> <a href="#32439" title="Source">dependentSource</a>
							<a href="#32381" title="scala.collection.mutable.HashSet[Source]">modified</a> <a title="(Source)Unit" id="21760">+=</a> <a href="#32439" title="Source">dependentSource</a>
						}
						<span title="Unit" class="keyword">case</span> <a title="object None" id="488">None</a> =&gt; <span title="Unit">(</span>)
					}
				}
			}
			<span class="keyword">else</span>
			{
				<a href="#32289" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;External dependency &quot;)" class="string">&quot;External dependency &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32422" title="External">external</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; not found.&quot;)" class="string">&quot; not found.&quot;</span>)
				<a href="#32380" title="scala.collection.mutable.HashSet[Source]">unmodified</a> <a title="(Iterable[Source])Unit" id="21523">--=</a> <a href="#32424" title="scala.collection.Set[Source]">dependentSources</a>
				<a href="#32381" title="scala.collection.mutable.HashSet[Source]">modified</a> <a title="(Iterable[Source])Unit" id="21514">++=</a> <a href="#32424" title="scala.collection.Set[Source]">dependentSources</a>
				<a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21430" title="(External)Unit">removeExternalDependency</a>(<a href="#32422" title="External">external</a>)
			}
		}
		
		<span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[Source]" id="32383">handled</a> = <span title="scala.collection.mutable.HashSet[Source]" class="keyword">new</span> scala.collection.mutable.<a title="scala.collection.mutable.HashSet[Source]" id="7909">HashSet</a>[Source]
		<span class="keyword">def</span> <a title="(Iterable[Source])Unit" id="32384">markModified</a>(<a title="Iterable[Source]" id="32450">changed</a>: <a title="Iterable[Source]" id="358">Iterable</a>[Source]) { <span class="keyword">for</span>(<span id="7256"><span id="7250"><span id="32452"><a title="((Source) =&gt; Unit)Unit" id="32454">c</a></span></span></span> &lt;- <a href="#32450" title="Iterable[Source]">changed</a> <span class="keyword">if</span> <a title="=&gt; Boolean" id="2637">!</a><a href="#32383" title="scala.collection.mutable.HashSet[Source]">handled</a>.<a title="(Source)Boolean" id="21759">contains</a>(<a href="#32452" title="Source">c</a>)) <a href="#32385" title="(Source)Unit">markSourceModified</a>(<a href="#32454" title="Source">c</a>) }
		<span class="keyword">def</span> <a title="(Source)Unit" id="32385">markSourceModified</a>(<a title="Source" id="32455">src</a>: <a href="#6248" title="Source">Source</a>)
		{
			<a href="#32380" title="scala.collection.mutable.HashSet[Source]">unmodified</a> <a title="(Source)Unit" id="21761">-=</a> <a href="#32455" title="Source">src</a>
			<a href="#32381" title="scala.collection.mutable.HashSet[Source]">modified</a> <a title="(Source)Unit" id="21760">+=</a> <a href="#32455" title="Source">src</a>
			<a href="#32383" title="scala.collection.mutable.HashSet[Source]">handled</a> <a title="(Source)Unit" id="21760">+=</a> <a href="#32455" title="Source">src</a>
			<a href="#32386" title="(Source)Unit">markDependenciesModified</a>(<a href="#32455" title="Source">src</a>)
		}
		<span class="keyword">def</span> <a title="(Source)Unit" id="32386">markDependenciesModified</a>(<a title="Source" id="32459">src</a>: <a href="#6248" title="Source">Source</a>) { <a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21429" title="(Source)Option[scala.collection.Set[Source]]">removeDependencies</a>(<a href="#32459" title="Source">src</a>).<a title="((scala.collection.Set[Source]) =&gt; Unit)Option[Unit]" id="10157">map</a>(<a href="#32384" title="(Iterable[Source])Unit">markModified</a>) }

		<a href="#32384" title="(Iterable[Source])Unit">markModified</a>(<a href="#32381" title="scala.collection.mutable.HashSet[Source]">modified</a>.<a title="=&gt; List[Source]" id="7279">toList</a>)
		<a href="#32378" title="scala.collection.mutable.HashSet[Source]">removedSources</a>.<a title="((Source) =&gt; Unit)Unit" id="7256">foreach</a>(<a href="#32386" title="(Source)Unit">markDependenciesModified</a>)
		
		<span class="keyword">for</span>(<span id="7256"><a title="((Source) =&gt; Unit)Unit" id="32476">changed</a></span> &lt;- <a href="#32378" title="scala.collection.mutable.HashSet[Source]">removedSources</a> <a title="(Iterable[Source])scala.collection.mutable.Set[Source]" id="21518">++</a> <a href="#32381" title="scala.collection.mutable.HashSet[Source]">modified</a>)
			<a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21427" title="(Source)Unit">removeSource</a>(<a href="#32476" title="Source">changed</a>)
		
		<a title="template $anon extends java.lang.Object with Conditional.this.ConditionalAnalysis" id="32477" class="keyword">new</a> <a href="#32302" title="Conditional.this.ConditionalAnalysis">ConditionalAnalysis</a>
		{
			<span class="keyword">def</span> <a title="=&gt; scala.collection.Set[Source]" id="32484">dirtySources</a> = <a href="#32381" title="scala.collection.mutable.HashSet[Source]">modified</a>.<a title="=&gt; scala.collection.Set[Source]" id="21535">readOnly</a>
			<span class="keyword">def</span> <a title="=&gt; scala.collection.Set[Source]" id="32485">cleanSources</a> = <a href="#32380" title="scala.collection.mutable.HashSet[Source]">unmodified</a>.<a title="=&gt; scala.collection.Set[Source]" id="21535">readOnly</a>
			<span class="keyword">def</span> <a title="=&gt; Int" id="32486">directlyModifiedSourcesCount</a> = <a href="#32382" title="Int">directlyModifiedCount</a>
			<span class="keyword">def</span> <a title="=&gt; Int" id="32487">invalidatedSourcesCount</a> = <a href="#32484" title="=&gt; scala.collection.Set[Source]">dirtySources</a>.<a title="=&gt; Int" id="21327">size</a> <a title="(Int)Int" id="3038">-</a> <a href="#32382" title="Int">directlyModifiedCount</a>
			<span class="keyword">def</span> <a title="=&gt; Int" id="32488">removedSourcesCount</a> = <a href="#32379" title="Int">removedCount</a>
			<span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="32489">toString</a> =
			{
				<span title="java.lang.String(&quot;  Source analysis: &quot;)" class="string">&quot;  Source analysis: &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32486" title="=&gt; Int">directlyModifiedSourcesCount</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; new/modified, &quot;)" class="string">&quot; new/modified, &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a>
					<a href="#32487" title="=&gt; Int">invalidatedSourcesCount</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; indirectly invalidated, &quot;)" class="string">&quot; indirectly invalidated, &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a>
					<a href="#32488" title="=&gt; Int">removedSourcesCount</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; removed.&quot;)" class="string">&quot; removed.&quot;</span>
			}
		}
	}
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="32305">checkLastModified</a> = <span title="Boolean(true)" class="keyword">true</span>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="32306">noProductsImpliesModified</a> = <span title="Boolean(true)" class="keyword">true</span>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(Source)Boolean" id="32307">isSourceModified</a>(<a title="Source" id="32394">source</a>: <a href="#6248" title="Source">Source</a>) =
	{
		<a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21421" title="(Source)Option[scala.collection.Set[Product]]">products</a>(<a href="#32394" title="Source">source</a>) <span title="Boolean" class="keyword">match</span>
		{
			<span title="Boolean" class="keyword">case</span> <a title="object None" id="488">None</a> =&gt;
			{
				<a href="#32289" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;New file &quot;)" class="string">&quot;New file &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32394" title="Source">source</a>)
				<span title="Boolean(true)" class="keyword">true</span>
			}
			<span title="Boolean" class="keyword">case</span> <a id="1">Some</a>(<a title="scala.collection.Set[Product]" id="32397">sourceProducts</a>) =&gt;
			{
				<span class="keyword">val</span> <a title="Long" id="32398">sourceModificationTime</a> = <a href="#32294" title="(Source)Long">sourceLastModified</a>(<a href="#32394" title="Source">source</a>)
				<span class="keyword">def</span> <a title="(Product)Boolean" id="32399">isOutofdate</a>(<a title="Product" id="32401">p</a>: <a href="#6249" title="Product">Product</a>) =
					<a title="=&gt; Boolean" id="2637">!</a><a href="#32295" title="(Product)Boolean">productExists</a>(<a href="#32401" title="Product">p</a>) <a title="(Boolean)Boolean" id="2640">||</a> (<a href="#32305" title="=&gt; Boolean">checkLastModified</a> <a title="(Boolean)Boolean" id="2641">&amp;&amp;</a> <a href="#32296" title="(Product)Long">productLastModified</a>(<a href="#32401" title="Product">p</a>) <a title="(Long)Boolean" id="3156">&lt;</a> <a href="#32398" title="Long">sourceModificationTime</a>)
				
				<a href="#32397" title="scala.collection.Set[Product]">sourceProducts</a>.<a title="((Product) =&gt; Boolean)Option[Product]" id="7259">find</a>(<a href="#32399" title="(Product)Boolean">isOutofdate</a>) <span title="Boolean" class="keyword">match</span>
				{
					<span title="Boolean" class="keyword">case</span> <a id="1">Some</a>(<a title="Product" id="32409">modifiedProduct</a>) =&gt;
						<a href="#32289" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Outdated &quot;)" class="string">&quot;Outdated &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32290" title="=&gt; String">productType</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32409" title="Product">modifiedProduct</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; for source &quot;)" class="string">&quot; for source &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32394" title="Source">source</a>)
						<span title="Boolean(true)" class="keyword">true</span>
					<span title="Boolean" class="keyword">case</span> <a title="object None" id="488">None</a> =&gt;
						<span title="Boolean" class="keyword">if</span>(<a href="#32306" title="=&gt; Boolean">noProductsImpliesModified</a> <a title="(Boolean)Boolean" id="2641">&amp;&amp;</a> <a href="#32397" title="scala.collection.Set[Product]">sourceProducts</a>.<a title="=&gt; Boolean" id="21330">isEmpty</a>)
						{
							<span class="comment">// necessary for change detection that depends on last modified</span>
							<a href="#32289" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Source &quot;)" class="string">&quot;Source &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32394" title="Source">source</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; has no products, marking it modified.&quot;)" class="string">&quot; has no products, marking it modified.&quot;</span>)
							<span title="Boolean(true)" class="keyword">true</span>
						}
						<span class="keyword">else</span>
							<span title="Boolean(false)" class="keyword">false</span>
				}
			}
		}
	}
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(Boolean)Unit" id="32308">processingComplete</a>(<a title="Boolean" id="32540">success</a>: <a title="Boolean" id="2060">Boolean</a>)
	{
		<span title="Unit" class="keyword">if</span>(<a href="#32540" title="Boolean">success</a>)
		{
			<a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21414" title="()Option[String]">save</a>()
			<a href="#32289" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8352" title="(=&gt; String)Unit">info</a>(<span title="java.lang.String(&quot;  Post-analysis: &quot;)" class="string">&quot;  Post-analysis: &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21418" title="=&gt; scala.collection.Set[Product]">allProducts</a>.<a title="=&gt; Seq[Product]" id="7280">toSeq</a>.<a title="=&gt; Int" id="7105">length</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#32291" title="=&gt; String">productTypePlural</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot;.&quot;)" class="string">&quot;.&quot;</span>)
		}
		<span class="keyword">else</span>
			<a href="#32286" title="=&gt; Conditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21415" title="()Option[String]">revert</a>()
	}
}

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class CompileConfiguration extends java.lang.Object with NotNull with ScalaObject" id="6251">CompileConfiguration</a> <span class="keyword">extends</span> <a title="NotNull" id="187">NotNull</a>
{
	<span class="keyword">def</span> <a title="=&gt; String" id="32343">label</a>: <a title="String" id="1751">String</a>
	<span class="keyword">def</span> <a title="=&gt; sbt.PathFinder" id="32344">sources</a>: <a href="Path.scala.html#6703" title="sbt.PathFinder">PathFinder</a>
	<span class="keyword">def</span> <a title="=&gt; sbt.Path" id="32345">outputDirectory</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>
	<span class="keyword">def</span> <a title="=&gt; sbt.PathFinder" id="32346">classpath</a>: <a href="Path.scala.html#6703" title="sbt.PathFinder">PathFinder</a>
	<span class="keyword">def</span> <a title="=&gt; sbt.Path" id="32347">analysisPath</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>
	<span class="keyword">def</span> <a title="=&gt; sbt.Path" id="32348">projectPath</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>
	<span class="keyword">def</span> <a title="=&gt; sbt.Logger" id="32349">log</a>: <a href="Logger.scala.html#6667" title="sbt.Logger">Logger</a>
	<span class="keyword">def</span> <a title="=&gt; Seq[String]" id="32350">options</a>: <a title="Seq[String]" id="715">Seq</a>[String]
	<span class="keyword">def</span> <a title="=&gt; Iterable[String]" id="32351">testDefinitionClassNames</a>: <a title="Iterable[String]" id="358">Iterable</a>[String]
}
<span class="keyword">import</span> java.io.File
<span class="keyword">class</span> <a title="class CompileConditional extends java.lang.Object with sbt.Conditional[sbt.Path,sbt.Path,java.io.File] with ScalaObject" id="6253">CompileConditional</a>(<span id="32310"><a title="sbt.CompileConfiguration" id="32339">config</a></span>: <a href="#6251" title="sbt.CompileConfiguration">CompileConfiguration</a>) <span class="keyword">extends</span> <a href="#6247" title="sbt.Conditional[sbt.Path,sbt.Path,java.io.File]">Conditional</a>[Path, Path, File]
{
	<span class="keyword">import</span> config._
	<span class="keyword">type</span> <a title="sbt.CompileAnalysis" id="32313">AnalysisType</a> = <a href="Analysis.scala.html#6138" title="sbt.CompileAnalysis">CompileAnalysis</a>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; sbt.CompileAnalysis" id="32314">loadAnalysis</a> =
	{
		<span class="keyword">val</span> <a title="sbt.CompileAnalysis" id="33226">a</a> = <span title="sbt.CompileAnalysis" class="keyword">new</span> <a href="Analysis.scala.html#6138" title="sbt.CompileAnalysis">CompileAnalysis</a>(<a href="#32347" title="=&gt; sbt.Path">analysisPath</a>, <a href="#32348" title="=&gt; sbt.Path">projectPath</a>, <a href="#32315" title="=&gt; sbt.Logger">log</a>)
		<span class="keyword">for</span>(<span id="10162"><a title="((String) =&gt; Unit)Unit" id="33230">errorMessage</a></span> &lt;- <a href="#33226" title="sbt.CompileAnalysis">a</a>.<a href="Analysis.scala.html#21472" title="()Option[String]">load</a>())
			<span id="5873"><a title="(String)Nothing" id="770">error</a></span>(<a href="#33230" title="String">errorMessage</a>)
		<a href="#33226" title="sbt.CompileAnalysis">a</a>
	}
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; sbt.Logger" id="32315">log</a> = <a href="#32310" title="sbt.CompileConfiguration">config</a>.<a href="#32349" title="=&gt; sbt.Logger">log</a>
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="32316">productType</a> = <span title="java.lang.String(&quot;class&quot;)" class="string">&quot;class&quot;</span>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="32317">productTypePlural</a> = <span title="java.lang.String(&quot;classes&quot;)" class="string">&quot;classes&quot;</span>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.Set[sbt.Path]" id="32318">sourcesToProcess</a> = <a href="#32344" title="=&gt; sbt.PathFinder">sources</a>.<a href="Path.scala.html#9518" title="=&gt; scala.collection.Set[sbt.Path]">get</a>
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(sbt.Path)Boolean" id="32319">sourceExists</a>(<a title="sbt.Path" id="33237">source</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>) = <a href="#33237" title="sbt.Path">source</a>.<a href="Path.scala.html#9529" title="=&gt; java.io.File">asFile</a>.<a title="()Boolean" id="9559">exists</a>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(sbt.Path)Long" id="32320">sourceLastModified</a>(<a title="sbt.Path" id="33239">source</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>) = <a href="#33239" title="sbt.Path">source</a>.<a href="Path.scala.html#9529" title="=&gt; java.io.File">asFile</a>.<a title="()Long" id="9563">lastModified</a>
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(sbt.Path)Boolean" id="32321">productExists</a>(<a title="sbt.Path" id="33241">product</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>) = <a href="#33241" title="sbt.Path">product</a>.<a href="Path.scala.html#9529" title="=&gt; java.io.File">asFile</a>.<a title="()Boolean" id="9559">exists</a>
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(sbt.Path)Long" id="32322">productLastModified</a>(<a title="sbt.Path" id="33243">product</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>) = <a href="#33243" title="sbt.Path">product</a>.<a href="Path.scala.html#9529" title="=&gt; java.io.File">asFile</a>.<a title="()Long" id="9563">lastModified</a>
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(Iterable[java.io.File])Iterable[(java.io.File, CompileConditional.this.ExternalInfo)]" id="32323">externalInfo</a>(<a title="Iterable[java.io.File]" id="33245">externals</a>: <a title="Iterable[java.io.File]" id="358">Iterable</a>[File]) =
	{
		<span class="keyword">val</span> <span id="9252"><a href="#33268" title="(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])" id="1283">(</a></span><span id="33268"><span id="33248"><a href="#33247" title="scala.collection.Set[java.io.File]" id="9240">classpathJars</a></span></span>, <span id="33269"><span id="33249"><a href="#33247" title="scala.collection.Set[java.io.File]" id="9242">classpathDirs</a></span></span>) = <a href="ClasspathUtilities.scala.html#6367" title="object sbt.ClasspathUtilities">ClasspathUtilities</a>.<a href="ClasspathUtilities.scala.html#33256" title="(Iterable[sbt.Path])(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])">buildSearchPaths</a>(<a href="#32346" title="=&gt; sbt.PathFinder">classpath</a>.<a href="Path.scala.html#9518" title="=&gt; scala.collection.Set[sbt.Path]">get</a>)
		<span class="keyword">for</span>(<span id="7246"><a title="((java.io.File) =&gt; (java.io.File, CompileConditional.this.ExternalInfo))Iterable[(java.io.File, CompileConditional.this.ExternalInfo)]" id="33274">external</a></span> &lt;- <a href="#33245" title="Iterable[java.io.File]">externals</a>) <span class="keyword">yield</span>
		{
			<span class="keyword">val</span> <a title="Boolean" id="33275">available</a> = <a href="#33274" title="java.io.File">external</a>.<a title="()Boolean" id="9559">exists</a> <a title="(Boolean)Boolean" id="2641">&amp;&amp;</a> <a href="ClasspathUtilities.scala.html#6367" title="object sbt.ClasspathUtilities">ClasspathUtilities</a>.<a href="ClasspathUtilities.scala.html#33257" title="(scala.collection.Set[java.io.File],Iterable[java.io.File],java.io.File)Boolean">onClasspath</a>(<a href="#33248" title="scala.collection.Set[java.io.File]">classpathJars</a>, <a href="#33249" title="scala.collection.Set[java.io.File]">classpathDirs</a>, <a href="#33274" title="java.io.File">external</a>)
			<span title="Unit" class="keyword">if</span>(<a title="=&gt; Boolean" id="2637">!</a><a href="#33275" title="Boolean">available</a>)
				<a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;External &quot;)" class="string">&quot;External &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#33274" title="java.io.File">external</a> <a title="(Any)java.lang.String" id="5683">+</a> (<span title="Any" class="keyword">if</span>(<a href="#33274" title="java.io.File">external</a>.<a title="()Boolean" id="9559">exists</a>) <span title="java.lang.String(&quot; not on classpath.&quot;)" class="string">&quot; not on classpath.&quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot; does not exist.&quot;)" class="string">&quot; does not exist.&quot;</span>))
			<span id="9252"><a title="(java.io.File,CompileConditional.this.ExternalInfo)(java.io.File, CompileConditional.this.ExternalInfo)" id="1283">(</a></span><a href="#33274" title="java.io.File">external</a>, <a href="#33190" title="(Boolean,Long)CompileConditional.this.ExternalInfo">ExternalInfo</a>(<a href="#33275" title="Boolean">available</a>, <a href="#33274" title="java.io.File">external</a>.<a title="()Long" id="9563">lastModified</a>))
		}
	}
	
	<span class="keyword">import</span> ChangeDetection._
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; sbt.ChangeDetection.Value" id="32325">changeDetectionMethod</a>: ChangeDetection.<a title="sbt.ChangeDetection.Value" id="20345">Value</a> = <a href="#33222" title="=&gt; sbt.ChangeDetection.Value">HashAndProductsExist</a>
	<span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="32326">checkLastModified</a> = <a href="#32325" title="=&gt; sbt.ChangeDetection.Value">changeDetectionMethod</a> <a title="(AnyRef)Boolean" id="5674">!=</a> <a href="#33222" title="=&gt; sbt.ChangeDetection.Value">HashAndProductsExist</a>
	<span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="32327">noProductsImpliesModified</a> = <a href="#32325" title="=&gt; sbt.ChangeDetection.Value">changeDetectionMethod</a> <a title="(AnyRef)Boolean" id="3399">==</a> <a href="#33216" title="=&gt; sbt.ChangeDetection.Value">LastModifiedOnly</a>
	<span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(sbt.Path)Boolean" id="32328">isSourceModified</a>(<a title="sbt.Path" id="33292">source</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>) =
		<a href="#32325" title="=&gt; sbt.ChangeDetection.Value">changeDetectionMethod</a> <span title="Boolean" class="keyword">match</span>
		{
			<span title="Boolean" class="keyword">case</span> <a href="#33220" title="=&gt; sbt.ChangeDetection.Value">HashAndLastModified</a> | <a href="#33222" title="=&gt; sbt.ChangeDetection.Value">HashAndProductsExist</a> =&gt;
				<span class="comment">// behavior will differ because of checkLastModified</span>
				<span class="comment">// hash modified must come first so that the latest hash is calculated for every source</span>
				<a href="#32333" title="(sbt.Path)Boolean">hashModified</a>(<a href="#33292" title="sbt.Path">source</a>) <a title="(Boolean)Boolean" id="2640">||</a> <span class="keyword">super</span>.<a href="#32307" title="(sbt.Path)Boolean">isSourceModified</a>(<a href="#33292" title="sbt.Path">source</a>)
			<span title="Boolean" class="keyword">case</span> <a href="#33218" title="=&gt; sbt.ChangeDetection.Value">HashOnly</a> =&gt; <a href="#32333" title="(sbt.Path)Boolean">hashModified</a>(<a href="#33292" title="sbt.Path">source</a>)
			<span title="Boolean" class="keyword">case</span> <a href="#33216" title="=&gt; sbt.ChangeDetection.Value">LastModifiedOnly</a> =&gt; <span class="keyword">super</span>.<a href="#32307" title="(sbt.Path)Boolean">isSourceModified</a>(<a href="#33292" title="sbt.Path">source</a>)
		}
	
	<span class="keyword">import</span> scala.collection.mutable.{Buffer, ListBuffer}
	<span class="keyword">private</span> <span class="keyword">val</span> <span id="32331"><a title="scala.collection.mutable.Buffer[(sbt.Path, Option[Array[Byte]])]" id="32330">newHashes</a></span>: <a title="scala.collection.mutable.Buffer[(sbt.Path, Option[Array[Byte]])]" id="7975">Buffer</a>[(Path, Option[Array[Byte]])] = <span title="scala.collection.mutable.ListBuffer[(sbt.Path, Option[Array[Byte]])]" class="keyword">new</span> <a title="scala.collection.mutable.ListBuffer[(sbt.Path, Option[Array[Byte]])]" id="7939">ListBuffer</a>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(sbt.Path,String)Unit" id="32332">warnHashError</a>(<a title="sbt.Path" id="33312">source</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>, <a title="String" id="33313">message</a>: <a title="String" id="1751">String</a>)
	{
		<a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8353" title="(=&gt; String)Unit">warn</a>(<span title="java.lang.String(&quot;Error computing hash for source &quot;)" class="string">&quot;Error computing hash for source &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#33312" title="sbt.Path">source</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#33313" title="String">message</a>)
		<a href="#32330" title="=&gt; scala.collection.mutable.Buffer[(sbt.Path, Option[Array[Byte]])]">newHashes</a> <span id="21715"><span id="9252"><a title="((sbt.Path, Option[Array[Byte]]))Unit" id="1283">+=</a></span></span> (<a href="#33312" title="sbt.Path">source</a>, <a title="object None" id="488">None</a>)
	}
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(sbt.Path)Boolean" id="32333">hashModified</a>(<a title="sbt.Path" id="33295">source</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>) =
	{
		<a href="#32286" title="=&gt; CompileConditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21499" title="(sbt.Path)Option[Array[Byte]]">hash</a>(<a href="#33295" title="sbt.Path">source</a>) <span title="Boolean" class="keyword">match</span>
		{
			<span title="Boolean" class="keyword">case</span> <a title="object None" id="488">None</a> =&gt;
				<a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Source &quot;)" class="string">&quot;Source &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#33295" title="sbt.Path">source</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; had no hash, marking modified.&quot;)" class="string">&quot; had no hash, marking modified.&quot;</span>)
				<a href="Hash.scala.html#22700" title="(sbt.Path,sbt.Logger)Either[String,Array[Byte]]">Hash</a>(<a href="#33295" title="sbt.Path">source</a>, <a href="#32315" title="=&gt; sbt.Logger">log</a>).<a title="((String) =&gt; Unit,(Array[Byte]) =&gt; Unit)Unit" id="22143">fold</a>(<a title="String" id="33311">err</a> =&gt; <a href="#32332" title="(sbt.Path,String)Unit">warnHashError</a>(<a href="#33295" title="sbt.Path">source</a>, <a href="#33311" title="String">err</a>), <a title="Array[Byte]" id="33315">newHash</a> =&gt; <a href="#32330" title="=&gt; scala.collection.mutable.Buffer[(sbt.Path, Option[Array[Byte]])]">newHashes</a> <span id="21715"><span id="9252"><a title="((sbt.Path, Option[Array[Byte]]))Unit" id="1283">+=</a></span></span> (<a href="#33295" title="sbt.Path">source</a>, <span id="10256"><a title="(Array[Byte])Some[Array[Byte]]" id="275">Some</a></span>(<a href="#33315" title="Array[Byte]">newHash</a>)))
				<span title="Boolean(true)" class="keyword">true</span>
			<span title="Boolean" class="keyword">case</span> <a id="1">Some</a>(<a title="Array[Byte]" id="33319">oldHash</a>) =&gt;
			{
				<a href="Hash.scala.html#22700" title="(sbt.Path,sbt.Logger)Either[String,Array[Byte]]">Hash</a>(<a href="#33295" title="sbt.Path">source</a>, <a href="#32315" title="=&gt; sbt.Logger">log</a>) <span title="Boolean" class="keyword">match</span>
				{
					<span title="Boolean" class="keyword">case</span> <a id="1">Left</a>(<a title="String" id="33324">err</a>) =&gt;
						<a href="#32332" title="(sbt.Path,String)Unit">warnHashError</a>(<a href="#33295" title="sbt.Path">source</a>, <a href="#33324" title="String">err</a>)
						<a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Assuming source is modified because of error.&quot;)" class="string">&quot;Assuming source is modified because of error.&quot;</span>)
						<span title="Boolean(true)" class="keyword">true</span>
					<span title="Boolean" class="keyword">case</span> <a id="1">Right</a>(<a title="Array[Byte]" id="33325">newHash</a>) =&gt;
						<a href="#32330" title="=&gt; scala.collection.mutable.Buffer[(sbt.Path, Option[Array[Byte]])]">newHashes</a> <span id="21715"><span id="9252"><a title="((sbt.Path, Option[Array[Byte]]))Unit" id="1283">+=</a></span></span> (<a href="#33295" title="sbt.Path">source</a>, <span id="10256"><a title="(Array[Byte])Some[Array[Byte]]" id="275">Some</a></span>(<a href="#33325" title="Array[Byte]">newHash</a>))
						<span class="keyword">val</span> <a title="Boolean" id="33326">different</a> = <a title="=&gt; Boolean" id="2637">!</a>(<a href="#33319" title="Array[Byte]">oldHash</a> <a title="(Any)Boolean" id="7000">deepEquals</a> <a href="#33325" title="Array[Byte]">newHash</a>)
						<span title="Unit" class="keyword">if</span>(<a href="#33326" title="Boolean">different</a>)
							<a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Hash for source &quot;)" class="string">&quot;Hash for source &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#33295" title="sbt.Path">source</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; changed (was &quot;)" class="string">&quot; changed (was &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="Hash.scala.html#6338" title="object sbt.Hash">Hash</a>.<a href="Hash.scala.html#22697" title="(Array[Byte])String">toHex</a>(<a href="#33319" title="Array[Byte]">oldHash</a>) <a title="(Any)java.lang.String" id="5683">+</a>
							<span title="java.lang.String(&quot;, is now &quot;)" class="string">&quot;, is now &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="Hash.scala.html#6338" title="object sbt.Hash">Hash</a>.<a href="Hash.scala.html#22697" title="(Array[Byte])String">toHex</a>(<a href="#33325" title="Array[Byte]">newHash</a>) <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot;), marking modified.&quot;)" class="string">&quot;), marking modified.&quot;</span>)
						<a href="#33326" title="Boolean">different</a>
				}
			}
		}
	}
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(CompileConditional.this.ConditionalAnalysis)Option[String]" id="32334">execute</a>(<a title="CompileConditional.this.ConditionalAnalysis" id="33338">executeAnalysis</a>: <a href="#32302" title="CompileConditional.this.ConditionalAnalysis">ConditionalAnalysis</a>) =
	{
		<a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8352" title="(=&gt; String)Unit">info</a>(<a href="#33338" title="CompileConditional.this.ConditionalAnalysis">executeAnalysis</a>.<a title="()java.lang.String" id="5666">toString</a>)
		<a href="#32335" title="()Unit">finishHashes</a>()
		<span class="keyword">import</span> executeAnalysis.dirtySources
		<span class="keyword">val</span> <a title="scala.collection.Set[sbt.Path]" id="33341">cp</a> = <a href="#32346" title="=&gt; sbt.PathFinder">classpath</a>.<a href="Path.scala.html#9518" title="=&gt; scala.collection.Set[sbt.Path]">get</a>
		<span title="Unit" class="keyword">if</span>(<a title="=&gt; Boolean" id="2637">!</a><a href="#32478" title="=&gt; Iterable[sbt.Path]">dirtySources</a>.<a title="=&gt; Boolean" id="7290">isEmpty</a>)
			<a href="#32336" title="(Iterable[sbt.Path])Unit">checkClasspath</a>(<a href="#33341" title="scala.collection.Set[sbt.Path]">cp</a>)
		<span class="keyword">val</span> <a title="String" id="33342">classpathString</a> = <a href="Path.scala.html#6701" title="object sbt.Path">Path</a>.<a href="Path.scala.html#9492" title="(Iterable[sbt.Path])String">makeString</a>(<a href="#33341" title="scala.collection.Set[sbt.Path]">cp</a>)
		<span class="keyword">val</span> <a title="Int" id="33343">id</a> = <a href="AnalysisCallback.scala.html#6218" title="object sbt.AnalysisCallback">AnalysisCallback</a>.<a href="AnalysisCallback.scala.html#32755" title="(sbt.AnalysisCallback)Int">register</a>(<a href="#32337" title="=&gt; sbt.AnalysisCallback">analysisCallback</a>)
		<span class="keyword">val</span> <a title="List[java.lang.String]" id="33344">allOptions</a> = ((<span title="java.lang.String(&quot;-Xplugin:&quot;)" class="string">&quot;-Xplugin:&quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="FileUtilities.scala.html#6351" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#9485" title="=&gt; java.io.File">sbtJar</a>.<a title="()java.lang.String" id="9553">getCanonicalPath</a>) <a href="#33349" title="(java.lang.String)List[java.lang.String]" id="6808">::</a>
			(<span title="java.lang.String(&quot;-P:sbt-analyzer:callback:&quot;)" class="string">&quot;-P:sbt-analyzer:callback:&quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#33343" title="Int">id</a>.<a title="()java.lang.String" id="3390">toString</a>) <a href="#33350" title="(java.lang.String)List[java.lang.String]" id="6808">::</a> <a title="object Nil" id="299">Nil</a>) <a title="(Iterable[java.lang.String])List[java.lang.String]" id="6814">++</a> <a href="#32350" title="=&gt; Seq[String]">options</a>
		<span class="keyword">val</span> <a title="Option[String]" id="33345">r</a> = <a href="Compile.scala.html#6797" title="(String,Iterable[sbt.Path],String,sbt.Path,Iterable[String],sbt.Logger)Option[String]">Compile</a>(<a href="#32343" title="=&gt; String">label</a>, <a href="#32478" title="=&gt; Iterable[sbt.Path]">dirtySources</a>, <a href="#33342" title="String">classpathString</a>, <a href="#32345" title="=&gt; sbt.Path">outputDirectory</a>, <a href="#33344" title="List[java.lang.String]">allOptions</a>, <a href="#32315" title="=&gt; sbt.Logger">log</a>)
		<a href="AnalysisCallback.scala.html#6218" title="object sbt.AnalysisCallback">AnalysisCallback</a>.<a href="AnalysisCallback.scala.html#32757" title="(Int)Unit">unregister</a>(<a href="#33343" title="Int">id</a>)
		<span title="Unit" class="keyword">if</span>(<a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8349" title="(sbt.Level.Value)Boolean">atLevel</a>(<a href="Logger.scala.html#6675" title="object sbt.Level">Level</a>.<a href="Logger.scala.html#20852" title="=&gt; sbt.Level.Value">Debug</a>))
		{
			<span class="comment">/** This checks that the plugin accounted for all classes in the output directory.*/</span>
			<span class="keyword">val</span> <a title="scala.collection.mutable.Set[sbt.Path]" id="33377">classes</a> = scala.collection.mutable.<span id="21765"><a title="(sbt.Path*)scala.collection.mutable.Set[sbt.Path]" id="7910">HashSet</a></span>(<a href="#32286" title="=&gt; CompileConditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21463" title="=&gt; scala.collection.mutable.Set[sbt.Path]">allProducts</a>.<a title="=&gt; Seq[sbt.Path]" id="7280">toSeq</a>: _*)
			<span class="keyword">var</span> <a title="Int" id="33378">missed</a> = <span title="Int(0)" class="int">0</span>
			<span class="keyword">for</span>(<span id="7256"><a title="((sbt.Path) =&gt; Unit)Unit" id="33386">c</a></span> &lt;- (<a href="#32345" title="=&gt; sbt.Path">outputDirectory</a> <a href="Path.scala.html#9512" title="(sbt.FileFilter)sbt.PathFinder">**</a> <a href="NameFilter.scala.html#33382" title="(String)sbt.NameFilter">GlobFilter</a>(<span title="java.lang.String(&quot;*.class&quot;)" class="string">&quot;*.class&quot;</span>)).<a href="Path.scala.html#9518" title="=&gt; scala.collection.Set[sbt.Path]">get</a>)
			{
				<span title="Unit" class="keyword">if</span>(<a title="=&gt; Boolean" id="2637">!</a><a href="#33377" title="scala.collection.mutable.Set[sbt.Path]">classes</a>.<a title="(sbt.Path)Boolean" id="21328">contains</a>(<a href="#33386" title="sbt.Path">c</a>))
				{
					<a href="#33378" title="Int">missed</a> <a title="(Int)Int" id="3037">+=</a> <span title="Int(1)" class="int">1</span>
					<a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Missed class: &quot;)" class="string">&quot;Missed class: &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#33386" title="sbt.Path">c</a>)
				}
			}
			<a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8351" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Total missed classes: &quot;)" class="string">&quot;Total missed classes: &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#33378" title="Int">missed</a>)
		}
		<a href="#33345" title="Option[String]">r</a>
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="32335">finishHashes</a>()
	{
		<span title="Unit" class="keyword">if</span>(<a href="#32325" title="=&gt; sbt.ChangeDetection.Value">changeDetectionMethod</a> <a title="(AnyRef)Boolean" id="3399">==</a> <a href="#33216" title="=&gt; sbt.ChangeDetection.Value">LastModifiedOnly</a>)
			<a href="#32286" title="=&gt; CompileConditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21500" title="()Unit">clearHashes</a>()
		<span class="keyword">else</span>
		{
			<span class="keyword">for</span>(<span id="7256"><a href="#33412" title="(((sbt.Path, Option[Array[Byte]])) =&gt; Unit)Unit" id="7128">(</a></span><span id="33413"><a title="sbt.Path" id="33417">path</a></span>, <span id="33414"><a title="Option[Array[Byte]]" id="33418">hash</a></span>) &lt;- <a href="#32330" title="=&gt; scala.collection.mutable.Buffer[(sbt.Path, Option[Array[Byte]])]">newHashes</a>)
			{
				<a href="#33418" title="Option[Array[Byte]]">hash</a> <span title="Unit" class="keyword">match</span>
				{
					<span title="Unit" class="keyword">case</span> <a title="object None" id="488">None</a> =&gt; <a href="#32286" title="=&gt; CompileConditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21498" title="(sbt.Path)Unit">clearHash</a>(<a href="#33417" title="sbt.Path">path</a>)
					<span title="Unit" class="keyword">case</span> <a id="1">Some</a>(<a title="Array[Byte]" id="33419">hash</a>) =&gt; <a href="#32286" title="=&gt; CompileConditional.this.AnalysisType">analysis</a>.<a href="Analysis.scala.html#21497" title="(sbt.Path,Array[Byte])Unit">setHash</a>(<a href="#33417" title="sbt.Path">path</a>, <a href="#33419" title="Array[Byte]">hash</a>)
				}
			}
		}
		<a href="#32330" title="=&gt; scala.collection.mutable.Buffer[(sbt.Path, Option[Array[Byte]])]">newHashes</a>.<a title="()Unit" id="21738">clear</a>()
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Iterable[sbt.Path])Unit" id="32336">checkClasspath</a>(<a title="Iterable[sbt.Path]" id="33346">cp</a>: <a title="Iterable[sbt.Path]" id="358">Iterable</a>[Path])
	{
		<span class="keyword">import</span> scala.collection.mutable.{HashMap, HashSet, Set}
		<span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[String,scala.collection.mutable.Set[sbt.Path]]" id="33421">collisions</a> = <span title="scala.collection.mutable.HashMap[String,scala.collection.mutable.Set[sbt.Path]]" class="keyword">new</span> <a title="scala.collection.mutable.HashMap[String,scala.collection.mutable.Set[sbt.Path]]" id="8092">HashMap</a>[String, Set[Path]]
		<span class="keyword">for</span>(<span id="7256"><span id="7250"><span id="33423"><a title="((sbt.Path) =&gt; Unit)Unit" id="33428">jar</a></span></span></span> &lt;- <a href="#33346" title="Iterable[sbt.Path]">cp</a> <span class="keyword">if</span> <a href="ClasspathUtilities.scala.html#6367" title="object sbt.ClasspathUtilities">ClasspathUtilities</a>.<a href="ClasspathUtilities.scala.html#33251" title="(sbt.Path)Boolean">isArchive</a>(<a href="#33423" title="sbt.Path">jar</a>))
			<a href="#33421" title="scala.collection.mutable.HashMap[String,scala.collection.mutable.Set[sbt.Path]]">collisions</a>.<a title="(String,=&gt; scala.collection.mutable.Set[sbt.Path])scala.collection.mutable.Set[sbt.Path]" id="20473">getOrElseUpdate</a>(<a href="#33428" title="sbt.Path">jar</a>.<a href="Path.scala.html#9529" title="=&gt; java.io.File">asFile</a>.<a title="()java.lang.String" id="9546">getName</a>, <span title="scala.collection.mutable.HashSet[sbt.Path]" class="keyword">new</span> <a title="scala.collection.mutable.HashSet[sbt.Path]" id="7909">HashSet</a>[Path]) <a title="(sbt.Path)Unit" id="21512">+=</a> <a href="#33428" title="sbt.Path">jar</a>
		<span class="keyword">for</span>(<span id="7256"><a href="#33431" title="(((String, scala.collection.mutable.Set[sbt.Path])) =&gt; Unit)Unit" id="7250">(</a></span><span id="33432"><a title="String" id="33436">name</a></span>, <span id="33433"><a title="scala.collection.mutable.Set[sbt.Path]" id="33437">jars</a></span>) &lt;- <a href="#33421" title="scala.collection.mutable.HashMap[String,scala.collection.mutable.Set[sbt.Path]]">collisions</a>)
		{
			<span title="Unit" class="keyword">if</span>(<a href="#33437" title="scala.collection.mutable.Set[sbt.Path]">jars</a>.<a title="=&gt; Int" id="21327">size</a> <a title="(Int)Boolean" id="3035">&gt;</a> <span title="Int(1)" class="int">1</span>)
			{
				<a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8353" title="(=&gt; String)Unit">warn</a>(<span title="java.lang.String(&quot;Possible duplicate classpath locations for jar &quot;)" class="string">&quot;Possible duplicate classpath locations for jar &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#33436" title="String">name</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span>)
				<span class="keyword">for</span>(<span id="7256"><a title="((sbt.Path) =&gt; Unit)Unit" id="33440">jar</a></span> &lt;- <a href="#33437" title="scala.collection.mutable.Set[sbt.Path]">jars</a>) <a href="#32315" title="=&gt; sbt.Logger">log</a>.<a href="Logger.scala.html#8353" title="(=&gt; String)Unit">warn</a>(<span title="java.lang.String(&quot;\011&quot;)" class="string">&quot;\t&quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#33440" title="sbt.Path">jar</a>.<a href="Path.scala.html#9529" title="=&gt; java.io.File">asFile</a>.<a title="()java.lang.String" id="9553">getCanonicalPath</a>)
			}
		}
	}
	
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; sbt.AnalysisCallback" id="32337">analysisCallback</a>: <a href="AnalysisCallback.scala.html#6220" title="sbt.AnalysisCallback">AnalysisCallback</a> = <span title="CompileConditional.this.CompileAnalysisCallback" class="keyword">new</span> <a href="#32338" title="CompileConditional.this.CompileAnalysisCallback">CompileAnalysisCallback</a>
	<span class="keyword">protected</span> <span class="keyword">class</span> <a title="class CompileAnalysisCallback extends sbt.BasicAnalysisCallback with ScalaObject" id="32338">CompileAnalysisCallback</a> <span class="keyword">extends</span> <a href="AnalysisCallback.scala.html#6221" title="sbt.BasicAnalysisCallback">BasicAnalysisCallback</a>(<a href="#32348" title="=&gt; sbt.Path">projectPath</a>, <a href="#32351" title="=&gt; Iterable[String]">testDefinitionClassNames</a>, <a href="#32286" title="=&gt; CompileConditional.this.AnalysisType">analysis</a>)
	{
		<span class="keyword">def</span> <a title="(sbt.Path,String,String,Boolean)Unit" id="33442">foundSubclass</a>(<a title="sbt.Path" id="33444">sourcePath</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>, <a title="String" id="33445">subclassName</a>: <a title="String" id="1751">String</a>, <a title="String" id="33446">superclassName</a>: <a title="String" id="1751">String</a>, <a title="Boolean" id="33447">isModule</a>: <a title="Boolean" id="2060">Boolean</a>)
		{
			<a href="AnalysisCallback.scala.html#32823" title="=&gt; sbt.CompileAnalysis">analysis</a>.<a href="Analysis.scala.html#21495" title="(sbt.Path,sbt.TestDefinition)Unit">addTest</a>(<a href="#33444" title="sbt.Path">sourcePath</a>, <a href="impl/TestParser.scala.html#32870" title="(Boolean,String,String)sbt.TestDefinition">TestDefinition</a>(<a href="#33447" title="Boolean">isModule</a>, <a href="#33445" title="String">subclassName</a>, <a href="#33446" title="String">superclassName</a>))
		}
	}
}
<span class="keyword">object</span> <a title="object sbt.ChangeDetection" id="6254">ChangeDetection</a> <span class="keyword">extends</span> <span id="1084"><a title="Enumeration" id="20341">Enumeration</a></span>
{
	<span class="keyword">val</span> <span id="33217"><a title="sbt.ChangeDetection.Value" id="33216">LastModifiedOnly</a></span>, <span id="33219"><a title="sbt.ChangeDetection.Value" id="33218">HashOnly</a></span>, <span id="33221"><a title="sbt.ChangeDetection.Value" id="33220">HashAndLastModified</a></span>, <span id="33223"><a title="sbt.ChangeDetection.Value" id="33222">HashAndProductsExist</a></span> = <a title="=&gt; sbt.ChangeDetection.Value" id="20379">Value</a>
}
        </pre>
    </body>
</html>