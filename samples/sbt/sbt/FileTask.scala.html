<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>sbt/FileTask.scala</title>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2009 Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">import</span> scala.collection.{mutable, Map, Set}

<span class="keyword">sealed</span> <span class="keyword">trait</span> <span class="typed"><span class="type">trait ProductsSources extends java.lang.Object with NotNull</span><a id="6735">ProductsSources</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">NotNull</span><a id="186">NotNull</a></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a id="56600">products</a></span>: <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="384">Iterable</a></span>[Path]
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a id="56601">sources</a></span>: <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="384">Iterable</a></span>[Path]
}
<span class="keyword">sealed</span> <span class="keyword">trait</span> <span class="typed"><span class="type">trait ProductsWrapper extends java.lang.Object with NotNull with ScalaObject</span><a id="6736">ProductsWrapper</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">NotNull</span><a id="186">NotNull</a></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">(=&gt; Iterable[sbt.Path])sbt.ProductsSources</span><a id="25790">from</a></span>(<span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a id="51551">sources</a></span>: =&gt; Iterable[Path]): <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#6735">ProductsSources</a></span> = <span class="typed"><span class="type">(sbt.PathFinder)sbt.ProductsSources</span><a href="#25791">from</a></span>(<span class="typed"><span class="type">object sbt.Path</span><a href="Path.scala.html#6800">Path</a></span>.<span class="typed"><span class="type">(=&gt; Iterable[sbt.Path])sbt.PathFinder</span><a href="Path.scala.html#9605">lazyPathFinder</a></span>(<span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a href="#51551">sources</a></span>))
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.PathFinder)sbt.ProductsSources</span><a id="25791">from</a></span>(<span class="typed"><span class="type">sbt.PathFinder</span><a id="51555">sources</a></span>: <span class="typed"><span class="type">sbt.PathFinder</span><a href="Path.scala.html#6802">PathFinder</a></span>): <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#6735">ProductsSources</a></span>
}
<span class="comment">/** Provides methods to define tasks with basic conditional execution based on the sources
* and products of the task. */</span>
<span class="keyword">trait</span> <span class="typed"><span class="type">trait FileTasks extends java.lang.Object with sbt.Project with ScalaObject</span><a id="6737">FileTasks</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">sbt.Project</span><a href="Project.scala.html#6494">Project</a></span>
{
	<span class="keyword">implicit</span> <span class="keyword">def</span> <span class="typed"><span class="type">implicit sbt.FileTasks.wrapProduct : (=&gt; sbt.Path)sbt.ProductsWrapper</span><a id="25450">wrapProduct</a></span>(<span class="typed"><span class="type">=&gt; sbt.Path</span><a id="25792">product</a></span>: =&gt; Path): <span class="typed"><span class="type">sbt.ProductsWrapper</span><a href="#6736">ProductsWrapper</a></span> = <span class="typed"><span class="type">object sbt.FileTasks</span><a href="#6738">FileTasks</a></span>.<span class="typed"><span class="type">implicit sbt.FileTasks.wrapProduct : (=&gt; sbt.Path)sbt.ProductsWrapper</span><a href="#51463">wrapProduct</a></span>(<span class="typed"><span class="type">=&gt; sbt.Path</span><a href="#25792">product</a></span>)
	<span class="keyword">implicit</span> <span class="keyword">def</span> <span class="typed"><span class="type">implicit sbt.FileTasks.wrapProducts : (=&gt; Iterable[sbt.Path])sbt.ProductsWrapper</span><a id="25451">wrapProducts</a></span>(<span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a id="25788">productsList</a></span>: =&gt; Iterable[Path]): <span class="typed"><span class="type">sbt.ProductsWrapper</span><a href="#6736">ProductsWrapper</a></span> = <span class="typed"><span class="type">object sbt.FileTasks</span><a href="#6738">FileTasks</a></span>.<span class="typed"><span class="type">implicit sbt.FileTasks.wrapProducts : (=&gt; Iterable[sbt.Path])sbt.ProductsWrapper</span><a href="#51464">wrapProducts</a></span>(<span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a href="#25788">productsList</a></span>)
	<span class="comment">/** Runs 'action' if the given products are out of date with respect to the given sources. */</span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(String,sbt.ProductsSources)(=&gt; Option[String])FileTasks.this.Task</span><a id="25452">fileTask</a></span>(<span class="typed"><span class="type">String</span><a id="56609">label</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">sbt.ProductsSources</span><a id="56610">files</a></span>: <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#6735">ProductsSources</a></span>)(<span class="typed"><span class="type">=&gt; Option[String]</span><a id="56611">action</a></span>: =&gt; Option[String]): <span class="typed"><span class="type">FileTasks.this.Task</span><a href="TaskManager.scala.html#25081">Task</a></span> =
		<span class="typed"><span class="type">(=&gt; Option[String])FileTasks.this.Task</span><a href="TaskManager.scala.html#25077">task</a></span> { <span class="typed"><span class="type">object sbt.FileTasks</span><a href="#6738">FileTasks</a></span>.<span class="typed"><span class="type">(String,sbt.ProductsSources,sbt.Logger)(=&gt; Option[String])Option[String]</span><a href="#51465">runOption</a></span>(<span class="typed"><span class="type">String</span><a href="#56609">label</a></span>, <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#56610">files</a></span>, <span class="typed"><span class="type">=&gt; sbt.Logger</span><a href="Project.scala.html#25084">log</a></span>)(<span class="typed"><span class="type">=&gt; Option[String]</span><a href="#56611">action</a></span>) }
	<span class="comment">/** Runs 'action' if any of the given products do not exist. */</span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(String,=&gt; Iterable[sbt.Path])(=&gt; Option[String])FileTasks.this.Task</span><a id="25453">fileTask</a></span>(<span class="typed"><span class="type">String</span><a id="56621">label</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a id="56622">products</a></span>: =&gt; Iterable[Path])(<span class="typed"><span class="type">=&gt; Option[String]</span><a id="56623">action</a></span>: =&gt; Option[String]): <span class="typed"><span class="type">FileTasks.this.Task</span><a href="TaskManager.scala.html#25081">Task</a></span> =
		<span class="typed"><span class="type">(=&gt; Option[String])FileTasks.this.Task</span><a href="TaskManager.scala.html#25077">task</a></span> { <span class="typed"><span class="type">object sbt.FileTasks</span><a href="#6738">FileTasks</a></span>.<span class="typed"><span class="type">(String,Iterable[sbt.Path],sbt.Logger)(=&gt; Option[String])(=&gt; Option[String])Option[String]</span><a href="#51469">existenceCheck</a></span>[<span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String]](<span class="typed"><span class="type">String</span><a href="#56621">label</a></span>, <span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a href="#56622">products</a></span>, <span class="typed"><span class="type">=&gt; sbt.Logger</span><a href="Project.scala.html#25084">log</a></span>)(<span class="typed"><span class="type">=&gt; Option[String]</span><a href="#56623">action</a></span>)(<span class="typed"><span class="type">object None</span><a id="517">None</a></span>) }
		
	<span class="comment">/** Creates a new task that performs 'action' only when the given products are out of date with respect to the given sources.. */</span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.ProductsSources)(=&gt; Option[String])FileTasks.this.Task</span><a id="25454">fileTask</a></span>(<span class="typed"><span class="type">sbt.ProductsSources</span><a id="56643">files</a></span>: <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#6735">ProductsSources</a></span>)(<span class="typed"><span class="type">=&gt; Option[String]</span><a id="56644">action</a></span>: =&gt; Option[String]): <span class="typed"><span class="type">FileTasks.this.Task</span><a href="TaskManager.scala.html#25081">Task</a></span> = <span class="typed"><span class="type">(String,sbt.ProductsSources)(=&gt; Option[String])FileTasks.this.Task</span><a href="#25452">fileTask</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>, <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#56643">files</a></span>)(<span class="typed"><span class="type">=&gt; Option[String]</span><a href="#56644">action</a></span>)
	<span class="comment">/** Creates a new task that performs 'action' only when at least one of the given products does not exist.. */</span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(=&gt; Iterable[sbt.Path])(=&gt; Option[String])FileTasks.this.Task</span><a id="25455">fileTask</a></span>(<span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a id="56646">products</a></span>: =&gt; Iterable[Path])(<span class="typed"><span class="type">=&gt; Option[String]</span><a id="56647">action</a></span>: =&gt; Option[String]): <span class="typed"><span class="type">FileTasks.this.Task</span><a href="TaskManager.scala.html#25081">Task</a></span> = <span class="typed"><span class="type">(String,=&gt; Iterable[sbt.Path])(=&gt; Option[String])FileTasks.this.Task</span><a href="#25453">fileTask</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>, <span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a href="#56646">products</a></span>)(<span class="typed"><span class="type">=&gt; Option[String]</span><a href="#56647">action</a></span>)
	
}
<span class="keyword">object</span> <span class="typed"><span class="type">object sbt.FileTasks</span><a id="6738">FileTasks</a></span>
{
	<span class="keyword">implicit</span> <span class="keyword">def</span> <span class="typed"><span class="type">implicit sbt.FileTasks.wrapProduct : (=&gt; sbt.Path)sbt.ProductsWrapper</span><a id="51463">wrapProduct</a></span>(<span class="typed"><span class="type">=&gt; sbt.Path</span><a id="51543">product</a></span>: =&gt; Path): <span class="typed"><span class="type">sbt.ProductsWrapper</span><a href="#6736">ProductsWrapper</a></span> = <span class="typed"><span class="type">implicit sbt.FileTasks.wrapProducts : (=&gt; Iterable[sbt.Path])sbt.ProductsWrapper</span><a href="#51464">wrapProducts</a></span>(<span class="typed"><span class="type">=&gt; sbt.Path</span><a href="#51543">product</a></span> <span class="typed"><span class="type">(sbt.Path)List[sbt.Path]</span><a href="#56676" id="6908">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>)
	<span class="keyword">implicit</span> <span class="keyword">def</span> <span class="typed"><span class="type">implicit sbt.FileTasks.wrapProducts : (=&gt; Iterable[sbt.Path])sbt.ProductsWrapper</span><a id="51464">wrapProducts</a></span>(<span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a id="51544">productsList</a></span>: =&gt; Iterable[Path]): <span class="typed"><span class="type">sbt.ProductsWrapper</span><a href="#6736">ProductsWrapper</a></span> =
		<span class="typed"><span class="type">template $anon extends java.lang.Object with sbt.ProductsWrapper</span><a id="56679" class="keyword">new</a></span> <span class="typed"><span class="type">sbt.ProductsWrapper</span><a href="#6736">ProductsWrapper</a></span>
		{
			<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.PathFinder)java.lang.Object with sbt.ProductsSources{def sources: scala.collection.Set[sbt.Path]}</span><a id="56681">from</a></span>(<span class="typed"><span class="type">sbt.PathFinder</span><a id="56684">sourceFinder</a></span>: <span class="typed"><span class="type">sbt.PathFinder</span><a href="Path.scala.html#6802">PathFinder</a></span>) =
				<span class="typed"><span class="type">template $anon extends java.lang.Object with sbt.ProductsSources</span><a id="56687" class="keyword">new</a></span> <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#6735">ProductsSources</a></span>
				{
					<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a id="56689">products</a></span> = <span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a href="#51544">productsList</a></span>
					<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.collection.Set[sbt.Path]</span><a id="56690">sources</a></span> = <span class="typed"><span class="type">sbt.PathFinder</span><a href="#56684">sourceFinder</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.Set[sbt.Path]</span><a href="Path.scala.html#9627">get</a></span>
				}
		}
	<span class="comment">/** Runs 'ifOutofdate' if the given products are out of date with respect to the given sources.*/</span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(String,sbt.ProductsSources,sbt.Logger)(=&gt; Option[String])Option[String]</span><a id="51465">runOption</a></span>(<span class="typed"><span class="type">String</span><a id="51536">label</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">sbt.ProductsSources</span><a id="51537">files</a></span>: <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#6735">ProductsSources</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a id="51538">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>)(<span class="typed"><span class="type">=&gt; Option[String]</span><a id="51539">ifOutofdate</a></span>: =&gt; Option[String]): <span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String] =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">Option[String]</span><a id="56704">result</a></span> = <span class="typed"><span class="type">(String,sbt.ProductsSources,sbt.Logger)(=&gt; Option[String])(=&gt; Option[String])Option[String]</span><a href="#51466">apply</a></span>[<span class="typed"><span class="type">Option[String]</span><a id="915">Option</a></span>[String]](<span class="typed"><span class="type">String</span><a href="#51536">label</a></span>, <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#51537">files</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#51538">log</a></span>)(<span class="typed"><span class="type">=&gt; Option[String]</span><a href="#51539">ifOutofdate</a></span>)(<span class="typed"><span class="type">object None</span><a id="517">None</a></span>)
		<span class="typed"><span class="type">Any</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Option[String]</span><a href="#56704">result</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="10260">isDefined</a></span>)
			<span class="typed"><span class="type">object sbt.FileUtilities</span><a href="FileUtilities.scala.html#6450">FileUtilities</a></span>.<span class="typed"><span class="type">(Iterable[sbt.Path],Boolean,sbt.Logger)Option[String]</span><a href="FileUtilities.scala.html#9548">clean</a></span>(<span class="typed"><span class="type">sbt.ProductsSources</span><a href="#51537">files</a></span>.<span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a href="#56600">products</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#51538">log</a></span>)
		<span class="typed"><span class="type">Option[String]</span><a href="#56704">result</a></span>
	}
	<span class="comment">/** Returns 'ifOutofdate' if the given products are out of date with respect to the given sources.  Otherwise, returns ifUptodate. */</span>
	<span class="keyword">def</span> <span class="typed"><span class="type">[T](String,sbt.ProductsSources,sbt.Logger)(=&gt; T)(=&gt; T)T</span><a id="51466">apply</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="51468">T</a></span>](<span class="typed"><span class="type">String</span><a id="56705">label</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">sbt.ProductsSources</span><a id="56706">files</a></span>: <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#6735">ProductsSources</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a id="56707">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>)(<span class="typed"><span class="type">=&gt; T</span><a id="56708">ifOutofdate</a></span>: =&gt; T)(<span class="typed"><span class="type">=&gt; T</span><a id="56709">ifUptodate</a></span>: =&gt; T): <span class="typed"><span class="type">T</span><a href="#51468">T</a></span> =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="56717">products</a></span> = <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#56706">files</a></span>.<span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a href="#56600">products</a></span>
		<span class="typed"><span class="type">(String,Iterable[sbt.Path],sbt.Logger)(=&gt; T)(=&gt; T)T</span><a href="#51469">existenceCheck</a></span>[<span class="typed"><span class="type">T</span><a href="#51468">T</a></span>](<span class="typed"><span class="type">String</span><a href="#56705">label</a></span>, <span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#56717">products</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#56707">log</a></span>)(<span class="typed"><span class="type">=&gt; T</span><a href="#56708">ifOutofdate</a></span>)
		{
			<span class="keyword">val</span> <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="56718">sources</a></span> = <span class="typed"><span class="type">sbt.ProductsSources</span><a href="#56706">files</a></span>.<span class="typed"><span class="type">=&gt; Iterable[sbt.Path]</span><a href="#56601">sources</a></span>
			<span class="typed"><span class="type">T</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#56718">sources</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="7399">isEmpty</a></span>)
			{
				<span class="typed"><span class="type">sbt.Logger</span><a href="#56707">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Running &quot;)</span><span class="string">&quot;Running &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">String</span><a href="#56705">label</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; task because no sources exist.&quot;)</span><span class="string">&quot; task because no sources exist.&quot;</span></span>)
				<span class="typed"><span class="type">=&gt; T</span><a href="#56708">ifOutofdate</a></span>
			}
			<span class="keyword">else</span>
			{
				<span class="keyword">val</span> <span class="typed"><span class="type">Long</span><a id="56719">oldestProductModifiedTime</a></span> = <span class="typed"><span class="type">(Iterable[sbt.Path])Iterable[Long]</span><a href="#51475">mapLastModified</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#56717">products</a></span>).<span class="typed"><span class="type">((Long, Long) =&gt; Long)Long</span><a id="7380">reduceLeft</a></span>(<span class="typed"><span class="type">implicit scala.Predef.longWrapper : (Long)scala.runtime.RichLong</span><span id="6099"><a href="#56725" id="802">_</a></span></span> <span class="typed"><span class="type">(Long)Long</span><a id="21764">min</a></span> <span class="typed"><span class="type">Long</span><a href="#56726">_</a></span>)
				<span class="keyword">val</span> <span class="typed"><span class="type">Long</span><a id="56720">newestSourceModifiedTime</a></span> = <span class="typed"><span class="type">(Iterable[sbt.Path])Iterable[Long]</span><a href="#51475">mapLastModified</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#56718">sources</a></span>).<span class="typed"><span class="type">((Long, Long) =&gt; Long)Long</span><a id="7380">reduceLeft</a></span>(<span class="typed"><span class="type">implicit scala.Predef.longWrapper : (Long)scala.runtime.RichLong</span><span id="6099"><a href="#56735" id="802">_</a></span></span> <span class="typed"><span class="type">(Long)Long</span><a id="21765">max</a></span> <span class="typed"><span class="type">Long</span><a href="#56736">_</a></span>)
				<span class="typed"><span class="type">T</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Long</span><a href="#56719">oldestProductModifiedTime</a></span> <span class="typed"><span class="type">(Long)Boolean</span><a id="3247">&lt;</a></span> <span class="typed"><span class="type">Long</span><a href="#56720">newestSourceModifiedTime</a></span>)
				{
					<span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">sbt.Logger</span><a href="#56707">log</a></span>.<span class="typed"><span class="type">(sbt.Level.Value)Boolean</span><a href="Logger.scala.html#8464">atLevel</a></span>(<span class="typed"><span class="type">object sbt.Level</span><a href="Logger.scala.html#6774">Level</a></span>.<span class="typed"><span class="type">=&gt; sbt.Level.Value</span><a href="Logger.scala.html#21788">Debug</a></span>))
					{
						<span class="typed"><span class="type">sbt.Logger</span><a href="#56707">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Running &quot;)</span><span class="string">&quot;Running &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">String</span><a href="#56705">label</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; task because the following sources are newer than at least one product: &quot;)</span><span class="string">&quot; task because the following sources are newer than at least one product: &quot;</span></span>)
						<span class="typed"><span class="type">(Iterable[sbt.Path],sbt.Logger)Unit</span><a href="#51472">logDebugIndented</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#56718">sources</a></span>.<span class="typed"><span class="type">((sbt.Path) =&gt; Boolean)Iterable[sbt.Path]</span><a id="7359">filter</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#56744">_</a></span>.<span class="typed"><span class="type">=&gt; Long</span><a href="Path.scala.html#9635">lastModified</a></span> <span class="typed"><span class="type">(Long)Boolean</span><a id="3249">&gt;</a></span> <span class="typed"><span class="type">Long</span><a href="#56719">oldestProductModifiedTime</a></span>), <span class="typed"><span class="type">sbt.Logger</span><a href="#56707">log</a></span>)
						<span class="typed"><span class="type">sbt.Logger</span><a href="#56707">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot; The following products are older than at least one source: &quot;)</span><span class="string">&quot; The following products are older than at least one source: &quot;</span></span>)
						<span class="typed"><span class="type">(Iterable[sbt.Path],sbt.Logger)Unit</span><a href="#51472">logDebugIndented</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#56717">products</a></span>.<span class="typed"><span class="type">((sbt.Path) =&gt; Boolean)Iterable[sbt.Path]</span><a id="7359">filter</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#56748">_</a></span>.<span class="typed"><span class="type">=&gt; Long</span><a href="Path.scala.html#9635">lastModified</a></span> <span class="typed"><span class="type">(Long)Boolean</span><a id="3247">&lt;</a></span> <span class="typed"><span class="type">Long</span><a href="#56720">newestSourceModifiedTime</a></span>), <span class="typed"><span class="type">sbt.Logger</span><a href="#56707">log</a></span>)
					}
					<span class="typed"><span class="type">=&gt; T</span><a href="#56708">ifOutofdate</a></span>
				}
				<span class="keyword">else</span>
					<span class="typed"><span class="type">=&gt; T</span><a href="#56709">ifUptodate</a></span>
			}
		}
	}
	<span class="comment">/** Checks that all 'products' exist.  If they do, 'ifAllExists' is returned, otherwise 'products' is returned.*/</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">[T](String,Iterable[sbt.Path],sbt.Logger)(=&gt; T)(=&gt; T)T</span><a id="51469">existenceCheck</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="51471">T</a></span>](<span class="typed"><span class="type">String</span><a id="56631">label</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="56632">products</a></span>: <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="384">Iterable</a></span>[Path], <span class="typed"><span class="type">sbt.Logger</span><a id="56633">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>)(<span class="typed"><span class="type">=&gt; T</span><a id="56634">action</a></span>: =&gt; T)(<span class="typed"><span class="type">=&gt; T</span><a id="56635">ifAllExist</a></span>: =&gt; T) =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="56637">nonexisting</a></span> = <span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#56632">products</a></span>.<span class="typed"><span class="type">((sbt.Path) =&gt; Boolean)Iterable[sbt.Path]</span><a id="7359">filter</a></span>(<span class="typed"><span class="type">=&gt; Boolean</span><a id="2728">!</a></span><span class="typed"><span class="type">sbt.Path</span><a href="#56639">_</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="Path.scala.html#9633">exists</a></span>)
		<span class="typed"><span class="type">T</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#56637">nonexisting</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="7399">isEmpty</a></span>)
			<span class="typed"><span class="type">=&gt; T</span><a href="#56635">ifAllExist</a></span>
		<span class="keyword">else</span>
		{
			<span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">sbt.Logger</span><a href="#56633">log</a></span>.<span class="typed"><span class="type">(sbt.Level.Value)Boolean</span><a href="Logger.scala.html#8464">atLevel</a></span>(<span class="typed"><span class="type">object sbt.Level</span><a href="Logger.scala.html#6774">Level</a></span>.<span class="typed"><span class="type">=&gt; sbt.Level.Value</span><a href="Logger.scala.html#21788">Debug</a></span>))
			{
				<span class="typed"><span class="type">sbt.Logger</span><a href="#56633">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Running &quot;)</span><span class="string">&quot;Running &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">String</span><a href="#56631">label</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; task because at least one product does not exist:&quot;)</span><span class="string">&quot; task because at least one product does not exist:&quot;</span></span>)
				<span class="typed"><span class="type">(Iterable[sbt.Path],sbt.Logger)Unit</span><a href="#51472">logDebugIndented</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#56637">nonexisting</a></span>, <span class="typed"><span class="type">sbt.Logger</span><a href="#56633">log</a></span>)
			}
			<span class="typed"><span class="type">=&gt; T</span><a href="#56634">action</a></span>
		}
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">[T](Iterable[T],sbt.Logger)Unit</span><a id="51472">logDebugIndented</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="51474">T</a></span>](<span class="typed"><span class="type">Iterable[T]</span><a id="56640">it</a></span>: <span class="typed"><span class="type">Iterable[T]</span><a id="384">Iterable</a></span>[T], <span class="typed"><span class="type">sbt.Logger</span><a id="56641">log</a></span>: <span class="typed"><span class="type">sbt.Logger</span><a href="Logger.scala.html#6766">Logger</a></span>) { <span class="typed"><span class="type">Iterable[T]</span><a href="#56640">it</a></span>.<span class="typed"><span class="type">((T) =&gt; Unit)Unit</span><a id="7365">foreach</a></span>(<span class="typed"><span class="type">T</span><a id="56751">x</a></span> =&gt; <span class="typed"><span class="type">sbt.Logger</span><a href="#56641">log</a></span>.<span class="typed"><span class="type">(=&gt; String)Unit</span><a href="Logger.scala.html#8466">debug</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;\011&quot;)</span><span class="string">&quot;\t&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">T</span><a href="#56751">x</a></span>)) }
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Iterable[sbt.Path])Iterable[Long]</span><a id="51475">mapLastModified</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="56721">paths</a></span>: <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="384">Iterable</a></span>[Path]): <span class="typed"><span class="type">Iterable[Long]</span><a id="384">Iterable</a></span>[Long] = <span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#56721">paths</a></span>.<span class="typed"><span class="type">((sbt.Path) =&gt; Long)Iterable[Long]</span><a id="7355">map</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#56754">_</a></span>.<span class="typed"><span class="type">=&gt; Long</span><a href="Path.scala.html#9635">lastModified</a></span>)
}
        </pre>
    </body>
</html>