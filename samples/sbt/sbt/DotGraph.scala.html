<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>sbt/DotGraph.scala</title>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008, 2009 Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">import</span> java.io.{File, Writer}

<span class="keyword">object</span> <a title="object sbt.DotGraph" id="6120">DotGraph</a>
{
	<span class="keyword">def</span> <a title="(sbt.CompileAnalysis,sbt.Path,sbt.Logger)Option[String]" id="21101">apply</a>(<a title="sbt.CompileAnalysis" id="21105">analysis</a>: <a href="Analysis.scala.html#6138" title="sbt.CompileAnalysis">CompileAnalysis</a>, <a title="sbt.Path" id="21106">outputDirectory</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>, <a title="sbt.Logger" id="21107">log</a>: <a href="Logger.scala.html#6667" title="sbt.Logger">Logger</a>) =
	{
		<span class="keyword">val</span> <a title="java.io.File" id="21109">outputDir</a> = <a href="#21106" title="sbt.Path">outputDirectory</a>.<a href="Path.scala.html#9529" title="=&gt; java.io.File">asFile</a>
		
		<span class="keyword">def</span> <a title="[Key, Value](String,String,Iterable[(Key, scala.collection.Set[Value])],(Key) =&gt; String,(Value) =&gt; String)Option[String]" id="21110">generateGraph</a>[<a title="&gt;: Nothing &lt;: Any" id="21113">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="21114">Value</a>](<a title="String" id="21115">fileName</a>: <a title="String" id="1751">String</a>, <a title="String" id="21116">graphName</a>: <a title="String" id="1751">String</a>, <a title="Iterable[(Key, scala.collection.Set[Value])]" id="21117">graph</a>: <a title="Iterable[(Key, scala.collection.Set[Value])]" id="358">Iterable</a>[(Key, scala.collection.Set[Value])],
			<a title="(Key) =&gt; String" id="21118">keyToString</a>: Key =&gt; String, <a title="(Value) =&gt; String" id="21119">valueToString</a>: Value =&gt; String) =
		{
			<a href="FileUtilities.scala.html#6351" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#9448" title="(java.io.File,sbt.Logger)((java.io.Writer) =&gt; Option[String])Option[String]">write</a>(<a title="(java.io.File,java.lang.String)java.io.File" id="9544" class="keyword">new</a> <a title="java.io.File" id="3559">File</a>(<a href="#21109" title="java.io.File">outputDir</a>, <a href="#21115" title="String">fileName</a>), <a href="#21107" title="sbt.Logger">log</a>)
			{
				(<a title="java.io.Writer" id="21320">writer</a>: <a title="java.io.Writer" id="3694">Writer</a>) =&gt;
				{
					<span class="keyword">def</span> <a title="(String)Unit" id="21321">writeLine</a>(<a title="String" id="21322">line</a>: <a title="String" id="1751">String</a>) = <a href="FileUtilities.scala.html#6351" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#9482" title="(java.io.Writer,String)Unit">writeLine</a>(<a href="#21320" title="java.io.Writer">writer</a>, <a href="#21322" title="String">line</a>)
					<a href="#21321" title="(String)Unit">writeLine</a>(<span title="java.lang.String(&quot;digraph &quot;)" class="string">&quot;digraph &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#21116" title="String">graphName</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; {&quot;)" class="string">&quot; {&quot;</span>)
					<span class="keyword">for</span>( <span id="7256"><a href="#21340" title="(((Key, scala.collection.Set[Value])) =&gt; Unit)Unit" id="7250">(</a></span><span id="21342"><a title="Key" id="21346">dependsOn</a></span>, <span id="21343"><a title="scala.collection.Set[Value]" id="21347">dependants</a></span>) &lt;- <a href="#21117" title="Iterable[(Key, scala.collection.Set[Value])]">graph</a>; <span id="7256"><a title="((Value) =&gt; Unit)Unit" id="21349">dependant</a></span> &lt;- <a href="#21347" title="scala.collection.Set[Value]">dependants</a>)
						<a href="#21321" title="(String)Unit">writeLine</a>(<a href="#21119" title="(Value)String" id="7221">valueToString</a>(<a href="#21349" title="Value">dependant</a>) <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#21118" title="(Key)String" id="7221">keyToString</a>(<a href="#21346" title="Key">dependsOn</a>))
					<a href="#21321" title="(String)Unit">writeLine</a>(<span title="java.lang.String(&quot;}&quot;)" class="string">&quot;}&quot;</span>)
					<a title="object None" id="488">None</a>
				}
			}
		}
		<a href="FileUtilities.scala.html#6351" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#9419" title="(java.io.File,sbt.Logger)Option[String]">createDirectory</a>(<a href="#21109" title="java.io.File">outputDir</a>, <a href="#21107" title="sbt.Logger">log</a>) <a title="(=&gt; Option[String])Option[String]" id="10163">orElse</a>
		<a href="#21110" title="(String,String,Iterable[(sbt.Path, scala.collection.Set[sbt.Path])],(sbt.Path) =&gt; String,(sbt.Path) =&gt; String)Option[String]">generateGraph</a>(<a href="Analysis.scala.html#6134" title="object sbt.BasicAnalysis">BasicAnalysis</a>.<a href="Analysis.scala.html#21358" title="=&gt; java.lang.String">DependenciesFileName</a>, <span title="java.lang.String(&quot;dependencies&quot;)" class="string">&quot;dependencies&quot;</span>, <a href="#21105" title="sbt.CompileAnalysis">analysis</a>.<a href="Analysis.scala.html#21466" title="=&gt; Iterable[(sbt.Path, scala.collection.Set[sbt.Path])]">allDependencies</a>,
			<a href="#21102" title="(sbt.Path)java.lang.String">sourceToString</a>, <a href="#21102" title="(sbt.Path)java.lang.String">sourceToString</a>) <a title="(=&gt; Option[String])Option[String]" id="10163">orElse</a>
		<a href="#21110" title="(String,String,Iterable[(java.io.File, scala.collection.Set[sbt.Path])],(java.io.File) =&gt; String,(sbt.Path) =&gt; String)Option[String]">generateGraph</a>(<a href="Analysis.scala.html#6134" title="object sbt.BasicAnalysis">BasicAnalysis</a>.<a href="Analysis.scala.html#21360" title="=&gt; java.lang.String">ExternalDependenciesFileName</a>, <span title="java.lang.String(&quot;externalDependencies&quot;)" class="string">&quot;externalDependencies&quot;</span>, <a href="#21105" title="sbt.CompileAnalysis">analysis</a>.<a href="Analysis.scala.html#21465" title="=&gt; Iterable[(java.io.File, scala.collection.Set[sbt.Path])]">allExternalDependencies</a>,
			<a href="#21103" title="(java.io.File)java.lang.String">fileToString</a>, <a href="#21102" title="(sbt.Path)java.lang.String">sourceToString</a>)
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(sbt.Path)java.lang.String" id="21102">sourceToString</a>(<a title="sbt.Path" id="21542">source</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>) = <a href="#21103" title="(java.io.File)java.lang.String">fileToString</a>(<a href="#21542" title="sbt.Path">source</a>.<a href="Path.scala.html#9529" title="=&gt; java.io.File">asFile</a>)
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(java.io.File)java.lang.String" id="21103">fileToString</a>(<a title="java.io.File" id="21544">file</a>: <a title="java.io.File" id="3559">File</a>) =
	{
		<span class="keyword">val</span> <a title="java.lang.String" id="21546">rawName</a> = <a href="#21544" title="java.io.File">file</a>.<a title="()java.lang.String" id="9546">getName</a>
		<span class="keyword">val</span> <a title="java.lang.String" id="21547">name</a> =
			<span title="java.lang.String" class="keyword">if</span>(<a href="#21546" title="java.lang.String">rawName</a>.<a title="(java.lang.String)Boolean" id="5723">endsWith</a>(<span title="java.lang.String(&quot;.scala&quot;)" class="string">&quot;.scala&quot;</span>))
				<a href="#21546" title="java.lang.String">rawName</a>.<a title="(Int,Int)java.lang.String" id="5736">substring</a>(<span title="Int(0)" class="int">0</span>, <a href="#21546" title="java.lang.String">rawName</a>.<a title="()Int" id="5702">length</a> <a title="(Int)Int" id="3038">-</a> <span title="java.lang.String(&quot;.scala&quot;)" class="string">&quot;.scala&quot;</span>.<a title="()Int" id="5702">length</a>)
			<span class="keyword">else</span>
				<a href="#21546" title="java.lang.String">rawName</a>
		<span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span> <a title="(Any)java.lang.String" id="5683">+</a> <a href="#21547" title="java.lang.String">name</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>
	}
}
        </pre>
    </body>
</html>