<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>sbt/ClasspathUtilities.scala</title>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008 Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> scala.collection.Set
<span class="keyword">import</span> scala.collection.mutable.{HashSet, ListBuffer}

<span class="keyword">private</span>[sbt] <span class="keyword">object</span> <a title="object sbt.ClasspathUtilities" id="6367">ClasspathUtilities</a>
{
	<span class="keyword">def</span> <a title="(sbt.Path)Boolean" id="33251">isArchive</a>(<a title="sbt.Path" id="33426">path</a>: <a href="Path.scala.html#6697" title="sbt.Path">Path</a>): <a title="Boolean" id="2060">Boolean</a> = <a href="#33252" title="(java.io.File)Boolean">isArchive</a>(<a href="#33426" title="sbt.Path">path</a>.<a href="Path.scala.html#9529" title="=&gt; java.io.File">asFile</a>)
	<span class="keyword">def</span> <a title="(java.io.File)Boolean" id="33252">isArchive</a>(<a title="java.io.File" id="33425">file</a>: <a title="java.io.File" id="3559">File</a>): <a title="Boolean" id="2060">Boolean</a> = <a href="#33253" title="(String)Boolean">isArchiveName</a>(<a href="#33425" title="java.io.File">file</a>.<a title="()java.lang.String" id="9546">getName</a>)
	<span class="keyword">def</span> <a title="(String)Boolean" id="33253">isArchiveName</a>(<a title="String" id="45101">fileName</a>: <a title="String" id="1751">String</a>) = <a href="#45101" title="String">fileName</a>.<a title="(java.lang.String)Boolean" id="5723">endsWith</a>(<span title="java.lang.String(&quot;.jar&quot;)" class="string">&quot;.jar&quot;</span>) <a title="(Boolean)Boolean" id="2640">||</a> <a href="#45101" title="String">fileName</a>.<a title="(java.lang.String)Boolean" id="5723">endsWith</a>(<span title="java.lang.String(&quot;.zip&quot;)" class="string">&quot;.zip&quot;</span>)
	<span class="comment">// (jars, dirs)</span>
	<span class="keyword">def</span> <a title="(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])" id="33254">separate</a>(<a title="Iterable[java.io.File]" id="45103">paths</a>: <a title="Iterable[java.io.File]" id="358">Iterable</a>[File]): <a title="(Iterable[java.io.File], Iterable[java.io.File])" id="1282">(</a>Iterable[File], Iterable[File]) = <a href="#45103" title="Iterable[java.io.File]">paths</a>.<a title="((java.io.File) =&gt; Boolean)(Iterable[java.io.File], Iterable[java.io.File])" id="7251">partition</a>(<a href="#33252" title="(java.io.File)Boolean">isArchive</a>)
	<span class="keyword">def</span> <a title="(Iterable[sbt.Path])(Iterable[java.io.File], Iterable[java.io.File])" id="33255">separatePaths</a>(<a title="Iterable[sbt.Path]" id="45108">paths</a>: <a title="Iterable[sbt.Path]" id="358">Iterable</a>[Path]) = <a href="#33254" title="(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])">separate</a>(<a href="#45108" title="Iterable[sbt.Path]">paths</a>.<a title="((sbt.Path) =&gt; java.io.File)Iterable[java.io.File]" id="7246">map</a>(<a href="#45112" title="sbt.Path">_</a>.<a href="Path.scala.html#9529" title="=&gt; java.io.File">asFile</a>.<a title="()java.io.File" id="9554">getCanonicalFile</a>))
	<span class="keyword">def</span> <a title="(Iterable[sbt.Path])(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])" id="33256">buildSearchPaths</a>(<a title="Iterable[sbt.Path]" id="33267">classpath</a>: <a title="Iterable[sbt.Path]" id="358">Iterable</a>[Path]): <a title="(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])" id="1282">(</a>Set[File], Set[File]) =
	{
		<span class="keyword">val</span> <span id="9252"><a href="#45116" title="(Iterable[java.io.File], Iterable[java.io.File])" id="1283">(</a></span><span id="45116"><span id="45114"><a href="#45113" title="Iterable[java.io.File]" id="9240">jars</a></span></span>, <span id="45117"><span id="45115"><a href="#45113" title="Iterable[java.io.File]" id="9242">dirs</a></span></span>) = <a href="#33255" title="(Iterable[sbt.Path])(Iterable[java.io.File], Iterable[java.io.File])">separatePaths</a>(<a href="#33267" title="Iterable[sbt.Path]">classpath</a>)
		<span id="9252"><a title="(scala.collection.Set[java.io.File],scala.collection.Set[java.io.File])(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])" id="1283">(</a></span><a href="#33264" title="(Iterable[java.io.File])scala.collection.Set[java.io.File]">linkedSet</a>(<a href="#45114" title="Iterable[java.io.File]">jars</a> <a title="(Iterable[java.io.File])Collection[java.io.File]" id="7244">++</a> <a href="#33260" title="=&gt; scala.collection.Set[java.io.File]">extraJars</a>), <a href="#33264" title="(Iterable[java.io.File])scala.collection.Set[java.io.File]">linkedSet</a>(<a href="#45115" title="Iterable[java.io.File]">dirs</a> <a title="(Iterable[java.io.File])Collection[java.io.File]" id="7244">++</a> <a href="#33262" title="=&gt; scala.collection.Set[java.io.File]">extraDirs</a>))
	}
	<span class="keyword">def</span> <a title="(scala.collection.Set[java.io.File],Iterable[java.io.File],java.io.File)Boolean" id="33257">onClasspath</a>(<a title="scala.collection.Set[java.io.File]" id="33276">classpathJars</a>: <a title="scala.collection.Set[java.io.File]" id="7387">Set</a>[File], <a title="Iterable[java.io.File]" id="33277">classpathDirectories</a>: <a title="Iterable[java.io.File]" id="358">Iterable</a>[File], <a title="java.io.File" id="33278">file</a>: <a title="java.io.File" id="3559">File</a>): <a title="Boolean" id="2060">Boolean</a> =
	{
		<span class="keyword">val</span> <a title="java.io.File" id="45220">f</a> = <a href="#33278" title="java.io.File">file</a>.<a title="()java.io.File" id="9554">getCanonicalFile</a>
		<span title="Boolean" class="keyword">if</span>(<a href="#6367" title="object sbt.ClasspathUtilities">ClasspathUtilities</a>.<a href="#33252" title="(java.io.File)Boolean">isArchive</a>(<a href="#45220" title="java.io.File">f</a>))
			<a href="#33276" title="scala.collection.Set[java.io.File]">classpathJars</a>.<a title="(java.io.File)Boolean" id="21328">contains</a>(<a href="#45220" title="java.io.File">f</a>)
		<span class="keyword">else</span>
			<a href="#33277" title="Iterable[java.io.File]">classpathDirectories</a>.<a title="((java.io.File) =&gt; Boolean)Option[java.io.File]" id="7259">find</a>(<a href="Path.scala.html#6701" title="object sbt.Path">Path</a>.<a href="Path.scala.html#9505" title="(java.io.File,java.io.File)Option[String]">relativize</a>(<a href="#45223" title="java.io.File">_</a>, <a href="#45220" title="java.io.File">f</a>).<a title="=&gt; Boolean" id="10151">isDefined</a>).<a title="=&gt; Boolean" id="10151">isDefined</a>
	}
	
	<span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <span id="33259"><span id="9252"><a href="#45213" title="(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])" id="1283">(</a></span></span><span id="45213"><span id="33261"><a href="#33258" title="scala.collection.Set[java.io.File]" id="9240">extraJars</a></span></span>, <span id="45214"><span id="33263"><a href="#33258" title="scala.collection.Set[java.io.File]" id="9242">extraDirs</a></span></span>) =
	{
		<span class="keyword">import</span> scala.tools.nsc.GenericRunnerCommand
		<span class="keyword">val</span> <a title="scala.tools.nsc.GenericRunnerSettings" id="45127">settings</a> = (<a title="(List[String],(String) =&gt; Unit)scala.tools.nsc.GenericRunnerCommand" id="42936" class="keyword">new</a> <a title="scala.tools.nsc.GenericRunnerCommand" id="11132">GenericRunnerCommand</a>(<a title="object Nil" id="299">Nil</a>, <a title="String" id="45146">message</a> =&gt; <span id="5873"><a title="(String)Nothing" id="770">error</a></span>(<a href="#45146" title="String">message</a>))).<a title="=&gt; scala.tools.nsc.GenericRunnerSettings" id="42932">settings</a>
		<span class="keyword">val</span> <a title="List[java.io.File]" id="45128">bootPaths</a> = <a href="FileUtilities.scala.html#6351" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#9394" title="(String)Array[java.lang.String]">pathSplit</a>(<a href="#45127" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a title="=&gt; settings.StringSetting" id="11694">bootclasspath</a>.<a title="=&gt; String" id="11679">value</a>).<a title="((java.lang.String) =&gt; java.io.File)Array[java.io.File]" id="6989">map</a>(<a title="java.lang.String" id="45151">p</a> =&gt; <span title="java.io.File" class="keyword">new</span> <a title="java.io.File" id="3559">File</a>(<a href="#45151" title="java.lang.String">p</a>)).<a title="=&gt; List[java.io.File]" id="7279">toList</a>
		<span class="keyword">val</span> <span id="9252"><a href="#45154" title="(Iterable[java.io.File], Iterable[java.io.File])" id="1283">(</a></span><span id="45154"><span id="45130"><a href="#45129" title="Iterable[java.io.File]" id="9240">bootJars</a></span></span>, <span id="45155"><span id="45131"><a href="#45129" title="Iterable[java.io.File]" id="9242">bootDirs</a></span></span>) = <a href="#33254" title="(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])">separate</a>(<a href="#45128" title="List[java.io.File]">bootPaths</a>)
		<span class="keyword">val</span> <a title="List[java.io.File]" id="45132">extJars</a> =
		{
			<span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[java.io.File]" id="45158">buffer</a> = <span title="scala.collection.mutable.ListBuffer[java.io.File]" class="keyword">new</span> <a title="scala.collection.mutable.ListBuffer[java.io.File]" id="7939">ListBuffer</a>[File]
			<span class="keyword">def</span> <a title="(java.io.File)Unit" id="45159">findJars</a>(<a title="java.io.File" id="45160">dir</a>: <a title="java.io.File" id="3559">File</a>)
			{
				<a href="#45158" title="scala.collection.mutable.ListBuffer[java.io.File]">buffer</a> <a title="(Iterable[java.io.File])Unit" id="21719">++=</a> <a href="#45160" title="java.io.File">dir</a>.<a title="(java.io.FileFilter)Array[java.io.File]" id="9572">listFiles</a>(<span title="sbt.SimpleFileFilter" class="keyword">new</span> <a href="NameFilter.scala.html#6532" title="sbt.SimpleFileFilter">SimpleFileFilter</a>(<a href="#33252" title="(java.io.File)Boolean">isArchive</a>))
				<span class="keyword">for</span>(<span id="7256"><a title="((java.io.File) =&gt; Unit)Unit" id="45180">dir</a></span> &lt;- <a href="#45160" title="java.io.File">dir</a>.<a title="(java.io.FileFilter)Array[java.io.File]" id="9572">listFiles</a>(<a href="NameFilter.scala.html#6530" title="object sbt.DirectoryFilter">DirectoryFilter</a>))
					<a href="#45159" title="(java.io.File)Unit">findJars</a>(<a href="#45180" title="java.io.File">dir</a>)
			}
			<span class="keyword">for</span>(<span id="45197"><span id="7256"><span id="45193"><span id="6989"><span id="45184"><span id="9252"><span id="1283"><a title="(((java.lang.String, java.io.File)) =&gt; Unit)Unit" id="6986">path</a></span></span></span></span></span></span></span> &lt;- <a href="FileUtilities.scala.html#6351" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#9394" title="(String)Array[java.lang.String]">pathSplit</a>(<a href="#45127" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a title="=&gt; settings.StringSetting" id="11696">extdirs</a>.<a title="=&gt; String" id="11679">value</a>); <span class="keyword">val</span> <span id="45185"><span id="45194"><a title="java.io.File" id="45198">dir</a></span></span> = <span title="java.io.File" class="keyword">new</span> <a title="java.io.File" id="3559">File</a>(<a href="#45184" title="java.lang.String">path</a>) <span class="keyword">if</span> <a href="#45194" title="java.io.File">dir</a>.<a title="()Boolean" id="9560">isDirectory</a>)
				<a href="#45159" title="(java.io.File)Unit">findJars</a>(<a href="#45198" title="java.io.File">dir</a>)
			<a href="#45158" title="scala.collection.mutable.ListBuffer[java.io.File]">buffer</a>.<a title="=&gt; List[java.io.File]" id="21696">readOnly</a>.<a title="((java.io.File) =&gt; java.io.File)List[java.io.File]" id="6835">map</a>(<a href="#45202" title="java.io.File">_</a>.<a title="()java.io.File" id="9554">getCanonicalFile</a>)
		}
		<span id="9252"><a title="(scala.collection.Set[java.io.File],scala.collection.Set[java.io.File])(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])" id="1283">(</a></span><a href="#33264" title="(Iterable[java.io.File])scala.collection.Set[java.io.File]">linkedSet</a>(<a href="#45132" title="List[java.io.File]">extJars</a> <a title="(Iterable[java.io.File])List[java.io.File]" id="6814">++</a> <a href="#45130" title="Iterable[java.io.File]">bootJars</a>), <a href="#33264" title="(Iterable[java.io.File])scala.collection.Set[java.io.File]">linkedSet</a>(<a href="#45131" title="Iterable[java.io.File]">bootDirs</a>))
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](Iterable[T])scala.collection.Set[T]" id="33264">linkedSet</a>[<a title="&gt;: Nothing &lt;: Any" id="33266">T</a>](<a title="Iterable[T]" id="45122">s</a>: <a title="Iterable[T]" id="358">Iterable</a>[T]): <a title="scala.collection.Set[T]" id="7387">Set</a>[T] =
	{
		<span class="keyword">import</span> scala.collection.jcl.Conversions.convertSet
		<span class="keyword">val</span> <a title="scala.collection.mutable.Set[T]" id="45227">set</a>: scala.collection.mutable.<a title="scala.collection.mutable.Set[T]" id="8158">Set</a>[T] = <span id="23299"><span id="7676"><a title="(java.util.Set[T])java.lang.Object with scala.collection.jcl.SetWrapper[T]" id="27154" class="keyword">new</a></span></span> java.util.<a title="java.util.LinkedHashSet[T]" id="5483">LinkedHashSet</a>[T]
		<a href="#45227" title="scala.collection.mutable.Set[T]">set</a> <a title="(Iterable[T])Unit" id="21514">++=</a> <a href="#45122" title="Iterable[T]">s</a>
		<a href="#45227" title="scala.collection.mutable.Set[T]">set</a>.<a title="=&gt; scala.collection.Set[T]" id="21535">readOnly</a>
	}
}

<span class="keyword">import</span> java.net.{URL, URLClassLoader}
<span class="keyword">private</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class LoaderBase extends java.net.URLClassLoader with NotNull with ScalaObject" id="6370">LoaderBase</a>(<span id="35345"><a title="Array[java.net.URL]" id="45262">urls</a></span>: <a title="Array[java.net.URL]" id="1003">Array</a>[URL], <span id="35346"><a title="java.lang.ClassLoader" id="45263">parent</a></span>: <a title="java.lang.ClassLoader" id="1616">ClassLoader</a>) <span class="keyword">extends</span> <a title="java.net.URLClassLoader" id="4302">URLClassLoader</a>(<a href="#45262" title="Array[java.net.URL]">urls</a>, <a href="#45263" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <a title="NotNull" id="187">NotNull</a>
{
	<span id="5880"><a title="(Boolean)Unit" id="770">require</a></span>(<a href="#35346" title="java.lang.ClassLoader">parent</a> <a title="(AnyRef)Boolean" id="5674">!=</a> <span title="Null(null)" class="keyword">null</span>) <span class="comment">// included because a null parent is legitimate in Java</span>
	@<a title="throws" id="232">throws</a>(<span title="java.lang.Class[java.lang.ClassNotFoundException]">classOf</span>[ClassNotFoundException])
	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,Boolean)Class[_]" id="35348">loadClass</a>(<a title="String" id="45292">className</a>: <a title="String" id="1751">String</a>, <a title="Boolean" id="45293">resolve</a>: <a title="Boolean" id="2060">Boolean</a>): <a title="Class[_]" id="1562">Class</a>[_] =
	{
		<span class="keyword">val</span> <a title="java.lang.Class[_]" id="45298">loaded</a> = <a href="#6370" title="(java.lang.String)java.lang.Class[_]" id="33669">findLoadedClass</a>(<a href="#45292" title="String">className</a>)
		<span class="keyword">val</span> <a title="java.lang.Class[_ &gt;: _$2 with ?0]" id="45299">found</a> =
			<span title="java.lang.Class[_8]" class="keyword">if</span>(<a href="#45298" title="java.lang.Class[_]">loaded</a> <a title="(AnyRef)Boolean" id="3399">==</a> <span title="Null(null)" class="keyword">null</span>)
				<a href="#35349" title="(String)Class[_]">doLoadClass</a>(<a href="#45292" title="String">className</a>)
			<span class="keyword">else</span>
				<a href="#45298" title="java.lang.Class[_]">loaded</a>
			
		<span title="Unit" class="keyword">if</span>(<a href="#45293" title="Boolean">resolve</a>)
			<a href="#6370" title="(java.lang.Class[_])Unit" id="33663">resolveClass</a>(<a href="#45299" title="java.lang.Class[_ &gt;: _$2 with ?0]">found</a>)
		<a href="#45299" title="java.lang.Class[_ &gt;: _$2 with ?0]">found</a>
	}
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(String)Class[_]" id="35349">doLoadClass</a>(<a title="String" id="45303">className</a>: <a title="String" id="1751">String</a>): <a title="Class[_]" id="1562">Class</a>[_]
	<span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String)Class[_]" id="35350">selfLoadClass</a>(<a title="String" id="45344">className</a>: <a title="String" id="1751">String</a>): <a title="Class[_]" id="1562">Class</a>[_] = <span class="keyword">super</span>.<a title="(java.lang.String,Boolean)java.lang.Class[_]" id="33645">loadClass</a>(<a href="#45344" title="String">className</a>, <span title="Boolean(false)" class="keyword">false</span>)
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class IntermediateLoader extends sbt.LoaderBase with NotNull with ScalaObject" id="6371">IntermediateLoader</a>(<span id="35353"><a title="Array[java.net.URL]" id="35367">urls</a></span>: <a title="Array[java.net.URL]" id="1003">Array</a>[URL], <span id="35354"><a title="java.lang.ClassLoader" id="35368">parent</a></span>: <a title="java.lang.ClassLoader" id="1616">ClassLoader</a>) <span class="keyword">extends</span> <a href="#6370" title="sbt.LoaderBase">LoaderBase</a>(<a href="#35367" title="Array[java.net.URL]">urls</a>, <a href="#35368" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <a title="NotNull" id="187">NotNull</a>
{
	<span class="keyword">def</span> <a title="(String)Class[_]" id="35356">doLoadClass</a>(<a title="String" id="45362">className</a>: <a title="String" id="1751">String</a>): <a title="Class[_]" id="1562">Class</a>[_] =
	{
		<span class="comment">// if this loader is asked to load an sbt class, it must be because the project we are building is sbt itself,</span>
		 <span class="comment">// so we want to load the version of classes on the project classpath, not the parent</span>
		<span title="java.lang.Class[_9]" class="keyword">if</span>(<a href="#45362" title="String">className</a>.<a title="(java.lang.String)Boolean" id="5722">startsWith</a>(<a href="#6375" title="object sbt.Loaders">Loaders</a>.<a href="#45369" title="=&gt; java.lang.String">SbtPackage</a>))
			<a href="#6371" title="(java.lang.String)java.lang.Class[_]" id="35330">findClass</a>(<a href="#45362" title="String">className</a>)
		<span class="keyword">else</span>
			<a href="#35350" title="(String)Class[_]">selfLoadClass</a>(<a href="#45362" title="String">className</a>)
	}
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class FilteredLoader extends java.net.URLClassLoader with NotNull with ScalaObject" id="6372">FilteredLoader</a>(<span id="45399"><a title="Array[java.net.URL]" id="45410">urls</a></span>: <a title="Array[java.net.URL]" id="1003">Array</a>[URL], <span id="45400"><a title="java.lang.ClassLoader" id="45411">parent</a></span>: <a title="java.lang.ClassLoader" id="1616">ClassLoader</a>, <span id="45401"><a title="sbt.ClassFilter" id="45412">filter</a></span>: <a href="#6373" title="sbt.ClassFilter">ClassFilter</a>) <span class="keyword">extends</span> <a title="java.net.URLClassLoader" id="4302">URLClassLoader</a>(<a href="#45410" title="Array[java.net.URL]">urls</a>, <a href="#45411" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <a title="NotNull" id="187">NotNull</a>
{
	<span class="keyword">def</span> <a title="(Array[java.net.URL],java.lang.ClassLoader,Iterable[String])sbt.FilteredLoader" id="45403" class="keyword">this</a>(<a title="Array[java.net.URL]" id="45431">urls</a>: <a title="Array[java.net.URL]" id="1003">Array</a>[URL], <a title="java.lang.ClassLoader" id="45432">parent</a>: <a title="java.lang.ClassLoader" id="1616">ClassLoader</a>, <a title="Iterable[String]" id="45433">includePackages</a>: <a title="Iterable[String]" id="358">Iterable</a>[String]) =
		<a href="#6372" title="FilteredLoader.this.type" class="keyword">this</a>(<a href="#45431" title="Array[java.net.URL]">urls</a>, <a href="#45432" title="java.lang.ClassLoader">parent</a>, <a title="template $anon extends java.lang.Object with sbt.ClassFilter" id="45436" class="keyword">new</a> <a href="#6373" title="sbt.ClassFilter">ClassFilter</a> { <span class="keyword">def</span> <a title="(String)Boolean" id="45438">include</a>(<a title="String" id="45441">className</a>: <a title="String" id="1751">String</a>) = <a href="#45433" title="Iterable[String]">includePackages</a>.<a title="((String) =&gt; Boolean)Boolean" id="7258">exists</a>(<a href="#45441" title="String">className</a>.<a href="#45446" title="(java.lang.String)Boolean" id="5722">startsWith</a>) })
	<span id="5880"><a title="(Boolean)Unit" id="770">require</a></span>(<a href="#45400" title="java.lang.ClassLoader">parent</a> <a title="(AnyRef)Boolean" id="5674">!=</a> <span title="Null(null)" class="keyword">null</span>) <span class="comment">// included because a null parent is legitimate in Java</span>
	@<a title="throws" id="232">throws</a>(<span title="java.lang.Class[java.lang.ClassNotFoundException]">classOf</span>[ClassNotFoundException])
	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,Boolean)Class[_]" id="45404">loadClass</a>(<a title="String" id="45451">className</a>: <a title="String" id="1751">String</a>, <a title="Boolean" id="45452">resolve</a>: <a title="Boolean" id="2060">Boolean</a>): <a title="Class[_]" id="1562">Class</a>[_] =
	{
		<span title="java.lang.Class[_10]" class="keyword">if</span>(<a href="#45401" title="sbt.ClassFilter">filter</a>.<a href="#45409" title="(String)Boolean">include</a>(<a href="#45451" title="String">className</a>))
			<span class="keyword">super</span>.<a title="(java.lang.String,Boolean)java.lang.Class[_]" id="33645">loadClass</a>(<a href="#45451" title="String">className</a>, <a href="#45452" title="Boolean">resolve</a>)
		<span class="keyword">else</span>
		{
			<span class="keyword">val</span> <a title="java.lang.Class[_]" id="45467">loaded</a> = <a href="#45400" title="java.lang.ClassLoader">parent</a>.<a title="(java.lang.String)java.lang.Class[_]" id="33642">loadClass</a>(<a href="#45451" title="String">className</a>)
			<span title="Unit" class="keyword">if</span>(<a href="#45452" title="Boolean">resolve</a>)
				<a href="#6372" title="(java.lang.Class[_])Unit" id="33663">resolveClass</a>(<a href="#45467" title="java.lang.Class[_]">loaded</a>)
			<a href="#45467" title="java.lang.Class[_]">loaded</a>
		}
	}
}
<span class="keyword">private</span> <span class="keyword">trait</span> <span id="6373"><a title="trait ClassFilter extends java.lang.Object" id="2055">ClassFilter</a></span>
{
	<span class="keyword">def</span> <a title="(String)Boolean" id="45409">include</a>(<a title="String" id="45443">className</a>: <a title="String" id="1751">String</a>): <a title="Boolean" id="2060">Boolean</a>
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class LazyFrameworkLoader extends sbt.LoaderBase with NotNull with ScalaObject" id="6374">LazyFrameworkLoader</a>(<span id="35739"><a title="String" id="35745">runnerClassName</a></span>: <a title="String" id="1751">String</a>, <span id="35740"><a title="Array[java.net.URL]" id="35746">urls</a></span>: <a title="Array[java.net.URL]" id="1003">Array</a>[URL], <span id="35741"><a title="java.lang.ClassLoader" id="35747">parent</a></span>: <a title="java.lang.ClassLoader" id="1616">ClassLoader</a>, <span id="35742"><a title="java.lang.ClassLoader" id="35748">grandparent</a></span>: <a title="java.lang.ClassLoader" id="1616">ClassLoader</a>)
	<span class="keyword">extends</span> <a href="#6370" title="sbt.LoaderBase">LoaderBase</a>(<a href="#35746" title="Array[java.net.URL]">urls</a>, <a href="#35747" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <a title="NotNull" id="187">NotNull</a>
{
	<span class="keyword">def</span> <a title="(String)Class[_]" id="35744">doLoadClass</a>(<a title="String" id="45501">className</a>: <a title="String" id="1751">String</a>): <a title="Class[_]" id="1562">Class</a>[_] =
	{
		<span title="java.lang.Class[_12]" class="keyword">if</span>(<a href="#6375" title="object sbt.Loaders">Loaders</a>.<a href="#45371" title="(String,String)Boolean">isNestedOrSelf</a>(<a href="#45501" title="String">className</a>, <a href="#35739" title="String">runnerClassName</a>))
			<a href="#6374" title="(java.lang.String)java.lang.Class[_]" id="35330">findClass</a>(<a href="#45501" title="String">className</a>)
		<span class="keyword">else</span> <span title="java.lang.Class[_11]" class="keyword">if</span>(<a href="#45501" title="String">className</a>.<a title="(java.lang.String)Boolean" id="5722">startsWith</a>(<a href="#6375" title="object sbt.Loaders">Loaders</a>.<a href="#45369" title="=&gt; java.lang.String">SbtPackage</a>)) <span class="comment">// we circumvent the parent loader because we know that we want the</span>
			<a href="#35742" title="java.lang.ClassLoader">grandparent</a>.<a title="(java.lang.String)java.lang.Class[_]" id="33642">loadClass</a>(<a href="#45501" title="String">className</a>)              <span class="comment">// version of sbt that is currently the builder (not the project being built)</span>
		<span class="keyword">else</span>
			<a href="#35741" title="java.lang.ClassLoader">parent</a>.<a title="(java.lang.String)java.lang.Class[_]" id="33642">loadClass</a>(<a href="#45501" title="String">className</a>)
	}
}
<span class="keyword">private</span> <span class="keyword">object</span> <a title="object sbt.Loaders" id="6375">Loaders</a>
{
	<span class="keyword">val</span> <span id="45370"><a title="java.lang.String" id="45369">SbtPackage</a></span> = <span title="java.lang.String(&quot;sbt.&quot;)" class="string">&quot;sbt.&quot;</span>
	<span class="keyword">def</span> <a title="(String,String)Boolean" id="45371">isNestedOrSelf</a>(<a title="String" id="45506">className</a>: <a title="String" id="1751">String</a>, <a title="String" id="45507">checkAgainst</a>: <a title="String" id="1751">String</a>) =
		<a href="#45506" title="String">className</a> <a title="(AnyRef)Boolean" id="3399">==</a> <a href="#45507" title="String">checkAgainst</a> <a title="(Boolean)Boolean" id="2640">||</a> <a href="#45506" title="String">className</a>.<a title="(java.lang.String)Boolean" id="5722">startsWith</a>(<a href="#45507" title="String">checkAgainst</a> <a title="(Any)java.lang.String" id="5683">+</a> <span title="java.lang.String(&quot;$&quot;)" class="string">&quot;$&quot;</span>)
}
        </pre>
    </body>
</html>