<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>sbt/ClasspathUtilities.scala</title>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008 Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> scala.collection.Set
<span class="keyword">import</span> scala.collection.mutable.{HashSet, ListBuffer}

<span class="keyword">private</span>[sbt] <span class="keyword">object</span> <span class="typed"><span class="type">object sbt.ClasspathUtilities</span><a id="6466">ClasspathUtilities</a></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">(sbt.Path)Boolean</span><a id="34256">isArchive</a></span>(<span class="typed"><span class="type">sbt.Path</span><a id="34431">path</a></span>: <span class="typed"><span class="type">sbt.Path</span><a href="Path.scala.html#6796">Path</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2151">Boolean</a></span> = <span class="typed"><span class="type">(java.io.File)Boolean</span><a href="#34257">isArchive</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#34431">path</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="Path.scala.html#9638">asFile</a></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(java.io.File)Boolean</span><a id="34257">isArchive</a></span>(<span class="typed"><span class="type">java.io.File</span><a id="34430">file</a></span>: <span class="typed"><span class="type">java.io.File</span><a id="3650">File</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2151">Boolean</a></span> = <span class="typed"><span class="type">(String)Boolean</span><a href="#34258">isArchiveName</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#34430">file</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="9655">getName</a></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="34258">isArchiveName</a></span>(<span class="typed"><span class="type">String</span><a id="46114">fileName</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) = <span class="typed"><span class="type">String</span><a href="#46114">fileName</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5814">endsWith</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;.jar&quot;)</span><span class="string">&quot;.jar&quot;</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2731">||</a></span> <span class="typed"><span class="type">String</span><a href="#46114">fileName</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5814">endsWith</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;.zip&quot;)</span><span class="string">&quot;.zip&quot;</span></span>)
	<span class="comment">// (jars, dirs)</span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])</span><a id="34259">separate</a></span>(<span class="typed"><span class="type">Iterable[java.io.File]</span><a id="46116">paths</a></span>: <span class="typed"><span class="type">Iterable[java.io.File]</span><a id="384">Iterable</a></span>[File]): <span class="typed"><span class="type">(Iterable[java.io.File], Iterable[java.io.File])</span><a id="1359">(</a></span>Iterable[File], Iterable[File]) = <span class="typed"><span class="type">Iterable[java.io.File]</span><a href="#46116">paths</a></span>.<span class="typed"><span class="type">((java.io.File) =&gt; Boolean)(Iterable[java.io.File], Iterable[java.io.File])</span><a id="7360">partition</a></span>(<span class="typed"><span class="type">(java.io.File)Boolean</span><a href="#34257">isArchive</a></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">(Iterable[sbt.Path])(Iterable[java.io.File], Iterable[java.io.File])</span><a id="34260">separatePaths</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="46121">paths</a></span>: <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="384">Iterable</a></span>[Path]) = <span class="typed"><span class="type">(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])</span><a href="#34259">separate</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#46121">paths</a></span>.<span class="typed"><span class="type">((sbt.Path) =&gt; java.io.File)Iterable[java.io.File]</span><a id="7355">map</a></span>(<span class="typed"><span class="type">sbt.Path</span><a href="#46125">_</a></span>.<span class="typed"><span class="type">=&gt; java.io.File</span><a href="Path.scala.html#9638">asFile</a></span>.<span class="typed"><span class="type">()java.io.File</span><a id="9663">getCanonicalFile</a></span>))
	<span class="keyword">def</span> <span class="typed"><span class="type">(Iterable[sbt.Path])(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])</span><a id="34261">buildSearchPaths</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="34272">classpath</a></span>: <span class="typed"><span class="type">Iterable[sbt.Path]</span><a id="384">Iterable</a></span>[Path]): <span class="typed"><span class="type">(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])</span><a id="1359">(</a></span>Set[File], Set[File]) =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">(Iterable[java.io.File], Iterable[java.io.File])</span><span id="9362"><a href="#46129" id="1360">(</a></span></span><span class="typed"><span class="type">Iterable[java.io.File]</span><span id="46129"><span id="46127"><a href="#46126" id="9351">jars</a></span></span></span>, <span class="typed"><span class="type">Iterable[java.io.File]</span><span id="46130"><span id="46128"><a href="#46126" id="9353">dirs</a></span></span></span>) = <span class="typed"><span class="type">(Iterable[sbt.Path])(Iterable[java.io.File], Iterable[java.io.File])</span><a href="#34260">separatePaths</a></span>(<span class="typed"><span class="type">Iterable[sbt.Path]</span><a href="#34272">classpath</a></span>)
		<span class="typed"><span class="type">(scala.collection.Set[java.io.File],scala.collection.Set[java.io.File])(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])</span><span id="9362"><a id="1360">(</a></span></span><span class="typed"><span class="type">(Iterable[java.io.File])scala.collection.Set[java.io.File]</span><a href="#34269">linkedSet</a></span>(<span class="typed"><span class="type">Iterable[java.io.File]</span><a href="#46127">jars</a></span> <span class="typed"><span class="type">(Iterable[java.io.File])Collection[java.io.File]</span><a id="7353">++</a></span> <span class="typed"><span class="type">=&gt; scala.collection.Set[java.io.File]</span><a href="#34265">extraJars</a></span>), <span class="typed"><span class="type">(Iterable[java.io.File])scala.collection.Set[java.io.File]</span><a href="#34269">linkedSet</a></span>(<span class="typed"><span class="type">Iterable[java.io.File]</span><a href="#46128">dirs</a></span> <span class="typed"><span class="type">(Iterable[java.io.File])Collection[java.io.File]</span><a id="7353">++</a></span> <span class="typed"><span class="type">=&gt; scala.collection.Set[java.io.File]</span><a href="#34267">extraDirs</a></span>))
	}
	<span class="keyword">def</span> <span class="typed"><span class="type">(scala.collection.Set[java.io.File],Iterable[java.io.File],java.io.File)Boolean</span><a id="34262">onClasspath</a></span>(<span class="typed"><span class="type">scala.collection.Set[java.io.File]</span><a id="34281">classpathJars</a></span>: <span class="typed"><span class="type">scala.collection.Set[java.io.File]</span><a id="7496">Set</a></span>[File], <span class="typed"><span class="type">Iterable[java.io.File]</span><a id="34282">classpathDirectories</a></span>: <span class="typed"><span class="type">Iterable[java.io.File]</span><a id="384">Iterable</a></span>[File], <span class="typed"><span class="type">java.io.File</span><a id="34283">file</a></span>: <span class="typed"><span class="type">java.io.File</span><a id="3650">File</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2151">Boolean</a></span> =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">java.io.File</span><a id="46233">f</a></span> = <span class="typed"><span class="type">java.io.File</span><a href="#34283">file</a></span>.<span class="typed"><span class="type">()java.io.File</span><a id="9663">getCanonicalFile</a></span>
		<span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">object sbt.ClasspathUtilities</span><a href="#6466">ClasspathUtilities</a></span>.<span class="typed"><span class="type">(java.io.File)Boolean</span><a href="#34257">isArchive</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#46233">f</a></span>))
			<span class="typed"><span class="type">scala.collection.Set[java.io.File]</span><a href="#34281">classpathJars</a></span>.<span class="typed"><span class="type">(java.io.File)Boolean</span><a id="22294">contains</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#46233">f</a></span>)
		<span class="keyword">else</span>
			<span class="typed"><span class="type">Iterable[java.io.File]</span><a href="#34282">classpathDirectories</a></span>.<span class="typed"><span class="type">((java.io.File) =&gt; Boolean)Option[java.io.File]</span><a id="7368">find</a></span>(<span class="typed"><span class="type">object sbt.Path</span><a href="Path.scala.html#6800">Path</a></span>.<span class="typed"><span class="type">(java.io.File,java.io.File)Option[String]</span><a href="Path.scala.html#9614">relativize</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#46236">_</a></span>, <span class="typed"><span class="type">java.io.File</span><a href="#46233">f</a></span>).<span class="typed"><span class="type">=&gt; Boolean</span><a id="10260">isDefined</a></span>).<span class="typed"><span class="type">=&gt; Boolean</span><a id="10260">isDefined</a></span>
	}
	
	<span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])</span><span id="34264"><span id="9362"><a href="#46226" id="1360">(</a></span></span></span><span class="typed"><span class="type">scala.collection.Set[java.io.File]</span><span id="46226"><span id="34266"><a href="#34263" id="9351">extraJars</a></span></span></span>, <span class="typed"><span class="type">scala.collection.Set[java.io.File]</span><span id="46227"><span id="34268"><a href="#34263" id="9353">extraDirs</a></span></span></span>) =
	{
		<span class="keyword">import</span> scala.tools.nsc.GenericRunnerCommand
		<span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a id="46140">settings</a></span> = (<span class="typed"><span class="type">(List[String],(String) =&gt; Unit)scala.tools.nsc.GenericRunnerCommand</span><a id="43929" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a id="11568">GenericRunnerCommand</a></span>(<span class="typed"><span class="type">object Nil</span><a id="316">Nil</a></span>, <span class="typed"><span class="type">String</span><a id="46159">message</a></span> =&gt; <span class="typed"><span class="type">(String)Nothing</span><span id="5964"><a id="802">error</a></span></span>(<span class="typed"><span class="type">String</span><a href="#46159">message</a></span>))).<span class="typed"><span class="type">=&gt; scala.tools.nsc.GenericRunnerSettings</span><a id="43925">settings</a></span>
		<span class="keyword">val</span> <span class="typed"><span class="type">List[java.io.File]</span><a id="46141">bootPaths</a></span> = <span class="typed"><span class="type">object sbt.FileUtilities</span><a href="FileUtilities.scala.html#6450">FileUtilities</a></span>.<span class="typed"><span class="type">(String)Array[java.lang.String]</span><a href="FileUtilities.scala.html#9503">pathSplit</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#46140">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a id="12238">bootclasspath</a></span>.<span class="typed"><span class="type">=&gt; settings.bootclasspath.T</span><a id="12023">value</a></span>).<span class="typed"><span class="type">((java.lang.String) =&gt; java.io.File)Array[java.io.File]</span><a id="7089">map</a></span>(<span class="typed"><span class="type">java.lang.String</span><a id="46164">p</a></span> =&gt; <span class="typed"><span class="type">java.io.File</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.File</span><a id="3650">File</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#46164">p</a></span>)).<span class="typed"><span class="type">=&gt; List[java.io.File]</span><a id="7388">toList</a></span>
		<span class="keyword">val</span> <span class="typed"><span class="type">(Iterable[java.io.File], Iterable[java.io.File])</span><span id="9362"><a href="#46167" id="1360">(</a></span></span><span class="typed"><span class="type">Iterable[java.io.File]</span><span id="46167"><span id="46143"><a href="#46142" id="9351">bootJars</a></span></span></span>, <span class="typed"><span class="type">Iterable[java.io.File]</span><span id="46168"><span id="46144"><a href="#46142" id="9353">bootDirs</a></span></span></span>) = <span class="typed"><span class="type">(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])</span><a href="#34259">separate</a></span>(<span class="typed"><span class="type">List[java.io.File]</span><a href="#46141">bootPaths</a></span>)
		<span class="keyword">val</span> <span class="typed"><span class="type">List[java.io.File]</span><a id="46145">extJars</a></span> =
		{
			<span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[java.io.File]</span><a id="46171">buffer</a></span> = <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[java.io.File]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[java.io.File]</span><a id="8048">ListBuffer</a></span>[File]
			<span class="keyword">def</span> <span class="typed"><span class="type">(java.io.File)Unit</span><a id="46172">findJars</a></span>(<span class="typed"><span class="type">java.io.File</span><a id="46173">dir</a></span>: <span class="typed"><span class="type">java.io.File</span><a id="3650">File</a></span>)
			{
				<span class="typed"><span class="type">scala.collection.mutable.ListBuffer[java.io.File]</span><a href="#46171">buffer</a></span> <span class="typed"><span class="type">(Iterable[java.io.File])Unit</span><a id="22685">++=</a></span> <span class="typed"><span class="type">java.io.File</span><a href="#46173">dir</a></span>.<span class="typed"><span class="type">(java.io.FileFilter)Array[java.io.File]</span><a id="9681">listFiles</a></span>(<span class="typed"><span class="type">sbt.SimpleFileFilter</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.SimpleFileFilter</span><a href="NameFilter.scala.html#6631">SimpleFileFilter</a></span>(<span class="typed"><span class="type">(java.io.File)Boolean</span><a href="#34257">isArchive</a></span>))
				<span class="keyword">for</span>(<span class="typed"><span class="type">((java.io.File) =&gt; Unit)Unit</span><span id="7365"><a id="46193">dir</a></span></span> &lt;- <span class="typed"><span class="type">java.io.File</span><a href="#46173">dir</a></span>.<span class="typed"><span class="type">(java.io.FileFilter)Array[java.io.File]</span><a id="9681">listFiles</a></span>(<span class="typed"><span class="type">object sbt.DirectoryFilter</span><a href="NameFilter.scala.html#6629">DirectoryFilter</a></span>))
					<span class="typed"><span class="type">(java.io.File)Unit</span><a href="#46172">findJars</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#46193">dir</a></span>)
			}
			<span class="keyword">for</span>(<span class="typed"><span class="type">(((java.lang.String, java.io.File)) =&gt; Unit)Unit</span><span id="7089"><span id="46197"><span id="46210"><span id="7086"><span id="7365"><span id="1360"><span id="46206"><a id="9362">path</a></span></span></span></span></span></span></span></span> &lt;- <span class="typed"><span class="type">object sbt.FileUtilities</span><a href="FileUtilities.scala.html#6450">FileUtilities</a></span>.<span class="typed"><span class="type">(String)Array[java.lang.String]</span><a href="FileUtilities.scala.html#9503">pathSplit</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#46140">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a id="12252">extdirs</a></span>.<span class="typed"><span class="type">=&gt; settings.extdirs.T</span><a id="12023">value</a></span>); <span class="keyword">val</span> <span class="typed"><span class="type">java.io.File</span><span id="46198"><span id="46207"><a id="46211">dir</a></span></span></span> = <span class="typed"><span class="type">java.io.File</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.File</span><a id="3650">File</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#46197">path</a></span>) <span class="keyword">if</span> <span class="typed"><span class="type">java.io.File</span><a href="#46207">dir</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="9669">isDirectory</a></span>)
				<span class="typed"><span class="type">(java.io.File)Unit</span><a href="#46172">findJars</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#46211">dir</a></span>)
			<span class="typed"><span class="type">scala.collection.mutable.ListBuffer[java.io.File]</span><a href="#46171">buffer</a></span>.<span class="typed"><span class="type">=&gt; List[java.io.File]</span><a id="22662">readOnly</a></span>.<span class="typed"><span class="type">((java.io.File) =&gt; java.io.File)List[java.io.File]</span><a id="6935">map</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#46215">_</a></span>.<span class="typed"><span class="type">()java.io.File</span><a id="9663">getCanonicalFile</a></span>)
		}
		<span class="typed"><span class="type">(scala.collection.Set[java.io.File],scala.collection.Set[java.io.File])(scala.collection.Set[java.io.File], scala.collection.Set[java.io.File])</span><span id="9362"><a id="1360">(</a></span></span><span class="typed"><span class="type">(Iterable[java.io.File])scala.collection.Set[java.io.File]</span><a href="#34269">linkedSet</a></span>(<span class="typed"><span class="type">List[java.io.File]</span><a href="#46145">extJars</a></span> <span class="typed"><span class="type">(Iterable[java.io.File])List[java.io.File]</span><a id="6914">++</a></span> <span class="typed"><span class="type">Iterable[java.io.File]</span><a href="#46143">bootJars</a></span>), <span class="typed"><span class="type">(Iterable[java.io.File])scala.collection.Set[java.io.File]</span><a href="#34269">linkedSet</a></span>(<span class="typed"><span class="type">Iterable[java.io.File]</span><a href="#46144">bootDirs</a></span>))
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">[T](Iterable[T])scala.collection.Set[T]</span><a id="34269">linkedSet</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="34271">T</a></span>](<span class="typed"><span class="type">Iterable[T]</span><a id="46135">s</a></span>: <span class="typed"><span class="type">Iterable[T]</span><a id="384">Iterable</a></span>[T]): <span class="typed"><span class="type">scala.collection.Set[T]</span><a id="7496">Set</a></span>[T] =
	{
		<span class="keyword">import</span> scala.collection.jcl.Conversions.convertSet
		<span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.Set[T]</span><a id="46240">set</a></span>: scala.collection.mutable.<span class="typed"><span class="type">scala.collection.mutable.Set[T]</span><a id="8270">Set</a></span>[T] = <span class="typed"><span class="type">(java.util.Set[T])java.lang.Object with scala.collection.jcl.SetWrapper[T]</span><span id="24270"><span id="7785"><a id="28763" class="keyword">new</a></span></span></span> java.util.<span class="typed"><span class="type">java.util.LinkedHashSet[T]</span><a id="5574">LinkedHashSet</a></span>[T]
		<span class="typed"><span class="type">scala.collection.mutable.Set[T]</span><a href="#46240">set</a></span> <span class="typed"><span class="type">(Iterable[T])Unit</span><a id="22480">++=</a></span> <span class="typed"><span class="type">Iterable[T]</span><a href="#46135">s</a></span>
		<span class="typed"><span class="type">scala.collection.mutable.Set[T]</span><a href="#46240">set</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.Set[T]</span><a id="22501">readOnly</a></span>
	}
}

<span class="keyword">import</span> java.net.{URL, URLClassLoader}
<span class="keyword">private</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class LoaderBase extends java.net.URLClassLoader with NotNull with ScalaObject</span><a id="6469">LoaderBase</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><span id="36338"><a id="46263">urls</a></span></span>: <span class="typed"><span class="type">Array[java.net.URL]</span><a id="1053">Array</a></span>[URL], <span class="typed"><span class="type">java.lang.ClassLoader</span><span id="36339"><a id="46264">parent</a></span></span>: <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="1707">ClassLoader</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">java.net.URLClassLoader</span><a id="4393">URLClassLoader</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><a href="#46263">urls</a></span>, <span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#46264">parent</a></span>) <span class="keyword">with</span> <span class="typed"><span class="type">NotNull</span><a id="186">NotNull</a></span>
{
	<span class="typed"><span class="type">(Boolean)Unit</span><span id="5971"><a id="802">require</a></span></span>(<span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#36339">parent</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5765">!=</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) <span class="comment">// included because a null parent is legitimate in Java</span>
	@<span class="typed"><span class="type">throws</span><a id="237">throws</a></span>(<span class="typed"><span class="type">java.lang.Class[java.lang.ClassNotFoundException]</span><span >classOf</span></span>[ClassNotFoundException])
	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String,Boolean)Class[_]</span><a id="36341">loadClass</a></span>(<span class="typed"><span class="type">String</span><a id="46293">className</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">Boolean</span><a id="46294">resolve</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2151">Boolean</a></span>): <span class="typed"><span class="type">Class[_]</span><a id="1653">Class</a></span>[_] =
	{
		<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.Class[_]</span><a id="46299">loaded</a></span> = <span class="typed"><span class="type">(java.lang.String)java.lang.Class[_]</span><a href="#6469" id="34674">findLoadedClass</a></span>(<span class="typed"><span class="type">String</span><a href="#46293">className</a></span>)
		<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.Class[_ &gt;: _$2 with ?0]</span><a id="46300">found</a></span> =
			<span class="typed"><span class="type">java.lang.Class[_8]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">java.lang.Class[_]</span><a href="#46299">loaded</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3490">==</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)
				<span class="typed"><span class="type">(String)Class[_]</span><a href="#36342">doLoadClass</a></span>(<span class="typed"><span class="type">String</span><a href="#46293">className</a></span>)
			<span class="keyword">else</span>
				<span class="typed"><span class="type">java.lang.Class[_]</span><a href="#46299">loaded</a></span>
			
		<span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Boolean</span><a href="#46294">resolve</a></span>)
			<span class="typed"><span class="type">(java.lang.Class[_])Unit</span><a href="#6469" id="34668">resolveClass</a></span>(<span class="typed"><span class="type">java.lang.Class[_ &gt;: _$2 with ?0]</span><a href="#46300">found</a></span>)
		<span class="typed"><span class="type">java.lang.Class[_ &gt;: _$2 with ?0]</span><a href="#46300">found</a></span>
	}
	<span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)Class[_]</span><a id="36342">doLoadClass</a></span>(<span class="typed"><span class="type">String</span><a id="46304">className</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>): <span class="typed"><span class="type">Class[_]</span><a id="1653">Class</a></span>[_]
	<span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)Class[_]</span><a id="36343">selfLoadClass</a></span>(<span class="typed"><span class="type">String</span><a id="46343">className</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>): <span class="typed"><span class="type">Class[_]</span><a id="1653">Class</a></span>[_] = <span class="keyword">super</span>.<span class="typed"><span class="type">(java.lang.String,Boolean)java.lang.Class[_]</span><a id="34650">loadClass</a></span>(<span class="typed"><span class="type">String</span><a href="#46343">className</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
}
<span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class IntermediateLoader extends sbt.LoaderBase with NotNull with ScalaObject</span><a id="6470">IntermediateLoader</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><span id="36346"><a id="36360">urls</a></span></span>: <span class="typed"><span class="type">Array[java.net.URL]</span><a id="1053">Array</a></span>[URL], <span class="typed"><span class="type">java.lang.ClassLoader</span><span id="36347"><a id="36361">parent</a></span></span>: <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="1707">ClassLoader</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">sbt.LoaderBase</span><a href="#6469">LoaderBase</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><a href="#36360">urls</a></span>, <span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#36361">parent</a></span>) <span class="keyword">with</span> <span class="typed"><span class="type">NotNull</span><a id="186">NotNull</a></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)Class[_]</span><a id="36349">doLoadClass</a></span>(<span class="typed"><span class="type">String</span><a id="46361">className</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>): <span class="typed"><span class="type">Class[_]</span><a id="1653">Class</a></span>[_] =
	{
		<span class="comment">// if this loader is asked to load an sbt class, it must be because the project we are building is sbt itself,</span>
		 <span class="comment">// so we want to load the version of classes on the project classpath, not the parent</span>
		<span class="typed"><span class="type">java.lang.Class[_9]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">String</span><a href="#46361">className</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5813">startsWith</a></span>(<span class="typed"><span class="type">object sbt.Loaders</span><a href="#6474">Loaders</a></span>.<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#46368">SbtPackage</a></span>))
			<span class="typed"><span class="type">(java.lang.String)java.lang.Class[_]</span><a href="#6470" id="36323">findClass</a></span>(<span class="typed"><span class="type">String</span><a href="#46361">className</a></span>)
		<span class="keyword">else</span>
			<span class="typed"><span class="type">(String)Class[_]</span><a href="#36343">selfLoadClass</a></span>(<span class="typed"><span class="type">String</span><a href="#46361">className</a></span>)
	}
}
<span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class FilteredLoader extends java.net.URLClassLoader with NotNull with ScalaObject</span><a id="6471">FilteredLoader</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><span id="46396"><a id="46407">urls</a></span></span>: <span class="typed"><span class="type">Array[java.net.URL]</span><a id="1053">Array</a></span>[URL], <span class="typed"><span class="type">java.lang.ClassLoader</span><span id="46397"><a id="46408">parent</a></span></span>: <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="1707">ClassLoader</a></span>, <span class="typed"><span class="type">sbt.ClassFilter</span><span id="46398"><a id="46409">filter</a></span></span>: <span class="typed"><span class="type">sbt.ClassFilter</span><a href="#6472">ClassFilter</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">java.net.URLClassLoader</span><a id="4393">URLClassLoader</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><a href="#46407">urls</a></span>, <span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#46408">parent</a></span>) <span class="keyword">with</span> <span class="typed"><span class="type">NotNull</span><a id="186">NotNull</a></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">(Array[java.net.URL],java.lang.ClassLoader,Iterable[String])sbt.FilteredLoader</span><a id="46400" class="keyword">this</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><a id="46428">urls</a></span>: <span class="typed"><span class="type">Array[java.net.URL]</span><a id="1053">Array</a></span>[URL], <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="46429">parent</a></span>: <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="1707">ClassLoader</a></span>, <span class="typed"><span class="type">Iterable[String]</span><a id="46430">includePackages</a></span>: <span class="typed"><span class="type">Iterable[String]</span><a id="384">Iterable</a></span>[String]) =
		<span class="typed"><span class="type">FilteredLoader.this.type</span><a href="#6471" class="keyword">this</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><a href="#46428">urls</a></span>, <span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#46429">parent</a></span>, <span class="typed"><span class="type">template $anon extends java.lang.Object with sbt.ClassFilter</span><a id="46433" class="keyword">new</a></span> <span class="typed"><span class="type">sbt.ClassFilter</span><a href="#6472">ClassFilter</a></span> { <span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="46435">include</a></span>(<span class="typed"><span class="type">String</span><a id="46438">className</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) = <span class="typed"><span class="type">Iterable[String]</span><a href="#46430">includePackages</a></span>.<span class="typed"><span class="type">((String) =&gt; Boolean)Boolean</span><a id="7367">exists</a></span>(<span class="typed"><span class="type">String</span><a href="#46438">className</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a href="#46443" id="5813">startsWith</a></span>) })
	<span class="typed"><span class="type">(Boolean)Unit</span><span id="5971"><a id="802">require</a></span></span>(<span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#46397">parent</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5765">!=</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) <span class="comment">// included because a null parent is legitimate in Java</span>
	@<span class="typed"><span class="type">throws</span><a id="237">throws</a></span>(<span class="typed"><span class="type">java.lang.Class[java.lang.ClassNotFoundException]</span><span >classOf</span></span>[ClassNotFoundException])
	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String,Boolean)Class[_]</span><a id="46401">loadClass</a></span>(<span class="typed"><span class="type">String</span><a id="46448">className</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">Boolean</span><a id="46449">resolve</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2151">Boolean</a></span>): <span class="typed"><span class="type">Class[_]</span><a id="1653">Class</a></span>[_] =
	{
		<span class="typed"><span class="type">java.lang.Class[_10]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">sbt.ClassFilter</span><a href="#46398">filter</a></span>.<span class="typed"><span class="type">(String)Boolean</span><a href="#46406">include</a></span>(<span class="typed"><span class="type">String</span><a href="#46448">className</a></span>))
			<span class="keyword">super</span>.<span class="typed"><span class="type">(java.lang.String,Boolean)java.lang.Class[_]</span><a id="34650">loadClass</a></span>(<span class="typed"><span class="type">String</span><a href="#46448">className</a></span>, <span class="typed"><span class="type">Boolean</span><a href="#46449">resolve</a></span>)
		<span class="keyword">else</span>
		{
			<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.Class[_]</span><a id="46464">loaded</a></span> = <span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#46397">parent</a></span>.<span class="typed"><span class="type">(java.lang.String)java.lang.Class[_]</span><a id="34647">loadClass</a></span>(<span class="typed"><span class="type">String</span><a href="#46448">className</a></span>)
			<span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Boolean</span><a href="#46449">resolve</a></span>)
				<span class="typed"><span class="type">(java.lang.Class[_])Unit</span><a href="#6471" id="34668">resolveClass</a></span>(<span class="typed"><span class="type">java.lang.Class[_]</span><a href="#46464">loaded</a></span>)
			<span class="typed"><span class="type">java.lang.Class[_]</span><a href="#46464">loaded</a></span>
		}
	}
}
<span class="keyword">private</span> <span class="keyword">trait</span> <span class="typed"><span class="type">trait ClassFilter extends java.lang.Object</span><span id="6472"><a id="2146">ClassFilter</a></span></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="46406">include</a></span>(<span class="typed"><span class="type">String</span><a id="46440">className</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2151">Boolean</a></span>
}
<span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class LazyFrameworkLoader extends sbt.LoaderBase with NotNull with ScalaObject</span><a id="6473">LazyFrameworkLoader</a></span>(<span class="typed"><span class="type">String</span><span id="36732"><a id="36738">runnerClassName</a></span></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">Array[java.net.URL]</span><span id="36733"><a id="36739">urls</a></span></span>: <span class="typed"><span class="type">Array[java.net.URL]</span><a id="1053">Array</a></span>[URL], <span class="typed"><span class="type">java.lang.ClassLoader</span><span id="36734"><a id="36740">parent</a></span></span>: <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="1707">ClassLoader</a></span>, <span class="typed"><span class="type">java.lang.ClassLoader</span><span id="36735"><a id="36741">grandparent</a></span></span>: <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="1707">ClassLoader</a></span>)
	<span class="keyword">extends</span> <span class="typed"><span class="type">sbt.LoaderBase</span><a href="#6469">LoaderBase</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><a href="#36739">urls</a></span>, <span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#36740">parent</a></span>) <span class="keyword">with</span> <span class="typed"><span class="type">NotNull</span><a id="186">NotNull</a></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)Class[_]</span><a id="36737">doLoadClass</a></span>(<span class="typed"><span class="type">String</span><a id="46496">className</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>): <span class="typed"><span class="type">Class[_]</span><a id="1653">Class</a></span>[_] =
	{
		<span class="typed"><span class="type">java.lang.Class[_12]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">object sbt.Loaders</span><a href="#6474">Loaders</a></span>.<span class="typed"><span class="type">(String,String)Boolean</span><a href="#46370">isNestedOrSelf</a></span>(<span class="typed"><span class="type">String</span><a href="#46496">className</a></span>, <span class="typed"><span class="type">String</span><a href="#36732">runnerClassName</a></span>))
			<span class="typed"><span class="type">(java.lang.String)java.lang.Class[_]</span><a href="#6473" id="36323">findClass</a></span>(<span class="typed"><span class="type">String</span><a href="#46496">className</a></span>)
		<span class="keyword">else</span> <span class="typed"><span class="type">java.lang.Class[_11]</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">String</span><a href="#46496">className</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5813">startsWith</a></span>(<span class="typed"><span class="type">object sbt.Loaders</span><a href="#6474">Loaders</a></span>.<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#46368">SbtPackage</a></span>)) <span class="comment">// we circumvent the parent loader because we know that we want the</span>
			<span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#36735">grandparent</a></span>.<span class="typed"><span class="type">(java.lang.String)java.lang.Class[_]</span><a id="34647">loadClass</a></span>(<span class="typed"><span class="type">String</span><a href="#46496">className</a></span>)              <span class="comment">// version of sbt that is currently the builder (not the project being built)</span>
		<span class="keyword">else</span>
			<span class="typed"><span class="type">java.lang.ClassLoader</span><a href="#36734">parent</a></span>.<span class="typed"><span class="type">(java.lang.String)java.lang.Class[_]</span><a id="34647">loadClass</a></span>(<span class="typed"><span class="type">String</span><a href="#46496">className</a></span>)
	}
}
<span class="keyword">private</span> <span class="keyword">object</span> <span class="typed"><span class="type">object sbt.Loaders</span><a id="6474">Loaders</a></span>
{
	<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="46369"><a id="46368">SbtPackage</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;sbt.&quot;)</span><span class="string">&quot;sbt.&quot;</span></span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(String,String)Boolean</span><a id="46370">isNestedOrSelf</a></span>(<span class="typed"><span class="type">String</span><a id="46501">className</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">String</span><a id="46502">checkAgainst</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) =
		<span class="typed"><span class="type">String</span><a href="#46501">className</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3490">==</a></span> <span class="typed"><span class="type">String</span><a href="#46502">checkAgainst</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2731">||</a></span> <span class="typed"><span class="type">String</span><a href="#46501">className</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5813">startsWith</a></span>(<span class="typed"><span class="type">String</span><a href="#46502">checkAgainst</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;$&quot;)</span><span class="string">&quot;$&quot;</span></span>)
}
        </pre>
    </body>
</html>