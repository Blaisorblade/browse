<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>sbt/impl/TestParser.scala</title>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008, 2009 Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="comment">/* The following implements the simple syntax for storing test definitions.
* The syntax is:
*
* definition := isModule? className separator className
* isModule := '&lt;module&gt;'
* separator := '&lt;&lt;'
*/</span>

<span class="keyword">import</span> scala.util.parsing.combinator._

<span class="keyword">import</span> TestParser._
<span class="comment">/** Represents a test implemented by 'testClassName' of type 'superClassName'.*/</span>
<span class="keyword">final</span> <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class TestDefinition extends java.lang.Object with NotNull with ScalaObject with Product</span><span id="2731"><span id="33886"><span id="3490"><span id="9327"><span id="33876"><span id="33890"><span id="3481"><span id="33885"><span id="33891"><span id="2729"><span id="5766"><span id="33893"><span id="3482"><span id="6332"><span id="33892"><span id="33878"><span id="6333"><span id="33877"><span id="33884"><span id="28986"><span id="289"><span id="29016"><span id="33874"><span id="33872"><span id="2732"><span id="33873"><span id="10375"><a id="430">TestDefinition</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">Boolean</span><span id="23606"><span id="23605"><span id="33869"><a id="34052">isModule</a></span></span></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2151">Boolean</a></span>, <span class="typed"><span class="type">String</span><span id="23608"><span id="23607"><span id="33870"><a id="34053">testClassName</a></span></span></span></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>, <span class="typed"><span class="type">String</span><span id="23610"><span id="23609"><span id="33871"><a id="34054">superClassName</a></span></span></span></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">NotNull</span><a id="186">NotNull</a></span>
{
	<span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()java.lang.String</span><a id="23612">toString</a></span> =
		(<span class="typed"><span class="type">java.lang.String</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">=&gt; Boolean</span><a href="#23605">isModule</a></span>) <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#23182">IsModuleLiteral</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">=&gt; String</span><a href="#23607">testClassName</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#23184">SubSuperSeparator</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">=&gt; String</span><a href="#23609">superClassName</a></span>
}
<span class="keyword">final</span> <span class="keyword">class</span> <span class="typed"><span class="type">class TestParser extends java.lang.Object with scala.util.parsing.combinator.RegexParsers with NotNull with ScalaObject</span><a id="6335">TestParser</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">scala.util.parsing.combinator.RegexParsers</span><a id="23563">RegexParsers</a></span> <span class="keyword">with</span> <span class="typed"><span class="type">NotNull</span><a id="186">NotNull</a></span>
{
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; TestParser.this.Parser[sbt.TestDefinition]</span><a id="33920">test</a></span>: <span class="typed"><span class="type">TestParser.this.Parser[sbt.TestDefinition]</span><a id="32985">Parser</a></span>[TestDefinition] =
		( <span class="typed"><span class="type">=&gt; TestParser.this.Parser[Boolean]</span><a href="#33921">isModule</a></span> <span class="typed"><span class="type">(=&gt; TestParser.this.Parser[String])TestParser.this.Parser[TestParser.this.~[Boolean,String]]</span><a id="33020">~!</a></span> <span class="typed"><span class="type">=&gt; TestParser.this.Parser[String]</span><a href="#33922">className</a></span> <span class="typed"><span class="type">(=&gt; TestParser.this.Parser[String])TestParser.this.Parser[TestParser.this.~[TestParser.this.~[Boolean,String],String]]</span><a id="33020">~!</a></span> <span class="typed"><span class="type">implicit scala.util.parsing.combinator.RegexParsers.literal : (String)TestParser.this.Parser[String]</span><a href="#6335" id="33901">SubSuperSeparator</a></span> <span class="typed"><span class="type">(=&gt; TestParser.this.Parser[String])TestParser.this.Parser[TestParser.this.~[TestParser.this.~[TestParser.this.~[Boolean,String],String],String]]</span><a id="33020">~!</a></span> <span class="typed"><span class="type">=&gt; TestParser.this.Parser[String]</span><a href="#33922">className</a></span> ) <span class="typed"><span class="type">((TestParser.this.~[TestParser.this.~[TestParser.this.~[Boolean,String],String],String]) =&gt; sbt.TestDefinition)TestParser.this.Parser[sbt.TestDefinition]</span><a id="33026">^^</a></span>
			<span class="typed"><span class="type">sbt.TestDefinition</span><a href="#34048">{</a></span> <span class="typed"><span class="type">sbt.TestDefinition</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Boolean</span><a id="34049">module</a></span> <a id="1">~</a> <span class="typed"><span class="type">String</span><a id="34050">testName</a></span> <a id="1">~</a> <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#23184">SubSuperSeparator</a></span> <a id="1">~</a> <span class="typed"><span class="type">String</span><a id="34051">superName</a></span> =&gt; <span class="typed"><span class="type">(Boolean,String,String)sbt.TestDefinition</span><a href="#33876">TestDefinition</a></span>(<span class="typed"><span class="type">Boolean</span><a href="#34049">module</a></span>, <span class="typed"><span class="type">String</span><a href="#34050">testName</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="5842">trim</a></span>, <span class="typed"><span class="type">String</span><a href="#34051">superName</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="5842">trim</a></span>) }
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; TestParser.this.Parser[Boolean]</span><a id="33921">isModule</a></span>: <span class="typed"><span class="type">TestParser.this.Parser[Boolean]</span><a id="32985">Parser</a></span>[Boolean] = (<span class="typed"><span class="type">implicit scala.util.parsing.combinator.RegexParsers.literal : (String)TestParser.this.Parser[String]</span><a href="#6335" id="33901">IsModuleLiteral</a></span><span class="typed"><span class="type">=&gt; TestParser.this.Parser[Option[String]]</span><a id="33042">?</a></span>) <span class="typed"><span class="type">((Option[String]) =&gt; Boolean)TestParser.this.Parser[Boolean]</span><a id="33026">^^</a></span> (<span class="typed"><span class="type">Option[String]</span><a href="#34061">_</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="10260">isDefined</a></span>)
	<span class="keyword">def</span> <span class="typed"><span class="type">=&gt; TestParser.this.Parser[String]</span><a id="33922">className</a></span>: <span class="typed"><span class="type">TestParser.this.Parser[String]</span><a id="32985">Parser</a></span>[String] = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6104"><a href="#23186" id="802">ClassNameRegexString</a></span></span>.<span class="typed"><span class="type">implicit scala.util.parsing.combinator.RegexParsers.regex : (scala.util.matching.Regex)TestParser.this.Parser[String]</span><span id="33902"><a href="#6335" id="8884">r</a></span></span>
	
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)Either[String,sbt.TestDefinition]</span><a id="33923">parse</a></span>(<span class="typed"><span class="type">String</span><a id="34066">testDefinitionString</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>): <span class="typed"><span class="type">Either[String,sbt.TestDefinition]</span><a id="342">Either</a></span>[String, TestDefinition] =
	{
		<span class="keyword">def</span> <span class="typed"><span class="type">(String)Left[java.lang.String,Nothing]</span><a id="34067">parseError</a></span>(<span class="typed"><span class="type">String</span><a id="34068">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>) = <span class="typed"><span class="type">(java.lang.String)Left[java.lang.String,Nothing]</span><span id="31304"><a id="1198">Left</a></span></span>(<span class="typed"><span class="type">java.lang.String(&quot;Could not parse test definition '&quot;)</span><span class="string">&quot;Could not parse test definition '&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">String</span><a href="#34066">testDefinitionString</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;': &quot;)</span><span class="string">&quot;': &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5774">+</a></span> <span class="typed"><span class="type">String</span><a href="#34068">msg</a></span>)
		<span class="typed"><span class="type">(TestParser.this.Parser[sbt.TestDefinition],java.lang.CharSequence)TestParser.this.ParseResult[sbt.TestDefinition]</span><a href="#6335" id="33915">parseAll</a></span>(<span class="typed"><span class="type">=&gt; TestParser.this.Parser[sbt.TestDefinition]</span><a href="#33920">test</a></span>, <span class="typed"><span class="type">String</span><a href="#34066">testDefinitionString</a></span>) <span class="typed"><span class="type">Either[String,sbt.TestDefinition]</span><span class="keyword">match</span></span>
		{
			<span class="typed"><span class="type">Right[Nothing,sbt.TestDefinition]</span><span class="keyword">case</span></span> <a id="1">Success</a>(<span class="typed"><span class="type">sbt.TestDefinition</span><a id="34079">result</a></span>, <span class="typed"><span class="type">TestParser.this.Input</span><a id="34080">next</a></span>) =&gt; <span class="typed"><span class="type">(sbt.TestDefinition)Right[Nothing,sbt.TestDefinition]</span><span id="30775"><a id="502">Right</a></span></span>(<span class="typed"><span class="type">sbt.TestDefinition</span><a href="#34079">result</a></span>)
			<span class="typed"><span class="type">Left[java.lang.String,Nothing]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">TestParser.this.NoSuccess</span><a id="34083">err</a></span>: <span class="typed"><span class="type">TestParser.this.NoSuccess</span><a id="32898">NoSuccess</a></span> =&gt; <span class="typed"><span class="type">(String)Left[java.lang.String,Nothing]</span><a href="#34067">parseError</a></span>(<span class="typed"><span class="type">TestParser.this.NoSuccess</span><a href="#34083">err</a></span>.<span class="typed"><span class="type">=&gt; String</span><a id="32922">msg</a></span>)
		}
	}
}
<span class="keyword">object</span> <span class="typed"><span class="type">object sbt.TestParser</span><a id="6336">TestParser</a></span>
{
	<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="23183"><a id="23182">IsModuleLiteral</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;&lt;module&gt;&quot;)</span><span class="string">&quot;&lt;module&gt;&quot;</span></span>
	<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="23185"><a id="23184">SubSuperSeparator</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;&lt;&lt;&quot;)</span><span class="string">&quot;&lt;&lt;&quot;</span></span>
	<span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="23187"><a id="23186">ClassNameRegexString</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;[^&lt;]+&quot;)</span><span class="string">&quot;&quot;&quot;[^&lt;]+&quot;&quot;&quot;</span></span>
	<span class="keyword">def</span> <span class="typed"><span class="type">(String)Either[String,sbt.TestDefinition]</span><a id="23188">parse</a></span>(<span class="typed"><span class="type">String</span><a id="23712">testDefinitionString</a></span>: <span class="typed"><span class="type">String</span><a id="1842">String</a></span>): <span class="typed"><span class="type">Either[String,sbt.TestDefinition]</span><a id="342">Either</a></span>[String, TestDefinition] = (<span class="typed"><span class="type">sbt.TestParser</span><span class="keyword">new</span></span> <span class="typed"><span class="type">sbt.TestParser</span><a href="#6335">TestParser</a></span>).<span class="typed"><span class="type">(String)Either[String,sbt.TestDefinition]</span><a href="#33923">parse</a></span>(<span class="typed"><span class="type">String</span><a href="#23712">testDefinitionString</a></span>)
}
        </pre>
    </body>
</html>