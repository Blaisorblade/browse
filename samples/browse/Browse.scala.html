<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Browse.scala</title>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* browse -- Scala Source Browser
 * Copyright 2009 Mark Harrah
 */</span>

<span class="keyword">package</span> browse

<span class="keyword">import</span> scala.tools.nsc.{ast, plugins, symtab, util, Global}
<span class="keyword">import</span> ast.parser.Tokens
<span class="keyword">import</span> plugins.Plugin
<span class="keyword">import</span> symtab.Flags
<span class="keyword">import</span> util.SourceFile
<span class="keyword">import</span> scala.collection.jcl.{TreeMap, TreeSet}

<span class="keyword">import</span> java.io.{File, Reader, Writer}

<span class="comment">/** The actual work extracting symbols and types is done here. */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Browse extends scala.tools.nsc.plugins.Plugin with ScalaObject" id="6168">Browse</a> <span class="keyword">extends</span> <a title="scala.tools.nsc.plugins.Plugin" id="8400">Plugin</a>
{
	<span class="comment">/** The directory to which the annotated sources will be written. */</span>
	<span class="keyword">def</span> <a title="=&gt; java.io.File" id="10763">outputDirectory</a>: <a title="java.io.File" id="3612">File</a>
	<span class="comment">/** The directory against which the input source paths will be relativized.*/</span>
	<span class="keyword">def</span> <a title="=&gt; Option[java.io.File]" id="10764">baseDirectory</a>: <a title="Option[java.io.File]" id="889">Option</a>[File]
	<span class="comment">/** The compiler.*/</span>
	<span class="keyword">val</span> <a title="=&gt; scala.tools.nsc.Global" id="10765">global</a>: <a title="scala.tools.nsc.Global" id="6639">Global</a>
	
	<span class="keyword">import</span> global._
	<span class="keyword">import</span> Browse._

	<span class="comment">/** The entry method for producing a set of html files and auxiliary javascript and CSS files that
	* annotate the source code for display in a web browser. */</span>
	<span class="keyword">def</span> <a title="()Unit" id="10768">generateOutput</a>()
	{
		<span class="keyword">val</span> <a title="java.io.File" id="16197">cssFile</a> = <a title="(java.io.File,java.lang.String)java.io.File" id="11663" class="keyword">new</a> <a title="java.io.File" id="3612">File</a>(<a href="#10763" title="=&gt; java.io.File">outputDirectory</a>, <a href="#16184" title="=&gt; java.lang.String">CSSRelativePath</a>)
		<span class="keyword">val</span> <a title="java.io.File" id="16198">jsFile</a> = <a title="(java.io.File,java.lang.String)java.io.File" id="11663" class="keyword">new</a> <a title="java.io.File" id="3612">File</a>(<a href="#10763" title="=&gt; java.io.File">outputDirectory</a>, <a href="#16186" title="=&gt; java.lang.String">JSRelativePath</a>)
		<a href="#16192" title="(java.io.File)Unit">writeDefaultCSS</a>(<a href="#16197" title="java.io.File">cssFile</a>)
		<a href="#16193" title="(java.io.File)Unit">writeJS</a>(<a href="#16198" title="java.io.File">jsFile</a>)
		<span class="keyword">var</span> <a title="List[java.io.File]" id="16199">outputFiles</a> = <a title="object Nil" id="302">List</a>[File]()
		<span class="keyword">for</span>(<span id="17355"><a title="((Browse.this.global.CompilationUnit) =&gt; Unit)Unit" id="17422">unit</a></span> &lt;- <a href="#10765" title="=&gt; Browse.this.global.Run" id="11125">currentRun</a>.<a title="=&gt; Iterator[Browse.this.global.CompilationUnit]" id="11112">units</a>)
		{
			<span class="keyword">val</span> <a title="java.io.File" id="17423">sourceFile</a> = <a href="#17422" title="Browse.this.global.CompilationUnit">unit</a>.<a title="=&gt; scala.tools.nsc.util.SourceFile" id="16136">source</a>.<a title="=&gt; scala.tools.nsc.io.AbstractFile" id="17443">file</a>.<a title="=&gt; java.io.File" id="17527">file</a>
			<span class="keyword">val</span> <a title="String" id="17424">relativeSourcePath</a> = <a href="#10780" title="(java.io.File)String">getRelativeSourcePath</a>(<a href="#17423" title="java.io.File">sourceFile</a>)
			<span class="keyword">val</span> <a title="java.io.File" id="17425">outputFile</a> = <a title="(java.io.File,java.lang.String)java.io.File" id="11663" class="keyword">new</a> <a title="java.io.File" id="3612">File</a>(<a href="#10763" title="=&gt; java.io.File">outputDirectory</a>, <a href="#17424" title="String">relativeSourcePath</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;.html&quot;)" class="string">&quot;.html&quot;</span>)
			<a href="#16199" title="List[java.io.File]">outputFiles</a> <a title="(java.io.File)List[java.io.File]" id="11153">::=</a> <a href="#17425" title="java.io.File">outputFile</a>
			<span class="keyword">val</span> <a title="String" id="17426">relativizedCSSPath</a> = <a href="FileUtil.scala.html#6223" title="object browse.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#17579" title="(java.io.File,java.io.File)String">relativePath</a>(<a href="#17425" title="java.io.File">outputFile</a>, <a href="#16197" title="java.io.File">cssFile</a>)
			<span class="keyword">val</span> <a title="String" id="17427">relativizedJSPath</a> = <a href="FileUtil.scala.html#6223" title="object browse.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#17579" title="(java.io.File,java.io.File)String">relativePath</a>(<a href="#17425" title="java.io.File">outputFile</a>, <a href="#16198" title="java.io.File">jsFile</a>)

			<span class="comment">// generate the tokens</span>
			<span class="keyword">val</span> <a title="scala.collection.jcl.TreeSet[browse.Token]" id="17428">tokens</a> = <a href="#10769" title="(Browse.this.global.CompilationUnit)scala.collection.jcl.TreeSet[browse.Token]">scan</a>(<a href="#17422" title="Browse.this.global.CompilationUnit">unit</a>)
			<span class="keyword">val</span> <a title="Browse.this.Traverse" id="17429">traverser</a> = <span title="Browse.this.Traverse" class="keyword">new</span> <a href="#10774" title="Browse.this.Traverse">Traverse</a>(<a href="#17428" title="scala.collection.jcl.TreeSet[browse.Token]">tokens</a>, <a href="#17422" title="Browse.this.global.CompilationUnit">unit</a>.<a title="=&gt; scala.tools.nsc.util.SourceFile" id="16136">source</a>)
			<a href="#17429" title="(Browse.this.global.Tree)Browse.this.global.Tree" id="16049">traverser</a>(<a href="#17422" title="Browse.this.global.CompilationUnit">unit</a>.<a title="=&gt; Browse.this.global.Tree" id="16142">body</a>)

			<span class="keyword">val</span> <a title="browse.BasicStyler" id="17430">styler</a> = <span title="browse.BasicStyler" class="keyword">new</span> <a href="Styler.scala.html#6199" title="browse.BasicStyler">BasicStyler</a>(<a href="#17428" title="scala.collection.jcl.TreeSet[browse.Token]">tokens</a>, <a href="#17424" title="String">relativeSourcePath</a>, <a href="#17426" title="String">relativizedCSSPath</a>, <a href="#17427" title="String">relativizedJSPath</a>)
			<a href="Annotate.scala.html#19439" title="(java.io.File,java.io.File,scala.collection.jcl.TreeSet[browse.Token],browse.Styler)Unit">Annotate</a>(<a href="#17423" title="java.io.File">sourceFile</a>, <a href="#17425" title="java.io.File">outputFile</a>, <a href="#17428" title="scala.collection.jcl.TreeSet[browse.Token]">tokens</a>, <a href="#17430" title="browse.BasicStyler">styler</a>)
		}
		<span class="keyword">val</span> <a title="java.io.File" id="16200">indexFile</a> = <a title="(java.io.File,java.lang.String)java.io.File" id="11663" class="keyword">new</a> <a title="java.io.File" id="3612">File</a>(<a href="#10763" title="=&gt; java.io.File">outputDirectory</a>, <a href="#16182" title="=&gt; java.lang.String">IndexRelativePath</a>)
		<a href="#16194" title="(java.io.File,Iterable[java.io.File])Unit">writeIndex</a>(<a href="#16200" title="java.io.File">indexFile</a>, <a href="#16199" title="List[java.io.File]">outputFiles</a>)
	}
	<span class="comment">/** Tokenizes the given source.  The tokens are put into an ordered set by the start position of the token.
	* Symbols will be mapped back to these tokens by the offset of the symbol.*/</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Browse.this.global.CompilationUnit)scala.collection.jcl.TreeSet[browse.Token]" id="10769">scan</a>(<a title="Browse.this.global.CompilationUnit" id="17587">unit</a>: <a title="Browse.this.global.CompilationUnit" id="16135">CompilationUnit</a>) =
	{
		<span class="keyword">val</span> <a title="scala.collection.jcl.TreeSet[browse.Token]" id="17589">tokens</a> = <span id="6055"><a href="#18369" title="scala.collection.jcl.TreeSet[browse.Token]" id="779" class="keyword">new</a></span> <a title="scala.collection.jcl.TreeSet[browse.Token]" id="10489">TreeSet</a>[Token]
		<span class="keyword">val</span> <a title="Browse.this.global.syntaxAnalyzer.UnitScanner" id="17590">scanner</a> = <a title="template $anon extends Browse.this.global.syntaxAnalyzer.UnitScanner" id="18370" class="keyword">new</a> <a href="#10765" title="object Browse.this.global.syntaxAnalyzer" id="10921">syntaxAnalyzer</a>.<a title="Browse.this.global.syntaxAnalyzer.UnitScanner" id="18885">UnitScanner</a>(<a href="#17587" title="Browse.this.global.CompilationUnit">unit</a>) { <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Unit" id="19202">init</a> <span title="Unit">{</span>} }
		<span class="keyword">for</span>( <span id="17355"><a href="#19213" title="(((Int, Int, Int)) =&gt; Unit)Unit" id="17346">(</a></span><span id="19215"><a title="Int" id="19220">offset</a></span>, <span id="19216"><a title="Int" id="19221">length</a></span>, <span id="19217"><a title="Int" id="19222">code</a></span>) &lt;- <a href="#17590" title="Browse.this.global.syntaxAnalyzer.UnitScanner">scanner</a>.<a title="=&gt; &lt;refinement&gt; extends java.lang.Object with Iterator[(Int, Int, Int)]" id="18794">iterator</a>)
		{
			<span title="Unit" class="keyword">if</span>(<a href="#10770" title="(Int)Boolean">includeToken</a>(<a href="#19222" title="Int">code</a>))
				<a href="#17589" title="scala.collection.jcl.TreeSet[browse.Token]">tokens</a> <a title="(browse.Token)Unit" id="18243">+=</a> <span title="browse.Token" class="keyword">new</span> <a href="Token.scala.html#6182" title="browse.Token">Token</a>(<a href="#19220" title="Int">offset</a>, <a href="#19221" title="Int">length</a>, <a href="#19222" title="Int">code</a>)
		}
		<a href="#17589" title="scala.collection.jcl.TreeSet[browse.Token]">tokens</a>
	}
	<span class="comment">/** Filters out unwanted tokens such as whitespace and commas.  Braces are currently
	* included because () is annotated as Unit, and a partial function created by
	* { case ... } is associated with the opening brace.  */</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Int)Boolean" id="10770">includeToken</a>(<a title="Int" id="19223">code</a>: <a title="Int" id="2346">Int</a>) =
	{
		<span class="keyword">import</span> Tokens.{COMMENT, USCORE, isBrace, isKeyword, isIdentifier, isLiteral}
		<a href="#19223" title="Int">code</a> <span title="Boolean" class="keyword">match</span>
		{
			<span title="Boolean(true)" class="keyword">case</span> <span title="Int(97)">COMMENT</span> | <span title="Int(73)">USCORE</span> =&gt; <span title="Boolean(true)" class="keyword">true</span>
			<span title="Boolean" class="keyword">case</span> _ =&gt; <span id="19340"><a title="(Int)Boolean" id="8326">isKeyword</a></span>(<a href="#19223" title="Int">code</a>) <a title="(Boolean)Boolean" id="2693">||</a> <span id="19254"><a title="(Int)Boolean" id="8326">isIdentifier</a></span>(<a href="#19223" title="Int">code</a>) <a title="(Boolean)Boolean" id="2693">||</a> <span id="19249"><a title="(Int)Boolean" id="8326">isLiteral</a></span>(<a href="#19223" title="Int">code</a>) <a title="(Boolean)Boolean" id="2693">||</a> <span id="19385"><a title="(Int)Boolean" id="8326">isBrace</a></span>(<a href="#19223" title="Int">code</a>)
		}
	}
	<span class="comment">/** Gets the token for the given offset.*/</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(scala.collection.jcl.TreeSet[browse.Token],Int)Option[browse.Token]" id="10771">tokenAt</a>(<a title="scala.collection.jcl.TreeSet[browse.Token]" id="19462">tokens</a>: <a title="scala.collection.jcl.TreeSet[browse.Token]" id="10489">TreeSet</a>[Token], <a title="Int" id="19463">offset</a>: <a title="Int" id="2346">Int</a>): <a title="Option[browse.Token]" id="889">Option</a>[Token] =
	{
		<span class="comment">// create artificial tokens to get a subset of the tokens starting at the given offset</span>
		<span class="keyword">val</span> <a title="tokens.SortedSelf" id="19464">inRange</a> = <a href="#19462" title="scala.collection.jcl.TreeSet[browse.Token]">tokens</a>.<a title="(browse.Token,browse.Token)tokens.SortedSelf" id="18301">range</a>(<span title="browse.Token" class="keyword">new</span> <a href="Token.scala.html#6182" title="browse.Token">Token</a>(<a href="#19463" title="Int">offset</a>, <span title="Int(1)" class="int">1</span>, <span title="Int(0)" class="int">0</span>), <span title="browse.Token" class="keyword">new</span> <a href="Token.scala.html#6182" title="browse.Token">Token</a>(<a href="#19463" title="Int">offset</a><a title="(Int)Int" id="3090">+</a><span title="Int(1)" class="int">1</span>, <span title="Int(1)" class="int">1</span>, <span title="Int(0)" class="int">0</span>))
		<span class="comment">// then, take the first token in the range</span>
		<span title="Option[browse.Token]" class="keyword">if</span>(<a href="#19464" title="tokens.SortedSelf">inRange</a>.<a title="=&gt; Boolean" id="18173">isEmpty</a>)
			<a title="object None" id="497">None</a>
		<span class="keyword">else</span>
			<span id="19672"><a title="(browse.Token)Some[browse.Token]" id="278">Some</a></span>(<a href="#19464" title="tokens.SortedSelf">inRange</a>.<a title="=&gt; browse.Token" id="17621">firstKey</a>)
	}

	<span class="comment">/** Filters unwanted symbols, such as packages.*/</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Browse.this.global.Symbol)Boolean" id="10772">ignore</a>(<a title="Browse.this.global.Symbol" id="19677">s</a>: <a title="Browse.this.global.Symbol" id="11886">Symbol</a>): <a title="Boolean" id="2110">Boolean</a> =
		<a href="#10773" title="(Browse.this.global.Symbol)Boolean">ignoreBase</a>(<a href="#19677" title="Browse.this.global.Symbol">s</a>) <a title="(Boolean)Boolean" id="2693">||</a>
		<a href="#19677" title="Browse.this.global.Symbol">s</a>.<a title="=&gt; Boolean" id="12085">isModuleClass</a> <a title="(Boolean)Boolean" id="2693">||</a> <span class="comment">// ignore the generated class for modules</span>
		<a href="#19677" title="Browse.this.global.Symbol">s</a>.<a title="=&gt; Boolean" id="12105">isPrimaryConstructor</a> <span class="comment">// the primary constructor overlaps with the class type, so just use the class type</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Browse.this.global.Symbol)Boolean" id="10773">ignoreBase</a>(<a title="Browse.this.global.Symbol" id="19704">s</a>: <a title="Browse.this.global.Symbol" id="11886">Symbol</a>): <a title="Boolean" id="2110">Boolean</a> =
		<a title="=&gt; Boolean" id="2690">!</a><a href="#19704" title="Browse.this.global.Symbol">s</a>.<a title="=&gt; Boolean" id="12122">exists</a> <a title="(Boolean)Boolean" id="2693">||</a>
		<a href="#19704" title="Browse.this.global.Symbol">s</a>.<a title="=&gt; Boolean" id="12070">isPackage</a> <a title="(Boolean)Boolean" id="2693">||</a> <span class="comment">// nothing done with packages</span>
		<a href="#19704" title="Browse.this.global.Symbol">s</a>.<a title="=&gt; Boolean" id="12107">isImplClass</a>
		
	<span class="keyword">private</span> <span class="keyword">class</span> <a title="class Traverse extends Browse.this.global.Traverser with ScalaObject" id="10774">Traverse</a>(<span id="19406"><a title="scala.collection.jcl.TreeSet[browse.Token]" id="19411">tokens</a></span>: <a title="scala.collection.jcl.TreeSet[browse.Token]" id="10489">TreeSet</a>[Token], <span id="19407"><a title="scala.tools.nsc.util.SourceFile" id="19412">source</a></span>: <a title="scala.tools.nsc.util.SourceFile" id="10189">SourceFile</a>) <span class="keyword">extends</span> <a href="#10765" title="Browse.this.global.Traverser" id="16040">Traverser</a>
	{
		<span class="comment">// magic method #1</span>
		<span class="keyword">override</span> <span class="keyword">def</span> <a title="(Browse.this.global.Tree)Unit" id="19409">traverse</a>(<a title="Browse.this.global.Tree" id="19708">tree</a>: <a title="Browse.this.global.Tree" id="15001">Tree</a>)
		{
			<span class="keyword">def</span> <a title="()Unit" id="19709">handleDefault</a>()
			{
				<a href="#19410" title="(Browse.this.global.Tree)Unit">process</a>(<a href="#19708" title="Browse.this.global.Tree">tree</a>)
				<span class="keyword">super</span>.<a title="(Browse.this.global.Tree)Unit" id="16045">traverse</a>(<a href="#19708" title="Browse.this.global.Tree">tree</a>)
			}
			<a href="#19708" title="Browse.this.global.Tree">tree</a> <span title="Unit" class="keyword">match</span>
			{
				<span title="Unit" class="keyword">case</span> <a id="1">ValDef</a>(_, _, _, <a title="Browse.this.global.Tree" id="19722">rhs</a>) =&gt;
					<span class="comment">// tests for synthetic val created for the x in x :: Nil, which would associate the wrong type with ::</span>
					<span class="comment">// because the synthetic val is associated with the :: token</span>
					<span title="Unit" class="keyword">if</span>(<a href="#19708" title="Browse.this.global.Tree">tree</a>.<a title="=&gt; Browse.this.global.Symbol" id="15012">symbol</a> <a title="(AnyRef)Boolean" id="5727">!=</a> <span title="Null(null)" class="keyword">null</span> <a title="(Boolean)Boolean" id="2694">&amp;&amp;</a> <a href="#19708" title="Browse.this.global.Tree">tree</a>.<a title="=&gt; Browse.this.global.Symbol" id="15012">symbol</a>.<a title="(Long)Boolean" id="12140">hasFlag</a>(Flags.<span title="Long(2097152L)">SYNTHETIC</span>))
						<a href="#19409" title="(Browse.this.global.Tree)Unit">traverse</a>(<a href="#19722" title="Browse.this.global.Tree">rhs</a>)
					<span class="keyword">else</span>
						<a href="#19709" title="()Unit">handleDefault</a>()
				<span title="Unit" class="keyword">case</span> <a id="1">Template</a>(<a title="List[Browse.this.global.Tree]" id="20082">parents</a>, <a title="Browse.this.global.ValDef" id="20083">self</a>, <a title="List[Browse.this.global.Tree]" id="20084">body</a>) =&gt;
					<span class="comment">// If the first parent in the source is a trait, the first parent in parents will be AnyRef and it will</span>
					<span class="comment">// use the trait's token, bumping the trait.  So, this hack processes traits first</span>
					<span class="keyword">val</span> <span id="16294"><a href="#20090" title="(List[Browse.this.global.Tree], List[Browse.this.global.Tree])" id="1322">(</a></span><span id="20090"><span id="20086"><a href="#20085" title="List[Browse.this.global.Tree]" id="16282">traits</a></span></span>, <span id="20091"><span id="20087"><a href="#20085" title="List[Browse.this.global.Tree]" id="16284">notTraits</a></span></span>) = <a href="#20082" title="List[Browse.this.global.Tree]">parents</a>.<a title="((Browse.this.global.Tree) =&gt; Boolean)(List[Browse.this.global.Tree], List[Browse.this.global.Tree])" id="11187">partition</a>(<a href="#20089" title="Browse.this.global.Tree">_</a>.<a title="=&gt; Browse.this.global.Symbol" id="15012">symbol</a>.<a title="=&gt; Boolean" id="12074">isTrait</a>)
					<a href="#10774" title="(List[Browse.this.global.Tree])Unit" id="16046">traverseTrees</a>(<a href="#20086" title="List[Browse.this.global.Tree]">traits</a>)
					<a href="#10774" title="(List[Browse.this.global.Tree])Unit" id="16046">traverseTrees</a>(<a href="#20087" title="List[Browse.this.global.Tree]">notTraits</a>)
					<span title="Unit" class="keyword">if</span> (<a title="=&gt; Boolean" id="2690">!</a><a href="#20083" title="Browse.this.global.ValDef">self</a>.<a title="=&gt; Boolean" id="15019">isEmpty</a>) <a href="#19409" title="(Browse.this.global.Tree)Unit">traverse</a>(<a href="#20083" title="Browse.this.global.ValDef">self</a>)
					<a href="#10774" title="(List[Browse.this.global.Tree],Browse.this.global.Symbol)Unit" id="16048">traverseStats</a>(<a href="#20084" title="List[Browse.this.global.Tree]">body</a>, <a href="#19708" title="Browse.this.global.Tree">tree</a>.<a title="=&gt; Browse.this.global.Symbol" id="15012">symbol</a>)
				<span class="comment">/*case DefDef(_, _, tparams, vparamss, _, rhs) =&gt;
					atOwner(tree.symbol) {
						traverseTrees(tparams); traverseTreess(vparamss); traverse(rhs)
					}*/</span>
				<span title="Unit" class="keyword">case</span> _ =&gt;
					<a href="#19709" title="()Unit">handleDefault</a>()
			}
		}
		
		<span class="comment">// magic method #2</span>
		<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Browse.this.global.Tree)Unit" id="19410">process</a>(<a title="Browse.this.global.Tree" id="19710">t</a>: <a title="Browse.this.global.Tree" id="15001">Tree</a>)
		{
			<span class="keyword">for</span>(<span id="11724"><span id="11723"><span id="20106"><a title="((scala.tools.nsc.util.SourceFile) =&gt; Unit)Unit" id="20109">tSource</a></span></span></span> &lt;- <a href="#19710" title="Browse.this.global.Tree">t</a>.<a title="=&gt; scala.tools.nsc.util.Position" id="15006">pos</a>.<a title="=&gt; Option[scala.tools.nsc.util.SourceFile]" id="20099">source</a> <span class="keyword">if</span> <a href="#20106" title="scala.tools.nsc.util.SourceFile">tSource</a> <a title="(AnyRef)Boolean" id="3452">==</a> <a href="#19407" title="scala.tools.nsc.util.SourceFile">source</a>; <span id="11724"><a title="((Int) =&gt; Unit)Unit" id="20111">offset</a></span> &lt;- <a href="#19710" title="Browse.this.global.Tree">t</a>.<a title="=&gt; scala.tools.nsc.util.Position" id="15006">pos</a>.<a title="=&gt; Option[Int]" id="20098">offset</a>; <span id="11724"><a title="((browse.Token) =&gt; Unit)Unit" id="20113">token</a></span> &lt;- <a href="#10771" title="(scala.collection.jcl.TreeSet[browse.Token],Int)Option[browse.Token]">tokenAt</a>(<a href="#19406" title="scala.collection.jcl.TreeSet[browse.Token]">tokens</a>, <a href="#20111" title="Int">offset</a>))
			{
				<span class="keyword">def</span> <a title="()Unit" id="20114">processDefaultSymbol</a>() =
				{
					<span title="Unit" class="keyword">if</span>(<a href="#19710" title="Browse.this.global.Tree">t</a>.<a title="=&gt; Boolean" id="15015">hasSymbol</a> <a title="(Boolean)Boolean" id="2694">&amp;&amp;</a> <a title="=&gt; Boolean" id="2690">!</a><a href="#10772" title="(Browse.this.global.Symbol)Boolean">ignore</a>(<a href="#19710" title="Browse.this.global.Tree">t</a>.<a title="=&gt; Browse.this.global.Symbol" id="15012">symbol</a>))
						<a href="#10775" title="(Browse.this.global.Tree,browse.Token,java.io.File)Unit">processSymbol</a>(<a href="#19710" title="Browse.this.global.Tree">t</a>, <a href="#20113" title="browse.Token">token</a>, <a href="#19407" title="scala.tools.nsc.util.SourceFile">source</a>.<a title="=&gt; scala.tools.nsc.io.AbstractFile" id="17443">file</a>.<a title="=&gt; java.io.File" id="17527">file</a>)
				}
				<span class="keyword">def</span> <a title="()Unit" id="20115">processSimple</a>() { <a href="#20113" title="browse.Token">token</a>.<a href="Token.scala.html#18356" title="(browse.TypeAttribute)Unit">tpe</a> = <a href="Token.scala.html#20131" title="(String,Option[browse.Link])browse.TypeAttribute">TypeAttribute</a>(<a href="#10777" title="(Browse.this.global.Type)String">typeString</a>(<a href="#19710" title="Browse.this.global.Tree">t</a>.<a title="=&gt; Browse.this.global.Type" id="15008">tpe</a>), <a title="object None" id="497">None</a>) }
				<span class="keyword">def</span> <a title="(Browse.this.global.TypeTree)Unit" id="20116">processTypeTree</a>(<a title="Browse.this.global.TypeTree" id="20151">tt</a>: <a title="Browse.this.global.TypeTree" id="15547">TypeTree</a>) { <span title="Unit" class="keyword">if</span>(<a title="=&gt; Boolean" id="2690">!</a><a href="#10772" title="(Browse.this.global.Symbol)Boolean">ignore</a>(<a href="#20151" title="Browse.this.global.TypeTree">tt</a>.<a title="=&gt; Browse.this.global.Symbol" id="15555">symbol</a>)) <a href="#10775" title="(Browse.this.global.Tree,browse.Token,java.io.File)Unit">processSymbol</a>(<a href="#20151" title="Browse.this.global.TypeTree">tt</a>, <a href="#20113" title="browse.Token">token</a>, <a href="#19407" title="scala.tools.nsc.util.SourceFile">source</a>.<a title="=&gt; scala.tools.nsc.io.AbstractFile" id="17443">file</a>.<a title="=&gt; java.io.File" id="17527">file</a>) }
				<a href="#19710" title="Browse.this.global.Tree">t</a> <span title="Unit" class="keyword">match</span>
				{
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.ClassDef" id="15055">ClassDef</a> =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.ModuleDef" id="15194">ModuleDef</a> =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.ValOrDefDef" id="15128">ValOrDefDef</a> =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.TypeDef" id="15158">TypeDef</a> =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span class="comment">//case _: Super =&gt; processDefaultSymbol()</span>
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.This" id="15515">This</a> =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span title="Unit" class="keyword">case</span> <a title="Browse.this.global.Select" id="20152">s</a>: <a title="Browse.this.global.Select" id="15524">Select</a> =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.New" id="15443">New</a> =&gt; <a href="#20115" title="()Unit">processSimple</a>()
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.Sequence" id="15304">Sequence</a> =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.Alternative" id="15313">Alternative</a> =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.Star" id="15322">Star</a> =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.Bind" id="15331">Bind</a> =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span title="Unit" class="keyword">case</span> <a id="1">Apply</a>(<a title="Browse.this.global.Tree" id="20153">fun</a>, <a title="List[Browse.this.global.Tree]" id="20154">args</a>) =&gt; <span class="comment">//processDefaultSymbol()</span>
						<span class="comment">/*fun match
						{
							case tt: TypeTree =&gt; if(!ignoreBase(tt.symbol)) processTypeTree(tt)
							case _ =&gt; traverse(fun)
						}
						traverseTrees(args)*/</span>
					<span class="comment">//case _: Import =&gt; processSimple()</span>
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.Return" id="15412">Return</a> =&gt; <a href="#20115" title="()Unit">processSimple</a>()
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.If" id="15388">If</a> =&gt; <a href="#20115" title="()Unit">processSimple</a>()
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.Match" id="15401">Match</a> =&gt; <a href="#20115" title="()Unit">processSimple</a>() <span class="comment">// this will annotate the 'match' keyword with the type returned by the associated pattern match</span>
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.CaseDef" id="15291">CaseDef</a> =&gt; <a href="#20115" title="()Unit">processSimple</a>() <span class="comment">// this will annotate the 'case' keyword with the type returned by that particular case statement</span>
					<span title="Unit" class="keyword">case</span> _: <a title="Browse.this.global.Throw" id="15434">Throw</a> =&gt; <a href="#20115" title="()Unit">processSimple</a>()
					<span title="Unit" class="keyword">case</span> <a title="Browse.this.global.TypeApply" id="20155">ta</a>: <a title="Browse.this.global.TypeApply" id="15463">TypeApply</a> =&gt; <a href="#20115" title="()Unit">processSimple</a>() <span class="comment">// this fills in type parameters for methods</span>
					<span title="Unit" class="keyword">case</span> <a id="1">Ident</a>(_) =&gt; <a href="#20114" title="()Unit">processDefaultSymbol</a>()
					<span title="Unit" class="keyword">case</span> <a id="1">Literal</a>(<a title="Browse.this.global.Constant" id="20158">value</a>) =&gt; <a href="#20115" title="()Unit">processSimple</a>() <span class="comment">// annotate literals</span>
					<span title="Unit" class="keyword">case</span> <a title="Browse.this.global.TypeTree" id="20159">tt</a>: <a title="Browse.this.global.TypeTree" id="15547">TypeTree</a> =&gt;
						<span title="Unit" class="keyword">if</span>(<a href="#20113" title="browse.Token">token</a>.<a href="Token.scala.html#18363" title="=&gt; Boolean">isPlain</a>)
							<a href="#10775" title="(Browse.this.global.Tree,browse.Token,java.io.File)Unit">processSymbol</a>(<a href="#20159" title="Browse.this.global.TypeTree">tt</a>, <a href="#20113" title="browse.Token">token</a>, <a href="#19407" title="scala.tools.nsc.util.SourceFile">source</a>.<a title="=&gt; scala.tools.nsc.io.AbstractFile" id="17443">file</a>.<a title="=&gt; java.io.File" id="17527">file</a>)
					<span title="Unit" class="keyword">case</span> _ =&gt; <span title="Unit">(</span>)
				}
			}
		}
	}
		<span class="comment">// magic method #3</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Browse.this.global.Tree,browse.Token,java.io.File)Unit" id="10775">processSymbol</a>(<a title="Browse.this.global.Tree" id="20117">t</a>: <a title="Browse.this.global.Tree" id="15001">Tree</a>, <a title="browse.Token" id="20118">token</a>: <a href="Token.scala.html#6182" title="browse.Token">Token</a>, <a title="java.io.File" id="20119">sourceFile</a>: <a title="java.io.File" id="3612">File</a>)
	{
		<span class="keyword">val</span> <a title="Browse.this.global.Symbol" id="20169">sym</a> = <a href="#20117" title="Browse.this.global.Tree">t</a>.<a title="=&gt; Browse.this.global.Symbol" id="15012">symbol</a>
		<a href="#20169" title="Browse.this.global.Symbol">sym</a> <span title="Unit" class="keyword">match</span>
		{
			<span title="Unit" class="keyword">case</span> <a title="Browse.this.global.TermSymbol" id="20170">ts</a>: <a title="Browse.this.global.TermSymbol" id="11920">TermSymbol</a> =&gt;
				<span class="keyword">val</span> <a title="Browse.this.global.Type" id="20171">sType</a> =
					<a href="#20117" title="Browse.this.global.Tree">t</a> <span title="Browse.this.global.Type" class="keyword">match</span>
					{
						<span title="Browse.this.global.Type" class="keyword">case</span> <a title="Browse.this.global.ApplyDynamic" id="20173">ad</a>: <a title="Browse.this.global.ApplyDynamic" id="15493">ApplyDynamic</a> =&gt; <a href="#20173" title="Browse.this.global.ApplyDynamic">ad</a>.<a title="=&gt; Browse.this.global.Tree" id="15494">qual</a>.<a title="=&gt; Browse.this.global.Type" id="15008">tpe</a>.<a title="(Browse.this.global.Symbol)Browse.this.global.Type" id="12456">memberType</a>(<a href="#20173" title="Browse.this.global.ApplyDynamic">ad</a>.<a title="=&gt; Browse.this.global.Symbol" id="15062">symbol</a>)
						<span title="Browse.this.global.Type" class="keyword">case</span> <a title="Browse.this.global.Select" id="20174">s</a>: <a title="Browse.this.global.Select" id="15524">Select</a> =&gt; <a href="#20174" title="Browse.this.global.Select">s</a>.<a title="=&gt; Browse.this.global.Tree" id="15525">qualifier</a>.<a title="=&gt; Browse.this.global.Type" id="15008">tpe</a>.<a title="(Browse.this.global.Symbol)Browse.this.global.Type" id="12456">memberType</a>(<a href="#20174" title="Browse.this.global.Select">s</a>.<a title="=&gt; Browse.this.global.Symbol" id="15062">symbol</a>)
						<span title="Browse.this.global.Type" class="keyword">case</span> _ =&gt; <a href="#20170" title="Browse.this.global.TermSymbol">ts</a>.<a title="=&gt; Browse.this.global.Symbol" id="12128">owner</a>.<a title="=&gt; Browse.this.global.Type" id="12195">thisType</a>.<a title="(Browse.this.global.Symbol)Browse.this.global.Type" id="12456">memberType</a>(<a href="#20170" title="Browse.this.global.TermSymbol">ts</a>)
					}
				<span class="keyword">val</span> <a title="java.lang.String" id="20172">asString</a> =
					<a href="#20171" title="Browse.this.global.Type">sType</a> <span title="java.lang.String" class="keyword">match</span>
					{
						<span title="java.lang.String" class="keyword">case</span> <a title="Browse.this.global.MethodType" id="20175">mt</a>: <a title="Browse.this.global.MethodType" id="13008">MethodType</a> <span class="keyword">if</span> <a href="#20170" title="Browse.this.global.TermSymbol">ts</a>.<a title="(Long)Boolean" id="12140">hasFlag</a>(Flags.<span title="Long(1L)">IMPLICIT</span>)=&gt; <span title="java.lang.String(&quot;implicit &quot;)" class="string">&quot;implicit &quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#10776" title="(Browse.this.global.Symbol)String">fullName</a>(<a href="#20169" title="Browse.this.global.Symbol">sym</a>) <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot; : &quot;)" class="string">&quot; : &quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#10777" title="(Browse.this.global.Type)String">typeString</a>(<a href="#20171" title="Browse.this.global.Type">sType</a>)
						<span title="String" class="keyword">case</span> _ =&gt; <a href="#10777" title="(Browse.this.global.Type)String">typeString</a>(<a href="#20171" title="Browse.this.global.Type">sType</a>)
					}
				<span class="comment">//println(&quot;Term symbol &quot; + sym.id + &quot;: &quot; + asString)</span>
				<a href="#20118" title="browse.Token">token</a>.<a href="Token.scala.html#18356" title="(browse.TypeAttribute)Unit">tpe</a> = <a href="Token.scala.html#20131" title="(String,Option[browse.Link])browse.TypeAttribute">TypeAttribute</a>(<a href="#20172" title="java.lang.String">asString</a>, <a href="#10779" title="(java.io.File,Browse.this.global.Symbol)Option[browse.Link]">linkTo</a>(<a href="#20119" title="java.io.File">sourceFile</a>, <a href="#20171" title="Browse.this.global.Type">sType</a>.<a title="=&gt; Browse.this.global.Symbol" id="12387">typeSymbol</a>))
			<span title="Unit" class="keyword">case</span> <a title="Browse.this.global.TypeSymbol" id="20179">ts</a>: <a title="Browse.this.global.TypeSymbol" id="11945">TypeSymbol</a> =&gt;
				<span class="keyword">val</span> <a title="Browse.this.global.Type" id="20180">treeType</a> = <a href="#20117" title="Browse.this.global.Tree">t</a>.<a title="=&gt; Browse.this.global.Type" id="15008">tpe</a>
				<span class="keyword">val</span> <a title="Browse.this.global.Type" id="20181">sType</a> =
					<span title="Browse.this.global.Type" class="keyword">if</span>(<a href="#20180" title="Browse.this.global.Type">treeType</a> <a title="(AnyRef)Boolean" id="3452">==</a> <a href="#10765" title="object Browse.this.global.NoType" id="12689">NoType</a>) <a href="#20179" title="Browse.this.global.TypeSymbol">ts</a>.<a title="=&gt; Browse.this.global.Type" id="12163">info</a>
					<span class="keyword">else</span> <a href="#20180" title="Browse.this.global.Type">treeType</a>
				<span class="comment">//println(&quot;Type symbol &quot; + sym.id + &quot;: &quot; + typeString(sType))</span>
				<a href="#20118" title="browse.Token">token</a>.<a href="Token.scala.html#18356" title="(browse.TypeAttribute)Unit">tpe</a> = <a href="Token.scala.html#20131" title="(String,Option[browse.Link])browse.TypeAttribute">TypeAttribute</a>(<a href="#10777" title="(Browse.this.global.Type)String">typeString</a>(<a href="#20181" title="Browse.this.global.Type">sType</a>), <a href="#10779" title="(java.io.File,Browse.this.global.Symbol)Option[browse.Link]">linkTo</a>(<a href="#20119" title="java.io.File">sourceFile</a>, <a href="#20181" title="Browse.this.global.Type">sType</a>.<a title="=&gt; Browse.this.global.Symbol" id="12387">typeSymbol</a>))
			<span title="Unit" class="keyword">case</span> _ =&gt; <span title="Unit">(</span>)
		}
		<span title="Unit" class="keyword">if</span>(<a href="#20117" title="Browse.this.global.Tree">t</a>.<a title="=&gt; Boolean" id="15016">isDef</a>)
			<a href="#20118" title="browse.Token">token</a> <a href="Token.scala.html#18358" title="(Int)Unit">+=</a> <a href="#20169" title="Browse.this.global.Symbol">sym</a>.<a title="=&gt; Int" id="11903">id</a>
		<span class="keyword">else</span>
		{
			<a href="#10779" title="(java.io.File,Browse.this.global.Symbol)Option[browse.Link]">linkTo</a>(<a href="#20119" title="java.io.File">sourceFile</a>, <a href="#20169" title="Browse.this.global.Symbol">sym</a>) <span title="Unit" class="keyword">match</span>
			{
				<span title="Unit" class="keyword">case</span> <a id="1">Some</a>(<a title="browse.Link" id="20184">x</a>) =&gt; <a href="#20118" title="browse.Token">token</a>.<a href="Token.scala.html#18357" title="(browse.Link)Unit">reference</a> = <a href="#20184" title="browse.Link">x</a>
				<span title="Unit" class="keyword">case</span> <a title="object None" id="497">None</a> =&gt; <a href="#20118" title="browse.Token">token</a> <a href="Token.scala.html#18358" title="(Int)Unit">+=</a> <a href="#20169" title="Browse.this.global.Symbol">sym</a>.<a title="=&gt; Int" id="11903">id</a>
			}
		}
	}
	<span class="comment">/** Constructs a decoded fully qualified name for the given symbol. */</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Browse.this.global.Symbol)String" id="10776">fullName</a>(<a title="Browse.this.global.Symbol" id="20176">s</a>: <a title="Browse.this.global.Symbol" id="11886">Symbol</a>): <a title="String" id="1801">String</a> =
	{
		<span id="5933"><a title="(Boolean)Unit" id="779">require</a></span>(<a href="#20176" title="Browse.this.global.Symbol">s</a> <a title="(AnyRef)Boolean" id="5727">!=</a> <a href="#10765" title="object Browse.this.global.NoSymbol" id="12288">NoSymbol</a>)
		<span class="keyword">val</span> <a title="Browse.this.global.Symbol" id="20186">owner</a> = <a href="#20176" title="Browse.this.global.Symbol">s</a>.<a title="=&gt; Browse.this.global.Symbol" id="12128">owner</a>
		<span id="5933"><a title="(Boolean)Unit" id="779">require</a></span>(<a href="#20186" title="Browse.this.global.Symbol">owner</a> <a title="(AnyRef)Boolean" id="5727">!=</a> <a href="#10765" title="object Browse.this.global.NoSymbol" id="12288">NoSymbol</a>)
		<span title="String" class="keyword">if</span>(<a href="#20186" title="Browse.this.global.Symbol">owner</a>.<a title="=&gt; Boolean" id="12087">isRoot</a> <a title="(Boolean)Boolean" id="2693">||</a> <a href="#20186" title="Browse.this.global.Symbol">owner</a>.<a title="=&gt; Boolean" id="12090">isEmptyPackageClass</a>)
			<a href="#20176" title="Browse.this.global.Symbol">s</a>.<a title="=&gt; String" id="12242">nameString</a>
		<span class="keyword">else</span>
			<a href="#10776" title="(Browse.this.global.Symbol)String">fullName</a>(<a href="#20186" title="Browse.this.global.Symbol">owner</a>.<a title="=&gt; Browse.this.global.Symbol" id="12189">enclClass</a>) <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;.&quot;)" class="string">&quot;.&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#20176" title="Browse.this.global.Symbol">s</a>.<a title="=&gt; String" id="12242">nameString</a>
	}
	<span class="comment">/** Produces a string for the given type that should be informative, but brief.*/</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Browse.this.global.Type)String" id="10777">typeString</a>(<a title="Browse.this.global.Type" id="20142">t</a>: <a title="Browse.this.global.Type" id="12378">Type</a>): <a title="String" id="1801">String</a> =
	{
		<a href="#20142" title="Browse.this.global.Type">t</a> <span title="String" class="keyword">match</span>
		{
			<span title="java.lang.String" class="keyword">case</span> <a title="Browse.this.global.CompoundType" id="20191">ct</a>: <a title="Browse.this.global.CompoundType" id="12820">CompoundType</a> =&gt; <a href="#10778" title="(Browse.this.global.CompoundType,String)java.lang.String">compoundTypeString</a>(<a href="#20191" title="Browse.this.global.CompoundType">ct</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>)<span class="comment">// tries to reduce size of some type strings</span>
			<span title="String" class="keyword">case</span> <a title="Browse.this.global.PolyType" id="20203">pt</a>: <a title="Browse.this.global.PolyType" id="13043">PolyType</a> =&gt;
				<span class="keyword">import</span> pt._
				<span title="String" class="keyword">if</span>(<a href="#20203" title="=&gt; List[Browse.this.global.Symbol]" id="13044">typeParams</a>.<a title="=&gt; Boolean" id="11453">isEmpty</a>)
					<span title="java.lang.String(&quot;=&gt; &quot;)" class="string">&quot;=&gt; &quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#10777" title="(Browse.this.global.Type)String">typeString</a>(<a href="#20203" title="=&gt; Browse.this.global.Type" id="13046">resultType</a>)
				<span class="keyword">else</span>
				{
					<span class="keyword">val</span> <a title="String" id="20206">typeParameters</a> = <a href="#20203" title="=&gt; List[Browse.this.global.Symbol]" id="13044">typeParams</a>.<a title="((Browse.this.global.Symbol) =&gt; String)List[String]" id="11180">map</a>(<a href="#20209" title="Browse.this.global.Symbol">_</a>.<a title="=&gt; String" id="12251">defString</a>).<a title="(String,String,String)String" id="11627">mkString</a>(<span title="java.lang.String(&quot;[&quot;)" class="string">&quot;[&quot;</span>, <span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span>, <span title="java.lang.String(&quot;]&quot;)" class="string">&quot;]&quot;</span>)
					<a href="#20203" title="=&gt; Browse.this.global.Type" id="13046">resultType</a> <span title="String" class="keyword">match</span>
					{
						<span title="java.lang.String" class="keyword">case</span> <a title="Browse.this.global.CompoundType" id="20216">ct</a>: <a title="Browse.this.global.CompoundType" id="12820">CompoundType</a> =&gt; <a href="#10778" title="(Browse.this.global.CompoundType,String)java.lang.String">compoundTypeString</a>(<a href="#20216" title="Browse.this.global.CompoundType">ct</a>, <a href="#20206" title="String">typeParameters</a>)
						<span title="java.lang.String" class="keyword">case</span> _ =&gt; <a href="#20206" title="String">typeParameters</a> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#10777" title="(Browse.this.global.Type)String">typeString</a>(<a href="#20203" title="=&gt; Browse.this.global.Type" id="13046">resultType</a>)
					}
				}
			<span title="String" class="keyword">case</span> _ =&gt; <a href="#20142" title="Browse.this.global.Type">t</a>.<a title="()String" id="12498">toString</a>
		}
	}
	<span class="comment">/** Converts the given compound type to a string.  'mainPostfix' is copied after the main type symbol
	* but before any parents or refinements*/</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Browse.this.global.CompoundType,String)java.lang.String" id="10778">compoundTypeString</a>(<a title="Browse.this.global.CompoundType" id="20192">ct</a>: <a title="Browse.this.global.CompoundType" id="12820">CompoundType</a>, <a title="String" id="20193">mainPostfix</a>: <a title="String" id="1801">String</a>) =
	{
		<span class="keyword">import</span> ct._
		<a href="#20192" title="=&gt; Browse.this.global.Symbol" id="12387">typeSymbol</a>.<a title="()String" id="12246">toString</a> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#20193" title="String">mainPostfix</a> <a title="(Any)java.lang.String" id="5736">+</a>
		{
			<span title="Any" class="keyword">if</span>(<a href="#20192" title="Browse.this.global.CompoundType">ct</a>.<a title="=&gt; Browse.this.global.Symbol" id="12387">typeSymbol</a>.<a title="=&gt; Boolean" id="12086">isPackageClass</a>)
				<span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
			<span class="keyword">else</span> <span title="Any" class="keyword">if</span>(<a href="#20192" title="=&gt; List[Browse.this.global.Type]" id="12425">parents</a>.<a title="=&gt; Boolean" id="11453">isEmpty</a>)
			{
				<span title="Any" class="keyword">if</span>(<a href="#20192" title="=&gt; Browse.this.global.Scope" id="12443">decls</a>.<a title="=&gt; Boolean" id="13553">isEmpty</a>)
					<span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
				<span class="keyword">else</span>
					<a href="#20192" title="=&gt; Browse.this.global.Scope" id="12443">decls</a>.<a title="(String,String,String)String" id="13571">mkString</a>(<span title="java.lang.String(&quot;{&quot;)" class="string">&quot;{&quot;</span>, <span title="java.lang.String(&quot;; &quot;)" class="string">&quot;; &quot;</span>, <span title="java.lang.String(&quot;}&quot;)" class="string">&quot;}&quot;</span>)
			}
			<span class="keyword">else</span>
				<a href="#20192" title="=&gt; List[Browse.this.global.Type]" id="12425">parents</a>.<a title="(String,String,String)String" id="11627">mkString</a>(<span title="java.lang.String(&quot; extends &quot;)" class="string">&quot; extends &quot;</span>, <span title="java.lang.String(&quot; with &quot;)" class="string">&quot; with &quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>)
		}
	}

	<span class="comment">/** Generates a link usable in the file 'from' to the symbol 'to', which might be in some other file. */</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(java.io.File,Browse.this.global.Symbol)Option[browse.Link]" id="10779">linkTo</a>(<a title="java.io.File" id="20177">from</a>: <a title="java.io.File" id="3612">File</a>, <a title="Browse.this.global.Symbol" id="20178">sym</a>: <a title="Browse.this.global.Symbol" id="11886">Symbol</a>): <a title="Option[browse.Link]" id="889">Option</a>[Link] =
	{
		<span title="Option[browse.Link]" class="keyword">if</span>(<a href="#20178" title="Browse.this.global.Symbol">sym</a> <a title="(AnyRef)Boolean" id="3452">==</a> <a href="#10765" title="object Browse.this.global.NoSymbol" id="12288">NoSymbol</a>)
			<a title="object None" id="497">None</a>
		<span class="keyword">else</span>
		{
			<span class="keyword">val</span> <a title="scala.tools.nsc.io.AbstractFile" id="20219">source</a> = <a href="#20178" title="Browse.this.global.Symbol">sym</a>.<a title="=&gt; scala.tools.nsc.io.AbstractFile" id="12233">sourceFile</a>
			<span title="Option[browse.Link]" class="keyword">if</span>(<a href="#20219" title="scala.tools.nsc.io.AbstractFile">source</a> <a title="(AnyRef)Boolean" id="3452">==</a> <span title="Null(null)" class="keyword">null</span>)
				<a title="object None" id="497">None</a>
			<span class="keyword">else</span>
			{
				<span class="keyword">val</span> <a title="java.io.File" id="20221">file</a> = <a href="#20219" title="scala.tools.nsc.io.AbstractFile">source</a>.<a title="=&gt; java.io.File" id="17527">file</a>
				<span class="keyword">val</span> <a title="java.lang.String" id="20222">base</a> = <span title="java.lang.String" class="keyword">if</span>(<a href="#20221" title="java.io.File">file</a> <a title="(AnyRef)Boolean" id="3452">==</a> <a href="#20177" title="java.io.File">from</a>) <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <a href="FileUtil.scala.html#6223" title="object browse.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#17579" title="(java.io.File,java.io.File)String">relativePath</a>(<a href="#20177" title="java.io.File">from</a>, <a href="#20219" title="scala.tools.nsc.io.AbstractFile">source</a>.<a title="=&gt; java.io.File" id="17527">file</a>) <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;.html&quot;)" class="string">&quot;.html&quot;</span>
				<span id="19672"><a title="(browse.Link)Some[browse.Link]" id="278">Some</a></span>(<span title="browse.Link" class="keyword">new</span> <a href="Token.scala.html#6179" title="browse.Link">Link</a>(<a href="#20222" title="java.lang.String">base</a>, <a href="#20178" title="Browse.this.global.Symbol">sym</a>.<a title="=&gt; Int" id="11903">id</a>.<a title="()java.lang.String" id="3443">toString</a>))
			}
		}
	}
	<span class="comment">/** Relativizes the path to the given Scala source file to the base directory. */</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(java.io.File)String" id="10780">getRelativeSourcePath</a>(<a title="java.io.File" id="17545">source</a>: <a title="java.io.File" id="3612">File</a>): <a title="String" id="1801">String</a> =
	{
		<a href="#10764" title="=&gt; Option[java.io.File]">baseDirectory</a> <span title="String" class="keyword">match</span>
		{
			<span title="String" class="keyword">case</span> <a id="1">Some</a>(<a title="java.io.File" id="20227">base</a>) =&gt;
				<a href="FileUtil.scala.html#6223" title="object browse.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#17583" title="(java.io.File,java.io.File)Option[String]">relativize</a>(<a href="#20227" title="java.io.File">base</a>, <a href="#17545" title="java.io.File">source</a>) <span title="String" class="keyword">match</span>
				{
					<span title="String" class="keyword">case</span> <a id="1">Some</a>(<a title="String" id="20230">relative</a>) =&gt; <a href="#20230" title="String">relative</a>
					<span title="java.lang.String" class="keyword">case</span> <a title="object None" id="497">None</a> =&gt; <a href="#10765" title="(String)Unit" id="10856">error</a>(<span title="java.lang.String(&quot;Source &quot;)" class="string">&quot;Source &quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#17545" title="java.io.File">source</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot; not in base directory &quot;)" class="string">&quot; not in base directory &quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#20227" title="java.io.File">base</a>); <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
				}
			<span title="java.lang.String" class="keyword">case</span> <a title="object None" id="497">None</a> =&gt; <a href="#17545" title="java.io.File">source</a>.<a title="()java.lang.String" id="11665">getName</a>
		}
	}
}

<span class="keyword">object</span> <a title="object browse.Browse" id="6169">Browse</a>
{
	<span class="comment">/** The location to store the index relative to the output directory.*/</span>
	<span class="keyword">val</span> <span id="16183"><a title="java.lang.String" id="16182">IndexRelativePath</a></span> = <span title="java.lang.String(&quot;index.html&quot;)" class="string">&quot;index.html&quot;</span>
	<span class="comment">/** The location to store the style sheet relative to the output directory.*/</span>
	<span class="keyword">val</span> <span id="16185"><a title="java.lang.String" id="16184">CSSRelativePath</a></span> = <span title="java.lang.String(&quot;style.css&quot;)" class="string">&quot;style.css&quot;</span>
	<span class="comment">/** The location to store the script relative to the output directory.*/</span>
	<span class="keyword">val</span> <span id="16187"><a title="java.lang.String" id="16186">JSRelativePath</a></span> = <span title="java.lang.String(&quot;linked.js&quot;)" class="string">&quot;linked.js&quot;</span>
	<span class="comment">/** The path of the default style sheet resource.*/</span>
	<span class="keyword">val</span> <span id="16189"><a title="java.lang.String" id="16188">DefaultCSS</a></span> = <span title="java.lang.String(&quot;/default-style.css&quot;)" class="string">&quot;/default-style.css&quot;</span>
	<span class="comment">/** The path of the default script resource.*/</span>
	<span class="keyword">val</span> <span id="16191"><a title="java.lang.String" id="16190">LinkedJS</a></span> = <span title="java.lang.String(&quot;/linked.js&quot;)" class="string">&quot;/linked.js&quot;</span>
	
	<span class="comment">/** Copies the default style sheet available as a resource on the classpath to the file 'to'.*/</span>
	<span class="keyword">def</span> <a title="(java.io.File)Unit" id="16192">writeDefaultCSS</a>(<a title="java.io.File" id="17301">to</a>: <a title="java.io.File" id="3612">File</a>) { <a href="FileUtil.scala.html#6223" title="object browse.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#17580" title="(String,java.io.File)Unit">writeResource</a>(<a href="#16188" title="=&gt; java.lang.String">DefaultCSS</a>, <a href="#17301" title="java.io.File">to</a>) }
	<span class="comment">/** Copies the default script available as a resource on the classpath to the file 'to'.*/</span>
	<span class="keyword">def</span> <a title="(java.io.File)Unit" id="16193">writeJS</a>(<a title="java.io.File" id="17302">to</a>: <a title="java.io.File" id="3612">File</a>) { <a href="FileUtil.scala.html#6223" title="object browse.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#17580" title="(String,java.io.File)Unit">writeResource</a>(<a href="#16190" title="=&gt; java.lang.String">LinkedJS</a>, <a href="#17302" title="java.io.File">to</a>) }
	
	<span class="keyword">def</span> <a title="(java.io.File,Iterable[java.io.File])Unit" id="16194">writeIndex</a>(<a title="java.io.File" id="19458">to</a>: <a title="java.io.File" id="3612">File</a>, <a title="Iterable[java.io.File]" id="19459">files</a>: <a title="Iterable[java.io.File]" id="364">Iterable</a>[File])
	{
		<a href="FileUtil.scala.html#6223" title="object browse.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#17574" title="(java.io.File)((java.io.BufferedWriter) =&gt; Unit)Unit">withWriter</a>(<a href="#19458" title="java.io.File">to</a>) { <a title="java.io.BufferedWriter" id="20247">out</a> =&gt;
			<a href="#20247" title="java.io.BufferedWriter">out</a>.<a title="(java.lang.String)Unit" id="20254">write</a>(<span title="java.lang.String(&quot;&lt;html&gt;&lt;body&gt;&quot;)" class="string">&quot;&lt;html&gt;&lt;body&gt;&quot;</span>)
			<a href="#19459" title="Iterable[java.io.File]">files</a>.<a title="((java.io.File) =&gt; Unit)Unit" id="11601">foreach</a>(<a href="#16196" title="(java.io.File,java.io.Writer)(java.io.File)Unit">writeEntry</a>(<a href="#19458" title="java.io.File">to</a>, <a href="#20247" title="java.io.BufferedWriter">out</a>))
			<a href="#20247" title="java.io.BufferedWriter">out</a>.<a title="(java.lang.String)Unit" id="20254">write</a>(<span title="java.lang.String(&quot;&lt;/body&gt;&lt;/html&gt;&quot;)" class="string">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>)
		}
	}
	<span class="keyword">import</span> java.io.Writer
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(java.io.File,java.io.Writer)(java.io.File)Unit" id="16196">writeEntry</a>(<a title="java.io.File" id="20271">index</a>: <a title="java.io.File" id="3612">File</a>, <a title="java.io.Writer" id="20272">out</a>: <a title="java.io.Writer" id="3747">Writer</a>)(<a title="java.io.File" id="20273">file</a>: <a title="java.io.File" id="3612">File</a>)
	{
		<span class="keyword">for</span>(<span id="11724"><a title="((String) =&gt; Unit)Unit" id="20279">path</a></span> &lt;- <a href="FileUtil.scala.html#6223" title="object browse.FileUtil">FileUtil</a>.<a href="FileUtil.scala.html#17583" title="(java.io.File,java.io.File)Option[String]">relativize</a>(<a href="#20271" title="java.io.File">index</a>.<a title="()java.io.File" id="11667">getParentFile</a>, <a href="#20273" title="java.io.File">file</a>))
		{
			<a href="#20272" title="java.io.Writer">out</a>.<a title="(java.lang.String)Unit" id="20254">write</a>(<span title="java.lang.String(&quot;&lt;li&gt;&lt;a href=&quot;&quot;)" class="string">&quot;&lt;li&gt;&lt;a href=\&quot;&quot;</span>)
			<a href="#20272" title="java.io.Writer">out</a>.<a title="(java.lang.String)Unit" id="20254">write</a>(<a href="#20279" title="String">path</a>)
			<a href="#20272" title="java.io.Writer">out</a>.<a title="(java.lang.String)Unit" id="20254">write</a>(<span title="java.lang.String(&quot;&quot;&gt;&quot;)" class="string">&quot;\&quot;&gt;&quot;</span>)
			<span class="keyword">val</span> <a title="java.lang.String" id="20280">label</a> =
				<span title="java.lang.String" class="keyword">if</span>(<a href="#20279" title="String">path</a>.<a title="(java.lang.String)Boolean" id="5776">endsWith</a>(<span title="java.lang.String(&quot;.html&quot;)" class="string">&quot;.html&quot;</span>))
					<a href="#20279" title="String">path</a>.<a title="(Int,Int)java.lang.String" id="5789">substring</a>(<span title="Int(0)" class="int">0</span>, <a href="#20279" title="String">path</a>.<a title="()Int" id="5755">length</a> <a title="(Int)Int" id="3091">-</a> <span title="java.lang.String(&quot;.html&quot;)" class="string">&quot;.html&quot;</span>.<a title="()Int" id="5755">length</a>)
				<span class="keyword">else</span>
					<a href="#20279" title="String">path</a>
			<a href="#20272" title="java.io.Writer">out</a>.<a title="(java.lang.String)Unit" id="20254">write</a>(<a href="#20280" title="java.lang.String">label</a>)
			<a href="#20272" title="java.io.Writer">out</a>.<a title="(java.lang.String)Unit" id="20254">write</a>(<span title="java.lang.String(&quot;&lt;/a&gt;&lt;/li&gt;&quot;)" class="string">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span>)
		}
	}
}
        </pre>
    </body>
</html>