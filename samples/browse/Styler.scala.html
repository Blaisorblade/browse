<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Styler.scala</title>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* browse -- Scala Source Browser
 * Copyright 2009 Mark Harrah
 */</span>

<span class="keyword">package</span> browse

<span class="keyword">import</span> scala.collection.jcl.TreeSet
<span class="keyword">import</span> scala.tools.nsc.ast.parser.Tokens

<span class="keyword">private</span> <span class="keyword">trait</span> <a title="trait Styler extends java.lang.Object with NotNull" id="6193">Styler</a> <span class="keyword">extends</span> <a title="NotNull" id="181">NotNull</a>
{
	<span class="keyword">def</span> <a title="=&gt; String" id="19387">head</a>: <a title="String" id="1801">String</a>
	<span class="keyword">def</span> <a title="(browse.Token)List[browse.Annotation]" id="19388">apply</a>(<a title="browse.Token" id="20554">token</a>: <a href="Token.scala.html#6182" title="browse.Token">Token</a>): <a title="List[browse.Annotation]" id="487">List</a>[Annotation]
	<span class="keyword">def</span> <a title="=&gt; String" id="19389">tail</a>: <a title="String" id="1801">String</a>
}
<span class="keyword">private</span> <span class="keyword">case</span> <span class="keyword">class</span> <span id="20576"><span id="5728"><span id="20474"><span id="20575"><span id="3444"><span id="20586"><span id="20574"><span id="20473"><span id="3443"><span id="20572"><span id="20571"><span id="2694"><span id="20582"><span id="20585"><span id="20508"><span id="20588"><span id="6194"><span id="3452"><span id="20587"><span id="278"><span id="20568"><span id="20581"><span id="20569"><span id="1322"><span id="2693"><span id="20570"><span id="6195"><span id="19626"><a title="class Annotation extends java.lang.Object with NotNull with ScalaObject with Product" id="16287">Annotation</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span id="20559"><span id="20558"><span id="20566"><a title="String" id="21287">open</a></span></span></span>: <a title="String" id="1801">String</a>, <span id="20561"><span id="20560"><span id="20567"><a title="String" id="21288">close</a></span></span></span>: <a title="String" id="1801">String</a>) <span class="keyword">extends</span> <a title="NotNull" id="181">NotNull</a>

<span class="keyword">object</span> <a title="object browse.Classes" id="6197">Classes</a>
{
	<span class="keyword">val</span> <span id="20592"><a title="java.lang.String" id="20591">Keyword</a></span> = <span title="java.lang.String(&quot;keyword&quot;)" class="string">&quot;keyword&quot;</span>
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class BasicStyler extends java.lang.Object with browse.Styler with ScalaObject" id="6199">BasicStyler</a>(<span id="19394"><a title="scala.collection.jcl.TreeSet[browse.Token]" id="19405">tokens</a></span>: <a title="scala.collection.jcl.TreeSet[browse.Token]" id="10489">TreeSet</a>[Token], <span id="19395"><a title="String" id="19406">title</a></span>: <a title="String" id="1801">String</a>, <span id="19396"><a title="String" id="19407">baseStyle</a></span>: <a title="String" id="1801">String</a>, <span id="19397"><a title="String" id="19408">baseJs</a></span>: <a title="String" id="1801">String</a>) <span class="keyword">extends</span> <a href="#6193" title="browse.Styler">Styler</a>
{
	<span class="keyword">import</span> Classes._
	<span class="keyword">def</span> <a title="=&gt; String" id="19400">head</a> =
		(<span title="java.lang.String(&quot;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\012\011\011\011|&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;\012\011\011\011|    &lt;head&gt;\012\011\011\011|        &lt;title&gt;&quot;)" class="string">&quot;&quot;&quot;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
			|&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
			|    &lt;head&gt;
			|        &lt;title&gt;&quot;&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#19395" title="String">title</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&lt;/title&gt;\012\011\011\011|        &lt;script type=&quot;text/javascript&quot; src=&quot;)" class="string">&quot;&quot;&quot;&lt;/title&gt;
			|        &lt;script type=&quot;text/javascript&quot; src=&quot;&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <span title="Char('&quot;')" class="char">'&quot;'</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#19397" title="String">baseJs</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="Char('&quot;')" class="char">'&quot;'</span> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&gt;&lt;/script&gt;\012\011\011\011|        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;)" class="string">&quot;&quot;&quot;&gt;&lt;/script&gt;
			|        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <span title="Char('&quot;')" class="char">'&quot;'</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#19396" title="String">baseStyle</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="Char('&quot;')" class="char">'&quot;'</span> <span id="6065"><span id="779"><a title="implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString" id="5736">+</a></span></span> <span title="java.lang.String(&quot; title=&quot;Style&quot;&gt;\012\011\011\011|    &lt;/head&gt;\012\011\011\011|    &lt;body onload=&quot;initializeLinked()&quot;&gt;\012\011\011\011|        &lt;pre&gt;\012\011\011\011|&quot;)" class="string">&quot;&quot;&quot; title=&quot;Style&quot;&gt;
			|    &lt;/head&gt;
			|    &lt;body onload=&quot;initializeLinked()&quot;&gt;
			|        &lt;pre&gt;
			|&quot;&quot;&quot;</span>).<a title="=&gt; String" id="16435">stripMargin</a>
	<span class="keyword">def</span> <a title="=&gt; String" id="19401">tail</a> =
		<span id="6065"><a title="implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString" id="779" class="string">&quot;&quot;&quot;|
			|        &lt;/pre&gt;
			|    &lt;/body&gt;
		    |&lt;/html&gt;&quot;&quot;&quot;</a></span>.<a title="=&gt; String" id="16435">stripMargin</a>
	
	<span class="keyword">def</span> <a title="(browse.Token)List[browse.Annotation]" id="19402">apply</a>(<a title="browse.Token" id="20618">token</a>: <a href="Token.scala.html#6182" title="browse.Token">Token</a>) =
	{
		<span class="keyword">val</span> <a title="List[java.lang.String]" id="20620">styleClasses</a> = <a href="#19404" title="(Int)List[java.lang.String]">classes</a>(<a href="#20618" title="browse.Token">token</a>.<a href="Token.scala.html#18321" title="=&gt; Int">code</a>)
		<span title="List[browse.Annotation]" class="keyword">if</span>(<a href="#20618" title="browse.Token">token</a>.<a href="Token.scala.html#18335" title="=&gt; Boolean">isPlain</a> <a title="(Boolean)Boolean" id="2694">&amp;&amp;</a> <a href="#20620" title="List[java.lang.String]">styleClasses</a>.<a title="=&gt; Boolean" id="11453">isEmpty</a>)
			<a title="object Nil" id="302">Nil</a>
		<span class="keyword">else</span>
			<a href="#19403" title="(browse.Token,List[String])List[browse.Annotation]">annotateToken</a>(<a href="#20618" title="browse.Token">token</a>, <a href="#20620" title="List[java.lang.String]">styleClasses</a>)
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(browse.Token,List[String])List[browse.Annotation]" id="19403">annotateToken</a>(<a title="browse.Token" id="20651">token</a>: <a href="Token.scala.html#6182" title="browse.Token">Token</a>, <a title="List[String]" id="20652">styleClasses</a>: <a title="List[String]" id="487">List</a>[String]) =
	{
		<span class="keyword">val</span> <a title="java.lang.String" id="20654">tagName</a> = <span title="java.lang.String" class="keyword">if</span>(<a href="#20651" title="browse.Token">token</a>.<a href="Token.scala.html#18334" title="=&gt; Boolean">isSimple</a>) <span title="java.lang.String(&quot;span&quot;)" class="string">&quot;span&quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;a&quot;)" class="string">&quot;a&quot;</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[Int]" id="20655">definitions</a> = <span id="21245"><span id="5924"><a title="(Int*)scala.collection.immutable.Set[Int]" id="779">Set</a></span></span>(<a href="#20651" title="browse.Token">token</a>.<a href="Token.scala.html#18333" title="=&gt; List[Int]">definitions</a> : _*)
		<span class="keyword">val</span> <a title="Option[browse.Link]" id="20656">reference</a> = <a href="#20651" title="browse.Token">token</a>.<a href="Token.scala.html#18332" title="=&gt; Option[browse.Link]">reference</a>.<a title="((browse.Link) =&gt; Boolean)Option[browse.Link]" id="11723">filter</a>
			{ <a title="browse.Link" id="21249">link</a> =&gt;
				<span title="Boolean" class="keyword">if</span>(<a href="#21249" title="browse.Link">link</a> <a title="(AnyRef)Boolean" id="3452">==</a> <a href="Token.scala.html#6180" title="object browse.BlockLink">BlockLink</a>)
					<span title="Boolean(false)" class="keyword">false</span>
				<span class="keyword">else</span>
				{
					<span class="keyword">val</span> <a title="Int" id="21251">refID</a> = <a href="#21249" title="browse.Link">link</a>.<span id="6065"><a href="Token.scala.html#20101" title="implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString" id="779">target</a></span>.<a title="=&gt; Int" id="16701">toInt</a>
					<a title="=&gt; Boolean" id="2690">!</a><a href="#20655" title="scala.collection.immutable.Set[Int]">definitions</a>.<a title="(Int)Boolean" id="17631">contains</a>(<a href="#21251" title="Int">refID</a>)
				}
			}
		<span class="keyword">val</span> <a title="List[Int]" id="20657">definitionsList</a> = <a href="#20655" title="scala.collection.immutable.Set[Int]">definitions</a>.<a title="=&gt; List[Int]" id="11624">toList</a>
		<span class="keyword">val</span> <a title="List[String]" id="20658">attributes</a> = <a href="#20656" title="Option[browse.Link]">reference</a>.<a title="((browse.Link) =&gt; java.lang.String)Option[java.lang.String]" id="11719">map</a>(<span title="java.lang.String(&quot;href=&quot;&quot;)" class="string">&quot;href=\&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#21259" title="browse.Link">_</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>).<a title="=&gt; List[java.lang.String]" id="11728">toList</a> <a href="#21256" title="(List[String])List[String]" id="11157">:::</a>
			<a href="#20651" title="browse.Token">token</a>.<a href="Token.scala.html#18331" title="=&gt; Option[browse.TypeAttribute]">tpe</a>.<a title="((browse.TypeAttribute) =&gt; java.lang.String)Option[java.lang.String]" id="11719">map</a>(<a title="browse.TypeAttribute" id="21263">t</a> =&gt; <span title="java.lang.String(&quot;title=&quot;&quot;)" class="string">&quot;title=\&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="Escape.scala.html#20192" title="(String)String">Escape</a>(<a href="#21263" title="browse.TypeAttribute">t</a>.<a href="Token.scala.html#20088" title="=&gt; String">name</a>) <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>).<a title="=&gt; List[java.lang.String]" id="11728">toList</a> <a href="#21260" title="(List[String])List[String]" id="11157">:::</a>
			<a href="#20657" title="List[Int]">definitionsList</a>.<a title="=&gt; Option[Int]" id="11459">firstOption</a>.<a title="((Int) =&gt; java.lang.String)Option[java.lang.String]" id="11719">map</a>(<span title="java.lang.String(&quot;id=&quot;&quot;)" class="string">&quot;id=\&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#21267" title="Int">_</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>).<a title="=&gt; List[java.lang.String]" id="11728">toList</a> <a href="#21264" title="(List[String])List[String]" id="11157">:::</a>
			( <a href="#20652" title="List[String]">styleClasses</a> <span title="List[String]" class="keyword">match</span>
			{
				<span title="Nil.type" class="keyword">case</span> <a title="object Nil" id="302">Nil</a> =&gt; <a title="object Nil" id="302">Nil</a>
				<span title="List[String]" class="keyword">case</span> <a title="List[String]" id="21268">c</a> =&gt; <a href="#21268" title="List[String]">c</a>.<a title="(String,String,String)String" id="11627">mkString</a>(<span title="java.lang.String(&quot;class=&quot;&quot;)" class="string">&quot;class=\&quot;&quot;</span>, <span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span>, <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>) <a href="#21269" title="(String)List[String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			})
		<span class="keyword">val</span> <a title="List[browse.Annotation]" id="20659">extraIDs</a> = <span title="List[browse.Annotation]" class="keyword">if</span>(<a href="#20657" title="List[Int]">definitionsList</a>.<a title="=&gt; Boolean" id="11453">isEmpty</a>) <a title="object Nil" id="302">Nil</a> <span class="keyword">else</span> <a href="#20657" title="List[Int]">definitionsList</a>.<a title="=&gt; List[Int]" id="11152">tail</a>.<a title="((Int) =&gt; browse.Annotation)List[browse.Annotation]" id="11180">map</a>(<a title="Int" id="21286">id</a> =&gt; <a href="#20574" title="(String,String)browse.Annotation">Annotation</a>(<span title="java.lang.String(&quot;&lt;span id=&quot;&quot;)" class="string">&quot;&lt;span id=\&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#21286" title="Int">id</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&quot;&gt;&quot;)" class="string">&quot;\&quot;&gt;&quot;</span>,<span title="java.lang.String(&quot;&lt;/span&gt;&quot;)" class="string">&quot;&lt;/span&gt;&quot;</span>))
		<span class="keyword">val</span> <a title="browse.Annotation" id="20660">main</a> = <a href="#20574" title="(String,String)browse.Annotation">Annotation</a>(<span title="java.lang.String(&quot;&lt;&quot;)" class="string">&quot;&lt;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#20654" title="java.lang.String">tagName</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#20658" title="List[String]">attributes</a>.<a title="(String)String" id="11628">mkString</a>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>) <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&gt;&quot;)" class="string">&quot;&gt;&quot;</span>, <span title="java.lang.String(&quot;&lt;/&quot;)" class="string">&quot;&lt;/&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#20654" title="java.lang.String">tagName</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&gt;&quot;)" class="string">&quot;&gt;&quot;</span>)
		(<a href="#20660" title="browse.Annotation">main</a> <a href="#21290" title="(browse.Annotation)List[browse.Annotation]" id="11153">::</a> <a href="#20659" title="List[browse.Annotation]">extraIDs</a>).<a title="=&gt; List[browse.Annotation]" id="11203">reverse</a> <span class="comment">// ensure that the a is always the most nested</span>
		<span class="comment">//addType(token, (main :: extraIDs).reverse)</span>
	}
<span class="comment">/*	private def addType(token: Token, baseAnnotations: List[Annotation]) =
	{
		val typeSpan = token.tpe.map(t =&gt; &quot;&lt;span class=\&quot;type\&quot;&gt;&quot; + Escape(t.name) + &quot;&lt;/span&gt;&quot;).getOrElse(&quot;&quot;)
		if(typeSpan.isEmpty)
			baseAnnotations
		else
			Annotation(&quot;&quot;&quot;&lt;span class=&quot;typed&quot;&gt;&quot;&quot;&quot; + typeSpan, &quot;&lt;/span&gt;&quot;) :: baseAnnotations
	}*/</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Int)List[java.lang.String]" id="19404">classes</a>(<a title="Int" id="20621">code</a>: <a title="Int" id="2346">Int</a>) =
	{
		<span class="keyword">import</span> Tokens._
		<a href="#20621" title="Int">code</a> <span title="List[java.lang.String]" class="keyword">match</span>
		{
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(1)">CHARLIT</span> =&gt; <span title="java.lang.String(&quot;char&quot;)" class="string">&quot;char&quot;</span> <a href="#20624" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(2)">INTLIT</span> =&gt; <span title="java.lang.String(&quot;int&quot;)" class="string">&quot;int&quot;</span> <a href="#20627" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(3)">LONGLIT</span> =&gt; <span title="java.lang.String(&quot;long&quot;)" class="string">&quot;long&quot;</span> <a href="#20630" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(4)">FLOATLIT</span> =&gt; <span title="java.lang.String(&quot;float&quot;)" class="string">&quot;float&quot;</span> <a href="#20633" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(5)">DOUBLELIT</span> =&gt; <span title="java.lang.String(&quot;double&quot;)" class="string">&quot;double&quot;</span> <a href="#20636" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(6)">STRINGLIT</span> =&gt; <span title="java.lang.String(&quot;string&quot;)" class="string">&quot;string&quot;</span> <a href="#20639" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(7)">SYMBOLLIT</span> =&gt; <span title="java.lang.String(&quot;symbol&quot;)" class="string">&quot;symbol&quot;</span> <a href="#20642" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(97)">COMMENT</span> =&gt; <span title="java.lang.String(&quot;comment&quot;)" class="string">&quot;comment&quot;</span> <a href="#20645" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> _ =&gt;
				<span title="List[java.lang.String]" class="keyword">if</span>(<span id="19312"><a title="(Int)Boolean" id="8326">isKeyword</a></span>(<a href="#20621" title="Int">code</a>))
					<span title="java.lang.String(&quot;keyword&quot;)" class="string">&quot;keyword&quot;</span> <a href="#20648" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
				<span class="keyword">else</span>
					<a title="object Nil" id="302">Nil</a>
		}
	}
}
        </pre>
    </body>
</html>