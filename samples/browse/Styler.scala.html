<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Styler.scala</title>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* browse -- Scala Source Browser
 * Copyright 2009 Mark Harrah
 */</span>

<span class="keyword">package</span> browse

<span class="keyword">import</span> scala.collection.jcl.TreeSet
<span class="keyword">import</span> scala.tools.nsc.ast.parser.Tokens

<span class="keyword">private</span> <span class="keyword">trait</span> <a title="trait Styler extends java.lang.Object with NotNull" id="6193">Styler</a> <span class="keyword">extends</span> <a title="NotNull" id="181">NotNull</a>
{
	<span class="keyword">def</span> <a title="=&gt; String" id="19415">head</a>: <a title="String" id="1801">String</a>
	<span class="keyword">def</span> <a title="(browse.Token)List[browse.Annotation]" id="19416">apply</a>(<a title="browse.Token" id="20670">token</a>: <a href="Token.scala.html#6182" title="browse.Token">Token</a>): <a title="List[browse.Annotation]" id="487">List</a>[Annotation]
	<span class="keyword">def</span> <a title="=&gt; String" id="19417">tail</a>: <a title="String" id="1801">String</a>
}
<span class="keyword">private</span> <span class="keyword">case</span> <span class="keyword">class</span> <span id="20703"><span id="5728"><span id="16294"><span id="3444"><span id="20589"><span id="20687"><span id="20704"><span id="3443"><span id="20686"><span id="20590"><span id="2694"><span id="20624"><span id="6194"><span id="19672"><span id="20690"><span id="3452"><span id="278"><span id="20684"><span id="20697"><span id="1322"><span id="20691"><span id="20685"><span id="20702"><span id="20692"><span id="2693"><span id="20688"><span id="20701"><span id="20698"><a title="class Annotation extends java.lang.Object with NotNull with ScalaObject with Product" id="6195">Annotation</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span id="20675"><span id="20674"><span id="20682"><a title="String" id="21403">open</a></span></span></span>: <a title="String" id="1801">String</a>, <span id="20677"><span id="20676"><span id="20683"><a title="String" id="21404">close</a></span></span></span>: <a title="String" id="1801">String</a>) <span class="keyword">extends</span> <a title="NotNull" id="181">NotNull</a>

<span class="keyword">object</span> <a title="object browse.Classes" id="6197">Classes</a>
{
	<span class="keyword">val</span> <span id="20708"><a title="java.lang.String" id="20707">Keyword</a></span> = <span title="java.lang.String(&quot;keyword&quot;)" class="string">&quot;keyword&quot;</span>
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class BasicStyler extends java.lang.Object with browse.Styler with ScalaObject" id="6199">BasicStyler</a>(<span id="19422"><a title="scala.collection.jcl.TreeSet[browse.Token]" id="19433">tokens</a></span>: <a title="scala.collection.jcl.TreeSet[browse.Token]" id="10489">TreeSet</a>[Token], <span id="19423"><a title="String" id="19434">title</a></span>: <a title="String" id="1801">String</a>, <span id="19424"><a title="String" id="19435">baseStyle</a></span>: <a title="String" id="1801">String</a>, <span id="19425"><a title="String" id="19436">baseJs</a></span>: <a title="String" id="1801">String</a>) <span class="keyword">extends</span> <a href="#6193" title="browse.Styler">Styler</a>
{
	<span class="keyword">import</span> Classes._
	<span class="keyword">def</span> <a title="=&gt; String" id="19428">head</a> =
		(<span title="java.lang.String(&quot;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;\012\011\011\011|&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;\012\011\011\011|    &lt;head&gt;\012\011\011\011|        &lt;title&gt;&quot;)" class="string">&quot;&quot;&quot;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
			|&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
			|    &lt;head&gt;
			|        &lt;title&gt;&quot;&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#19423" title="String">title</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&lt;/title&gt;\012\011\011\011|        &lt;script type=&quot;text/javascript&quot; src=&quot;)" class="string">&quot;&quot;&quot;&lt;/title&gt;
			|        &lt;script type=&quot;text/javascript&quot; src=&quot;&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <span title="Char('&quot;')" class="char">'&quot;'</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#19425" title="String">baseJs</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="Char('&quot;')" class="char">'&quot;'</span> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&gt;&lt;/script&gt;\012\011\011\011|        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;)" class="string">&quot;&quot;&quot;&gt;&lt;/script&gt;
			|        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <span title="Char('&quot;')" class="char">'&quot;'</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#19424" title="String">baseStyle</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="Char('&quot;')" class="char">'&quot;'</span> <span id="6065"><span id="779"><a title="implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString" id="5736">+</a></span></span> <span title="java.lang.String(&quot; title=&quot;Style&quot;&gt;\012\011\011\011|    &lt;/head&gt;\012\011\011\011|    &lt;body onload=&quot;initializeLinked()&quot;&gt;\012\011\011\011|        &lt;pre&gt;\012\011\011\011|&quot;)" class="string">&quot;&quot;&quot; title=&quot;Style&quot;&gt;
			|    &lt;/head&gt;
			|    &lt;body onload=&quot;initializeLinked()&quot;&gt;
			|        &lt;pre&gt;
			|&quot;&quot;&quot;</span>).<a title="=&gt; String" id="16442">stripMargin</a>
	<span class="keyword">def</span> <a title="=&gt; String" id="19429">tail</a> =
		<span id="6065"><a title="implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString" id="779" class="string">&quot;&quot;&quot;|
			|        &lt;/pre&gt;
			|    &lt;/body&gt;
		    |&lt;/html&gt;&quot;&quot;&quot;</a></span>.<a title="=&gt; String" id="16442">stripMargin</a>
	
	<span class="keyword">def</span> <a title="(browse.Token)List[browse.Annotation]" id="19430">apply</a>(<a title="browse.Token" id="20734">token</a>: <a href="Token.scala.html#6182" title="browse.Token">Token</a>) =
	{
		<span class="keyword">val</span> <a title="List[java.lang.String]" id="20736">styleClasses</a> = <a href="#19432" title="(Int)List[java.lang.String]">classes</a>(<a href="#20734" title="browse.Token">token</a>.<a href="Token.scala.html#18349" title="=&gt; Int">code</a>)
		<span title="List[browse.Annotation]" class="keyword">if</span>(<a href="#20734" title="browse.Token">token</a>.<a href="Token.scala.html#18363" title="=&gt; Boolean">isPlain</a> <a title="(Boolean)Boolean" id="2694">&amp;&amp;</a> <a href="#20736" title="List[java.lang.String]">styleClasses</a>.<a title="=&gt; Boolean" id="11453">isEmpty</a>)
			<a title="object Nil" id="302">Nil</a>
		<span class="keyword">else</span>
			<a href="#19431" title="(browse.Token,List[String])List[browse.Annotation]">annotateToken</a>(<a href="#20734" title="browse.Token">token</a>, <a href="#20736" title="List[java.lang.String]">styleClasses</a>)
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(browse.Token,List[String])List[browse.Annotation]" id="19431">annotateToken</a>(<a title="browse.Token" id="20767">token</a>: <a href="Token.scala.html#6182" title="browse.Token">Token</a>, <a title="List[String]" id="20768">styleClasses</a>: <a title="List[String]" id="487">List</a>[String]) =
	{
		<span class="keyword">val</span> <a title="java.lang.String" id="20770">tagName</a> = <span title="java.lang.String" class="keyword">if</span>(<a href="#20767" title="browse.Token">token</a>.<a href="Token.scala.html#18362" title="=&gt; Boolean">isSimple</a>) <span title="java.lang.String(&quot;span&quot;)" class="string">&quot;span&quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;a&quot;)" class="string">&quot;a&quot;</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[Int]" id="20771">definitions</a> = <span id="21361"><span id="5924"><a title="(Int*)scala.collection.immutable.Set[Int]" id="779">Set</a></span></span>(<a href="#20767" title="browse.Token">token</a>.<a href="Token.scala.html#18361" title="=&gt; List[Int]">definitions</a> : _*)
		<span class="keyword">val</span> <a title="Option[browse.Link]" id="20772">reference</a> = <a href="#20767" title="browse.Token">token</a>.<a href="Token.scala.html#18360" title="=&gt; Option[browse.Link]">reference</a>.<a title="((browse.Link) =&gt; Boolean)Option[browse.Link]" id="11723">filter</a>
			{ <a title="browse.Link" id="21365">link</a> =&gt;
				<span title="Boolean" class="keyword">if</span>(<a href="#21365" title="browse.Link">link</a> <a title="(AnyRef)Boolean" id="3452">==</a> <a href="Token.scala.html#6180" title="object browse.BlockLink">BlockLink</a>)
					<span title="Boolean(false)" class="keyword">false</span>
				<span class="keyword">else</span>
				{
					<span class="keyword">val</span> <a title="Int" id="21367">refID</a> = <a href="#21365" title="browse.Link">link</a>.<span id="6065"><a href="Token.scala.html#20147" title="implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString" id="779">target</a></span>.<a title="=&gt; Int" id="16708">toInt</a>
					<a title="=&gt; Boolean" id="2690">!</a><a href="#20771" title="scala.collection.immutable.Set[Int]">definitions</a>.<a title="(Int)Boolean" id="17659">contains</a>(<a href="#21367" title="Int">refID</a>)
				}
			}
		<span class="keyword">val</span> <a title="List[Int]" id="20773">definitionsList</a> = <a href="#20771" title="scala.collection.immutable.Set[Int]">definitions</a>.<a title="=&gt; List[Int]" id="11624">toList</a>
		<span class="keyword">val</span> <a title="List[String]" id="20774">attributes</a> = <a href="#20772" title="Option[browse.Link]">reference</a>.<a title="((browse.Link) =&gt; java.lang.String)Option[java.lang.String]" id="11719">map</a>(<span title="java.lang.String(&quot;href=&quot;&quot;)" class="string">&quot;href=\&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#21375" title="browse.Link">_</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>).<a title="=&gt; List[java.lang.String]" id="11728">toList</a> <a href="#21372" title="(List[String])List[String]" id="11157">:::</a>
			<a href="#20767" title="browse.Token">token</a>.<a href="Token.scala.html#18359" title="=&gt; Option[browse.TypeAttribute]">tpe</a>.<a title="((browse.TypeAttribute) =&gt; java.lang.String)Option[java.lang.String]" id="11719">map</a>(<a title="browse.TypeAttribute" id="21379">t</a> =&gt; <span title="java.lang.String(&quot;title=&quot;&quot;)" class="string">&quot;title=\&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="Escape.scala.html#20317" title="(String)String">Escape</a>(<a href="#21379" title="browse.TypeAttribute">t</a>.<a href="Token.scala.html#20134" title="=&gt; String">name</a>) <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>).<a title="=&gt; List[java.lang.String]" id="11728">toList</a> <a href="#21376" title="(List[String])List[String]" id="11157">:::</a>
			<a href="#20773" title="List[Int]">definitionsList</a>.<a title="=&gt; Option[Int]" id="11459">firstOption</a>.<a title="((Int) =&gt; java.lang.String)Option[java.lang.String]" id="11719">map</a>(<span title="java.lang.String(&quot;id=&quot;&quot;)" class="string">&quot;id=\&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#21383" title="Int">_</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>).<a title="=&gt; List[java.lang.String]" id="11728">toList</a> <a href="#21380" title="(List[String])List[String]" id="11157">:::</a>
			( <a href="#20768" title="List[String]">styleClasses</a> <span title="List[String]" class="keyword">match</span>
			{
				<span title="Nil.type" class="keyword">case</span> <a title="object Nil" id="302">Nil</a> =&gt; <a title="object Nil" id="302">Nil</a>
				<span title="List[String]" class="keyword">case</span> <a title="List[String]" id="21384">c</a> =&gt; <a href="#21384" title="List[String]">c</a>.<a title="(String,String,String)String" id="11627">mkString</a>(<span title="java.lang.String(&quot;class=&quot;&quot;)" class="string">&quot;class=\&quot;&quot;</span>, <span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span>, <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>) <a href="#21385" title="(String)List[String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			})
		<span class="keyword">val</span> <a title="List[browse.Annotation]" id="20775">extraIDs</a> = <span title="List[browse.Annotation]" class="keyword">if</span>(<a href="#20773" title="List[Int]">definitionsList</a>.<a title="=&gt; Boolean" id="11453">isEmpty</a>) <a title="object Nil" id="302">Nil</a> <span class="keyword">else</span> <a href="#20773" title="List[Int]">definitionsList</a>.<a title="=&gt; List[Int]" id="11152">tail</a>.<a title="((Int) =&gt; browse.Annotation)List[browse.Annotation]" id="11180">map</a>(<a title="Int" id="21402">id</a> =&gt; <a href="#20690" title="(String,String)browse.Annotation">Annotation</a>(<span title="java.lang.String(&quot;&lt;span id=&quot;&quot;)" class="string">&quot;&lt;span id=\&quot;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#21402" title="Int">id</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&quot;&gt;&quot;)" class="string">&quot;\&quot;&gt;&quot;</span>,<span title="java.lang.String(&quot;&lt;/span&gt;&quot;)" class="string">&quot;&lt;/span&gt;&quot;</span>))
		<span class="keyword">val</span> <a title="browse.Annotation" id="20776">main</a> = <a href="#20690" title="(String,String)browse.Annotation">Annotation</a>(<span title="java.lang.String(&quot;&lt;&quot;)" class="string">&quot;&lt;&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#20770" title="java.lang.String">tagName</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#20774" title="List[String]">attributes</a>.<a title="(String)String" id="11628">mkString</a>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>) <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&gt;&quot;)" class="string">&quot;&gt;&quot;</span>, <span title="java.lang.String(&quot;&lt;/&quot;)" class="string">&quot;&lt;/&quot;</span> <a title="(Any)java.lang.String" id="5736">+</a> <a href="#20770" title="java.lang.String">tagName</a> <a title="(Any)java.lang.String" id="5736">+</a> <span title="java.lang.String(&quot;&gt;&quot;)" class="string">&quot;&gt;&quot;</span>)
		(<a href="#20776" title="browse.Annotation">main</a> <a href="#21406" title="(browse.Annotation)List[browse.Annotation]" id="11153">::</a> <a href="#20775" title="List[browse.Annotation]">extraIDs</a>).<a title="=&gt; List[browse.Annotation]" id="11203">reverse</a> <span class="comment">// ensure that the a is always the most nested</span>
		<span class="comment">//addType(token, (main :: extraIDs).reverse)</span>
	}
<span class="comment">/*	private def addType(token: Token, baseAnnotations: List[Annotation]) =
	{
		val typeSpan = token.tpe.map(t =&gt; &quot;&lt;span class=\&quot;type\&quot;&gt;&quot; + Escape(t.name) + &quot;&lt;/span&gt;&quot;).getOrElse(&quot;&quot;)
		if(typeSpan.isEmpty)
			baseAnnotations
		else
			Annotation(&quot;&quot;&quot;&lt;span class=&quot;typed&quot;&gt;&quot;&quot;&quot; + typeSpan, &quot;&lt;/span&gt;&quot;) :: baseAnnotations
	}*/</span>
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Int)List[java.lang.String]" id="19432">classes</a>(<a title="Int" id="20737">code</a>: <a title="Int" id="2346">Int</a>) =
	{
		<span class="keyword">import</span> Tokens._
		<a href="#20737" title="Int">code</a> <span title="List[java.lang.String]" class="keyword">match</span>
		{
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(1)">CHARLIT</span> =&gt; <span title="java.lang.String(&quot;char&quot;)" class="string">&quot;char&quot;</span> <a href="#20740" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(2)">INTLIT</span> =&gt; <span title="java.lang.String(&quot;int&quot;)" class="string">&quot;int&quot;</span> <a href="#20743" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(3)">LONGLIT</span> =&gt; <span title="java.lang.String(&quot;long&quot;)" class="string">&quot;long&quot;</span> <a href="#20746" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(4)">FLOATLIT</span> =&gt; <span title="java.lang.String(&quot;float&quot;)" class="string">&quot;float&quot;</span> <a href="#20749" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(5)">DOUBLELIT</span> =&gt; <span title="java.lang.String(&quot;double&quot;)" class="string">&quot;double&quot;</span> <a href="#20752" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(6)">STRINGLIT</span> =&gt; <span title="java.lang.String(&quot;string&quot;)" class="string">&quot;string&quot;</span> <a href="#20755" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(7)">SYMBOLLIT</span> =&gt; <span title="java.lang.String(&quot;symbol&quot;)" class="string">&quot;symbol&quot;</span> <a href="#20758" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> <span title="Int(97)">COMMENT</span> =&gt; <span title="java.lang.String(&quot;comment&quot;)" class="string">&quot;comment&quot;</span> <a href="#20761" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
			<span title="List[java.lang.String]" class="keyword">case</span> _ =&gt;
				<span title="List[java.lang.String]" class="keyword">if</span>(<span id="19340"><a title="(Int)Boolean" id="8326">isKeyword</a></span>(<a href="#20737" title="Int">code</a>))
					<span title="java.lang.String(&quot;keyword&quot;)" class="string">&quot;keyword&quot;</span> <a href="#20764" title="(java.lang.String)List[java.lang.String]" id="11153">::</a> <a title="object Nil" id="302">Nil</a>
				<span class="keyword">else</span>
					<a title="object Nil" id="302">Nil</a>
		}
	}
}
        </pre>
    </body>
</html>