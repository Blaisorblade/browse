<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/Interpreter.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */
// $Id: Interpreter.scala 18610 2009-08-30 20:42:17Z extempore $

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> java.io.{ File, PrintWriter, StringWriter, Writer }
<span class="keyword">import</span> java.lang.{ Class, ClassLoader }
<span class="keyword">import</span> java.net.{ MalformedURLException, URL }
<span class="keyword">import</span> java.lang.reflect
<span class="keyword">import</span> reflect.InvocationTargetException

<span class="keyword">import</span> scala.collection.immutable.ListSet
<span class="keyword">import</span> scala.collection.mutable
<span class="keyword">import</span> scala.collection.mutable.{ ListBuffer, HashSet, ArrayBuffer }
<span class="keyword">import</span> scala.util.{ ScalaClassLoader, URLClassLoader }
<span class="keyword">import</span> scala.util.control.Exception.{ Catcher, catching, ultimately, unwrapping }

<span class="keyword">import</span> io.{ PlainFile, VirtualDirectory }
<span class="keyword">import</span> reporters.{ ConsoleReporter, Reporter }
<span class="keyword">import</span> symtab.{ Flags, Names }
<span class="keyword">import</span> util.{ SourceFile, BatchSourceFile, ClassPath }
<span class="keyword">import</span> scala.util.NameTransformer
<span class="keyword">import</span> scala.tools.nsc.{ InterpreterResults =&gt; IR }
<span class="keyword">import</span> interpreter._
<span class="keyword">import</span> Interpreter._

/** &lt;p&gt;
 *    An interpreter for Scala code.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    The main public entry points are &lt;code&gt;compile()&lt;/code&gt;,
 *    &lt;code&gt;interpret()&lt;/code&gt;, and &lt;code&gt;bind()&lt;/code&gt;.
 *    The &lt;code&gt;compile()&lt;/code&gt; method loads a
 *    complete Scala file.  The &lt;code&gt;interpret()&lt;/code&gt; method executes one
 *    line of Scala code at the request of the user.  The &lt;code&gt;bind()&lt;/code&gt;
 *    method binds an object to a variable that can then be used by later
 *    interpreted code.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    The overall approach is based on compiling the requested code and then
 *    using a Java classloader and Java reflection to run the code
 *    and access its results.
 *  &lt;/p&gt;
 *  &lt;p&gt;  
 *    In more detail, a single compiler instance is used
 *    to accumulate all successfully compiled or interpreted Scala code.  To
 *    &quot;interpret&quot; a line of code, the compiler generates a fresh object that
 *    includes the line of code and which has public member(s) to export
 *    all variables defined by that code.  To extract the result of an
 *    interpreted line to show the user, a second &quot;result object&quot; is created
 *    which imports the variables exported by the above object and then
 *    exports a single member named &quot;result&quot;.  To accomodate user expressions
 *    that read from variables or methods defined in previous statements, &quot;import&quot;
 *    statements are used.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    This interpreter shares the strengths and weaknesses of using the
 *    full compiler-to-Java.  The main strength is that interpreted code
 *    behaves exactly as does compiled code, including running at full speed.
 *    The main weakness is that redefining classes and methods is not handled
 *    properly, because rebinding at the Java level is technically difficult.
 *  &lt;/p&gt;
 *
 * @author Moez A. Abdel-Gawad
 * @author Lex Spoon
 */
<span class="keyword">class</span> <a title="class Interpreter extends java.lang.Object with ScalaObject" id="8370">Interpreter</a><span title="ScalaObject">(</span><span class="keyword">val</span> <a title="scala.tools.nsc.Settings" id="117559">settings</a>: <a href="Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>, <a title="java.io.PrintWriter" id="117560">out</a>: <span title="java.io.PrintWriter">PrintWriter</span>)
{
  /** directory to save .class files to */
  <span class="keyword">val</span> <a title="scala.tools.nsc.io.VirtualDirectory" id="117189">virtualDirectory</a> = <span title="scala.tools.nsc.io.VirtualDirectory" class="keyword">new</span> <a href="io/VirtualDirectory.scala.html#20578" title="scala.tools.nsc.io.VirtualDirectory">VirtualDirectory</a>(<span title="java.lang.String(&quot;(memory)&quot;)" class="string">&quot;(memory)&quot;</span>, <span title="object None">None</span>)

  /** the compiler to compile expressions with */
  <span class="keyword">val</span> <a title="scala.tools.nsc.Global" id="117191">compiler</a>: <a href="Global.scala.html#8460" title="scala.tools.nsc.Global">Global</a> = <a href="#117208" title="(settings: scala.tools.nsc.Settings,reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global">newCompiler</a>(<a href="#117559" title="=&gt; scala.tools.nsc.Settings">settings</a>, <a href="#117206" title="object Interpreter.this.reporter">reporter</a>)

  <span class="keyword">import</span> compiler.{ Traverser, CompilationUnit, Symbol, Name, Type }
  <span class="keyword">import</span> compiler.{ 
    Tree, TermTree, ValOrDefDef, ValDef, DefDef, Assign, ClassDef,
    ModuleDef, Ident, Select, TypeDef, Import, MemberDef, DocDef }
  <span class="keyword">import</span> compiler.{ nme, newTermName }
  <span class="keyword">import</span> nme.{ 
    INTERPRETER_VAR_PREFIX, INTERPRETER_SYNTHVAR_PREFIX, INTERPRETER_LINE_PREFIX,
    INTERPRETER_IMPORT_WRAPPER, INTERPRETER_WRAPPER_SUFFIX, USCOREkw
  }
  
  /** construct an interpreter that reports to Console */
  <span class="keyword">def</span> <a title="(settings: scala.tools.nsc.Settings)scala.tools.nsc.Interpreter" id="117197" class="keyword">this</a>(<a title="scala.tools.nsc.Settings" id="117595">settings</a>: <a href="Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>) =
    <a href="#8370" title="Interpreter.this.type" class="keyword">this</a>(<a href="#117595" title="scala.tools.nsc.Settings">settings</a>, <span title="scala.tools.nsc.NewLinePrintWriter" class="keyword">new</span> <a href="NewLinePrintWriter.scala.html#8856" title="scala.tools.nsc.NewLinePrintWriter">NewLinePrintWriter</a>(<span title="scala.tools.nsc.ConsoleWriter" class="keyword">new</span> <a href="ConsoleWriter.scala.html#9411" title="scala.tools.nsc.ConsoleWriter">ConsoleWriter</a>, <span title="Boolean(true)" class="keyword">true</span>))

  /** whether to print out result lines */
  <span class="keyword">private</span>[nsc] <span class="keyword">var</span> <a title="Boolean" id="117199">printResults</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>

  /** Temporarily be quiet */
  <span class="keyword">def</span> <a title="[T](operation: =&gt; T)T" id="117201">beQuietDuring</a>[<a title="&gt;: Nothing &lt;: Any" id="117203">T</a>](<a title="=&gt; T" id="117648">operation</a>: =&gt; T): <a href="#117203" title="T">T</a> = {    
    <span class="keyword">val</span> <a title="Boolean" id="117651">wasPrinting</a> = <a href="#117199" title="=&gt; Boolean">printResults</a>    
    <a title="(body: =&gt; Unit)util.control.Exception.Catch[Nothing]" id="117149">ultimately</a><span title="(body: =&gt; T)T">(</span><a href="#117199" title="(x$1: Boolean)Unit">printResults</a> = <a href="#117651" title="Boolean">wasPrinting</a>) {
      <a href="#117199" title="(x$1: Boolean)Unit">printResults</a> = <span title="Boolean(false)" class="keyword">false</span>
      <a href="#117648" title="=&gt; T">operation</a>
    }
  }

  /** interpreter settings */
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.InterpreterSettings" id="117205">isettings</a> = <span title="scala.tools.nsc.InterpreterSettings" class="keyword">new</span> <a href="InterpreterSettings.scala.html#8412" title="scala.tools.nsc.InterpreterSettings">InterpreterSettings</a>

  <span class="keyword">object</span> <a title="object Interpreter.this.reporter" id="117206">reporter</a> <span title="ScalaObject" class="keyword">extends</span> <a href="reporters/ConsoleReporter.scala.html#13099" title="scala.tools.nsc.reporters.ConsoleReporter">ConsoleReporter</a>(<a href="#117559" title="=&gt; scala.tools.nsc.Settings">settings</a>, <span title="Null(null)" class="keyword">null</span>, <a href="#117560" title="java.io.PrintWriter">out</a>) {
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(msg: String)Unit" id="117592">printMessage</a>(<a title="String" id="117703">msg</a>: <span title="String">String</span>) {
      <a href="#117560" title="java.io.PrintWriter">out</a>.<span title="(x$1: java.lang.String)Unit">print</span>(<a href="#117235" title="(str: String)String">clean</a><span title="(x$1: Any)java.lang.String">(</span><a href="#117703" title="String">msg</a>) + <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>); <a href="#117560" title="java.io.PrintWriter">out</a>.<span title="()Unit">flush</span>()
    }
  }

  /** Instantiate a compiler.  Subclasses can override this to
   *  change the compiler class used by this interpreter. */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(settings: scala.tools.nsc.Settings,reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global" id="117208">newCompiler</a>(<a title="scala.tools.nsc.Settings" id="117565">settings</a>: <a href="Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>, <a title="scala.tools.nsc.reporters.Reporter" id="117566">reporter</a>: <a href="reporters/Reporter.scala.html#13075" title="scala.tools.nsc.reporters.Reporter">Reporter</a>) = {
    <a href="#117565" title="scala.tools.nsc.Settings">settings</a>.<a href="Settings.scala.html#37782" title="(dir: scala.tools.nsc.io.AbstractFile)Unit">outputDirs</a> setSingleOutput <a href="#117189" title="=&gt; scala.tools.nsc.io.VirtualDirectory">virtualDirectory</a>    
    <span title="scala.tools.nsc.Global" class="keyword">new</span> <a href="Global.scala.html#8460" title="scala.tools.nsc.Global">Global</a>(<a href="#117565" title="scala.tools.nsc.Settings">settings</a>, <a href="#117566" title="scala.tools.nsc.reporters.Reporter">reporter</a>)
  }
  
  /** the compiler's classpath, as URL's */
  <span class="keyword">val</span> <a title="List[java.net.URL]" id="117209">compilerClasspath</a>: <span title="List[java.net.URL]">List</span>[URL] = {
    <span class="keyword">import</span> scala.net.Utility.parseURL
    <span class="keyword">val</span> <a title="List[java.net.URL]" id="117735">classpathPart</a> = 
      <a href="util/ClassPath.scala.html#14720" title="object scala.tools.nsc.util.ClassPath">ClassPath</a>.<a href="util/ClassPath.scala.html#117752" title="(path: String)List[String]">expandPath</a>(<a href="#117191" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39018" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="Settings.scala.html#37036" title="=&gt; scala.tools.nsc.Settings.StringSetting">classpath</a>.<a href="Settings.scala.html#37759" title="=&gt; java.lang.String">value</a>).<span title="(f: (String) =&gt; java.net.URL)(implicit bf: scala.collection.generic.BuilderFactory[java.net.URL,List[java.net.URL],List[String]])List[java.net.URL]">map</span><span title="scala.collection.generic.BuilderFactory[java.net.URL,List[java.net.URL],List#Coll]">(</span><a title="String" id="117773">s</a> =&gt; <span title="java.io.File" class="keyword">new</span> <a title="java.io.File" id="3807">File</a>(<a href="#117773" title="String">s</a>).<a title="()java.net.URL" id="35188">toURL</a>)
      
    <span class="keyword">val</span> <a title="List[java.net.URL]" id="117736">codebasePart</a> = (<a href="#117191" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39018" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="Settings.scala.html#37144" title="=&gt; scala.tools.nsc.Settings.StringSetting">Xcodebase</a>.<a href="Settings.scala.html#37759" title="=&gt; java.lang.String">value</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)).<span title="(f: (java.lang.String) =&gt; Traversable[java.net.URL])(implicit bf: scala.collection.generic.BuilderFactory[java.net.URL,List[java.net.URL],List[java.lang.String]])List[java.net.URL]">toList</span> <span title="scala.collection.generic.BuilderFactory[java.net.URL,List[java.net.URL],List#Coll]">flatMap</span> <a href="#117875" title="(xo: Option[java.net.URL])Iterable[java.net.URL]" id="117738">parseURL</a>
    <a href="#117735" title="List[java.net.URL]">classpathPart</a> <a href="#117970" title="List[java.net.URL]">:::</a> <a href="#117736" title="(prefix: List[java.net.URL])List[java.net.URL]" id="24261">codebasePart</a>
  }

  /* A single class loader is used for all commands interpreted by this Interpreter.
     It would also be possible to create a new class loader for each command
     to interpret.  The advantages of the current approach are:

       - Expressions are only evaluated one time.  This is especially
         significant for I/O, e.g. &quot;val x = Console.readLine&quot;

     The main disadvantage is:

       - Objects, classes, and methods cannot be rebound.  Instead, definitions
         shadow the old ones, and old code objects refer to the old
         definitions.
  */
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="scala.util.ScalaClassLoader" id="117212">classLoader</a>: <span title="scala.util.ScalaClassLoader">ScalaClassLoader</span> = <a href="#117214" title="()scala.util.ScalaClassLoader">makeClassLoader</a>()
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()scala.util.ScalaClassLoader" id="117214">makeClassLoader</a>(): <span title="scala.util.ScalaClassLoader">ScalaClassLoader</span> = {
    <span class="keyword">val</span> <a title="scala.util.URLClassLoader" id="117981">parent</a> =
      <span title="scala.util.URLClassLoader" class="keyword">if</span> (<a href="#117217" title="(x$1: AnyRef)Boolean">parentClassLoader</a> == <span title="Null(null)" class="keyword">null</span>)  <a title="(urls: Seq[java.net.URL])scala.util.URLClassLoader" id="27737">ScalaClassLoader</a> fromURLs <a href="#117209" title="=&gt; List[java.net.URL]">compilerClasspath</a>
      <span class="keyword">else</span>                            <span title="scala.util.URLClassLoader" class="keyword">new</span> <a title="scala.util.URLClassLoader" id="27718">URLClassLoader</a>(<a href="#117209" title="=&gt; List[java.net.URL]">compilerClasspath</a>, <a href="#117217" title="=&gt; java.lang.ClassLoader">parentClassLoader</a>)

    <span title="scala.tools.nsc.interpreter.AbstractFileClassLoader" class="keyword">new</span> <a href="interpreter/AbstractFileClassLoader.scala.html#22183" title="scala.tools.nsc.interpreter.AbstractFileClassLoader">AbstractFileClassLoader</a>(<a href="#117189" title="=&gt; scala.tools.nsc.io.VirtualDirectory">virtualDirectory</a>, <a href="#117981" title="scala.util.URLClassLoader">parent</a>)
  }
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String)java.lang.Class[_]" id="117215">loadByName</a>(<a title="String" id="118859">s</a>: <span title="String">String</span>): <span title="java.lang.Class[_]">Class</span>[_] = (<a href="#117212" title="(path: String)Option[Class[Nothing]]">classLoader</a> tryToInitializeClass <a href="#118859" title="String">s</a>).<span title="=&gt; Class[Nothing]">get</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(c: java.lang.Class[_],name: String)java.lang.reflect.Method" id="117216">methodByName</a>(<a title="java.lang.Class[_]" id="118872">c</a>: <span title="java.lang.Class[_]">Class</span>[_], <a title="String" id="118873">name</a>: <span title="String">String</span>): reflect.<span title="java.lang.reflect.Method">Method</span> =
    <a href="#118872" title="java.lang.Class[_]">c</a>.<span title="(x$1: java.lang.String,x$2: java.lang.Class[_]*)java.lang.reflect.Method">getMethod</span>(<a href="#118873" title="String">name</a>, classOf<span title="java.lang.Class[java.lang.Object]">[</span>Object])
  
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; java.lang.ClassLoader" id="117217">parentClassLoader</a>: <a title="java.lang.ClassLoader" id="1470">ClassLoader</a> = <a href="#8370" title="Interpreter.this.type" class="keyword">this</a>.<span title="()java.lang.Class[_]">getClass</span>.<a title="()java.lang.ClassLoader" id="4110">getClassLoader</a>()  

  // Set the current Java &quot;context&quot; class loader to this interpreter's class loader
  <span class="keyword">def</span> <a title="()Unit" id="117218">setContextClassLoader</a>() = <a href="#117212" title="=&gt; scala.util.ScalaClassLoader">classLoader</a>.<a title="()Unit" id="117422">setAsContext</a>()

  /** the previous requests this interpreter has processed */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]" id="117219">prevRequests</a> = <a title="()scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]" id="108542" class="keyword">new</a> <a title="scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]" id="24996">ArrayBuffer</a>[Request]()
  <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[Interpreter.this.compiler.Import]" id="117221">prevImports</a> = <span title="scala.collection.mutable.ListBuffer[Interpreter.this.compiler.Import]" class="keyword">new</span> <a title="scala.collection.mutable.ListBuffer[Interpreter.this.compiler.Import]" id="24819">ListBuffer</a>[Import]()
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="117223">allUsedNames</a> = <a href="#117219" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<span title="=&gt; List[Interpreter.this.Request]">toList</span>.<span title="(f: (Interpreter.this.Request) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.Request]])List[Interpreter.this.compiler.Name]">flatMap</span><span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">(</span><a href="#118960" title="Interpreter.this.Request">_</a>.<a href="#118976" title="=&gt; List[Interpreter.this.compiler.Name]">usedNames</a>).<span title="=&gt; List[Interpreter.this.compiler.Name]">removeDuplicates</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="117224">allBoundNames</a> = <a href="#117219" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<span title="=&gt; List[Interpreter.this.Request]">toList</span>.<span title="(f: (Interpreter.this.Request) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.Request]])List[Interpreter.this.compiler.Name]">flatMap</span><span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">(</span><a href="#119087" title="Interpreter.this.Request">_</a>.<a href="#118974" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>).<span title="=&gt; List[Interpreter.this.compiler.Name]">removeDuplicates</span>
  // private def allImportedNames = prevImports.toList.flatMap(_.importedNames).removeDuplicates
  
  /** Generates names pre0, pre1, etc. via calls to apply method */
  <span class="keyword">class</span> <a title="class NameCreator extends java.lang.Object with ScalaObject" id="117225">NameCreator</a><span title="ScalaObject">(</span><a title="String" id="117482">pre</a>: <span title="String">String</span>) {
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="117477">x</a> = <span title="Int(-1)">-</span><span class="int">1</span>
    <span class="keyword">def</span> <a title="()String" id="117479">apply</a>(): <span title="String">String</span> = { 
      <a href="#117477" title="(x$1: Int)Unit">x</a> += <span title="Int(1)" class="int">1</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="119365">name</a> = <a href="#117482" title="(x$1: Any)java.lang.String">pre</a> + <a href="#117477" title="=&gt; Int">x</a>.<span title="()java.lang.String">toString</span>
      // make sure we don't overwrite their unwisely named res3 etc.
      <span title="String" class="keyword">if</span> (<a href="#117224" title="(p: (Interpreter.this.compiler.Name) =&gt; Boolean)Boolean">allBoundNames</a> exists (<a href="#119411" title="Interpreter.this.compiler.Name">_</a>.<a href="symtab/Names.scala.html#28205" title="(x$1: AnyRef)Boolean">toString</a> == <a href="#119365" title="java.lang.String">name</a>)) <a href="#117479" title="()String">apply</a>()
      <span class="keyword">else</span> <a href="#119365" title="java.lang.String">name</a>
    }
    <span class="keyword">def</span> <a title="()Unit" id="117480">reset</a>(): <span title="Unit">Unit</span> = <a href="#117477" title="(x$1: Int)Unit">x</a> = <span title="Int(-1)">-</span><span class="int">1</span>
    <span class="keyword">def</span> <a title="(name: String)Boolean" id="117481">didGenerate</a>(<a title="String" id="119428">name</a>: <span title="String">String</span>) =
      <span title="(x$1: Boolean)Boolean">(</span><a href="#119428" title="(x$1: java.lang.String)Boolean" id="6973">name</a> startsWith <a href="#117482" title="String">pre</a>) &amp;&amp; (<a title="(p: (Char) =&gt; Boolean)Boolean" id="25736">(</a><a href="#119428" title="(n: Int)scala.runtime.RichString" id="25786">name</a> drop <a href="#117482" title="String">pre</a>.<span title="()Int">length</span>) forall (<a href="#119460" title="implicit scala.Predef.charWrapper : (c: Char)scala.runtime.RichChar">_</a>.<a title="=&gt; Boolean" id="43324">isDigit</a>))
  }

  /** allocate a fresh line name */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Interpreter.this.NameCreator" id="117226">lineNameCreator</a> = <span title="Interpreter.this.NameCreator" class="keyword">new</span> <a href="#117225" title="Interpreter.this.NameCreator">NameCreator</a>(<a href="symtab/StdNames.scala.html#29630" title="=&gt; java.lang.String">INTERPRETER_LINE_PREFIX</a>)
  
  /** allocate a fresh var name */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Interpreter.this.NameCreator" id="117228">varNameCreator</a> = <span title="Interpreter.this.NameCreator" class="keyword">new</span> <a href="#117225" title="Interpreter.this.NameCreator">NameCreator</a>(<a href="symtab/StdNames.scala.html#29632" title="=&gt; java.lang.String">INTERPRETER_VAR_PREFIX</a>)
  
  /** allocate a fresh internal variable name */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Interpreter.this.NameCreator" id="117230">synthVarNameCreator</a> = <span title="Interpreter.this.NameCreator" class="keyword">new</span> <a href="#117225" title="Interpreter.this.NameCreator">NameCreator</a>(<a href="symtab/StdNames.scala.html#29636" title="=&gt; java.lang.String">INTERPRETER_SYNTHVAR_PREFIX</a>)

  /** Check if a name looks like it was generated by varNameCreator */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: String)Boolean" id="117231">isGeneratedVarName</a>(<a title="String" id="119482">name</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> = <a href="#117481" title="(name: String)Boolean">varNameCreator</a> didGenerate <a href="#119482" title="String">name</a>  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: String)Boolean" id="117232">isSynthVarName</a>(<a title="String" id="119486">name</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> = <a href="#117481" title="(name: String)Boolean">synthVarNameCreator</a> didGenerate <a href="#119486" title="String">name</a>

  /** generate a string using a routine that wants to write on a stream */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(writer: (java.io.PrintWriter) =&gt; Unit)String" id="117233">stringFrom</a>(<a title="(java.io.PrintWriter) =&gt; Unit" id="119490">writer</a>: PrintWriter =&gt; Unit): <span title="String">String</span> = {
    <span class="keyword">val</span> <a title="java.io.StringWriter" id="119492">stringWriter</a> = <span title="java.io.StringWriter" class="keyword">new</span> <a title="java.io.StringWriter" id="3750">StringWriter</a>()
    <span class="keyword">val</span> <a title="scala.tools.nsc.NewLinePrintWriter" id="119493">stream</a> = <a href="NewLinePrintWriter.scala.html#117621" title="(out: java.io.Writer)scala.tools.nsc.NewLinePrintWriter" class="keyword">new</a> <a href="NewLinePrintWriter.scala.html#8856" title="scala.tools.nsc.NewLinePrintWriter">NewLinePrintWriter</a>(<a href="#119492" title="java.io.StringWriter">stringWriter</a>)
    <a href="#119490" title="(v1: java.io.PrintWriter)Unit" id="25529">writer</a>(<a href="#119493" title="scala.tools.nsc.NewLinePrintWriter">stream</a>)
    <a href="#119493" title="scala.tools.nsc.NewLinePrintWriter">stream</a>.<a title="()Unit" id="38881">close</a>
    <a href="#119492" title="java.io.StringWriter">stringWriter</a>.<a title="()java.lang.String" id="81372">toString</a>
  }

  /** Truncate a string if it is longer than settings.maxPrintString */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(str: String)String" id="117234">truncPrintString</a>(<a title="String" id="117718">str</a>: <span title="String">String</span>): <span title="String">String</span> = {
    <span class="keyword">val</span> <a title="Int" id="119513">maxpr</a> = <a href="#117204" title="=&gt; scala.tools.nsc.InterpreterSettings">isettings</a>.<a href="InterpreterSettings.scala.html#117337" title="=&gt; Int">maxPrintString</a>
    <span class="keyword">val</span> <a title="java.lang.String" id="119514">trailer</a> = <span title="java.lang.String(&quot;...&quot;)" class="string">&quot;...&quot;</span>
    
    <span title="String" class="keyword">if</span> (<a href="#119513" title="(x$1: Int)Boolean">maxpr</a> <span title="(x$1: Boolean)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span> || <a href="#117718" title="String">str</a>.<span title="(x$1: Int)Boolean">length</span> &lt;= <a href="#119513" title="Int">maxpr</a>) <a href="#117718" title="String">str</a>
    <span class="keyword">else</span> <a href="#117718" title="String">str</a>.<a title="(x$1: Int,x$2: Int)java.lang.String" id="7016">substring</a><span title="(x$1: Any)java.lang.String">(</span><span title="Int(0)" class="int">0</span>, <a href="#119513" title="(x$1: Int)Int" id="2966">maxpr</a>-<span title="Int(3)" class="int">3</span>) + <a href="#119514" title="java.lang.String">trailer</a>
  }

  /** Clean up a string for output */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(str: String)String" id="117235">clean</a>(<a title="String" id="117715">str</a>: <span title="String">String</span>) = <a href="#117234" title="(str: String)String">truncPrintString</a>(<a href="#117177" title="(str: String)String">stripWrapperGunk</a>(<a href="#117715" title="String">str</a>))

  /** Indent some code by the width of the scala&gt; prompt.
   *  This way, compiler error messages read better.
   */
  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">val</span> <a title="String" id="117236">spaces</a> = <span title="object List">List</span>.<a title="(n: Int)(elem: =&gt; java.lang.String)List[java.lang.String]" id="24424">fill</a>(<span title="Int(7)" class="int">7</span>)(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>).<span title="=&gt; String">mkString</span>
  <span class="keyword">def</span> <a title="(code: String)String" id="117238">indentCode</a>(<a title="String" id="119559">code</a>: <span title="String">String</span>) =
    <a href="#117233" title="(writer: (java.io.PrintWriter) =&gt; Unit)String">stringFrom</a>(<a title="java.io.PrintWriter" id="119563">str</a> =&gt;
      <span class="keyword">for</span> (<a title="String" id="119581">line</a> &lt;- <a href="#119559" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">code</a>.<a title="(f: (String) =&gt; Unit)Unit" id="30459">lines</a>) {
        <a href="#119563" title="java.io.PrintWriter">str</a>.<span title="(x$1: java.lang.String)Unit">print</span>(<a href="#117236" title="=&gt; String">spaces</a>)
        <a href="#119563" title="java.io.PrintWriter">str</a>.<span title="(x$1: java.lang.String)Unit">print</span>(<a href="#119581" title="(x$1: Any)java.lang.String">line</a> + <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>)
        <a href="#119563" title="java.io.PrintWriter">str</a>.<span title="()Unit">flush</span>()
      })

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String" id="117239">name2string</a>(<a title="Interpreter.this.compiler.Name" id="117517">name</a>: <a href="symtab/Names.scala.html#26055" title="Interpreter.this.compiler.Name">Name</a>) = <a href="#117517" title="Interpreter.this.compiler.Name">name</a>.<a href="symtab/Names.scala.html#28205" title="()String">toString</a>

  /** Compute imports that allow definitions from previous
   *  requests to be visible in a new request.  Returns
   *  three pieces of related code:
   *
   *  1. An initial code fragment that should go before
   *  the code of the new request.
   *
   *  2. A code fragment that should go after the code
   *  of the new request.
   *
   *  3. An access path which can be traverested to access
   *  any bindings inside code wrapped by #1 and #2 .
   *
   * The argument is a set of Names that need to be imported.
   *
   * Limitations: This method is not as precise as it could be.
   * (1) It does not process wildcard imports to see what exactly
   * they import.
   * (2) If it imports any names from a request, it imports all
   * of them, which is not really necessary.
   * (3) It imports multiple same-named implicits, but only the
   * last one imported is actually usable.
   */
  <span class="keyword">private</span> case <span class="keyword">class</span> <a title="class ComputedImports extends java.lang.Object with ScalaObject with Product" id="119652">ComputedImports</a><span title="ScalaObject">(</span><a title="String" id="120936">prepend</a>: <span title="String">String</span>, <a title="String" id="120937">append</a>: <span title="String">String</span>, <a title="String" id="120938">access</a>: <span title="String">String</span>)
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(wanted: Set[Interpreter.this.compiler.Name])Interpreter.this.ComputedImports" id="117243">importsCode</a>(<a title="Set[Interpreter.this.compiler.Name]" id="119718">wanted</a>: <span title="Set[Interpreter.this.compiler.Name]">Set</span>[Name]): <a href="#119652" title="Interpreter.this.ComputedImports">ComputedImports</a> = {
    /** Narrow down the list of requests from which imports 
     *  should be taken.  Removes requests which cannot contribute
     *  useful imports for the specified set of wanted names.
     */
    case <span class="keyword">class</span> <a title="class ReqAndHandler extends java.lang.Object with ScalaObject with Product" id="119754">ReqAndHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.Request" id="120127">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="Interpreter.this.MemberHandler" id="120128">handler</a>: <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a>)
    <span class="keyword">def</span> <a title="=&gt; List[ReqAndHandler]" id="119723">reqsToUse</a>: <span title="List[ReqAndHandler]">List</span>[ReqAndHandler] = {
      /** Loop through a list of MemberHandlers and select which ones to keep.
        * 'wanted' is the set of names that need to be imported.
       */
      <span class="keyword">def</span> <a title="(reqs: List[ReqAndHandler],wanted: Set[Interpreter.this.compiler.Name])List[ReqAndHandler]" id="119808">select</a>(<a title="List[ReqAndHandler]" id="119810">reqs</a>: <span title="List[ReqAndHandler]">List</span>[ReqAndHandler], <a title="Set[Interpreter.this.compiler.Name]" id="119811">wanted</a>: <span title="Set[Interpreter.this.compiler.Name]">Set</span>[Name]): <span title="List[ReqAndHandler]">List</span>[ReqAndHandler] = {
        <span class="keyword">val</span> <a title="(Interpreter.this.compiler.Name) =&gt; Boolean" id="119812">isWanted</a> = <a href="#119811" title="(elem: Interpreter.this.compiler.Name)Boolean">wanted</a> contains <a href="#119816" title="Interpreter.this.compiler.Name">_</a>
        <span class="keyword">def</span> <a title="(handler: Interpreter.this.MemberHandler)Boolean" id="119813">keepHandler</a>(<a title="Interpreter.this.MemberHandler" id="119819">handler</a>: <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a>): <span title="Boolean">Boolean</span> = {
          <span class="keyword">import</span> handler._
          // Single symbol imports might be implicits! See bug #1752.  Rather than
          // try to finesse this, we will mimic all imports for now.
          <span class="keyword">def</span> <a title="=&gt; Boolean" id="119821">isImport</a> = <a href="#119819" title="Interpreter.this.MemberHandler">handler</a>.<span title="[T0]Boolean">isInstanceOf</span><span title="Boolean">[</span><a href="#117264" title="Interpreter.this.ImportHandler">ImportHandler</a>]
          <a href="#119183" title="(x$1: Boolean)Boolean">definesImplicit</a> <span title="(x$1: Boolean)Boolean">||</span> <a href="#119821" title="=&gt; Boolean">isImport</a> || (<a href="#119181" title="(that: Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,Sequence[Interpreter.this.compiler.Name],Sequence[Interpreter.this.compiler.Name]])Sequence[Interpreter.this.compiler.Name]">importedNames</a> <span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,Sequence[Interpreter.this.compiler.Name],Sequence#Coll]">++</span> <a href="#119176" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>).<span title="(p: (Interpreter.this.compiler.Name) =&gt; Boolean)Boolean">exists</span>(<a href="#119812" title="(Interpreter.this.compiler.Name) =&gt; Boolean">isWanted</a>)
        }
                   
        <a href="#119810" title="List[ReqAndHandler]">reqs</a> <span title="List[ReqAndHandler]" class="keyword">match</span> {
          <span title="scala.collection.immutable.Nil.type" class="keyword">case</span> <span title="object Nil">Nil</span>                                    =&gt; <span title="object Nil">Nil</span>
          <span title="List[ReqAndHandler]" class="keyword">case</span> <a title="ReqAndHandler" id="119951">rh</a> :: <a title="List[ReqAndHandler]" id="119952">rest</a> <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#119813" title="(handler: Interpreter.this.MemberHandler)Boolean">keepHandler</a>(<a href="#119951" title="ReqAndHandler">rh</a>.<a href="#120128" title="=&gt; Interpreter.this.MemberHandler">handler</a>) =&gt; <a href="#119808" title="(reqs: List[ReqAndHandler],wanted: Set[Interpreter.this.compiler.Name])List[ReqAndHandler]">select</a>(<a href="#119952" title="List[ReqAndHandler]">rest</a>, <a href="#119811" title="Set[Interpreter.this.compiler.Name]">wanted</a>)
          <span title="List[ReqAndHandler]" class="keyword">case</span> <a title="ReqAndHandler" id="119963">rh</a> :: <a title="List[ReqAndHandler]" id="119964">rest</a>                             =&gt;
            <span class="keyword">import</span> rh.handler._
            <span class="keyword">val</span> <a title="scala.collection.immutable.Set[Interpreter.this.compiler.Name]" id="119968">newWanted</a> = <a href="#119811" title="(elems: Traversable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]">wanted</a> <span title="(elems: Traversable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]">++</span> <a href="#119174" title="=&gt; List[Interpreter.this.compiler.Name]">usedNames</a> <span title="(elems: Traversable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]">--</span> <a href="#119176" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a> -- <a href="#119181" title="=&gt; Seq[Interpreter.this.compiler.Name]">importedNames</a>
            <a href="#119963" title="ReqAndHandler">rh</a> <a href="#120098" title="ReqAndHandler">::</a> <a href="#119808" title="(reqs: List[ReqAndHandler],wanted: Set[Interpreter.this.compiler.Name])List[ReqAndHandler]">select</a><span title="(x: ReqAndHandler)List[ReqAndHandler]">(</span><a href="#119964" title="List[ReqAndHandler]">rest</a>, <a href="#119968" title="scala.collection.immutable.Set[Interpreter.this.compiler.Name]">newWanted</a>)
        }
      }

      <span class="keyword">val</span> <a title="List[ReqAndHandler]" id="119809">rhpairs</a> = <span class="keyword">for</span> {
        <a title="Interpreter.this.Request" id="120117">req</a> &lt;- <a href="#117219" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<span title="=&gt; List[Interpreter.this.Request]">toList</span>.<span title="(f: (Interpreter.this.Request) =&gt; Traversable[ReqAndHandler])(implicit bf: scala.collection.generic.BuilderFactory[ReqAndHandler,List[ReqAndHandler],List[Interpreter.this.Request]])List[ReqAndHandler]">reverse</span>
        <a title="Interpreter.this.MemberHandler" id="120126">handler</a> &lt;- <a href="#120117" title="Interpreter.this.Request">req</a>.<a href="#118972" title="(f: (Interpreter.this.MemberHandler) =&gt; ReqAndHandler)(implicit bf: scala.collection.generic.BuilderFactory[ReqAndHandler,List[ReqAndHandler],List[Interpreter.this.MemberHandler]])List[ReqAndHandler]">handlers</a>
      } <span class="keyword">yield</span> <a href="#119754" title="(req: Interpreter.this.Request,handler: Interpreter.this.MemberHandler)ReqAndHandler">ReqAndHandler</a>(<a href="#120117" title="Interpreter.this.Request">req</a>, <a href="#120126" title="Interpreter.this.MemberHandler">handler</a>)

      <a href="#119808" title="(reqs: List[ReqAndHandler],wanted: Set[Interpreter.this.compiler.Name])List[ReqAndHandler]">select</a>(<a href="#119809" title="List[ReqAndHandler]">rhpairs</a>, <a href="#119718" title="Set[Interpreter.this.compiler.Name]">wanted</a>).<span title="=&gt; List[ReqAndHandler]">reverse</span>
    }

    <span class="keyword">val</span> <a title="java.lang.StringBuffer" id="119724">code</a>, <a title="java.lang.StringBuffer" id="119725">trailingBraces</a>, <a title="java.lang.StringBuffer" id="119726">accessPath</a> = <span title="java.lang.StringBuffer" class="keyword">new</span> <span title="java.lang.StringBuffer">StringBuffer</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.Set[Interpreter.this.compiler.Name]" id="119727">currentImps</a> = mutable.<a title="object scala.collection.mutable.Set" id="25012">Set</a>.<a title="[A]scala.collection.mutable.Set[A]" id="39312">empty</a><span title="scala.collection.mutable.Set[Interpreter.this.compiler.Name]">[</span><a href="symtab/Names.scala.html#26055" title="Interpreter.this.compiler.Name">Name</a>]

    // add code for a new object to hold some imports
    <span class="keyword">def</span> <a title="()Unit" id="119728">addWrapper</a>() {
      <span class="keyword">val</span> <a title="java.lang.String" id="120726">impname</a> = <a href="symtab/StdNames.scala.html#29634" title="=&gt; java.lang.String">INTERPRETER_IMPORT_WRAPPER</a>
      <a href="#119724" title="(x$1: java.lang.String)java.lang.StringBuffer">code</a> append <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;object %s {\n&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#120726" title="java.lang.String">impname</a>)
      <a href="#119725" title="(x$1: java.lang.String)java.lang.StringBuffer">trailingBraces</a> append <span title="java.lang.String(&quot;}\012&quot;)" class="string">&quot;}\n&quot;</span>
      <a href="#119726" title="(x$1: java.lang.String)java.lang.StringBuffer">accessPath</a> append (<span title="(x$1: Any)java.lang.String" class="string">&quot;.&quot;</span> + <a href="#120726" title="java.lang.String">impname</a>)

      <a href="#119727" title="scala.collection.mutable.Set[Interpreter.this.compiler.Name]">currentImps</a>.<a title="()Unit" id="39469">clear</a>
    }

    <a href="#119728" title="()Unit">addWrapper</a>()

    // loop through previous requests, adding imports for each one
    <span class="keyword">for</span> (ReqAndHandler(<a title="Interpreter.this.Request" id="120803">req</a>, <a title="Interpreter.this.MemberHandler" id="120804">handler</a>) &lt;- <a href="#119723" title="(f: (ReqAndHandler) =&gt; Unit)Unit">reqsToUse</a>) {
      <span class="keyword">import</span> handler._
      // If the user entered an import, then just use it; add an import wrapping
      // level if the import might conflict with some other import
      <span title="Unit" class="keyword">if</span> (<a href="#119179" title="(x$1: Boolean)Boolean">importsWildcard</a> || <a href="#119727" title="scala.collection.mutable.Set[Interpreter.this.compiler.Name]">currentImps</a>.<span title="(p: (Interpreter.this.compiler.Name) =&gt; Boolean)Boolean">exists</span>(<a href="#119181" title="=&gt; Seq[Interpreter.this.compiler.Name]">importedNames</a>.<a href="#120810" title="(elem: Any)Boolean">contains</a>))
        <a href="#119728" title="()Unit">addWrapper</a>()
      
      <span title="Any" class="keyword">if</span> (<a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">member</a>.<span title="[T0]Boolean">isInstanceOf</span><span title="Boolean">[</span><a href="ast/Trees.scala.html#26643" title="Interpreter.this.compiler.Import">Import</a>])
        <a href="#119724" title="(x$1: java.lang.String)java.lang.StringBuffer">code</a> append (<a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">member</a>.<a href="ast/Trees.scala.html#29381" title="(x$1: Any)java.lang.String">toString</a> + <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>)

      // give wildcard imports a import wrapper all to their own
      <span title="Any" class="keyword">if</span> (<a href="#119179" title="=&gt; Boolean">importsWildcard</a>)  <a href="#119728" title="()Unit">addWrapper</a>()  
      <span class="keyword">else</span>                  <a href="#119727" title="(iter: Traversable[Interpreter.this.compiler.Name])currentImps.type">currentImps</a> ++= <a href="#119181" title="=&gt; Seq[Interpreter.this.compiler.Name]">importedNames</a>

      // For other requests, import each bound variable.
      // import them explicitly instead of with _, so that
      // ambiguity errors will not be generated. Also, quote 
      // the name of the variable, so that we don't need to 
      // handle quoting keywords separately. 
      <span class="keyword">for</span> (<a title="Interpreter.this.compiler.Name" id="120878">imv</a> &lt;- <a href="#119176" title="(f: (Interpreter.this.compiler.Name) =&gt; scala.collection.mutable.Set[Interpreter.this.compiler.Name])Unit">boundNames</a>) {
        <span title="Unit" class="keyword">if</span> (<a href="#119727" title="(elem: Interpreter.this.compiler.Name)Boolean">currentImps</a> contains <a href="#120878" title="Interpreter.this.compiler.Name">imv</a>) <a href="#119728" title="()Unit">addWrapper</a>()
        
        <a href="#119724" title="(x$1: java.lang.String)java.lang.StringBuffer">code</a> append (<span title="(x$1: Any)java.lang.String" class="string">&quot;import &quot;</span> + <a href="#120803" title="Interpreter.this.Request">req</a>.<a href="#118986" title="(vname: Interpreter.this.compiler.Name)String">fullPath</a>(<a href="#120878" title="Interpreter.this.compiler.Name">imv</a>))
        <a href="#119727" title="(elem: Interpreter.this.compiler.Name)currentImps.type" id="39463">currentImps</a> += <a href="#120878" title="Interpreter.this.compiler.Name">imv</a>
      }
    }

    // add one extra wrapper, to prevent warnings in the common case of
    // redefining the value bound in the last interpreter request.
    <a href="#119728" title="()Unit">addWrapper</a>()
    <a href="#119652" title="(prepend: String,append: String,access: String)Interpreter.this.ComputedImports">ComputedImports</a>(<a href="#119724" title="java.lang.StringBuffer">code</a>.<span title="()java.lang.String">toString</span>, <a href="#119725" title="java.lang.StringBuffer">trailingBraces</a>.<span title="()java.lang.String">toString</span>, <a href="#119726" title="java.lang.StringBuffer">accessPath</a>.<span title="()java.lang.String">toString</span>)
  }

  /** Parse a line into a sequence of trees. Returns None if the input is incomplete. */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(line: String)Option[List[Interpreter.this.compiler.Tree]]" id="117244">parse</a>(<a title="String" id="120963">line</a>: <span title="String">String</span>): <span title="Option[List[Interpreter.this.compiler.Tree]]">Option</span>[List[Tree]] = {
    <span class="keyword">var</span> <a title="Boolean" id="120965">justNeedsMore</a> = <span title="Boolean(false)" class="keyword">false</span>
    <a href="#117206" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/Reporter.scala.html#38791" title="(handler: (scala.tools.nsc.util.Position, String) =&gt; Unit)(thunk: =&gt; Option[List[Interpreter.this.compiler.Tree]])Option[List[Interpreter.this.compiler.Tree]]">withIncompleteHandler</a>((<a title="scala.tools.nsc.util.Position" id="120987">pos</a>,<a title="String" id="120988">msg</a>) =&gt; {<a href="#120965" title="Boolean">justNeedsMore</a> = <span title="Boolean(true)" class="keyword">true</span>}) {
      // simple parse: just parse it, nothing else
      <span class="keyword">def</span> <a title="(code: String)List[Interpreter.this.compiler.Tree]" id="120992">simpleParse</a>(<a title="String" id="120994">code</a>: <span title="String">String</span>): <span title="List[Interpreter.this.compiler.Tree]">List</span>[Tree] = {
        <a href="#117206" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/AbstractReporter.scala.html#38799" title="=&gt; Unit">reset</a>
        <span class="keyword">val</span> <a title="Interpreter.this.compiler.CompilationUnit" id="120995">unit</a> = <span title="Interpreter.this.compiler.CompilationUnit" class="keyword">new</span> <a href="CompilationUnits.scala.html#39196" title="Interpreter.this.compiler.CompilationUnit">CompilationUnit</a>(<a href="util/SourceFile.scala.html#121007" title="(sourceName: String,cs: Seq[Char])scala.tools.nsc.util.BatchSourceFile" class="keyword">new</a> <a href="util/SourceFile.scala.html#14659" title="scala.tools.nsc.util.BatchSourceFile">BatchSourceFile</a>(<span title="java.lang.String(&quot;&lt;console&gt;&quot;)" class="string">&quot;&lt;console&gt;&quot;</span>, <a href="#120994" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">code</a>))
        <span class="keyword">val</span> <a title="Interpreter.this.compiler.syntaxAnalyzer.UnitParser" id="120996">scanner</a> = <a href="ast/parser/Parsers.scala.html#121320" title="(unit: Interpreter.this.compiler.syntaxAnalyzer.global.CompilationUnit)Interpreter.this.compiler.syntaxAnalyzer.UnitParser" class="keyword">new</a> <a href="#117191" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39100" title="object Interpreter.this.compiler.syntaxAnalyzer">syntaxAnalyzer</a>.<a href="ast/parser/Parsers.scala.html#39709" title="Interpreter.this.compiler.syntaxAnalyzer.UnitParser">UnitParser</a>(<a href="#120995" title="Interpreter.this.compiler.CompilationUnit">unit</a>)
        
        <a href="#120996" title="Interpreter.this.compiler.syntaxAnalyzer.UnitParser">scanner</a>.<a href="ast/parser/Parsers.scala.html#121309" title="(isPre: Boolean)(Interpreter.this.compiler.syntaxAnalyzer.global.ValDef, List[Interpreter.this.compiler.syntaxAnalyzer.global.Tree])">templateStatSeq</a>(<span title="Boolean(false)" class="keyword">false</span>).<span title="=&gt; List[Interpreter.this.compiler.syntaxAnalyzer.global.Tree]">_2</span>
      }
      <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Tree]" id="120993">trees</a> = <a href="#120992" title="(code: String)List[Interpreter.this.compiler.Tree]">simpleParse</a>(<a href="#120963" title="String">line</a>)
      
      <span title="Option[List[Interpreter.this.compiler.Tree]]" class="keyword">if</span> (<a href="#117206" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/Reporter.scala.html#38774" title="=&gt; Boolean">hasErrors</a>)   <span title="(x: object Nil)Some[object Nil]">Some</span>(<span title="object Nil">Nil</span>)  // the result did not parse, so stop
      <span class="keyword">else</span> <span title="Option[List[Interpreter.this.compiler.Tree]]" class="keyword">if</span> (<a href="#120965" title="Boolean">justNeedsMore</a>)   <span title="object None">None</span>
      <span class="keyword">else</span>                      <span title="(x: List[Interpreter.this.compiler.Tree])Some[List[Interpreter.this.compiler.Tree]]">Some</span>(<a href="#120993" title="List[Interpreter.this.compiler.Tree]">trees</a>)
    }
  }

  /** Compile an nsc SourceFile.  Returns true if there are
   *  no compilation errors, or false othrewise.
   */
  <span class="keyword">def</span> <a title="(sources: scala.tools.nsc.util.SourceFile*)Boolean" id="117245">compileSources</a>(<a title="scala.tools.nsc.util.SourceFile*" id="122277">sources</a>: <span title="scala.tools.nsc.util.SourceFile*">SourceFile</span>*): <span title="Boolean">Boolean</span> = {
    <a href="#117206" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/AbstractReporter.scala.html#38799" title="=&gt; Unit">reset</a>
    <a href="Global.scala.html#40218" title="(_sources: List[scala.tools.nsc.util.SourceFile])Unit" class="keyword">new</a> <a href="#117191" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39178" title="Interpreter.this.compiler.Run">Run</a>() compileSources <a href="#122277" title="scala.tools.nsc.util.SourceFile*">sources</a>.<span title="=&gt; List[scala.tools.nsc.util.SourceFile]">toList</span>
    <span title="=&gt; Boolean">!</span><a href="#117206" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/Reporter.scala.html#38774" title="=&gt; Boolean">hasErrors</a>
  }

  /** Compile a string.  Returns true if there are no
   *  compilation errors, or false otherwise.
   */
  <span class="keyword">def</span> <a title="(code: String)Boolean" id="117246">compileString</a>(<a title="String" id="122285">code</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> =
    <a href="#117245" title="(sources: scala.tools.nsc.util.SourceFile*)Boolean">compileSources</a>(<a href="util/SourceFile.scala.html#121007" title="(sourceName: String,cs: Seq[Char])scala.tools.nsc.util.BatchSourceFile" class="keyword">new</a> <a href="util/SourceFile.scala.html#14659" title="scala.tools.nsc.util.BatchSourceFile">BatchSourceFile</a>(<span title="java.lang.String(&quot;&lt;script&gt;&quot;)" class="string">&quot;&lt;script&gt;&quot;</span>, <a href="#122285" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">code</a>))

  /** Build a request from the user. &lt;code&gt;trees&lt;/code&gt; is &lt;code&gt;line&lt;/code&gt;
   *  after being parsed.
   */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(trees: List[Interpreter.this.compiler.Tree],line: String,lineName: String)Interpreter.this.Request" id="117247">buildRequest</a>(<a title="List[Interpreter.this.compiler.Tree]" id="122328">trees</a>: <span title="List[Interpreter.this.compiler.Tree]">List</span>[Tree], <a title="String" id="122329">line</a>: <span title="String">String</span>, <a title="String" id="122330">lineName</a>: <span title="String">String</span>): <a href="#117265" title="Interpreter.this.Request">Request</a> =
    <span title="Interpreter.this.Request" class="keyword">new</span> <a href="#117265" title="Interpreter.this.Request">Request</a>(<a href="#122329" title="String">line</a>, <a href="#122330" title="String">lineName</a>)

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(member: Interpreter.this.compiler.Tree)Interpreter.this.MemberHandler" id="117248">chooseHandler</a>(<a title="Interpreter.this.compiler.Tree" id="122336">member</a>: <a href="ast/Trees.scala.html#26593" title="Interpreter.this.compiler.Tree">Tree</a>): <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a> = <a href="#122336" title="Interpreter.this.compiler.Tree">member</a> <span title="Interpreter.this.MemberHandler" class="keyword">match</span> {
    <span title="Interpreter.this.DefHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.DefDef" id="122338">member</a>: <a href="ast/Trees.scala.html#26626" title="Interpreter.this.compiler.DefDef">DefDef</a>               =&gt; <span title="Interpreter.this.DefHandler" class="keyword">new</span> <a href="#117259" title="Interpreter.this.DefHandler">DefHandler</a>(<a href="#122338" title="Interpreter.this.compiler.DefDef">member</a>)
    <span title="Interpreter.this.ValHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.ValDef" id="122355">member</a>: <a href="ast/Trees.scala.html#26619" title="Interpreter.this.compiler.ValDef">ValDef</a>               =&gt; <span title="Interpreter.this.ValHandler" class="keyword">new</span> <a href="#117258" title="Interpreter.this.ValHandler">ValHandler</a>(<a href="#122355" title="Interpreter.this.compiler.ValDef">member</a>)
    <span title="Interpreter.this.AssignHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.Assign" id="122376">member</a>@Assign(Ident(_), _)   =&gt; <span title="Interpreter.this.AssignHandler" class="keyword">new</span> <a href="#117260" title="Interpreter.this.AssignHandler">AssignHandler</a>(<a href="#122376" title="Interpreter.this.compiler.Assign">member</a>)
    <span title="Interpreter.this.ModuleHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.ModuleDef" id="122400">member</a>: <a href="ast/Trees.scala.html#26614" title="Interpreter.this.compiler.ModuleDef">ModuleDef</a>            =&gt; <span title="Interpreter.this.ModuleHandler" class="keyword">new</span> <a href="#117261" title="Interpreter.this.ModuleHandler">ModuleHandler</a>(<a href="#122400" title="Interpreter.this.compiler.ModuleDef">member</a>)
    <span title="Interpreter.this.ClassHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.ClassDef" id="122416">member</a>: <a href="ast/Trees.scala.html#26609" title="Interpreter.this.compiler.ClassDef">ClassDef</a>             =&gt; <span title="Interpreter.this.ClassHandler" class="keyword">new</span> <a href="#117262" title="Interpreter.this.ClassHandler">ClassHandler</a>(<a href="#122416" title="Interpreter.this.compiler.ClassDef">member</a>)
    <span title="Interpreter.this.TypeAliasHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.TypeDef" id="122432">member</a>: <a href="ast/Trees.scala.html#26634" title="Interpreter.this.compiler.TypeDef">TypeDef</a>              =&gt; <span title="Interpreter.this.TypeAliasHandler" class="keyword">new</span> <a href="#117263" title="Interpreter.this.TypeAliasHandler">TypeAliasHandler</a>(<a href="#122432" title="Interpreter.this.compiler.TypeDef">member</a>)
    <span title="Interpreter.this.ImportHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.Import" id="122449">member</a>: <a href="ast/Trees.scala.html#26643" title="Interpreter.this.compiler.Import">Import</a>               =&gt; <span title="Interpreter.this.ImportHandler" class="keyword">new</span> <a href="#117264" title="Interpreter.this.ImportHandler">ImportHandler</a>(<a href="#122449" title="Interpreter.this.compiler.Import">member</a>)
    <span title="Interpreter.this.MemberHandler" class="keyword">case</span> DocDef(_, <a title="Interpreter.this.compiler.Tree" id="122476">documented</a>)        =&gt; <a href="#117248" title="(member: Interpreter.this.compiler.Tree)Interpreter.this.MemberHandler">chooseHandler</a>(<a href="#122476" title="Interpreter.this.compiler.Tree">documented</a>)
    <span title="Interpreter.this.GenericHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.Tree" id="122481">member</a>                       =&gt; <span title="Interpreter.this.GenericHandler" class="keyword">new</span> <a href="#117257" title="Interpreter.this.GenericHandler">GenericHandler</a>(<a href="#122481" title="Interpreter.this.compiler.Tree">member</a>)
  }

  /** &lt;p&gt;
   *    Interpret one line of input.  All feedback, including parse errors
   *    and evaluation results, are printed via the supplied compiler's 
   *    reporter.  Values defined are available for future interpreted
   *    strings.
   *  &lt;/p&gt;
   *  &lt;p&gt;
   *    The return value is whether the line was interpreter successfully,
   *    e.g. that there were no parse errors.
   *  &lt;/p&gt;
   *
   *  @param line ...
   *  @return     ...
   */
  <span class="keyword">def</span> <a title="(line: String)scala.tools.nsc.InterpreterResults.Result" id="117249">interpret</a>(<a title="String" id="122488">line</a>: <span title="String">String</span>): IR.<a href="InterpreterResults.scala.html#122490" title="scala.tools.nsc.InterpreterResults.Result">Result</a> = {
    // initialize the compiler
    <span title="Any" class="keyword">if</span> (<a href="#117219" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<a title="=&gt; Boolean" id="25732">isEmpty</a>) <span title="Interpreter.this.compiler.Run" class="keyword">new</span> <a href="#117191" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39178" title="Interpreter.this.compiler.Run">Run</a>()

    // parse
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Tree]" id="122499">trees</a> = <a href="#117244" title="(line: String)Option[List[Interpreter.this.compiler.Tree]]">parse</a>(<a href="#117238" title="(code: String)String">indentCode</a>(<a href="#122488" title="String">line</a>)) <span title="List[Interpreter.this.compiler.Tree]" class="keyword">match</span> {
      <span title="Nothing" class="keyword">case</span> <span title="object None">None</span>         =&gt; <span title="Nothing" class="keyword">return</span> <a href="InterpreterResults.scala.html#8377" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#122495" title="object scala.tools.nsc.InterpreterResults.Incomplete">Incomplete</a>
      <span title="Nothing" class="keyword">case</span> Some(<span title="object Nil">Nil</span>)    =&gt; <span title="Nothing" class="keyword">return</span> <a href="InterpreterResults.scala.html#8377" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#122493" title="object scala.tools.nsc.InterpreterResults.Error">Error</a> // parse error or empty input
      <span title="List[Interpreter.this.compiler.Tree]" class="keyword">case</span> Some(<a title="List[Interpreter.this.compiler.Tree]" id="122522">trees</a>)  =&gt; <a href="#122522" title="List[Interpreter.this.compiler.Tree]">trees</a>
    }

    // Treat a single bare expression specially. This is necessary due to it being hard to
    // modify code at a textual level, and it being hard to submit an AST to the compiler.
    <span title="Unit" class="keyword">if</span> (<a href="#122499" title="List[Interpreter.this.compiler.Tree]">trees</a>.<a title="(x$1: Int)Boolean" id="25548">size</a> == <span title="Int(1)" class="int">1</span>) <a href="#122499" title="List[Interpreter.this.compiler.Tree]">trees</a>.<a title="=&gt; Interpreter.this.compiler.Tree" id="25443">head</a> <span title="Unit" class="keyword">match</span> {
      <span title="Unit" class="keyword">case</span> _:<a href="ast/Trees.scala.html#26682" title="Interpreter.this.compiler.Assign">Assign</a>                         =&gt; // we don't want to include assignments
      <span title="Nothing" class="keyword">case</span> _:<a href="ast/Trees.scala.html#26597" title="Interpreter.this.compiler.TermTree">TermTree</a> | _:<a href="ast/Trees.scala.html#26732" title="Interpreter.this.compiler.Ident">Ident</a> | _:<a href="ast/Trees.scala.html#26728" title="Interpreter.this.compiler.Select">Select</a>  =&gt;
        <span title="Nothing" class="keyword">return</span> <a href="#117249" title="(line: String)scala.tools.nsc.InterpreterResults.Result">interpret</a>(<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;val %s =\n%s&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#117479" title="()String">varNameCreator</a>(), <a href="#122488" title="String">line</a>))
      <span title="Unit" class="keyword">case</span> _                                =&gt;
    }
        
    // figure out what kind of request
    <span class="keyword">val</span> <a title="Interpreter.this.Request" id="122500">req</a> = <a href="#117247" title="(trees: List[Interpreter.this.compiler.Tree],line: String,lineName: String)Interpreter.this.Request">buildRequest</a>(<a href="#122499" title="List[Interpreter.this.compiler.Tree]">trees</a>, <a href="#122488" title="String">line</a>, <a href="#117479" title="()String">lineNameCreator</a>())
    // null is a disallowed statement type; otherwise compile and fail if false (implying e.g. a type error)
    <span title="Unit" class="keyword">if</span> (<a href="#122500" title="(x$1: AnyRef)Boolean">req</a> <span title="(x$1: Boolean)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> || <span title="=&gt; Boolean">!</span><a href="#122500" title="Interpreter.this.Request">req</a>.<a href="#118994" title="()Boolean">compile</a>)
      <span title="Nothing" class="keyword">return</span> <a href="InterpreterResults.scala.html#8377" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#122493" title="object scala.tools.nsc.InterpreterResults.Error">Error</a>
        
    <span class="keyword">val</span> <a href="#122502" title="(String, Boolean)">(</a><a href="#122501" title="String" id="122502">result</a>, <a href="#122501" title="Boolean" id="122503">succeeded</a>) = <a href="#122500" title="Interpreter.this.Request">req</a>.<a href="#118996" title="=&gt; (String, Boolean)">loadAndRun</a>
    <span title="Unit" class="keyword">if</span> (<a href="#117199" title="(x$1: Boolean)Boolean">printResults</a> || <span title="=&gt; Boolean">!</span><a href="#122503" title="Boolean">succeeded</a>)
      <a href="#117560" title="(x$1: java.lang.String)Unit">out</a> print <a href="#117235" title="(str: String)String">clean</a>(<a href="#122502" title="String">result</a>)

    <span title="scala.tools.nsc.InterpreterResults.Result" class="keyword">if</span> (<a href="#122503" title="Boolean">succeeded</a>) {
      <a href="#117219" title="(elem: Interpreter.this.Request)Interpreter.this.prevRequests.type" id="108546">prevRequests</a> += <a href="#122500" title="Interpreter.this.Request">req</a>     // book-keeping
      <a href="InterpreterResults.scala.html#8377" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#122491" title="object scala.tools.nsc.InterpreterResults.Success">Success</a>
    }
    <span class="keyword">else</span> <a href="InterpreterResults.scala.html#8377" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#122493" title="object scala.tools.nsc.InterpreterResults.Error">Error</a>
  }

  /** A name creator used for objects created by &lt;code&gt;bind()&lt;/code&gt;. */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Interpreter.this.NameCreator" id="117250">newBinder</a> = <span title="Interpreter.this.NameCreator" class="keyword">new</span> <a href="#117225" title="Interpreter.this.NameCreator">NameCreator</a>(<span title="java.lang.String(&quot;binder&quot;)" class="string">&quot;binder&quot;</span>)

  /** Bind a specified name to a specified value.  The name may
   *  later be used by expressions passed to interpret.
   *
   *  @param name      the variable name to bind
   *  @param boundType the type of the variable, as a string
   *  @param value     the object value to bind to it
   *  @return          an indication of whether the binding succeeded
   */
  <span class="keyword">def</span> <a title="(name: String,boundType: String,value: Any)scala.tools.nsc.InterpreterResults.Result" id="117252">bind</a>(<a title="String" id="122632">name</a>: <span title="String">String</span>, <a title="String" id="122633">boundType</a>: <span title="String">String</span>, <a title="Any" id="122634">value</a>: <a title="Any" id="49">Any</a>): IR.<a href="InterpreterResults.scala.html#122490" title="scala.tools.nsc.InterpreterResults.Result">Result</a> = {
    <span class="keyword">val</span> <a title="String" id="122636">binderName</a> = <a href="#117479" title="()String">newBinder</a>()    // &quot;binder&quot; + binderNum()

    <a href="#117246" title="(code: String)Boolean">compileString</a>(<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;
      | object %s {
      |   var value: %s = _
      |   def set(x: Any) = value = x.asInstanceOf[%s]
      | }
    &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">stripMargin</span>.<span title="(args: Any*)String">format</span>(<a href="#122636" title="String">binderName</a>, <a href="#122633" title="String">boundType</a>, <a href="#122633" title="String">boundType</a>))

    <span class="keyword">val</span> <a title="java.lang.Class[_]" id="122637">binderObject</a> = <a href="#117215" title="(s: String)java.lang.Class[_]">loadByName</a>(<a href="#122636" title="String">binderName</a>)
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="122638">setterMethod</a> = <a href="#117216" title="(c: java.lang.Class[_],name: String)java.lang.reflect.Method">methodByName</a>(<a href="#122637" title="java.lang.Class[_]">binderObject</a>, <span title="java.lang.String(&quot;set&quot;)" class="string">&quot;set&quot;</span>)
        
    // this roundabout approach is to ensure the value is boxed
    <span class="keyword">var</span> <a title="Array[Any]" id="122639">argsHolder</a>: <span title="Array[Any]">Array</span>[Any] = <span title="Null(null)" class="keyword">null</span>
    <a href="#122639" title="Array[Any]">argsHolder</a> = <span title="(xs: Any*)List[Any]">List</span>(<a href="#122634" title="Any">value</a>).<a title="(implicit evidence$1: scala.reflect.ClassManifest[Any])Array[Any]" id="27603">toArray</a>
    <a href="#122638" title="java.lang.reflect.Method">setterMethod</a>.<span title="(x$1: Any,x$2: java.lang.Object*)java.lang.Object">invoke</span>(<span title="Null(null)" class="keyword">null</span>, <a href="#122639" title="Array[Any]">argsHolder</a>.<span title="[T0]T0">asInstanceOf</span><span title="Array[AnyRef]">[</span><span title="Array[AnyRef]">Array</span>[AnyRef]]: _*)
    <a href="#117249" title="(line: String)scala.tools.nsc.InterpreterResults.Result">interpret</a>(<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;val %s = %s.value&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#122632" title="String">name</a>, <a href="#122636" title="String">binderName</a>))
  }

  /** Reset this interpreter, forgetting all user-specified requests. */
  <span class="keyword">def</span> <a title="()Unit" id="117253">reset</a>() {
    <a href="#117189" title="=&gt; scala.tools.nsc.io.VirtualDirectory">virtualDirectory</a>.<a href="io/VirtualDirectory.scala.html#117311" title="()Unit">clear</a>
    <a href="#117212" title="(x$1: scala.util.ScalaClassLoader)Unit">classLoader</a> = <a href="#117214" title="()scala.util.ScalaClassLoader">makeClassLoader</a>
    <a href="#117226" title="=&gt; Interpreter.this.NameCreator">lineNameCreator</a>.<a href="#117480" title="()Unit">reset</a>()
    <a href="#117228" title="=&gt; Interpreter.this.NameCreator">varNameCreator</a>.<a href="#117480" title="()Unit">reset</a>()
    <a href="#117219" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<a title="()Unit" id="108543">clear</a>
  }

  /** &lt;p&gt;
   *    This instance is no longer needed, so release any resources
   *    it is using.  The reporter's output gets flushed.
   *  &lt;/p&gt;
   */
  <span class="keyword">def</span> <a title="()Unit" id="117254">close</a>() {
    <a href="#117206" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/ConsoleReporter.scala.html#38830" title="()Unit">flush</a>
  }

  /** A traverser that finds all mentioned identifiers, i.e. things
   *  that need to be imported.  It might return extra names.
   */
  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ImportVarsTraverser extends Interpreter.this.compiler.Traverser with ScalaObject" id="117255">ImportVarsTraverser</a><span title="ScalaObject">(</span><a title="List[Interpreter.this.compiler.Name]" id="122791">definedVars</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name]) <span class="keyword">extends</span> <a href="ast/Trees.scala.html#26774" title="Interpreter.this.compiler.Traverser">Traverser</a> {
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]" id="122784">importVars</a> = <span title="scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]" class="keyword">new</span> <a title="scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]" id="24801">HashSet</a>[Name]()

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ast: Interpreter.this.compiler.Tree)Unit" id="122786">traverse</a>(<a title="Interpreter.this.compiler.Tree" id="122794">ast</a>: <a href="ast/Trees.scala.html#26593" title="Interpreter.this.compiler.Tree">Tree</a>) = <a href="#122794" title="Interpreter.this.compiler.Tree">ast</a> <span title="Unit" class="keyword">match</span> {
      <span title="Unit" class="keyword">case</span> Ident(<a title="Interpreter.this.compiler.Name" id="122803">name</a>)  =&gt; <a href="#122784" title="(elem: Interpreter.this.compiler.Name)ImportVarsTraverser.this.importVars.type" id="39288">importVars</a> <span title="Unit">+=</span> <a href="#122803" title="Interpreter.this.compiler.Name">name</a>
      <span title="Unit" class="keyword">case</span> _            =&gt; <span class="keyword">super</span>.<a href="ast/Trees.scala.html#70825" title="(tree: Interpreter.this.compiler.Tree)Unit">traverse</a>(<a href="#122794" title="Interpreter.this.compiler.Tree">ast</a>)
    }
  }

  /** Class to handle one member among all the members included
   *  in a single interpreter request.
   */
  <span class="keyword">private</span> <span class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class MemberHandler extends java.lang.Object with ScalaObject" id="117256">MemberHandler</a><span title="ScalaObject">(</span><span class="keyword">val</span> <a title="Interpreter.this.compiler.Tree" id="122843">member</a>: <a href="ast/Trees.scala.html#26593" title="Interpreter.this.compiler.Tree">Tree</a>) {
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="119174">usedNames</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name] = {
      <span class="keyword">val</span> <a title="Interpreter.this.ImportVarsTraverser" id="122846">ivt</a> = <span title="Interpreter.this.ImportVarsTraverser" class="keyword">new</span> <a href="#117255" title="Interpreter.this.ImportVarsTraverser">ImportVarsTraverser</a>(<a href="#119176" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>)
      <a href="#122846" title="Interpreter.this.ImportVarsTraverser">ivt</a>.<a href="ast/Trees.scala.html#70826" title="(trees: List[Interpreter.this.compiler.Tree])Unit">traverseTrees</a>(<span title="(xs: Interpreter.this.compiler.Tree*)List[Interpreter.this.compiler.Tree]">List</span>(<a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">member</a>))
      <a href="#122846" title="Interpreter.this.ImportVarsTraverser">ivt</a>.<a href="#122784" title="=&gt; scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]">importVars</a>.<span title="=&gt; List[Interpreter.this.compiler.Name]">toList</span>
    }
    <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="119176">boundNames</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name] = <span title="object Nil">Nil</span>
    <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="119177">valAndVarNames</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name] = <span title="object Nil">Nil</span>
    <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="119178">defNames</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name] = <span title="object Nil">Nil</span>
    <span class="keyword">val</span> <a title="Boolean" id="119179">importsWildcard</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">val</span> <a title="Seq[Interpreter.this.compiler.Name]" id="119181">importedNames</a>: <span title="Seq[Interpreter.this.compiler.Name]">Seq</span>[Name] = <span title="object Nil">Nil</span>
    <span class="keyword">val</span> <a title="Boolean" id="119183">definesImplicit</a> = <a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">member</a> <span title="Boolean" class="keyword">match</span> {
      <span title="Boolean" class="keyword">case</span> <a title="Interpreter.this.compiler.MemberDef" id="119830">tree</a>: <a href="ast/Trees.scala.html#26604" title="Interpreter.this.compiler.MemberDef">MemberDef</a>  =&gt; <a href="#119830" title="Interpreter.this.compiler.MemberDef">tree</a>.<a href="ast/Trees.scala.html#52046" title="(flag: Long)Boolean">mods</a> hasFlag Flags.<span title="Long(512L)">IMPLICIT</span>
      <span title="Boolean(false)" class="keyword">case</span> _                =&gt; <span title="Boolean(false)" class="keyword">false</span>
    }

    <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="119185">extraCodeToEvaluate</a>(<a title="Interpreter.this.Request" id="122867">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="122868">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) <span title="Unit">{</span> }
    <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="119186">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="122870">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="122871">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) <span title="Unit">{</span> }
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class GenericHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117257">GenericHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.Tree" id="122485">member</a>: <a href="ast/Trees.scala.html#26593" title="Interpreter.this.compiler.Tree">Tree</a>) <span class="keyword">extends</span> <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122485" title="Interpreter.this.compiler.Tree">member</a>)
  
  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ValHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117258">ValHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.ValDef" id="122373">member</a>: <a href="ast/Trees.scala.html#26619" title="Interpreter.this.compiler.ValDef">ValDef</a>) <span class="keyword">extends</span> <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122373" title="Interpreter.this.compiler.ValDef">member</a>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> ValDef<a href="#122362" title="(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)" id="122360">(</a><a href="#122359" title="Interpreter.this.compiler.Modifiers" id="122362">mods</a>, <a href="#122359" title="Interpreter.this.compiler.Name" id="122364">vname</a>, _, _) = <a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">member</a>    
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="String" id="122366">prettyName</a> = <span title="object scala.util.NameTransformer">NameTransformer</span>.<span title="(name0: String)String">decode</span>(<a href="#117239" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">vname</a>)
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Boolean" id="122368">isLazy</a> = <a href="ast/Trees.scala.html#52046" title="(flag: Long)Boolean">mods</a> hasFlag Flags.<span title="Long(2147483648L)">LAZY</span>
    
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122370">boundNames</a> = <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122363" title="=&gt; Interpreter.this.compiler.Name">vname</a>)
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="122371">valAndVarNames</a> = <a href="#122369" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122372">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="122923">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="122924">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) {
      <span class="keyword">val</span> <a title="Boolean" id="122926">isInternal</a> = <a href="#117231" title="(name: String)Boolean">isGeneratedVarName</a><span title="(x$1: Boolean)Boolean">(</span><a href="#117239" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">vname</a>) &amp;&amp; <a href="#122923" title="Interpreter.this.Request">req</a>.<a href="#118992" title="(vname: Interpreter.this.compiler.Name)String">typeOfEnc</a><span title="(x$1: AnyRef)Boolean">(</span><a href="#122363" title="=&gt; Interpreter.this.compiler.Name">vname</a>) == <span title="java.lang.String(&quot;Unit&quot;)" class="string">&quot;Unit&quot;</span>
      <span title="Unit" class="keyword">if</span> (<span title="(x$1: Boolean)Boolean">!</span><a href="#122361" title="=&gt; Interpreter.this.compiler.Modifiers">mods</a>.<a href="ast/Trees.scala.html#52045" title="=&gt; Boolean">isPublic</a> || <a href="#122926" title="Boolean">isInternal</a>) <span title="Nothing" class="keyword">return</span>
      
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="String" id="122928">extractor</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;
        | {
        |    val s = scala.runtime.ScalaRunTime.stringOf(%s)
        |    val nl = if (s.contains('\n')) &quot;\n&quot; else &quot;&quot;
        |    nl + s + &quot;\n&quot;
        | }
      &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">stripMargin</span>.<span title="(args: Any*)String">format</span>(<a href="#118986" title="(vname: Interpreter.this.compiler.Name)String">req</a> fullPath <a href="#122363" title="=&gt; Interpreter.this.compiler.Name">vname</a>)
      
      // if this is a lazy val we avoid evaluating it here
      <span class="keyword">val</span> <a title="String" id="122929">resultString</a> = <span title="String" class="keyword">if</span> (<a href="#122367" title="=&gt; Boolean">isLazy</a>) <a href="#117178" title="(leadingPlus: Boolean,xs: String*)String">codegenln</a>(<span title="Boolean(false)" class="keyword">false</span>, <span title="java.lang.String(&quot;&lt;lazy&gt;&quot;)" class="string">&quot;&lt;lazy&gt;&quot;</span>) <span class="keyword">else</span> <a href="#122927" title="=&gt; String">extractor</a>
      <span class="keyword">val</span> <a title="String" id="122930">codeToPrint</a> = 
        <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot; + &quot;%s: %s = &quot; + %s&quot;&quot;&quot;</span> .
        <span title="(args: Any*)String">format</span>(<a href="#122365" title="=&gt; String">prettyName</a>, <a href="#117182" title="(str: String)String">string2code</a>(<a href="#122923" title="Interpreter.this.Request">req</a>.<a href="#118990" title="(key: Interpreter.this.compiler.Name)String">typeOf</a>(<a href="#122363" title="=&gt; Interpreter.this.compiler.Name">vname</a>)), <a href="#122929" title="String">resultString</a>)

      <a href="#122924" title="(x$1: java.lang.String)Unit">code</a> print <a href="#122930" title="String">codeToPrint</a>
    }
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class DefHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117259">DefHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.DefDef" id="122352">defDef</a>: <a href="ast/Trees.scala.html#26626" title="Interpreter.this.compiler.DefDef">DefDef</a>) <span class="keyword">extends</span> <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122352" title="Interpreter.this.compiler.DefDef">defDef</a>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> DefDef<a href="#122345" title="(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)" id="122343">(</a><a href="#122342" title="Interpreter.this.compiler.Modifiers" id="122345">mods</a>, <a href="#122342" title="Interpreter.this.compiler.Name" id="122347">name</a>, _, _, _, _) = <a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">defDef</a>
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122349">boundNames</a> = <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122346" title="=&gt; Interpreter.this.compiler.Name">name</a>)
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="122350">defNames</a> = <a href="#122348" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122351">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123140">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123141">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <span title="Unit" class="keyword">if</span> (<a href="#122344" title="=&gt; Interpreter.this.compiler.Modifiers">mods</a>.<a href="ast/Trees.scala.html#52045" title="=&gt; Boolean">isPublic</a>) <a href="#123141" title="(x$1: java.lang.String)Unit">code</a> print <a href="#117179" title="(xs: String*)String">codegenln</a>(<a href="#117239" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">name</a>, <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span>, <a href="#123140" title="Interpreter.this.Request">req</a>.<a href="#118990" title="(key: Interpreter.this.compiler.Name)String">typeOf</a>(<a href="#122346" title="=&gt; Interpreter.this.compiler.Name">name</a>))
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class AssignHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117260">AssignHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.Assign" id="122397">member</a>: <a href="ast/Trees.scala.html#26682" title="Interpreter.this.compiler.Assign">Assign</a>) <span class="keyword">extends</span> <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122397" title="Interpreter.this.compiler.Assign">member</a>) {
    <span class="keyword">val</span> <a title="Interpreter.this.compiler.Ident" id="122389">lhs</a> = <a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">member</a>.<a href="ast/Trees.scala.html#73095" title="=&gt; Trees.this.Tree">lhs</a>.<span title="[T0]T0">asInstanceOf</span><span title="Interpreter.this.compiler.Ident">[</span><a href="ast/Trees.scala.html#26732" title="Interpreter.this.compiler.Ident">Ident</a>] // an unfortunate limitation
    <span class="keyword">val</span> <a title="Interpreter.this.compiler.Name" id="122391">helperName</a> = <a href="symtab/Names.scala.html#26048" title="(s: String)Interpreter.this.compiler.Name">newTermName</a>(<a href="#117479" title="()String">synthVarNameCreator</a>())
    <span class="keyword">override</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122393">valAndVarNames</a> = <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122391" title="=&gt; Interpreter.this.compiler.Name">helperName</a>)

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122395">extraCodeToEvaluate</a>(<a title="Interpreter.this.Request" id="123210">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123211">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <a href="#123211" title="(x$1: java.lang.String)Unit">code</a> println <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;val %s = %s&quot;&quot;&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#122391" title="=&gt; Interpreter.this.compiler.Name">helperName</a>, <a href="#122389" title="=&gt; Interpreter.this.compiler.Ident">lhs</a>)

    /** Print out lhs instead of the generated varName */
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122396">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123241">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123242">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) {
      <span class="keyword">val</span> <a title="String" id="123244">lhsType</a> = <a href="#117182" title="(str: String)String">string2code</a>(<a href="#118992" title="(vname: Interpreter.this.compiler.Name)String">req</a> typeOfEnc <a href="#122391" title="=&gt; Interpreter.this.compiler.Name">helperName</a>)
      <span class="keyword">val</span> <a title="String" id="123245">res</a> = <a href="#117182" title="(str: String)String">string2code</a>(<a href="#118986" title="(vname: Interpreter.this.compiler.Name)String">req</a> fullPath <a href="#122391" title="=&gt; Interpreter.this.compiler.Name">helperName</a>)
      <span class="keyword">val</span> <a title="String" id="123246">codeToPrint</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot; + &quot;%s: %s = &quot; + %s + &quot;\n&quot; &quot;&quot;&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#122389" title="=&gt; Interpreter.this.compiler.Ident">lhs</a>, <a href="#123244" title="String">lhsType</a>, <a href="#123245" title="String">res</a>)
          
      <a href="#123242" title="(x$1: java.lang.String)Unit">code</a> println <a href="#123246" title="String">codeToPrint</a>
    }
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ModuleHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117261">ModuleHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.ModuleDef" id="122413">module</a>: <a href="ast/Trees.scala.html#26614" title="Interpreter.this.compiler.ModuleDef">ModuleDef</a>) <span class="keyword">extends</span> <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122413" title="Interpreter.this.compiler.ModuleDef">module</a>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> ModuleDef<a href="#122407" title="(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)" id="122405">(</a><a href="#122404" title="Interpreter.this.compiler.Modifiers" id="122407">mods</a>, <a href="#122404" title="Interpreter.this.compiler.Name" id="122409">name</a>, _) = <a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">module</a>
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122411">boundNames</a> = <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122408" title="=&gt; Interpreter.this.compiler.Name">name</a>)

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122412">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123318">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123319">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <a href="#123319" title="(x$1: java.lang.String)Unit">code</a> println <a href="#117179" title="(xs: String*)String">codegenln</a>(<span title="java.lang.String(&quot;defined module &quot;)" class="string">&quot;defined module &quot;</span>, <a href="#117239" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">name</a>)
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ClassHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117262">ClassHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.ClassDef" id="122429">classdef</a>: <a href="ast/Trees.scala.html#26609" title="Interpreter.this.compiler.ClassDef">ClassDef</a>) <span class="keyword">extends</span> <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122429" title="Interpreter.this.compiler.ClassDef">classdef</a>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> ClassDef<a href="#122423" title="(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)" id="122421">(</a><a href="#122420" title="Interpreter.this.compiler.Modifiers" id="122423">mods</a>, <a href="#122420" title="Interpreter.this.compiler.Name" id="122425">name</a>, _, _) = <a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">classdef</a>
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122427">boundNames</a> = 
      <a href="#122424" title="=&gt; Interpreter.this.compiler.Name">name</a> <a href="#123378" title="Interpreter.this.compiler.Name">::</a> <span title="(x: Interpreter.this.compiler.Name)List[Interpreter.this.compiler.Name]">(</span><span title="List[Interpreter.this.compiler.Name]" class="keyword">if</span> (<a href="ast/Trees.scala.html#52046" title="(flag: Long)Boolean">mods</a> hasFlag Flags.<span title="Long(2048L)">CASE</span>) <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122424" title="=&gt; Interpreter.this.compiler.Name">name</a>.<a href="symtab/Names.scala.html#28201" title="=&gt; Interpreter.this.compiler.Name">toTermName</a>) <span class="keyword">else</span> <span title="object Nil">Nil</span>)
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122428">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123399">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123400">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <a href="#123400" title="(x$1: java.lang.String)Unit">code</a> print <a href="#117179" title="(xs: String*)String">codegenln</a>(<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;defined %s %s&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">classdef</a>.<a href="ast/Trees.scala.html#51986" title="=&gt; String">keyword</a>, <a href="#122424" title="=&gt; Interpreter.this.compiler.Name">name</a>))
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class TypeAliasHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117263">TypeAliasHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.TypeDef" id="122446">typeDef</a>: <a href="ast/Trees.scala.html#26634" title="Interpreter.this.compiler.TypeDef">TypeDef</a>) <span class="keyword">extends</span> <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122446" title="Interpreter.this.compiler.TypeDef">typeDef</a>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> TypeDef<a href="#122439" title="(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)" id="122437">(</a><a href="#122436" title="Interpreter.this.compiler.Modifiers" id="122439">mods</a>, <a href="#122436" title="Interpreter.this.compiler.Name" id="122441">name</a>, _, _) = <a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">typeDef</a>
    <span class="keyword">def</span> <a title="()Boolean" id="122442">isAlias</a>() = <a href="#122438" title="=&gt; Interpreter.this.compiler.Modifiers">mods</a>.<a href="ast/Trees.scala.html#52045" title="(x$1: Boolean)Boolean">isPublic</a> &amp;&amp; <a href="#117191" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="ast/Trees.scala.html#26582" title="object Interpreter.this.compiler.treeInfo">treeInfo</a>.<a href="ast/TreeInfo.scala.html#48941" title="(tree: Interpreter.this.compiler.treeInfo.trees.Tree)Boolean">isAliasTypeDef</a>(<a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">typeDef</a>)
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122444">boundNames</a> = <span title="List[Interpreter.this.compiler.Name]" class="keyword">if</span> (<a href="#122442" title="()Boolean">isAlias</a>) <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122440" title="=&gt; Interpreter.this.compiler.Name">name</a>) <span class="keyword">else</span> <span title="object Nil">Nil</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122445">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123538">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123539">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <a href="#123539" title="(x$1: java.lang.String)Unit">code</a> println <a href="#117179" title="(xs: String*)String">codegenln</a>(<span title="java.lang.String(&quot;defined type alias &quot;)" class="string">&quot;defined type alias &quot;</span>, <a href="#117239" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">name</a>)
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ImportHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117264">ImportHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.Import" id="122450">imp</a>: <a href="ast/Trees.scala.html#26643" title="Interpreter.this.compiler.Import">Import</a>) <span class="keyword">extends</span> <a href="#117256" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122450" title="Interpreter.this.compiler.Import">imp</a>) {
    /** Whether this import includes a wildcard import */
    <span class="keyword">override</span> <span class="keyword">val</span> <a title="Boolean" id="119825">importsWildcard</a> = <a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">imp</a>.<a href="ast/Trees.scala.html#98812" title="=&gt; List[(Trees.this.Name, Trees.this.Name)]">selectors</a>.<span title="(f: ((Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)) =&gt; Interpreter.this.compiler.Name)(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[(Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)]])List[Interpreter.this.compiler.Name]">map</span><span title="(elem: Any)Boolean">(</span><a href="#123582" title="(Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)">_</a>.<span title="=&gt; Interpreter.this.compiler.Name">_1</span>) contains <a href="symtab/StdNames.scala.html#29596" title="=&gt; Interpreter.this.compiler.Name">USCOREkw</a>

    /** The individual names imported by this statement */
    <span class="keyword">override</span> <span class="keyword">val</span> <a title="Seq[Interpreter.this.compiler.Name]" id="119827">importedNames</a>: <span title="Seq[Interpreter.this.compiler.Name]">Seq</span>[Name] = <span class="keyword">for</span> {
      (_, <a title="Interpreter.this.compiler.Name" id="123723">sel</a>) &lt;- <a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">imp</a>.<a href="ast/Trees.scala.html#98812" title="(f: ((Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,Seq[Interpreter.this.compiler.Name],List[(Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)]])Seq[Interpreter.this.compiler.Name]">selectors</a>
      <span class="keyword">if</span> (<a href="#123723" title="(x$1: AnyRef)Boolean">sel</a> <span title="(x$1: Boolean)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> &amp;&amp; <a href="#123723" title="(x$1: AnyRef)Boolean">sel</a> != <a href="symtab/StdNames.scala.html#29596" title="=&gt; Interpreter.this.compiler.Name">USCOREkw</a>)
      <a title="Interpreter.this.compiler.Name" id="123743">name</a> &lt;- <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span><span title="(f: (Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.compiler.Name]])List[Interpreter.this.compiler.Name]">(</span><a href="#123723" title="Interpreter.this.compiler.Name">sel</a>.<a href="symtab/Names.scala.html#28202" title="=&gt; Interpreter.this.compiler.Name">toTypeName</a>, <a href="#123723" title="Interpreter.this.compiler.Name">sel</a>.<a href="symtab/Names.scala.html#28201" title="=&gt; Interpreter.this.compiler.Name">toTermName</a>)
    }
    <span class="keyword">yield</span> <a href="#123743" title="Interpreter.this.compiler.Name">name</a>

    // record the import
    <a href="#117221" title="(x: Interpreter.this.compiler.Import)Interpreter.this.prevImports.type" id="61580">prevImports</a> += <a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">imp</a>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="119829">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123907">req</a>: <a href="#117265" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123908">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <a href="#123908" title="(x$1: java.lang.String)Unit">code</a> println <a href="#117179" title="(xs: String*)String">codegenln</a>(<a href="#122843" title="=&gt; Interpreter.this.compiler.Tree">imp</a>.<a href="ast/Trees.scala.html#29381" title="()String">toString</a>)
  }

  /** One line of code submitted by the user for interpretation */
  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class Request extends java.lang.Object with ScalaObject" id="117265">Request</a><span title="ScalaObject">(</span><span class="keyword">val</span> <a title="String" id="122332">line</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="122333">lineName</a>: <span title="String">String</span>) {
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Tree]" id="118968">trees</a> = <a href="#117244" title="(line: String)Option[List[Interpreter.this.compiler.Tree]]">parse</a><span title="(default: =&gt; List[Interpreter.this.compiler.Tree])List[Interpreter.this.compiler.Tree]">(</span><a href="#122332" title="=&gt; String">line</a>) getOrElse <span title="object Nil">Nil</span>

    /** name to use for the object that will compute &quot;line&quot; */
    <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="118970">objectName</a> = <a href="#122333" title="(x$1: Any)java.lang.String">lineName</a> + <a href="symtab/StdNames.scala.html#29628" title="=&gt; java.lang.String">INTERPRETER_WRAPPER_SUFFIX</a>

    /** name of the object that retrieves the result from the above object */
    <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="118971">resultObjectName</a> = <span title="(x$1: Any)java.lang.String" class="string">&quot;RequestResult$&quot;</span> + <a href="#118970" title="=&gt; java.lang.String">objectName</a>

    /** handlers for each tree in this request */
    <span class="keyword">val</span> <a title="List[Interpreter.this.MemberHandler]" id="118972">handlers</a>: <span title="List[Interpreter.this.MemberHandler]">List</span>[MemberHandler] = <a href="#118968" title="(f: (Interpreter.this.compiler.Tree) =&gt; Interpreter.this.MemberHandler)(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.MemberHandler,List[Interpreter.this.MemberHandler],List[Interpreter.this.compiler.Tree]])List[Interpreter.this.MemberHandler]">trees</a> <span title="scala.collection.generic.BuilderFactory[Interpreter.this.MemberHandler,List[Interpreter.this.MemberHandler],List#Coll]">map</span> <a href="#117248" title="(member: Interpreter.this.compiler.Tree)Interpreter.this.MemberHandler">chooseHandler</a>

    /** all (public) names defined by these statements */
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="118974">boundNames</a> = (<a title="(args: Interpreter.this.compiler.Name*)scala.collection.immutable.ListSet[Interpreter.this.compiler.Name]" id="7313">ListSet</a><span title="(elems: Traversable[Interpreter.this.compiler.Name])scala.collection.immutable.ListSet[Interpreter.this.compiler.Name]">(</span>) ++ <a href="#118972" title="=&gt; List[Interpreter.this.MemberHandler]">handlers</a>.<span title="(f: (Interpreter.this.MemberHandler) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.MemberHandler]])List[Interpreter.this.compiler.Name]">flatMap</span><span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">(</span><a href="#119169" title="Interpreter.this.MemberHandler">_</a>.<a href="#119176" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>)).<span title="=&gt; List[Interpreter.this.compiler.Name]">toList</span>

    /** list of names used by this expression */
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="118976">usedNames</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name] = <a href="#118972" title="=&gt; List[Interpreter.this.MemberHandler]">handlers</a>.<span title="(f: (Interpreter.this.MemberHandler) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.MemberHandler]])List[Interpreter.this.compiler.Name]">flatMap</span><span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">(</span><a href="#124076" title="Interpreter.this.MemberHandler">_</a>.<a href="#119174" title="=&gt; List[Interpreter.this.compiler.Name]">usedNames</a>) 

    /** Code to import bound names from previous lines - accessPath is code to
      * append to objectName to access anything bound by request. */
    <span class="keyword">val</span> ComputedImports<a href="#118979" title="(String, String, String)">(</a><a href="#118978" title="String" id="118979">importsPreamble</a>, <a href="#118978" title="String" id="118981">importsTrailer</a>, <a href="#118978" title="String" id="118983">accessPath</a>) =
      <a href="#117243" title="(wanted: Set[Interpreter.this.compiler.Name])Interpreter.this.ComputedImports">importsCode</a><a href="#119652" title="Interpreter.this.ComputedImports @unchecked">(</a><a title="=&gt; collection.immutable.Set.type" id="7851">Set</a>.<a title="(elems: Traversable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]" id="54344">empty</a> ++ <a href="#118976" title="=&gt; List[Interpreter.this.compiler.Name]">usedNames</a>)

    /** Code to access a variable with the specified name */
    <span class="keyword">def</span> <a title="(vname: String)String" id="118985">fullPath</a>(<a title="String" id="120892">vname</a>: <span title="String">String</span>): <span title="String">String</span> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;%s.`%s`\n&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#118970" title="(x$1: Any)java.lang.String">objectName</a> + <a href="#118983" title="=&gt; String">accessPath</a>, <a href="#120892" title="String">vname</a>)

    /** Code to access a variable with the specified name */
    <span class="keyword">def</span> <a title="(vname: Interpreter.this.compiler.Name)String" id="118986">fullPath</a>(<a title="Interpreter.this.compiler.Name" id="120890">vname</a>: <a href="symtab/Names.scala.html#26055" title="Interpreter.this.compiler.Name">Name</a>): <span title="String">String</span> = <a href="#118985" title="(vname: String)String">fullPath</a>(<a href="#120890" title="Interpreter.this.compiler.Name">vname</a>.<a href="symtab/Names.scala.html#28205" title="()String">toString</a>)

    /** the line of code to compute */
    <span class="keyword">def</span> <a title="=&gt; String" id="118987">toCompute</a> = <a href="#122332" title="=&gt; String">line</a>

    /** generate the source code for the object that computes this request */
    <span class="keyword">def</span> <a title="=&gt; String" id="118988">objectSourceCode</a>: <span title="String">String</span> = <a href="#117233" title="(writer: (java.io.PrintWriter) =&gt; Unit)String">stringFrom</a> { <a title="java.io.PrintWriter" id="124141">code</a> =&gt; 
      // whitespace compatible with interpreter.scala
      <span class="keyword">val</span> <a title="String" id="124142">preamble</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;object %s {
        |   %s%s
      &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">stripMargin</span>.<span title="(args: Any*)String">format</span>(<a href="#118970" title="=&gt; java.lang.String">objectName</a>, <a href="#118979" title="=&gt; String">importsPreamble</a>, <a href="#117238" title="(code: String)String">indentCode</a>(<a href="#118987" title="=&gt; String">toCompute</a>))     
      // val preamble = &quot;&quot;&quot;
      //   | object %s {
      //   |   %s %s
      // &quot;&quot;&quot;.stripMargin.format(objectName, importsPreamble, indentCode(toCompute))
      <span class="keyword">val</span> <a title="java.lang.String" id="124143">postamble</a> = <a href="#118981" title="(x$1: Any)java.lang.String">importsTrailer</a> + <span title="java.lang.String(&quot;; }&quot;)" class="string">&quot;; }&quot;</span>

      <a href="#124141" title="(x$1: java.lang.String)Unit">code</a> println <a href="#124142" title="String">preamble</a>
      <a href="#118972" title="(f: (Interpreter.this.MemberHandler) =&gt; Unit)Unit">handlers</a> foreach { <a href="#124208" title="Interpreter.this.MemberHandler">_</a>.<a href="#119185" title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit">extraCodeToEvaluate</a>(<a href="#117265" title="Interpreter.this.Request" class="keyword">this</a>, <a href="#124141" title="java.io.PrintWriter">code</a>) }
      <a href="#124141" title="(x$1: java.lang.String)Unit">code</a> println <a href="#124143" title="java.lang.String">postamble</a>
    }
      
    /** Types of variables defined by this request.  They are computed
        after compilation of the main object */
    <span class="keyword">var</span> <a title="Map[Interpreter.this.compiler.Name,String]" id="118990">typeOf</a>: <span title="Map[Interpreter.this.compiler.Name,String]">Map</span>[Name, String] = _
    <span class="keyword">def</span> <a title="(vname: Interpreter.this.compiler.Name)String" id="118992">typeOfEnc</a>(<a title="Interpreter.this.compiler.Name" id="122939">vname</a>: <a href="symtab/Names.scala.html#26055" title="Interpreter.this.compiler.Name">Name</a>) = <a href="#118990" title="(key: Interpreter.this.compiler.Name)String">typeOf</a>(<a href="symtab/StdNames.scala.html#26533" title="(str: String)Interpreter.this.compiler.Name">compiler</a> encode <a href="#117239" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">vname</a>)

    /** generate source code for the object that retrieves the result
        from objectSourceCode */
    <span class="keyword">def</span> <a title="=&gt; String" id="118993">resultObjectSourceCode</a>: <span title="String">String</span> = <a href="#117233" title="(writer: (java.io.PrintWriter) =&gt; Unit)String">stringFrom</a> { <a title="java.io.PrintWriter" id="124225">code</a> =&gt;
      <span class="keyword">val</span> <a title="String" id="124226">preamble</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;
      | object %s {
      |   val result: String = {
      |     %s    // evaluate object to make sure constructor is run
      |     (&quot;&quot;   // an initial &quot;&quot; so later code can uniformly be: + etc
      &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">stripMargin</span>.<span title="(args: Any*)String">format</span>(<a href="#118971" title="=&gt; java.lang.String">resultObjectName</a>, <a href="#118970" title="(x$1: Any)java.lang.String">objectName</a> + <a href="#118983" title="=&gt; String">accessPath</a>)
      
      <span class="keyword">val</span> <a title="String" id="124227">postamble</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;
      |     )
      |   }
      | }
      &quot;&quot;&quot;</span>.<span title="=&gt; String">stripMargin</span>

      <a href="#124225" title="(x$1: java.lang.String)Unit">code</a> println <a href="#124226" title="String">preamble</a>
      <a href="#118972" title="(f: (Interpreter.this.MemberHandler) =&gt; Unit)Unit">handlers</a> foreach { <a href="#124307" title="Interpreter.this.MemberHandler">_</a>.<a href="#119186" title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit">resultExtractionCode</a>(<a href="#117265" title="Interpreter.this.Request" class="keyword">this</a>, <a href="#124225" title="java.io.PrintWriter">code</a>) }
      <a href="#124225" title="(x$1: java.lang.String)Unit">code</a> println <a href="#124227" title="String">postamble</a>
    }

    /** Compile the object file.  Returns whether the compilation succeeded.
     *  If all goes well, the &quot;types&quot; map is computed. */
    <span class="keyword">def</span> <a title="()Boolean" id="118994">compile</a>(): <span title="Boolean">Boolean</span> = {
      // error counting is wrong, hence interpreter may overlook failure - so we reset
      <a href="#117206" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/AbstractReporter.scala.html#38799" title="=&gt; Unit">reset</a>

      // compile the main object
      <span class="keyword">val</span> <a title="Interpreter.this.compiler.Run" id="124321">objRun</a> = <span title="Interpreter.this.compiler.Run" class="keyword">new</span> <a href="#117191" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39178" title="Interpreter.this.compiler.Run">Run</a>()
      <a href="#124321" title="Interpreter.this.compiler.Run">objRun</a>.<a href="Global.scala.html#40218" title="(_sources: List[scala.tools.nsc.util.SourceFile])Unit">compileSources</a>(<span title="(xs: scala.tools.nsc.util.BatchSourceFile*)List[scala.tools.nsc.util.BatchSourceFile]">List</span>(<a href="util/SourceFile.scala.html#121007" title="(sourceName: String,cs: Seq[Char])scala.tools.nsc.util.BatchSourceFile" class="keyword">new</a> <a href="util/SourceFile.scala.html#14659" title="scala.tools.nsc.util.BatchSourceFile">BatchSourceFile</a>(<span title="java.lang.String(&quot;&lt;console&gt;&quot;)" class="string">&quot;&lt;console&gt;&quot;</span>, <a href="#118988" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">objectSourceCode</a>)))
      <span title="Unit" class="keyword">if</span> (<a href="#117206" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/Reporter.scala.html#38774" title="=&gt; Boolean">hasErrors</a>)
        <span title="Nothing" class="keyword">return</span> <span title="Boolean(false)" class="keyword">false</span>

      // extract and remember types 
      <a href="#118990" title="(x$1: Map[Interpreter.this.compiler.Name,String])Unit">typeOf</a> = <a href="#118995" title="(objRun: Interpreter.this.compiler.Run)Map[Interpreter.this.compiler.Name,String]">findTypes</a>(<a href="#124321" title="Interpreter.this.compiler.Run">objRun</a>)

      // compile the result-extraction object
      <span title="Interpreter.this.compiler.Run" class="keyword">new</span> <a href="#117191" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39178" title="Interpreter.this.compiler.Run">Run</a>().<a href="Global.scala.html#40218" title="(_sources: List[scala.tools.nsc.util.SourceFile])Unit">compileSources</a>(<span title="(xs: scala.tools.nsc.util.BatchSourceFile*)List[scala.tools.nsc.util.BatchSourceFile]">List</span>(<a href="util/SourceFile.scala.html#121007" title="(sourceName: String,cs: Seq[Char])scala.tools.nsc.util.BatchSourceFile" class="keyword">new</a> <a href="util/SourceFile.scala.html#14659" title="scala.tools.nsc.util.BatchSourceFile">BatchSourceFile</a>(<span title="java.lang.String(&quot;&lt;console&gt;&quot;)" class="string">&quot;&lt;console&gt;&quot;</span>, <a href="#118993" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">resultObjectSourceCode</a>)))

      // success
      <span title="=&gt; Boolean">!</span><a href="#117206" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/Reporter.scala.html#38774" title="=&gt; Boolean">hasErrors</a>
    }

    /** Dig the types of all bound variables out of the compiler run.
     *
     *  @param objRun ...
     *  @return       ...
     */
    <span class="keyword">def</span> <a title="(objRun: Interpreter.this.compiler.Run)Map[Interpreter.this.compiler.Name,String]" id="118995">findTypes</a>(<a title="Interpreter.this.compiler.Run" id="124374">objRun</a>: compiler.<a href="Global.scala.html#39178" title="Interpreter.this.compiler.Run">Run</a>): <span title="Map[Interpreter.this.compiler.Name,String]">Map</span>[Name, String] = {
      <span class="keyword">import</span> compiler.definitions.{ EmptyPackage, getMember }
      <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="124433">valAndVarNames</a> = <a href="#118972" title="(f: (Interpreter.this.MemberHandler) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.MemberHandler]])List[Interpreter.this.compiler.Name]">handlers</a> <span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">flatMap</span> { <a href="#124446" title="Interpreter.this.MemberHandler">_</a>.<a href="#119177" title="=&gt; List[Interpreter.this.compiler.Name]">valAndVarNames</a> }
      <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="124434">defNames</a> = <a href="#118972" title="(f: (Interpreter.this.MemberHandler) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.MemberHandler]])List[Interpreter.this.compiler.Name]">handlers</a> <span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">flatMap</span> { <a href="#124534" title="Interpreter.this.MemberHandler">_</a>.<a href="#119178" title="=&gt; List[Interpreter.this.compiler.Name]">defNames</a> }
      
      <span class="keyword">def</span> <a title="(names: List[Interpreter.this.compiler.Name],nameMap: (Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)Map[Interpreter.this.compiler.Name,String]" id="124435">getTypes</a>(<a title="List[Interpreter.this.compiler.Name]" id="124614">names</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name], <a title="(Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name" id="124615">nameMap</a>: Name =&gt; Name): <span title="Map[Interpreter.this.compiler.Name,String]">Map</span>[Name, String] = {
        <span class="keyword">def</span> <a title="[T](op: =&gt; T)T" id="124616">atNextPhase</a>[<a title="&gt;: Nothing &lt;: Any" id="124618">T</a>](<a title="=&gt; T" id="124621">op</a>: =&gt; T): <a href="#124618" title="T">T</a> = <a href="#117191" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="symtab/SymbolTable.scala.html#26097" title="(ph: scala.tools.nsc.Phase)(op: =&gt; T)T">atPhase</a>(<a href="#124374" title="Interpreter.this.compiler.Run">objRun</a>.<a href="Global.scala.html#40188" title="=&gt; scala.tools.nsc.Phase">typerPhase</a>.<a href="Phase.scala.html#23158" title="=&gt; scala.tools.nsc.Phase">next</a>)(<a href="#124621" title="=&gt; T">op</a>)
        
        /** the outermost wrapper object */
        <span class="keyword">val</span> <a title="Interpreter.this.compiler.Symbol" id="124619">outerResObjSym</a>: <a href="symtab/Symbols.scala.html#26127" title="Interpreter.this.compiler.Symbol">Symbol</a> = <a href="symtab/Definitions.scala.html#28578" title="(owner: Interpreter.this.compiler.Symbol,name: Interpreter.this.compiler.Name)Interpreter.this.compiler.Symbol">getMember</a>(<a href="symtab/Definitions.scala.html#28241" title="=&gt; Interpreter.this.compiler.TermSymbol">EmptyPackage</a>, <a href="symtab/Names.scala.html#26048" title="(s: String)Interpreter.this.compiler.Name">newTermName</a>(<a href="#118970" title="=&gt; java.lang.String">objectName</a>))

        /** the innermost object inside the wrapper, found by
          * following accessPath into the outer one. */
        <span class="keyword">val</span> <a title="Interpreter.this.compiler.Symbol" id="124620">resObjSym</a> =
          <a href="#118983" title="=&gt; String">accessPath</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span>(<span title="java.lang.String(&quot;\.&quot;)" class="string">&quot;\\.&quot;</span>).<a title="(z: Interpreter.this.compiler.Symbol)(op: (Interpreter.this.compiler.Symbol, java.lang.String) =&gt; Interpreter.this.compiler.Symbol)Interpreter.this.compiler.Symbol" id="25753">foldLeft</a>(<a href="#124619" title="Interpreter.this.compiler.Symbol">outerResObjSym</a>) { (<a title="Interpreter.this.compiler.Symbol" id="124661">sym</a>, <a title="java.lang.String" id="124662">name</a>) =&gt;
            <span title="Interpreter.this.compiler.Symbol" class="keyword">if</span> (<a href="#124662" title="(x$1: AnyRef)Boolean">name</a> == <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>) <a href="#124661" title="Interpreter.this.compiler.Symbol">sym</a> <span class="keyword">else</span>
            <a href="#124616" title="(op: =&gt; Interpreter.this.compiler.Symbol)Interpreter.this.compiler.Symbol">atNextPhase</a>(<a href="#124661" title="Interpreter.this.compiler.Symbol">sym</a>.<a href="symtab/Types.scala.html#30217" title="(name: Interpreter.this.compiler.Name)Interpreter.this.compiler.Symbol">info</a> member <a href="symtab/Names.scala.html#26048" title="(s: String)Interpreter.this.compiler.Name">newTermName</a>(<a href="#124662" title="java.lang.String">name</a>))
          }

        <a href="#124614" title="List[Interpreter.this.compiler.Name]">names</a>.<a title="(z: scala.collection.immutable.Map[Interpreter.this.compiler.Name,String])(f: (scala.collection.immutable.Map[Interpreter.this.compiler.Name,String], Interpreter.this.compiler.Name) =&gt; scala.collection.immutable.Map[Interpreter.this.compiler.Name,String])scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]" id="28943">foldLeft</a>(<a title="=&gt; collection.immutable.Map.type" id="7849">Map</a>.<a title="[A, B]scala.collection.immutable.Map[A,B]" id="44848">empty</a><span title="scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]">[</span><a href="symtab/Names.scala.html#26055" title="Interpreter.this.compiler.Name">Name</a>, <span title="String">String</span>]) { (<a title="scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]" id="124698">map</a>, <a title="Interpreter.this.compiler.Name" id="124699">name</a>) =&gt;
          <span class="keyword">val</span> <a title="Interpreter.this.compiler.Type" id="124700">rawType</a> = <a href="#124616" title="(op: =&gt; Interpreter.this.compiler.Type)Interpreter.this.compiler.Type">atNextPhase</a>(<a href="#124620" title="Interpreter.this.compiler.Symbol">resObjSym</a>.<a href="symtab/Symbols.scala.html#27004" title="=&gt; Interpreter.this.compiler.Type">info</a>.<a href="symtab/Types.scala.html#30217" title="(name: Interpreter.this.compiler.Name)Interpreter.this.compiler.Symbol">member</a>(<a href="#124699" title="Interpreter.this.compiler.Name">name</a>).<a href="symtab/Symbols.scala.html#27003" title="=&gt; Interpreter.this.compiler.Type">tpe</a>)
          // the types are all =&gt;T; remove the =&gt;
          <span class="keyword">val</span> <a title="Interpreter.this.compiler.Type" id="124701">cleanedType</a> = <a href="#124700" title="Interpreter.this.compiler.Type">rawType</a> <span title="Interpreter.this.compiler.Type" class="keyword">match</span> { 
            <span title="Interpreter.this.compiler.Type" class="keyword">case</span> compiler.PolyType(<span title="object Nil">Nil</span>, <a title="Interpreter.this.compiler.Type" id="124712">rt</a>) =&gt; <a href="#124712" title="Interpreter.this.compiler.Type">rt</a>
            <span title="Interpreter.this.compiler.Type" class="keyword">case</span> <a title="Interpreter.this.compiler.Type" id="124715">rawType</a> =&gt; <a href="#124715" title="Interpreter.this.compiler.Type">rawType</a>
          }

          <a href="#124698" title="(kv: (Interpreter.this.compiler.Name, String))scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]" id="44832">map</a> + (<a href="#124699" title="(y: String)(Interpreter.this.compiler.Name, String)" id="7952">name</a> -&gt; <a href="#124616" title="(op: =&gt; String)String">atNextPhase</a>(<a href="#124701" title="Interpreter.this.compiler.Type">cleanedType</a>.<a href="symtab/Types.scala.html#30267" title="()String">toString</a>))
        }
      }

      <span class="keyword">val</span> <a title="Map[Interpreter.this.compiler.Name,String]" id="124436">names1</a> = <a href="#124435" title="(names: List[Interpreter.this.compiler.Name],nameMap: (Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)Map[Interpreter.this.compiler.Name,String]">getTypes</a>(<a href="#124433" title="=&gt; List[Interpreter.this.compiler.Name]">valAndVarNames</a>, <a href="symtab/StdNames.scala.html#26531" title="object Interpreter.this.compiler.nme">nme</a>.<a href="symtab/StdNames.scala.html#29664" title="(name: Interpreter.this.compiler.Name)Interpreter.this.compiler.Name">getterToLocal</a>(<a href="#124859" title="Interpreter.this.compiler.Name">_</a>))
      <span class="keyword">val</span> <a title="Map[Interpreter.this.compiler.Name,String]" id="124437">names2</a> = <a href="#124435" title="(names: List[Interpreter.this.compiler.Name],nameMap: (Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)Map[Interpreter.this.compiler.Name,String]">getTypes</a>(<a href="#124434" title="=&gt; List[Interpreter.this.compiler.Name]">defNames</a>, <a href="#124870" title="(x: Interpreter.this.compiler.Name)Interpreter.this.compiler.Name" id="7866">identity</a>)
      <a href="#124436" title="(elems: Traversable[(Interpreter.this.compiler.Name, String)])scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]" id="46741">names1</a> ++ <a href="#124437" title="Map[Interpreter.this.compiler.Name,String]">names2</a>
    }

    /** load and run the code using reflection */
    <span class="keyword">def</span> <a title="=&gt; (String, Boolean)" id="118996">loadAndRun</a>: <span title="(String, Boolean)">(</span>String, Boolean) = {
      <span class="keyword">val</span> <a title="java.lang.Class[_]" id="125047">resultObject</a>: <span title="java.lang.Class[_]">Class</span>[_] = <a href="#117215" title="(s: String)java.lang.Class[_]">loadByName</a>(<a href="#118971" title="=&gt; java.lang.String">resultObjectName</a>)
      <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="125048">resultValMethod</a>: reflect.<span title="java.lang.reflect.Method">Method</span> = <a href="#125047" title="(x$1: java.lang.String,x$2: java.lang.Class[_]*)java.lang.reflect.Method">resultObject</a> getMethod <span title="java.lang.String(&quot;result&quot;)" class="string">&quot;result&quot;</span>
      // XXX if wrapperExceptions isn't type-annotated we crash scalac
      <span class="keyword">val</span> <a title="List[java.lang.Class[_ &lt;: Throwable]]" id="125049">wrapperExceptions</a>: <span title="List[java.lang.Class[_ &lt;: Throwable]]">List</span>[Class[_ &lt;: Throwable]] =
        <span title="(xs: java.lang.Class[_ &gt;: java.lang.ExceptionInInitializerError with java.lang.reflect.InvocationTargetException &lt;: java.lang.Throwable]*)List[java.lang.Class[_ &gt;: java.lang.ExceptionInInitializerError with java.lang.reflect.InvocationTargetException &lt;: java.lang.Throwable]]">List</span>(classOf<span title="java.lang.Class[java.lang.reflect.InvocationTargetException]">[</span>InvocationTargetException], classOf<span title="java.lang.Class[java.lang.ExceptionInInitializerError]">[</span>ExceptionInInitializerError])
      
      <span class="keyword">def</span> <a title="=&gt; util.control.Exception.Catcher[(String, Boolean)]" id="125050">onErr</a>: <a title="util.control.Exception.Catcher[(String, Boolean)]" id="1085">Catcher</a>[(String, Boolean)] = <a href="#125125" title="(String, Boolean)">{</a> <span title="(String, Boolean)" class="keyword">case</span> <a title="java.lang.Throwable" id="125126">t</a>: <a title="Throwable" id="1887">Throwable</a> =&gt;
        <a href="#117201" title="(operation: =&gt; scala.tools.nsc.InterpreterResults.Result)scala.tools.nsc.InterpreterResults.Result">beQuietDuring</a> { <a href="#117252" title="(name: String,boundType: String,value: Any)scala.tools.nsc.InterpreterResults.Result">bind</a>(<span title="java.lang.String(&quot;lastException&quot;)" class="string">&quot;lastException&quot;</span>, <span title="java.lang.String(&quot;java.lang.Throwable&quot;)" class="string">&quot;java.lang.Throwable&quot;</span>, <a href="#125126" title="java.lang.Throwable">t</a>) }
        <span title="(_1: String,_2: Boolean)(String, Boolean)">(</span><a href="#117233" title="(writer: (java.io.PrintWriter) =&gt; Unit)String">stringFrom</a>(<a href="#125126" title="java.lang.Throwable">t</a>.<a title="(x$1: java.io.PrintWriter)Unit" id="25935">printStackTrace</a>(<a href="#125139" title="java.io.PrintWriter">_</a>)), <span title="Boolean(false)" class="keyword">false</span>)
      }
      
      <a title="(c: util.control.Exception.Catcher[(String, Boolean)])util.control.Exception.Catch[(String, Boolean)]" id="117127">catching</a><span title="(body: =&gt; (String, Boolean))(String, Boolean)">(</span><a href="#125050" title="=&gt; util.control.Exception.Catcher[(String, Boolean)]">onErr</a>) {
        <a title="(exceptions: Class[_]*)util.control.Exception.Catch[Nothing]" id="117157">unwrapping</a><span title="(body: =&gt; (java.lang.String, Boolean))(java.lang.String, Boolean)">(</span><a href="#125049" title="List[java.lang.Class[_ &lt;: Throwable]]">wrapperExceptions</a>: _*) {
          <span title="(_1: java.lang.String,_2: Boolean)(java.lang.String, Boolean)">(</span><a href="#125048" title="java.lang.reflect.Method">resultValMethod</a>.<span title="(x$1: Any,x$2: java.lang.Object*)java.lang.Object">invoke</span>(<a href="#125047" title="java.lang.Class[_]">resultObject</a>).<span title="()java.lang.String">toString</span>, <span title="Boolean(true)" class="keyword">true</span>)
        }
      }
    }
  }
  
  /** These methods are exposed so REPL commands can access them.
   *  The command infrastructure is in InterpreterLoop.
   */
  <span class="keyword">def</span> <a title="(xs: List[String])String" id="117266">dumpState</a>(<a title="List[String]" id="125203">xs</a>: <span title="List[String]">List</span>[String]): <span title="String">String</span> = {
    // println(&quot;Imports for &quot; + req + &quot; =&gt; &quot; + req.importsPreamble)
    // req.handlers foreach { h =&gt; println(&quot;Handler &quot; + h + &quot; used names: &quot; + h.usedNames) }
    // req.trees foreach { x =&gt; println(&quot;Tree: &quot; + x) }
    // xs foreach { x =&gt; println(&quot;membersOfIdentifier(&quot; + x + &quot;) = &quot; + membersOfIdentifier(x)) }
    <span title="(xs: java.lang.Object*)List[java.lang.Object]">List</span>(
      <span title="(x$1: Any)java.lang.String" class="string">&quot;allUsedNames = &quot;</span> + <a href="#117223" title="=&gt; List[Interpreter.this.compiler.Name]">allUsedNames</a>,
      <span title="(x$1: Any)java.lang.String" class="string">&quot;allBoundNames = &quot;</span> + <a href="#117224" title="=&gt; List[Interpreter.this.compiler.Name]">allBoundNames</a>,
      <a href="#117219" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<span title="=&gt; List[Interpreter.this.Request]">toList</span>.<span title="(f: (Interpreter.this.Request) =&gt; java.lang.String)(implicit bf: scala.collection.generic.BuilderFactory[java.lang.String,List[java.lang.String],List[Interpreter.this.Request]])List[java.lang.String]">map</span><span title="scala.collection.generic.BuilderFactory[java.lang.String,List[java.lang.String],List#Coll]">(</span><a title="Interpreter.this.Request" id="125223">req</a> =&gt; <span title="(x$1: Any)java.lang.String" class="string">&quot;  \&quot;&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#125223" title="Interpreter.this.Request">req</a>.<a href="#122332" title="=&gt; String">line</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;&quot; =&gt; &quot;)" class="string">&quot;\&quot; =&gt; &quot;</span> + <a href="#125223" title="Interpreter.this.Request">req</a>.<a href="#118988" title="=&gt; String">objectSourceCode</a>)
    ).<span title="(start: String,sep: String,end: String)String">mkString</span>(<span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>, <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>)
  }
      
  // very simple right now, will get more interesting
  <span class="keyword">def</span> <a title="(xs: List[String])String" id="117267">dumpTrees</a>(<a title="List[String]" id="125332">xs</a>: <span title="List[String]">List</span>[String]): <span title="String">String</span> = {
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Tree]" id="125334">treestrs</a> = 
      <span title="object List">List</span>.<a title="(xss: List[List[Interpreter.this.compiler.Tree]])List[Interpreter.this.compiler.Tree]" id="24330">flatten</a>(
        <span class="keyword">for</span> (<a title="String" id="125345">x</a> &lt;- <a href="#125332" title="(f: (String) =&gt; Traversable[List[Interpreter.this.compiler.Tree]])(implicit bf: scala.collection.generic.BuilderFactory[List[Interpreter.this.compiler.Tree],List[List[Interpreter.this.compiler.Tree]],List[String]])List[List[Interpreter.this.compiler.Tree]]">xs</a> ; <a title="Interpreter.this.compiler.Name" id="125365">name</a> &lt;- <a href="#117269" title="(line: String)Option[Interpreter.this.compiler.Name]">nameOfIdent</a><span title="(f: (Interpreter.this.compiler.Name) =&gt; Option[List[Interpreter.this.compiler.Tree]])Option[List[Interpreter.this.compiler.Tree]]">(</span><a href="#125345" title="String">x</a>) ; <a title="Interpreter.this.Request" id="125374">req</a> &lt;- <a href="#117270" title="(name: Interpreter.this.compiler.Name)Option[Interpreter.this.Request]">requestForName</a><span title="(f: (Interpreter.this.Request) =&gt; List[Interpreter.this.compiler.Tree])Option[List[Interpreter.this.compiler.Tree]]">(</span><a href="#125365" title="Interpreter.this.compiler.Name">name</a>))
        <span class="keyword">yield</span> <a href="#125374" title="Interpreter.this.Request">req</a>.<a href="#118968" title="=&gt; List[Interpreter.this.compiler.Tree]">trees</a>
      )

    <span title="String" class="keyword">if</span> (<a href="#125334" title="List[Interpreter.this.compiler.Tree]">treestrs</a>.<a title="=&gt; Boolean" id="25434">isEmpty</a>) <span title="java.lang.String(&quot;No trees found.&quot;)" class="string">&quot;No trees found.&quot;</span>
    <span class="keyword">else</span> <a href="#125334" title="List[Interpreter.this.compiler.Tree]">treestrs</a>.<span title="(f: (Interpreter.this.compiler.Tree) =&gt; java.lang.String)(implicit bf: scala.collection.generic.BuilderFactory[java.lang.String,List[java.lang.String],List[Interpreter.this.compiler.Tree]])List[java.lang.String]">map</span><span title="scala.collection.generic.BuilderFactory[java.lang.String,List[java.lang.String],List#Coll]">(</span><a title="Interpreter.this.compiler.Tree" id="125505">t</a> =&gt; <a href="#125505" title="Interpreter.this.compiler.Tree">t</a>.<a href="ast/Trees.scala.html#29381" title="(x$1: Any)java.lang.String">toString</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; (&quot;)" class="string">&quot; (&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#125505" title="Interpreter.this.compiler.Tree">t</a>.<span title="()java.lang.Class[_]">getClass</span>.<a title="()java.lang.String" id="4830">getSimpleName</a> + <span title="java.lang.String(&quot;)\012&quot;)" class="string">&quot;)\n&quot;</span>).<span title="=&gt; String">mkString</span>
  }
      
  <span class="keyword">def</span> <a title="()String" id="117268">powerUser</a>(): <span title="String">String</span> = {
    <a href="#117201" title="(operation: =&gt; scala.tools.nsc.InterpreterResults.Result)scala.tools.nsc.InterpreterResults.Result">beQuietDuring</a> {
      <span class="keyword">val</span> <a title="java.lang.String" id="125602">mkTypeCmd</a> =
        <span title="java.lang.String(&quot;def mkType(name: String, what: String) = interpreter.interpret(&quot;type &quot; + name + &quot; = &quot; + what)&quot;)" class="string">&quot;&quot;&quot;def mkType(name: String, what: String) = interpreter.interpret(&quot;type &quot; + name + &quot; = &quot; + what)&quot;&quot;&quot;</span>
      
      <a href="#8370" title="Interpreter.this.type" class="keyword">this</a>.<a href="#117252" title="(name: String,boundType: String,value: Any)scala.tools.nsc.InterpreterResults.Result">bind</a>(<span title="java.lang.String(&quot;interpreter&quot;)" class="string">&quot;interpreter&quot;</span>, <span title="java.lang.String(&quot;scala.tools.nsc.Interpreter&quot;)" class="string">&quot;scala.tools.nsc.Interpreter&quot;</span>, <a href="#8370" title="scala.tools.nsc.Interpreter" class="keyword">this</a>)
      <a href="#117249" title="(line: String)scala.tools.nsc.InterpreterResults.Result">interpret</a>(<a href="#125602" title="java.lang.String">mkTypeCmd</a>)
    }
    
    <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;** Power User mode enabled - BEEP BOOP      **
      |** New vals! Try interpreter.&lt;tab&gt;          **
      |** New defs! Try mkType(&quot;T&quot;, &quot;String&quot;)      **
      |** New cmds! :help to discover them         **&quot;&quot;&quot;</span>.<span title="=&gt; String">stripMargin</span>
  }
  
  <span class="keyword">def</span> <a title="(line: String)Option[Interpreter.this.compiler.Name]" id="117269">nameOfIdent</a>(<a title="String" id="125346">line</a>: <span title="String">String</span>): <span title="Option[Interpreter.this.compiler.Name]">Option</span>[Name] = {
    <a href="#117244" title="(line: String)Option[List[Interpreter.this.compiler.Tree]]">parse</a>(<a href="#125346" title="String">line</a>) <span title="Option[Interpreter.this.compiler.Name]" class="keyword">match</span> {
      <span title="Some[Interpreter.this.compiler.Name]" class="keyword">case</span> Some(<a href="#125631" title="(x: List[Interpreter.this.compiler.Tree])Some[List[Interpreter.this.compiler.Tree]]" id="24409">List</a>(Ident(<a title="Interpreter.this.compiler.Name" id="125643">x</a>))) =&gt; <span title="(x: Interpreter.this.compiler.Name)Some[Interpreter.this.compiler.Name]">Some</span>(<a href="#125643" title="Interpreter.this.compiler.Name">x</a>)
      <span title="None.type" class="keyword">case</span> _                    =&gt; <span title="object None">None</span>
    }
  }
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: Interpreter.this.compiler.Name)Option[Interpreter.this.Request]" id="117270">requestForName</a>(<a title="Interpreter.this.compiler.Name" id="125366">name</a>: <a href="symtab/Names.scala.html#26055" title="Interpreter.this.compiler.Name">Name</a>): <span title="Option[Interpreter.this.Request]">Option</span>[Request] = {
    <span class="keyword">for</span> (<a title="Interpreter.this.Request" id="125672">req</a> &lt;- <a href="#117219" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<span title="=&gt; List[Interpreter.this.Request]">toList</span>.<span title="(f: (Interpreter.this.Request) =&gt; Unit)Unit">reverse</span>) {
      <span title="Unit" class="keyword">if</span> (<a href="#125672" title="Interpreter.this.Request">req</a>.<a href="#118972" title="=&gt; List[Interpreter.this.MemberHandler]">handlers</a>.<span title="(p: (Interpreter.this.MemberHandler) =&gt; Boolean)Boolean">exists</span>(<a href="#125677" title="Interpreter.this.MemberHandler">_</a>.<a href="#119176" title="(elem: Any)Boolean">boundNames</a> contains <a href="#125366" title="Interpreter.this.compiler.Name">name</a>))
        <span title="Nothing" class="keyword">return</span> <span title="(x: Interpreter.this.Request)Some[Interpreter.this.Request]">Some</span>(<a href="#125672" title="Interpreter.this.Request">req</a>)
    }
    <span title="object None">None</span>
  }
  
  // XXX at the moment this is imperfect because scala's protected semantics
  // differ from java's, so protected methods appear public via reflection;
  // yet scala enforces the protection.  The result is that protected members
  // appear in completion yet cannot actually be called.  Fixing this 
  // properly requires a scala.reflect.* API.  Fixing it uglily is possible
  // too (cast to structural type!) but I deem poor use of energy.
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Int" id="117271">filterFlags</a>: <a title="Int" id="2177">Int</a> = {
    <span class="keyword">import</span> java.lang.reflect.Modifier._
    STATIC | PRIVATE <span title="Int(14)">|</span> PROTECTED
  }
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="String" id="117273">methodsCode</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot; .
    | asInstanceOf[AnyRef].getClass.getMethods .
    | filter(x =&gt; (x.getModifiers &amp; %d) == 0) .
    | map(_.getName) .
    | mkString(&quot; &quot;)&quot;&quot;&quot;</span>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">stripMargin</span>.<span title="(args: Any*)String">format</span>(<a href="#117271" title="=&gt; Int">filterFlags</a>)  
  
  /** The main entry point for tab-completion.  When the user types x.&lt;tab&gt;
   *  this method is called with &quot;x&quot; as an argument, and it discovers the
   *  fields and methods of x via reflection and returns their names to jline.
   */
  <span class="keyword">def</span> <a title="(line: String)List[String]" id="117275">membersOfIdentifier</a>(<a title="String" id="125754">line</a>: <span title="String">String</span>): <span title="List[String]">List</span>[String] = {
    <span class="keyword">import</span> Completion.{ isValidCompletion }
    <span class="keyword">import</span> NameTransformer.{ decode, encode }   // e.g. $plus$plus =&gt; ++
    
    <span class="keyword">val</span> <a title="Option[List[String]]" id="125758">res</a> = <a href="#117201" title="(operation: =&gt; Option[List[String]])Option[List[String]]">beQuietDuring</a> {
      <span class="keyword">for</span> (<a title="Interpreter.this.compiler.Name" id="125784">name</a> &lt;- <a href="#117269" title="(line: String)Option[Interpreter.this.compiler.Name]">nameOfIdent</a><span title="(f: (Interpreter.this.compiler.Name) =&gt; Option[List[String]])Option[List[String]]">(</span><a href="#125754" title="String">line</a>) ; <a title="Interpreter.this.Request" id="125791">req</a> &lt;- <a href="#117270" title="(name: Interpreter.this.compiler.Name)Option[Interpreter.this.Request]">requestForName</a><span title="(f: (Interpreter.this.Request) =&gt; List[String])Option[List[String]]">(</span><a href="#125784" title="Interpreter.this.compiler.Name">name</a>)) <span class="keyword">yield</span> {
        <span title="List[String]" class="keyword">if</span> (<a href="#117249" title="(line: String)scala.tools.nsc.InterpreterResults.Result">interpret</a><span title="(x$1: AnyRef)Boolean">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;val &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#117479" title="()String">synthVarNameCreator</a>() <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; = &quot;)" class="string">&quot; = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#125784" title="Interpreter.this.compiler.Name">name</a> + <a href="#117273" title="=&gt; String">methodsCode</a>) != <a href="InterpreterResults.scala.html#8377" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#122491" title="object scala.tools.nsc.InterpreterResults.Success">Success</a>) <span title="object Nil">Nil</span>
        <span class="keyword">else</span> {
          <span class="keyword">val</span> <a title="java.lang.String" id="125811">result</a> = <a href="#117219" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<a title="=&gt; Interpreter.this.Request" id="25782">last</a>.<a href="#118971" title="=&gt; java.lang.String">resultObjectName</a>
          <span class="keyword">val</span> <a title="Class[Nothing]" id="125812">resultObj</a> = (<a href="#117212" title="(path: String)Option[Class[Nothing]]">classLoader</a> tryToInitializeClass <a href="#125811" title="java.lang.String">result</a>).<span title="=&gt; Class[Nothing]">get</span>
          <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="125813">valMethod</a> = <a href="#125812" title="(x$1: java.lang.String,x$2: java.lang.Class[_]*)java.lang.reflect.Method">resultObj</a> getMethod <span title="java.lang.String(&quot;result&quot;)" class="string">&quot;result&quot;</span>
          <span class="keyword">val</span> <a title="java.lang.String" id="125814">str</a> = <a href="#125813" title="java.lang.reflect.Method">valMethod</a>.<span title="(x$1: Any,x$2: java.lang.Object*)java.lang.Object">invoke</span>(<a href="#125812" title="Class[Nothing]">resultObj</a>).<span title="()java.lang.String">toString</span>
        
          <a href="#125814" title="java.lang.String">str</a>.<a title="(x$1: Int)java.lang.String" id="7014">substring</a>(<a href="#125814" title="java.lang.String">str</a>.<a title="(x$1: Int)Int" id="6978">indexOf</a><span title="(x$1: Int)Int">(</span><span title="Int(61)" class="char">'='</span>) + <span title="Int(1)" class="int">1</span>).<a title="()java.lang.String" id="7051">trim</a> .
          <span title="(x$1: java.lang.String)Array[java.lang.String]">split</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>).<span title="=&gt; List[java.lang.String]">toList</span> .
          <span title="(f: (java.lang.String) =&gt; String)(implicit bf: scala.collection.generic.BuilderFactory[String,List[String],List[java.lang.String]])List[String]">map</span><span title="scala.collection.generic.BuilderFactory[String,List[String],List#Coll]">(</span><a href="#125887" title="(name0: String)String">decode</a>) .
          <span title="(p: (String) =&gt; Boolean)List[String]">filter</span>(<a href="interpreter/Completion.scala.html#125771" title="(x: String)Boolean">isValidCompletion</a>) .
          <span title="=&gt; List[String]">removeDuplicates</span>
        }
      }
    }
      
    <a href="#125758" title="(default: =&gt; List[String])List[String]">res</a> getOrElse <span title="object Nil">Nil</span>
  }
  
  /** Another entry point for tab-completion, ids in scope */
  <span class="keyword">def</span> <a title="()List[String]" id="117276">unqualifiedIds</a>(): <span title="List[String]">List</span>[String] =
    <a href="#117224" title="=&gt; List[Interpreter.this.compiler.Name]">allBoundNames</a> .
      <span title="(f: (Interpreter.this.compiler.Name) =&gt; String)(implicit bf: scala.collection.generic.BuilderFactory[String,List[String],List[Interpreter.this.compiler.Name]])List[String]">map</span><span title="scala.collection.generic.BuilderFactory[String,List[String],List#Coll]">(</span><a href="#126778" title="Interpreter.this.compiler.Name">_</a>.<a href="symtab/Names.scala.html#28205" title="()String">toString</a>) .
      <span title="(p: (String) =&gt; Boolean)List[String]">filter</span>(<span title="=&gt; Boolean">!</span><a href="#117232" title="(name: String)Boolean">isSynthVarName</a>(<a href="#126862" title="String">_</a>))
   
  /** For static/object method completion */ 
  <span class="keyword">def</span> <a title="(path: String)Option[java.lang.Class[_]]" id="117277">getClassObject</a>(<a title="String" id="126867">path</a>: <span title="String">String</span>): <span title="Option[java.lang.Class[_]]">Option</span>[Class[_]] = <a href="#117212" title="(path: String)Option[Class[Nothing]]" id="117423">classLoader</a> tryToLoadClass <a href="#126867" title="String">path</a>
  
  // debugging
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Boolean" id="117279">debuggingOutput</a> = <span title="Boolean(false)" class="keyword">false</span>
  <span class="keyword">def</span> <a title="(s: String)Unit" id="117281">DBG</a>(<a title="String" id="126876">s</a>: <span title="String">String</span>) = <span title="Unit" class="keyword">if</span> (<a href="#117279" title="=&gt; Boolean">debuggingOutput</a>) <a href="#117560" title="(x$1: java.lang.String)Unit">out</a> println <a href="#126876" title="String">s</a> <span class="keyword">else</span> <span title="Unit">(</span>)  
}

/** Utility methods for the Interpreter. */
<span class="keyword">object</span> <a title="object scala.tools.nsc.Interpreter" id="8371">Interpreter</a> <span title="ScalaObject">{</span>
  <span class="keyword">object</span> <a title="object scala.tools.nsc.Interpreter.DebugParam" id="117171">DebugParam</a> <span title="ScalaObject">{</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](x: (String, T))(implicit m: scala.reflect.Manifest[T])scala.tools.nsc.Interpreter.DebugParam[T]" id="126895">tuple2debugparam</a>[<a title="&gt;: Nothing &lt;: Any" id="126897">T</a>](<a title="(String, T)" id="126934">x</a>: <span title="(String, T)">(</span>String, T))(<span class="keyword">implicit</span> <a title="scala.reflect.Manifest[T]" id="126935">m</a>: scala.reflect.<span title="scala.reflect.Manifest[T]">Manifest</span>[T]): <a href="#127362" title="scala.tools.nsc.Interpreter.DebugParam[T]">DebugParam</a>[T] =
      <a href="#127362" title="(name: String,param: T)(implicit m: scala.reflect.Manifest[T])scala.tools.nsc.Interpreter.DebugParam[T]">DebugParam</a><a href="#126935" title="scala.reflect.Manifest[T]">(</a><a href="#126934" title="(String, T)">x</a>.<span title="=&gt; String">_1</span>, <a href="#126934" title="(String, T)">x</a>.<span title="=&gt; T">_2</span>)
    
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](x: T)(implicit m: scala.reflect.Manifest[T])scala.tools.nsc.Interpreter.DebugParam[T]" id="126898">any2debugparam</a>[<a title="&gt;: Nothing &lt;: Any" id="126900">T</a>](<a title="T" id="126958">x</a>: <a href="#126900" title="T">T</a>)(<span class="keyword">implicit</span> <a title="scala.reflect.Manifest[T]" id="126959">m</a>: scala.reflect.<span title="scala.reflect.Manifest[T]">Manifest</span>[T]): <a href="#127362" title="scala.tools.nsc.Interpreter.DebugParam[T]">DebugParam</a>[T] =
      <a href="#127362" title="(name: String,param: T)(implicit m: scala.reflect.Manifest[T])scala.tools.nsc.Interpreter.DebugParam[T]">DebugParam</a><a href="#126959" title="scala.reflect.Manifest[T]">(</a><span title="(x$1: Any)java.lang.String" class="string">&quot;p&quot;</span> + <a href="#126904" title="()Int">getCount</a>(), <a href="#126958" title="T">x</a>)
    
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="126902">counter</a> = <span title="Int(0)" class="int">0</span> 
    <span class="keyword">def</span> <a title="()Int" id="126904">getCount</a>() = { <a href="#126902" title="(x$1: Int)Unit">counter</a> += <span title="Int(1)" class="int">1</span>; <a href="#126902" title="=&gt; Int">counter</a> }
  }
  case <span class="keyword">class</span> <a href="#127290" title="[T](x$0: scala.tools.nsc.Interpreter.DebugParam[T])Some[(String, T)]" id="127362">DebugParam</a>[<a title="&gt;: Nothing &lt;: Any" id="127292">T</a>]<span title="ScalaObject">(</span><a title="String" id="127290">name</a>: <span title="String">String</span>, <a title="T" id="127293">param</a>: <a href="#127292" title="T">T</a>)(<span class="keyword">implicit</span> <a title="scala.reflect.Manifest[T]" id="127296">m</a>: scala.reflect.<span title="scala.reflect.Manifest[T]">Manifest</span>[T]) {
    <span class="keyword">val</span> <a title="scala.reflect.Manifest[T]" id="126917">manifest</a> = <a href="#127296" title="scala.reflect.Manifest[T]">m</a>
    <span class="keyword">val</span> <a title="String" id="126919">typeStr</a> = {
      <span class="keyword">val</span> <a title="java.lang.String" id="127069">str</a> = <a href="#126917" title="=&gt; scala.reflect.Manifest[T]">manifest</a>.<span title="()java.lang.String">toString</span>
      // I'm sure there are more to be discovered...
      <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="127070">regexp1</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;(.*?)\[(.*)\]&quot;&quot;&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="127071">regexp2str</a> = <span title="java.lang.String(&quot;.*\.type#&quot;)" class="string">&quot;&quot;&quot;.*\.type#&quot;&quot;&quot;</span>
      <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="127072">regexp2</a> = (<a href="#127071" title="(x$1: Any)java.lang.String">regexp2str</a> <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">+</span> <span title="java.lang.String(&quot;(.*)&quot;)" class="string">&quot;&quot;&quot;(.*)&quot;&quot;&quot;</span>).<span title="=&gt; scala.util.matching.Regex">r</span>
      
      (<a href="#127069" title="java.lang.String">str</a>.<span title="(x$1: java.lang.String,x$2: java.lang.String)java.lang.String">replaceAll</span>(<span title="java.lang.String(&quot;\n&quot;)" class="string">&quot;&quot;&quot;\n&quot;&quot;&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>)) <span title="String" class="keyword">match</span> {
        <span title="String" class="keyword">case</span> <a href="#127070" title="(target: Any)Option[List[String]]">regexp1</a>(<a title="String" id="127253">clazz</a>, <a title="String" id="127254">typeArgs</a>) =&gt; <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;%s[%s]&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#127253" title="String">clazz</a>, <a href="#127254" title="String">typeArgs</a>.<span title="(x$1: java.lang.String,x$2: java.lang.String)java.lang.String">replaceAll</span>(<a href="#127071" title="java.lang.String">regexp2str</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>))
        <span title="String" class="keyword">case</span> <a href="#127072" title="(target: Any)Option[List[String]]">regexp2</a>(<a title="String" id="127282">clazz</a>)           =&gt; <a href="#127282" title="String">clazz</a>
        <span title="java.lang.String" class="keyword">case</span> _                        =&gt; <a href="#127069" title="java.lang.String">str</a>
      }
    }
  }
  <span class="keyword">def</span> <a title="(assertion: =&gt; Boolean,args: scala.tools.nsc.Interpreter.DebugParam[_]*)Unit" id="117175">breakIf</a>(<a title="=&gt; Boolean" id="127366">assertion</a>: =&gt; Boolean, <a title="scala.tools.nsc.Interpreter.DebugParam[_]*" id="127367">args</a>: <span title="scala.tools.nsc.Interpreter.DebugParam[_]*">DebugParam</span>[_]*): <span title="Unit">Unit</span> =
    <span title="Unit" class="keyword">if</span> (<a href="#127366" title="=&gt; Boolean">assertion</a>) <a href="#117176" title="(args: List[scala.tools.nsc.Interpreter.DebugParam[_]])Unit">break</a>(<a href="#127367" title="scala.tools.nsc.Interpreter.DebugParam[_]*">args</a>.<span title="=&gt; List[scala.tools.nsc.Interpreter.DebugParam[_]]">toList</span>)

  // start a repl, binding supplied args
  <span class="keyword">def</span> <a title="(args: List[scala.tools.nsc.Interpreter.DebugParam[_]])Unit" id="117176">break</a>(<a title="List[scala.tools.nsc.Interpreter.DebugParam[_]]" id="127372">args</a>: <span title="List[scala.tools.nsc.Interpreter.DebugParam[_]]">List</span>[DebugParam[_]]): <span title="Unit">Unit</span> = {
    <span class="keyword">val</span> <a title="scala.tools.nsc.InterpreterLoop" id="127380">intLoop</a> = <a href="InterpreterLoop.scala.html#127387" title="()scala.tools.nsc.InterpreterLoop" class="keyword">new</a> <a href="InterpreterLoop.scala.html#9072" title="scala.tools.nsc.InterpreterLoop">InterpreterLoop</a>
    <a href="#127380" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127394" title="(x$1: scala.tools.nsc.Settings)Unit">settings</a> = <span title="scala.tools.nsc.Settings" class="keyword">new</span> <a href="Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>(<a title="object Console" id="390">Console</a>.<a href="#127473" title="(x: Any)Unit" id="51323">println</a>)
    <a href="#127380" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127409" title="()Unit">createInterpreter</a>
    <a href="#127380" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127389" title="(x$1: scala.tools.nsc.interpreter.InteractiveReader)Unit">in</a> = <a href="interpreter/InteractiveReader.scala.html#22133" title="object scala.tools.nsc.interpreter.InteractiveReader">InteractiveReader</a>.<a href="interpreter/InteractiveReader.scala.html#127492" title="(interpreter: scala.tools.nsc.Interpreter)scala.tools.nsc.interpreter.InteractiveReader">createDefault</a>(<a href="#127380" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127396" title="=&gt; scala.tools.nsc.Interpreter">interpreter</a>)
    
    // rebind exit so people don't accidentally call System.exit by way of predef
    <a href="#127380" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127396" title="=&gt; scala.tools.nsc.Interpreter">interpreter</a>.<a href="#117201" title="(operation: =&gt; Unit)Unit">beQuietDuring</a> {
      <a href="#127380" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127396" title="=&gt; scala.tools.nsc.Interpreter">interpreter</a>.<a href="#117249" title="(line: String)scala.tools.nsc.InterpreterResults.Result">interpret</a>(<span title="java.lang.String(&quot;def exit = println(&quot;Type :quit to resume program execution.&quot;)&quot;)" class="string">&quot;&quot;&quot;def exit = println(&quot;Type :quit to resume program execution.&quot;)&quot;&quot;&quot;</span>)
      <span class="keyword">for</span> (<a title="scala.tools.nsc.Interpreter.DebugParam[_]" id="127522">p</a> &lt;- <a href="#127372" title="(f: (scala.tools.nsc.Interpreter.DebugParam[_]) =&gt; Unit)Unit">args</a>) {
        <a href="#127380" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127396" title="=&gt; scala.tools.nsc.Interpreter">interpreter</a>.<a href="#117252" title="(name: String,boundType: String,value: Any)scala.tools.nsc.InterpreterResults.Result">bind</a>(<a href="#127522" title="scala.tools.nsc.Interpreter.DebugParam[_]">p</a>.<a href="#127290" title="=&gt; String">name</a>, <a href="#127522" title="scala.tools.nsc.Interpreter.DebugParam[_]">p</a>.<a href="#126919" title="=&gt; String">typeStr</a>, <a href="#127522" title="scala.tools.nsc.Interpreter.DebugParam[_]">p</a>.<a href="#127293" title="=&gt; Any">param</a>)
        <a title="(x: Any)Unit" id="8057">println</a>(<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;%s: %s&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#127522" title="scala.tools.nsc.Interpreter.DebugParam[_]">p</a>.<a href="#127290" title="=&gt; String">name</a>, <a href="#127522" title="scala.tools.nsc.Interpreter.DebugParam[_]">p</a>.<a href="#126919" title="=&gt; String">typeStr</a>))
      }
    }
    <a href="#127380" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127425" title="()Unit">repl</a>()
    <a href="#127380" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127408" title="()Unit">closeInterpreter</a>
  }

  /** Heuristically strip interpreter wrapper prefixes
   *  from an interpreter output string.
   */
  <span class="keyword">def</span> <a title="(str: String)String" id="117177">stripWrapperGunk</a>(<a title="String" id="117720">str</a>: <span title="String">String</span>): <span title="String">String</span> = {
    <span class="keyword">val</span> <a title="java.lang.String" id="127562">wrapregex</a> = <span title="java.lang.String(&quot;(line[0-9]+\$object[$.])?(\$iw[$.])*&quot;)" class="string">&quot;&quot;&quot;(line[0-9]+\$object[$.])?(\$iw[$.])*&quot;&quot;&quot;</span>
    <a href="#117720" title="String">str</a>.<span title="(x$1: java.lang.String,x$2: java.lang.String)java.lang.String">replaceAll</span>(<a href="#127562" title="java.lang.String">wrapregex</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>)
  }
  
  <span class="keyword">def</span> <a title="(leadingPlus: Boolean,xs: String*)String" id="117178">codegenln</a>(<a title="Boolean" id="123049">leadingPlus</a>: <span title="Boolean">Boolean</span>, <a title="String*" id="123050">xs</a>: <span title="String*">String</span>*): <span title="String">String</span> = <a href="#117181" title="(leadingPlus: Boolean,xs: String*)String">codegen</a>(<a href="#123049" title="Boolean">leadingPlus</a>, (<a href="#123050" title="(that: Traversable[String])(implicit bf: scala.collection.generic.BuilderFactory[String,Sequence[String],Sequence[String]])Sequence[String]">xs</a> <span title="scala.collection.generic.BuilderFactory[String,Sequence[String],Sequence#Coll]">++</span> <a title="(xs: java.lang.String*)(implicit evidence$2: scala.reflect.ClassManifest[java.lang.String])Array[java.lang.String]" id="888">Array</a><a title="(clazz: Class[_])scala.reflect.ClassManifest[java.lang.String]" id="27330">(</a><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>)): _*)
  <span class="keyword">def</span> <a title="(xs: String*)String" id="117179">codegenln</a>(<a title="String*" id="123047">xs</a>: <span title="String*">String</span>*): <span title="String">String</span> = <a href="#117178" title="(leadingPlus: Boolean,xs: String*)String">codegenln</a>(<span title="Boolean(true)" class="keyword">true</span>, <a href="#123047" title="String*">xs</a>: _*)
  <span class="keyword">def</span> <a title="(xs: String*)String" id="117180">codegen</a>(<a title="String*" id="127571">xs</a>: <span title="String*">String</span>*): <span title="String">String</span> = <a href="#117181" title="(leadingPlus: Boolean,xs: String*)String">codegen</a>(<span title="Boolean(true)" class="keyword">true</span>, <a href="#127571" title="String*">xs</a>: _*)
  <span class="keyword">def</span> <a title="(leadingPlus: Boolean,xs: String*)String" id="117181">codegen</a>(<a title="Boolean" id="127568">leadingPlus</a>: <span title="Boolean">Boolean</span>, <a title="String*" id="127569">xs</a>: <span title="String*">String</span>*): <span title="String">String</span> = {
    <span class="keyword">val</span> <a title="java.lang.String" id="127717">front</a> = <span title="java.lang.String" class="keyword">if</span> (<a href="#127568" title="Boolean">leadingPlus</a>) <span title="java.lang.String(&quot;+ &quot;)" class="string">&quot;+ &quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <a href="#127569" title="String*">xs</a>.<span title="(f: (String) =&gt; java.lang.String)(implicit bf: scala.collection.generic.BuilderFactory[java.lang.String,Sequence[java.lang.String],Sequence[String]])Sequence[java.lang.String]">map</span><span title="scala.collection.generic.BuilderFactory[java.lang.String,Sequence[java.lang.String],Sequence#Coll]">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;\&quot;&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#117182" title="(str: String)String">string2code</a>(<a href="#127726" title="String">_</a>) + <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>).<span title="(start: String,sep: String,end: String)String">mkString</span>(<a href="#127717" title="java.lang.String">front</a>, <span title="java.lang.String(&quot; + &quot;)" class="string">&quot; + &quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>)
  }

  /** Convert a string into code that can recreate the string.
   *  This requires replacing all special characters by escape
   *  codes. It does not add the surrounding &quot; marks.  */
  <span class="keyword">def</span> <a title="(str: String)String" id="117182">string2code</a>(<a title="String" id="123075">str</a>: <span title="String">String</span>): <span title="String">String</span> = {
    /** Convert a character to a backslash-u escape */
    <span class="keyword">def</span> <a title="(c: Char)String" id="127772">char2uescape</a>(<a title="Char" id="127774">c</a>: <a title="Char" id="2163">Char</a>): <span title="String">String</span> = {
      <span class="keyword">var</span> <a title="Int" id="127775">rest</a> = <a href="#127774" title="Char">c</a>.<a title="=&gt; Int" id="2639">toInt</a>
      <span class="keyword">val</span> <a title="StringBuilder" id="127776">buf</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span>
      <span class="keyword">for</span> (<a title="Int" id="127823">i</a> &lt;- <a title="(end: Int)Range" id="31706" class="int">1</a> <a title="(f: (Int) =&gt; Unit)Unit" id="56267">to</a> <span title="Int(4)" class="int">4</span>) {
        <a href="#127776" title="(iter: Traversable[Char])buf.type">buf</a> ++= (<a href="#127775" title="(x$1: Int)Int" id="2972">rest</a> <span title="implicit scala.Predef.intWrapper : (x: Int)scala.runtime.RichInt">%</span> <span title="Int(16)" class="int">16</span>).<a title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" id="31719">toHexString</a>
        <a href="#127775" title="Int">rest</a> = <a href="#127775" title="(x$1: Int)Int" id="2970">rest</a> / <span title="Int(16)" class="int">16</span>
      }
      <span title="(x$1: Any)java.lang.String" class="string">&quot;\\u&quot;</span> + <a href="#127776" title="StringBuilder">buf</a>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">toString</span>.<a title="=&gt; scala.runtime.RichString" id="25821">reverse</a>
    }
    
    <span class="keyword">val</span> <a title="StringBuilder" id="127773">res</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span>
    <span class="keyword">for</span> (<a title="Char" id="127990">c</a> &lt;- <a href="#123075" title="(f: (Char) =&gt; StringBuilder)Unit" id="25733">str</a>) <a href="#127990" title="Char">c</a> <span title="res.type" class="keyword">match</span> {
      <span title="res.type" class="keyword">case</span> <span title="Char('&quot;')" class="char">'&quot;'</span> | <span title="Char(''')" class="char">'\''</span> | <span title="Char('\')" class="char">'\\'</span>  =&gt; <a href="#127773" title="(x: Char)res.type">res</a> += <span title="Char('\')" class="char">'\\'</span> ; <a href="#127773" title="(x: Char)res.type">res</a> += <a href="#127990" title="Char">c</a>
      <span title="res.type" class="keyword">case</span> _ <span class="keyword">if</span> <a href="#127990" title="implicit scala.Predef.charWrapper : (c: Char)scala.runtime.RichChar">c</a>.<a title="=&gt; Boolean" id="43323">isControl</a>   =&gt; <a href="#127773" title="(iter: Traversable[Char])res.type">res</a> ++= <a href="#127772" title="(c: Char)String">char2uescape</a><span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">(</span><a href="#127990" title="Char">c</a>)
      <span title="res.type" class="keyword">case</span> _                  =&gt; <a href="#127773" title="(x: Char)res.type">res</a> += <a href="#127990" title="Char">c</a>
    }
    <a href="#127773" title="StringBuilder">res</a>.<span title="()String">toString</span>
  }
}

        </pre>
    </body>
</html>