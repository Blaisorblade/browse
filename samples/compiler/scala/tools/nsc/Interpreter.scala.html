<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/Interpreter.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */
// $Id: Interpreter.scala 18610 2009-08-30 20:42:17Z extempore $

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> java.io.{ File, PrintWriter, StringWriter, Writer }
<span class="keyword">import</span> java.lang.{ Class, ClassLoader }
<span class="keyword">import</span> java.net.{ MalformedURLException, URL }
<span class="keyword">import</span> java.lang.reflect
<span class="keyword">import</span> reflect.InvocationTargetException

<span class="keyword">import</span> scala.collection.immutable.ListSet
<span class="keyword">import</span> scala.collection.mutable
<span class="keyword">import</span> scala.collection.mutable.{ ListBuffer, HashSet, ArrayBuffer }
<span class="keyword">import</span> scala.util.{ ScalaClassLoader, URLClassLoader }
<span class="keyword">import</span> scala.util.control.Exception.{ Catcher, catching, ultimately, unwrapping }

<span class="keyword">import</span> io.{ PlainFile, VirtualDirectory }
<span class="keyword">import</span> reporters.{ ConsoleReporter, Reporter }
<span class="keyword">import</span> symtab.{ Flags, Names }
<span class="keyword">import</span> util.{ SourceFile, BatchSourceFile, ClassPath }
<span class="keyword">import</span> scala.util.NameTransformer
<span class="keyword">import</span> scala.tools.nsc.{ InterpreterResults =&gt; IR }
<span class="keyword">import</span> interpreter._
<span class="keyword">import</span> Interpreter._

/** &lt;p&gt;
 *    An interpreter for Scala code.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    The main public entry points are &lt;code&gt;compile()&lt;/code&gt;,
 *    &lt;code&gt;interpret()&lt;/code&gt;, and &lt;code&gt;bind()&lt;/code&gt;.
 *    The &lt;code&gt;compile()&lt;/code&gt; method loads a
 *    complete Scala file.  The &lt;code&gt;interpret()&lt;/code&gt; method executes one
 *    line of Scala code at the request of the user.  The &lt;code&gt;bind()&lt;/code&gt;
 *    method binds an object to a variable that can then be used by later
 *    interpreted code.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    The overall approach is based on compiling the requested code and then
 *    using a Java classloader and Java reflection to run the code
 *    and access its results.
 *  &lt;/p&gt;
 *  &lt;p&gt;  
 *    In more detail, a single compiler instance is used
 *    to accumulate all successfully compiled or interpreted Scala code.  To
 *    &quot;interpret&quot; a line of code, the compiler generates a fresh object that
 *    includes the line of code and which has public member(s) to export
 *    all variables defined by that code.  To extract the result of an
 *    interpreted line to show the user, a second &quot;result object&quot; is created
 *    which imports the variables exported by the above object and then
 *    exports a single member named &quot;result&quot;.  To accomodate user expressions
 *    that read from variables or methods defined in previous statements, &quot;import&quot;
 *    statements are used.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    This interpreter shares the strengths and weaknesses of using the
 *    full compiler-to-Java.  The main strength is that interpreted code
 *    behaves exactly as does compiled code, including running at full speed.
 *    The main weakness is that redefining classes and methods is not handled
 *    properly, because rebinding at the Java level is technically difficult.
 *  &lt;/p&gt;
 *
 * @author Moez A. Abdel-Gawad
 * @author Lex Spoon
 */
<span class="keyword">class</span> <a title="class Interpreter extends java.lang.Object with ScalaObject" id="8439">Interpreter</a><span title="ScalaObject">(</span><span class="keyword">val</span> <a title="scala.tools.nsc.Settings" id="118046">settings</a>: <a href="Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>, <a title="java.io.PrintWriter" id="118047">out</a>: <span title="java.io.PrintWriter">PrintWriter</span>)
{
  /** directory to save .class files to */
  <span class="keyword">val</span> <a title="scala.tools.nsc.io.VirtualDirectory" id="117677">virtualDirectory</a> = <span title="scala.tools.nsc.io.VirtualDirectory" class="keyword">new</span> <a href="io/VirtualDirectory.scala.html#20719" title="scala.tools.nsc.io.VirtualDirectory">VirtualDirectory</a>(<span title="java.lang.String(&quot;(memory)&quot;)" class="string">&quot;(memory)&quot;</span>, <span title="object None">None</span>)

  /** the compiler to compile expressions with */
  <span class="keyword">val</span> <a title="scala.tools.nsc.Global" id="117679">compiler</a>: <a href="Global.scala.html#8529" title="scala.tools.nsc.Global">Global</a> = <a href="#117696" title="(settings: scala.tools.nsc.Settings,reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global">newCompiler</a>(<a href="#118046" title="=&gt; scala.tools.nsc.Settings">settings</a>, <a href="#117694" title="object Interpreter.this.reporter">reporter</a>)

  <span class="keyword">import</span> compiler.{ Traverser, CompilationUnit, Symbol, Name, Type }
  <span class="keyword">import</span> compiler.{ 
    Tree, TermTree, ValOrDefDef, ValDef, DefDef, Assign, ClassDef,
    ModuleDef, Ident, Select, TypeDef, Import, MemberDef, DocDef }
  <span class="keyword">import</span> compiler.{ nme, newTermName }
  <span class="keyword">import</span> nme.{ 
    INTERPRETER_VAR_PREFIX, INTERPRETER_SYNTHVAR_PREFIX, INTERPRETER_LINE_PREFIX,
    INTERPRETER_IMPORT_WRAPPER, INTERPRETER_WRAPPER_SUFFIX, USCOREkw
  }
  
  /** construct an interpreter that reports to Console */
  <span class="keyword">def</span> <a title="(settings: scala.tools.nsc.Settings)scala.tools.nsc.Interpreter" id="117685" class="keyword">this</a>(<a title="scala.tools.nsc.Settings" id="118082">settings</a>: <a href="Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>) =
    <a href="#8439" title="Interpreter.this.type" class="keyword">this</a>(<a href="#118082" title="scala.tools.nsc.Settings">settings</a>, <span title="scala.tools.nsc.NewLinePrintWriter" class="keyword">new</span> <a href="NewLinePrintWriter.scala.html#8925" title="scala.tools.nsc.NewLinePrintWriter">NewLinePrintWriter</a>(<span title="scala.tools.nsc.ConsoleWriter" class="keyword">new</span> <a href="ConsoleWriter.scala.html#9480" title="scala.tools.nsc.ConsoleWriter">ConsoleWriter</a>, <span title="Boolean(true)" class="keyword">true</span>))

  /** whether to print out result lines */
  <span class="keyword">private</span>[nsc] <span class="keyword">var</span> <a title="Boolean" id="117687">printResults</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>

  /** Temporarily be quiet */
  <span class="keyword">def</span> <a title="[T](operation: =&gt; T)T" id="117689">beQuietDuring</a>[<a title="&gt;: Nothing &lt;: Any" id="117691">T</a>](<a title="=&gt; T" id="118135">operation</a>: =&gt; T): <a href="#117691" title="T">T</a> = {    
    <span class="keyword">val</span> <a title="Boolean" id="118138">wasPrinting</a> = <a href="#117687" title="=&gt; Boolean">printResults</a>    
    <a title="(body: =&gt; Unit)util.control.Exception.Catch[Nothing]" id="117637">ultimately</a><span title="(body: =&gt; T)T">(</span><a href="#117687" title="(x$1: Boolean)Unit">printResults</a> = <a href="#118138" title="Boolean">wasPrinting</a>) {
      <a href="#117687" title="(x$1: Boolean)Unit">printResults</a> = <span title="Boolean(false)" class="keyword">false</span>
      <a href="#118135" title="=&gt; T">operation</a>
    }
  }

  /** interpreter settings */
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.InterpreterSettings" id="117693">isettings</a> = <span title="scala.tools.nsc.InterpreterSettings" class="keyword">new</span> <a href="InterpreterSettings.scala.html#8481" title="scala.tools.nsc.InterpreterSettings">InterpreterSettings</a>

  <span class="keyword">object</span> <a title="object Interpreter.this.reporter" id="117694">reporter</a> <span title="ScalaObject" class="keyword">extends</span> <a href="reporters/ConsoleReporter.scala.html#13171" title="scala.tools.nsc.reporters.ConsoleReporter">ConsoleReporter</a>(<a href="#118046" title="=&gt; scala.tools.nsc.Settings">settings</a>, <span title="Null(null)" class="keyword">null</span>, <a href="#118047" title="java.io.PrintWriter">out</a>) {
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(msg: String)Unit" id="118079">printMessage</a>(<a title="String" id="118190">msg</a>: <span title="String">String</span>) {
      <a href="#118047" title="java.io.PrintWriter">out</a>.<span title="(x$1: java.lang.String)Unit">print</span>(<a href="#117723" title="(str: String)String">clean</a><span title="(x$1: Any)java.lang.String">(</span><a href="#118190" title="String">msg</a>) + <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>); <a href="#118047" title="java.io.PrintWriter">out</a>.<span title="()Unit">flush</span>()
    }
  }

  /** Instantiate a compiler.  Subclasses can override this to
   *  change the compiler class used by this interpreter. */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(settings: scala.tools.nsc.Settings,reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global" id="117696">newCompiler</a>(<a title="scala.tools.nsc.Settings" id="118052">settings</a>: <a href="Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>, <a title="scala.tools.nsc.reporters.Reporter" id="118053">reporter</a>: <a href="reporters/Reporter.scala.html#13147" title="scala.tools.nsc.reporters.Reporter">Reporter</a>) = {
    <a href="#118052" title="scala.tools.nsc.Settings">settings</a>.<a href="Settings.scala.html#38011" title="(dir: scala.tools.nsc.io.AbstractFile)Unit">outputDirs</a> setSingleOutput <a href="#117677" title="=&gt; scala.tools.nsc.io.VirtualDirectory">virtualDirectory</a>    
    <span title="scala.tools.nsc.Global" class="keyword">new</span> <a href="Global.scala.html#8529" title="scala.tools.nsc.Global">Global</a>(<a href="#118052" title="scala.tools.nsc.Settings">settings</a>, <a href="#118053" title="scala.tools.nsc.reporters.Reporter">reporter</a>)
  }
  
  /** the compiler's classpath, as URL's */
  <span class="keyword">val</span> <a title="List[java.net.URL]" id="117697">compilerClasspath</a>: <span title="List[java.net.URL]">List</span>[URL] = {
    <span class="keyword">import</span> scala.net.Utility.parseURL
    <span class="keyword">val</span> <a title="List[java.net.URL]" id="118222">classpathPart</a> = 
      <a href="util/ClassPath.scala.html#14795" title="object scala.tools.nsc.util.ClassPath">ClassPath</a>.<a href="util/ClassPath.scala.html#118239" title="(path: String)List[String]">expandPath</a>(<a href="#117679" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39250" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="Settings.scala.html#37231" title="=&gt; scala.tools.nsc.Settings.StringSetting">classpath</a>.<a href="Settings.scala.html#37988" title="=&gt; java.lang.String">value</a>).<span title="(f: (String) =&gt; java.net.URL)(implicit bf: scala.collection.generic.BuilderFactory[java.net.URL,List[java.net.URL],List[String]])List[java.net.URL]">map</span><span title="scala.collection.generic.BuilderFactory[java.net.URL,List[java.net.URL],List#Coll]">(</span><a title="String" id="118260">s</a> =&gt; <span title="java.io.File" class="keyword">new</span> <a title="java.io.File" id="3828">File</a>(<a href="#118260" title="String">s</a>).<a title="()java.net.URL" id="35377">toURL</a>)
      
    <span class="keyword">val</span> <a title="List[java.net.URL]" id="118223">codebasePart</a> = (<a href="#117679" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39250" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="Settings.scala.html#37339" title="=&gt; scala.tools.nsc.Settings.StringSetting">Xcodebase</a>.<a href="Settings.scala.html#37988" title="=&gt; java.lang.String">value</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)).<span title="(f: (java.lang.String) =&gt; Traversable[java.net.URL])(implicit bf: scala.collection.generic.BuilderFactory[java.net.URL,List[java.net.URL],List[java.lang.String]])List[java.net.URL]">toList</span> <span title="scala.collection.generic.BuilderFactory[java.net.URL,List[java.net.URL],List#Coll]">flatMap</span> <a href="#118365" title="(xo: Option[java.net.URL])Iterable[java.net.URL]" id="118225">parseURL</a>
    <a href="#118222" title="List[java.net.URL]">classpathPart</a> <a href="#118463" title="List[java.net.URL]">:::</a> <a href="#118223" title="(prefix: List[java.net.URL])List[java.net.URL]" id="24420">codebasePart</a>
  }

  /* A single class loader is used for all commands interpreted by this Interpreter.
     It would also be possible to create a new class loader for each command
     to interpret.  The advantages of the current approach are:

       - Expressions are only evaluated one time.  This is especially
         significant for I/O, e.g. &quot;val x = Console.readLine&quot;

     The main disadvantage is:

       - Objects, classes, and methods cannot be rebound.  Instead, definitions
         shadow the old ones, and old code objects refer to the old
         definitions.
  */
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="scala.util.ScalaClassLoader" id="117700">classLoader</a>: <span title="scala.util.ScalaClassLoader">ScalaClassLoader</span> = <a href="#117702" title="()scala.util.ScalaClassLoader">makeClassLoader</a>()
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()scala.util.ScalaClassLoader" id="117702">makeClassLoader</a>(): <span title="scala.util.ScalaClassLoader">ScalaClassLoader</span> = {
    <span class="keyword">val</span> <a title="scala.util.URLClassLoader" id="118474">parent</a> =
      <span title="scala.util.URLClassLoader" class="keyword">if</span> (<a href="#117705" title="(x$1: AnyRef)Boolean">parentClassLoader</a> == <span title="Null(null)" class="keyword">null</span>)  <a title="(urls: Seq[java.net.URL])scala.util.URLClassLoader" id="27896">ScalaClassLoader</a> fromURLs <a href="#117697" title="=&gt; List[java.net.URL]">compilerClasspath</a>
      <span class="keyword">else</span>                            <span title="scala.util.URLClassLoader" class="keyword">new</span> <a title="scala.util.URLClassLoader" id="27880">URLClassLoader</a>(<a href="#117697" title="=&gt; List[java.net.URL]">compilerClasspath</a>, <a href="#117705" title="=&gt; java.lang.ClassLoader">parentClassLoader</a>)

    <span title="scala.tools.nsc.interpreter.AbstractFileClassLoader" class="keyword">new</span> <a href="interpreter/AbstractFileClassLoader.scala.html#22325" title="scala.tools.nsc.interpreter.AbstractFileClassLoader">AbstractFileClassLoader</a>(<a href="#117677" title="=&gt; scala.tools.nsc.io.VirtualDirectory">virtualDirectory</a>, <a href="#118474" title="scala.util.URLClassLoader">parent</a>)
  }
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String)java.lang.Class[_]" id="117703">loadByName</a>(<a title="String" id="119352">s</a>: <span title="String">String</span>): <span title="java.lang.Class[_]">Class</span>[_] = (<a href="#117700" title="(path: String)Option[Class[Nothing]]">classLoader</a> tryToInitializeClass <a href="#119352" title="String">s</a>).<span title="=&gt; Class[Nothing]">get</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(c: java.lang.Class[_],name: String)java.lang.reflect.Method" id="117704">methodByName</a>(<a title="java.lang.Class[_]" id="119365">c</a>: <span title="java.lang.Class[_]">Class</span>[_], <a title="String" id="119366">name</a>: <span title="String">String</span>): reflect.<span title="java.lang.reflect.Method">Method</span> =
    <a href="#119365" title="java.lang.Class[_]">c</a>.<span title="(x$1: java.lang.String,x$2: java.lang.Class[_]*)java.lang.reflect.Method">getMethod</span>(<a href="#119366" title="String">name</a>, classOf<span title="java.lang.Class[java.lang.Object]">[</span>Object])
  
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; java.lang.ClassLoader" id="117705">parentClassLoader</a>: <a title="java.lang.ClassLoader" id="1491">ClassLoader</a> = <a href="#8439" title="Interpreter.this.type" class="keyword">this</a>.<span title="()java.lang.Class[_]">getClass</span>.<a title="()java.lang.ClassLoader" id="4131">getClassLoader</a>()  

  // Set the current Java &quot;context&quot; class loader to this interpreter's class loader
  <span class="keyword">def</span> <a title="()Unit" id="117706">setContextClassLoader</a>() = <a href="#117700" title="=&gt; scala.util.ScalaClassLoader">classLoader</a>.<a title="()Unit" id="117909">setAsContext</a>()

  /** the previous requests this interpreter has processed */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]" id="117707">prevRequests</a> = <a title="()scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]" id="108940" class="keyword">new</a> <a title="scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]" id="25155">ArrayBuffer</a>[Request]()
  <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[Interpreter.this.compiler.Import]" id="117709">prevImports</a> = <span title="scala.collection.mutable.ListBuffer[Interpreter.this.compiler.Import]" class="keyword">new</span> <a title="scala.collection.mutable.ListBuffer[Interpreter.this.compiler.Import]" id="24978">ListBuffer</a>[Import]()
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="117711">allUsedNames</a> = <a href="#117707" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<span title="=&gt; List[Interpreter.this.Request]">toList</span>.<span title="(f: (Interpreter.this.Request) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.Request]])List[Interpreter.this.compiler.Name]">flatMap</span><span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">(</span><a href="#119453" title="Interpreter.this.Request">_</a>.<a href="#119469" title="=&gt; List[Interpreter.this.compiler.Name]">usedNames</a>).<span title="=&gt; List[Interpreter.this.compiler.Name]">removeDuplicates</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="117712">allBoundNames</a> = <a href="#117707" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<span title="=&gt; List[Interpreter.this.Request]">toList</span>.<span title="(f: (Interpreter.this.Request) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.Request]])List[Interpreter.this.compiler.Name]">flatMap</span><span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">(</span><a href="#119583" title="Interpreter.this.Request">_</a>.<a href="#119467" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>).<span title="=&gt; List[Interpreter.this.compiler.Name]">removeDuplicates</span>
  // private def allImportedNames = prevImports.toList.flatMap(_.importedNames).removeDuplicates
  
  /** Generates names pre0, pre1, etc. via calls to apply method */
  <span class="keyword">class</span> <a title="class NameCreator extends java.lang.Object with ScalaObject" id="117713">NameCreator</a><span title="ScalaObject">(</span><a title="String" id="117969">pre</a>: <span title="String">String</span>) {
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="117964">x</a> = <span title="Int(-1)">-</span><span class="int">1</span>
    <span class="keyword">def</span> <a title="()String" id="117966">apply</a>(): <span title="String">String</span> = { 
      <a href="#117964" title="(x$1: Int)Unit">x</a> += <span title="Int(1)" class="int">1</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="119867">name</a> = <a href="#117969" title="(x$1: Any)java.lang.String">pre</a> + <a href="#117964" title="=&gt; Int">x</a>.<span title="()java.lang.String">toString</span>
      // make sure we don't overwrite their unwisely named res3 etc.
      <span title="String" class="keyword">if</span> (<a href="#117712" title="(p: (Interpreter.this.compiler.Name) =&gt; Boolean)Boolean">allBoundNames</a> exists (<a href="#119913" title="Interpreter.this.compiler.Name">_</a>.<a href="symtab/Names.scala.html#28391" title="(x$1: AnyRef)Boolean">toString</a> == <a href="#119867" title="java.lang.String">name</a>)) <a href="#117966" title="()String">apply</a>()
      <span class="keyword">else</span> <a href="#119867" title="java.lang.String">name</a>
    }
    <span class="keyword">def</span> <a title="()Unit" id="117967">reset</a>(): <span title="Unit">Unit</span> = <a href="#117964" title="(x$1: Int)Unit">x</a> = <span title="Int(-1)">-</span><span class="int">1</span>
    <span class="keyword">def</span> <a title="(name: String)Boolean" id="117968">didGenerate</a>(<a title="String" id="119930">name</a>: <span title="String">String</span>) =
      <span title="(x$1: Boolean)Boolean">(</span><a href="#119930" title="(x$1: java.lang.String)Boolean" id="7042">name</a> startsWith <a href="#117969" title="String">pre</a>) &amp;&amp; (<a title="(p: (Char) =&gt; Boolean)Boolean" id="25895">(</a><a href="#119930" title="(n: Int)scala.runtime.RichString" id="25945">name</a> drop <a href="#117969" title="String">pre</a>.<span title="()Int">length</span>) forall (<a href="#119962" title="implicit scala.Predef.charWrapper : (c: Char)scala.runtime.RichChar">_</a>.<a title="=&gt; Boolean" id="43556">isDigit</a>))
  }

  /** allocate a fresh line name */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Interpreter.this.NameCreator" id="117714">lineNameCreator</a> = <span title="Interpreter.this.NameCreator" class="keyword">new</span> <a href="#117713" title="Interpreter.this.NameCreator">NameCreator</a>(<a href="symtab/StdNames.scala.html#29816" title="=&gt; java.lang.String">INTERPRETER_LINE_PREFIX</a>)
  
  /** allocate a fresh var name */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Interpreter.this.NameCreator" id="117716">varNameCreator</a> = <span title="Interpreter.this.NameCreator" class="keyword">new</span> <a href="#117713" title="Interpreter.this.NameCreator">NameCreator</a>(<a href="symtab/StdNames.scala.html#29818" title="=&gt; java.lang.String">INTERPRETER_VAR_PREFIX</a>)
  
  /** allocate a fresh internal variable name */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Interpreter.this.NameCreator" id="117718">synthVarNameCreator</a> = <span title="Interpreter.this.NameCreator" class="keyword">new</span> <a href="#117713" title="Interpreter.this.NameCreator">NameCreator</a>(<a href="symtab/StdNames.scala.html#29822" title="=&gt; java.lang.String">INTERPRETER_SYNTHVAR_PREFIX</a>)

  /** Check if a name looks like it was generated by varNameCreator */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: String)Boolean" id="117719">isGeneratedVarName</a>(<a title="String" id="119984">name</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> = <a href="#117968" title="(name: String)Boolean">varNameCreator</a> didGenerate <a href="#119984" title="String">name</a>  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: String)Boolean" id="117720">isSynthVarName</a>(<a title="String" id="119988">name</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> = <a href="#117968" title="(name: String)Boolean">synthVarNameCreator</a> didGenerate <a href="#119988" title="String">name</a>

  /** generate a string using a routine that wants to write on a stream */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(writer: (java.io.PrintWriter) =&gt; Unit)String" id="117721">stringFrom</a>(<a title="(java.io.PrintWriter) =&gt; Unit" id="119992">writer</a>: PrintWriter =&gt; Unit): <span title="String">String</span> = {
    <span class="keyword">val</span> <a title="java.io.StringWriter" id="119994">stringWriter</a> = <span title="java.io.StringWriter" class="keyword">new</span> <a title="java.io.StringWriter" id="3771">StringWriter</a>()
    <span class="keyword">val</span> <a title="scala.tools.nsc.NewLinePrintWriter" id="119995">stream</a> = <a href="NewLinePrintWriter.scala.html#118108" title="(out: java.io.Writer)scala.tools.nsc.NewLinePrintWriter" class="keyword">new</a> <a href="NewLinePrintWriter.scala.html#8925" title="scala.tools.nsc.NewLinePrintWriter">NewLinePrintWriter</a>(<a href="#119994" title="java.io.StringWriter">stringWriter</a>)
    <a href="#119992" title="(v1: java.io.PrintWriter)Unit" id="25688">writer</a>(<a href="#119995" title="scala.tools.nsc.NewLinePrintWriter">stream</a>)
    <a href="#119995" title="scala.tools.nsc.NewLinePrintWriter">stream</a>.<a title="()Unit" id="39113">close</a>
    <a href="#119994" title="java.io.StringWriter">stringWriter</a>.<a title="()java.lang.String" id="81671">toString</a>
  }

  /** Truncate a string if it is longer than settings.maxPrintString */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(str: String)String" id="117722">truncPrintString</a>(<a title="String" id="118205">str</a>: <span title="String">String</span>): <span title="String">String</span> = {
    <span class="keyword">val</span> <a title="Int" id="120015">maxpr</a> = <a href="#117692" title="=&gt; scala.tools.nsc.InterpreterSettings">isettings</a>.<a href="InterpreterSettings.scala.html#117824" title="=&gt; Int">maxPrintString</a>
    <span class="keyword">val</span> <a title="java.lang.String" id="120016">trailer</a> = <span title="java.lang.String(&quot;...&quot;)" class="string">&quot;...&quot;</span>
    
    <span title="String" class="keyword">if</span> (<a href="#120015" title="(x$1: Int)Boolean">maxpr</a> <span title="(x$1: Boolean)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span> || <a href="#118205" title="String">str</a>.<span title="(x$1: Int)Boolean">length</span> &lt;= <a href="#120015" title="Int">maxpr</a>) <a href="#118205" title="String">str</a>
    <span class="keyword">else</span> <a href="#118205" title="String">str</a>.<a title="(x$1: Int,x$2: Int)java.lang.String" id="7085">substring</a><span title="(x$1: Any)java.lang.String">(</span><span title="Int(0)" class="int">0</span>, <a href="#120015" title="(x$1: Int)Int" id="2987">maxpr</a>-<span title="Int(3)" class="int">3</span>) + <a href="#120016" title="java.lang.String">trailer</a>
  }

  /** Clean up a string for output */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(str: String)String" id="117723">clean</a>(<a title="String" id="118202">str</a>: <span title="String">String</span>) = <a href="#117722" title="(str: String)String">truncPrintString</a>(<a href="#117665" title="(str: String)String">stripWrapperGunk</a>(<a href="#118202" title="String">str</a>))

  /** Indent some code by the width of the scala&gt; prompt.
   *  This way, compiler error messages read better.
   */
  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">val</span> <a title="String" id="117724">spaces</a> = <span title="object List">List</span>.<a title="(n: Int)(elem: =&gt; java.lang.String)List[java.lang.String]" id="24583">fill</a>(<span title="Int(7)" class="int">7</span>)(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>).<span title="=&gt; String">mkString</span>
  <span class="keyword">def</span> <a title="(code: String)String" id="117726">indentCode</a>(<a title="String" id="120061">code</a>: <span title="String">String</span>) =
    <a href="#117721" title="(writer: (java.io.PrintWriter) =&gt; Unit)String">stringFrom</a>(<a title="java.io.PrintWriter" id="120065">str</a> =&gt;
      <span class="keyword">for</span> (<a title="String" id="120083">line</a> &lt;- <a href="#120061" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">code</a>.<a title="(f: (String) =&gt; Unit)Unit" id="30645">lines</a>) {
        <a href="#120065" title="java.io.PrintWriter">str</a>.<span title="(x$1: java.lang.String)Unit">print</span>(<a href="#117724" title="=&gt; String">spaces</a>)
        <a href="#120065" title="java.io.PrintWriter">str</a>.<span title="(x$1: java.lang.String)Unit">print</span>(<a href="#120083" title="(x$1: Any)java.lang.String">line</a> + <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>)
        <a href="#120065" title="java.io.PrintWriter">str</a>.<span title="()Unit">flush</span>()
      })

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String" id="117727">name2string</a>(<a title="Interpreter.this.compiler.Name" id="118004">name</a>: <a href="symtab/Names.scala.html#26214" title="Interpreter.this.compiler.Name">Name</a>) = <a href="#118004" title="Interpreter.this.compiler.Name">name</a>.<a href="symtab/Names.scala.html#28391" title="()String">toString</a>

  /** Compute imports that allow definitions from previous
   *  requests to be visible in a new request.  Returns
   *  three pieces of related code:
   *
   *  1. An initial code fragment that should go before
   *  the code of the new request.
   *
   *  2. A code fragment that should go after the code
   *  of the new request.
   *
   *  3. An access path which can be traverested to access
   *  any bindings inside code wrapped by #1 and #2 .
   *
   * The argument is a set of Names that need to be imported.
   *
   * Limitations: This method is not as precise as it could be.
   * (1) It does not process wildcard imports to see what exactly
   * they import.
   * (2) If it imports any names from a request, it imports all
   * of them, which is not really necessary.
   * (3) It imports multiple same-named implicits, but only the
   * last one imported is actually usable.
   */
  <span class="keyword">private</span> case <span class="keyword">class</span> <a title="class ComputedImports extends java.lang.Object with ScalaObject with Product" id="120154">ComputedImports</a><span title="ScalaObject">(</span><a title="String" id="121444">prepend</a>: <span title="String">String</span>, <a title="String" id="121445">append</a>: <span title="String">String</span>, <a title="String" id="121446">access</a>: <span title="String">String</span>)
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(wanted: Set[Interpreter.this.compiler.Name])Interpreter.this.ComputedImports" id="117731">importsCode</a>(<a title="Set[Interpreter.this.compiler.Name]" id="120220">wanted</a>: <span title="Set[Interpreter.this.compiler.Name]">Set</span>[Name]): <a href="#120154" title="Interpreter.this.ComputedImports">ComputedImports</a> = {
    /** Narrow down the list of requests from which imports 
     *  should be taken.  Removes requests which cannot contribute
     *  useful imports for the specified set of wanted names.
     */
    case <span class="keyword">class</span> <a title="class ReqAndHandler extends java.lang.Object with ScalaObject with Product" id="120256">ReqAndHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.Request" id="120629">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="Interpreter.this.MemberHandler" id="120630">handler</a>: <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a>)
    <span class="keyword">def</span> <a title="=&gt; List[ReqAndHandler]" id="120225">reqsToUse</a>: <span title="List[ReqAndHandler]">List</span>[ReqAndHandler] = {
      /** Loop through a list of MemberHandlers and select which ones to keep.
        * 'wanted' is the set of names that need to be imported.
       */
      <span class="keyword">def</span> <a title="(reqs: List[ReqAndHandler],wanted: Set[Interpreter.this.compiler.Name])List[ReqAndHandler]" id="120310">select</a>(<a title="List[ReqAndHandler]" id="120312">reqs</a>: <span title="List[ReqAndHandler]">List</span>[ReqAndHandler], <a title="Set[Interpreter.this.compiler.Name]" id="120313">wanted</a>: <span title="Set[Interpreter.this.compiler.Name]">Set</span>[Name]): <span title="List[ReqAndHandler]">List</span>[ReqAndHandler] = {
        <span class="keyword">val</span> <a title="(Interpreter.this.compiler.Name) =&gt; Boolean" id="120314">isWanted</a> = <a href="#120313" title="(elem: Interpreter.this.compiler.Name)Boolean">wanted</a> contains <a href="#120318" title="Interpreter.this.compiler.Name">_</a>
        <span class="keyword">def</span> <a title="(handler: Interpreter.this.MemberHandler)Boolean" id="120315">keepHandler</a>(<a title="Interpreter.this.MemberHandler" id="120321">handler</a>: <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a>): <span title="Boolean">Boolean</span> = {
          <span class="keyword">import</span> handler._
          // Single symbol imports might be implicits! See bug #1752.  Rather than
          // try to finesse this, we will mimic all imports for now.
          <span class="keyword">def</span> <a title="=&gt; Boolean" id="120323">isImport</a> = <a href="#120321" title="Interpreter.this.MemberHandler">handler</a>.<span title="[T0]Boolean">isInstanceOf</span><span title="Boolean">[</span><a href="#117752" title="Interpreter.this.ImportHandler">ImportHandler</a>]
          <a href="#119679" title="(x$1: Boolean)Boolean">definesImplicit</a> <span title="(x$1: Boolean)Boolean">||</span> <a href="#120323" title="=&gt; Boolean">isImport</a> || (<a href="#119677" title="(that: Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,Sequence[Interpreter.this.compiler.Name],Sequence[Interpreter.this.compiler.Name]])Sequence[Interpreter.this.compiler.Name]">importedNames</a> <span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,Sequence[Interpreter.this.compiler.Name],Sequence#Coll]">++</span> <a href="#119672" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>).<span title="(p: (Interpreter.this.compiler.Name) =&gt; Boolean)Boolean">exists</span>(<a href="#120314" title="(Interpreter.this.compiler.Name) =&gt; Boolean">isWanted</a>)
        }
                   
        <a href="#120312" title="List[ReqAndHandler]">reqs</a> <span title="List[ReqAndHandler]" class="keyword">match</span> {
          <span title="scala.collection.immutable.Nil.type" class="keyword">case</span> <span title="object Nil">Nil</span>                                    =&gt; <span title="object Nil">Nil</span>
          <span title="List[ReqAndHandler]" class="keyword">case</span> <a title="ReqAndHandler" id="120453">rh</a> :: <a title="List[ReqAndHandler]" id="120454">rest</a> <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#120315" title="(handler: Interpreter.this.MemberHandler)Boolean">keepHandler</a>(<a href="#120453" title="ReqAndHandler">rh</a>.<a href="#120630" title="=&gt; Interpreter.this.MemberHandler">handler</a>) =&gt; <a href="#120310" title="(reqs: List[ReqAndHandler],wanted: Set[Interpreter.this.compiler.Name])List[ReqAndHandler]">select</a>(<a href="#120454" title="List[ReqAndHandler]">rest</a>, <a href="#120313" title="Set[Interpreter.this.compiler.Name]">wanted</a>)
          <span title="List[ReqAndHandler]" class="keyword">case</span> <a title="ReqAndHandler" id="120465">rh</a> :: <a title="List[ReqAndHandler]" id="120466">rest</a>                             =&gt;
            <span class="keyword">import</span> rh.handler._
            <span class="keyword">val</span> <a title="scala.collection.immutable.Set[Interpreter.this.compiler.Name]" id="120470">newWanted</a> = <a href="#120313" title="(elems: Traversable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]">wanted</a> <span title="(elems: Traversable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]">++</span> <a href="#119670" title="=&gt; List[Interpreter.this.compiler.Name]">usedNames</a> <span title="(elems: Traversable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]">--</span> <a href="#119672" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a> -- <a href="#119677" title="=&gt; Seq[Interpreter.this.compiler.Name]">importedNames</a>
            <a href="#120465" title="ReqAndHandler">rh</a> <a href="#120600" title="ReqAndHandler">::</a> <a href="#120310" title="(reqs: List[ReqAndHandler],wanted: Set[Interpreter.this.compiler.Name])List[ReqAndHandler]">select</a><span title="(x: ReqAndHandler)List[ReqAndHandler]">(</span><a href="#120466" title="List[ReqAndHandler]">rest</a>, <a href="#120470" title="scala.collection.immutable.Set[Interpreter.this.compiler.Name]">newWanted</a>)
        }
      }

      <span class="keyword">val</span> <a title="List[ReqAndHandler]" id="120311">rhpairs</a> = <span class="keyword">for</span> {
        <a title="Interpreter.this.Request" id="120619">req</a> &lt;- <a href="#117707" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<span title="=&gt; List[Interpreter.this.Request]">toList</span>.<span title="(f: (Interpreter.this.Request) =&gt; Traversable[ReqAndHandler])(implicit bf: scala.collection.generic.BuilderFactory[ReqAndHandler,List[ReqAndHandler],List[Interpreter.this.Request]])List[ReqAndHandler]">reverse</span>
        <a title="Interpreter.this.MemberHandler" id="120628">handler</a> &lt;- <a href="#120619" title="Interpreter.this.Request">req</a>.<a href="#119465" title="(f: (Interpreter.this.MemberHandler) =&gt; ReqAndHandler)(implicit bf: scala.collection.generic.BuilderFactory[ReqAndHandler,List[ReqAndHandler],List[Interpreter.this.MemberHandler]])List[ReqAndHandler]">handlers</a>
      } <span class="keyword">yield</span> <a href="#120256" title="(req: Interpreter.this.Request,handler: Interpreter.this.MemberHandler)ReqAndHandler">ReqAndHandler</a>(<a href="#120619" title="Interpreter.this.Request">req</a>, <a href="#120628" title="Interpreter.this.MemberHandler">handler</a>)

      <a href="#120310" title="(reqs: List[ReqAndHandler],wanted: Set[Interpreter.this.compiler.Name])List[ReqAndHandler]">select</a>(<a href="#120311" title="List[ReqAndHandler]">rhpairs</a>, <a href="#120220" title="Set[Interpreter.this.compiler.Name]">wanted</a>).<span title="=&gt; List[ReqAndHandler]">reverse</span>
    }

    <span class="keyword">val</span> <a title="java.lang.StringBuffer" id="120226">code</a>, <a title="java.lang.StringBuffer" id="120227">trailingBraces</a>, <a title="java.lang.StringBuffer" id="120228">accessPath</a> = <span title="java.lang.StringBuffer" class="keyword">new</span> <span title="java.lang.StringBuffer">StringBuffer</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.Set[Interpreter.this.compiler.Name]" id="120229">currentImps</a> = mutable.<a title="object scala.collection.mutable.Set" id="25171">Set</a>.<a title="[A]scala.collection.mutable.Set[A]" id="39544">empty</a><span title="scala.collection.mutable.Set[Interpreter.this.compiler.Name]">[</span><a href="symtab/Names.scala.html#26214" title="Interpreter.this.compiler.Name">Name</a>]

    // add code for a new object to hold some imports
    <span class="keyword">def</span> <a title="()Unit" id="120230">addWrapper</a>() {
      <span class="keyword">val</span> <a title="java.lang.String" id="121234">impname</a> = <a href="symtab/StdNames.scala.html#29820" title="=&gt; java.lang.String">INTERPRETER_IMPORT_WRAPPER</a>
      <a href="#120226" title="(x$1: java.lang.String)java.lang.StringBuffer">code</a> append <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;object %s {\n&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#121234" title="java.lang.String">impname</a>)
      <a href="#120227" title="(x$1: java.lang.String)java.lang.StringBuffer">trailingBraces</a> append <span title="java.lang.String(&quot;}\012&quot;)" class="string">&quot;}\n&quot;</span>
      <a href="#120228" title="(x$1: java.lang.String)java.lang.StringBuffer">accessPath</a> append (<span title="(x$1: Any)java.lang.String" class="string">&quot;.&quot;</span> + <a href="#121234" title="java.lang.String">impname</a>)

      <a href="#120229" title="scala.collection.mutable.Set[Interpreter.this.compiler.Name]">currentImps</a>.<a title="()Unit" id="39701">clear</a>
    }

    <a href="#120230" title="()Unit">addWrapper</a>()

    // loop through previous requests, adding imports for each one
    <span class="keyword">for</span> (ReqAndHandler(<a title="Interpreter.this.Request" id="121311">req</a>, <a title="Interpreter.this.MemberHandler" id="121312">handler</a>) &lt;- <a href="#120225" title="(f: (ReqAndHandler) =&gt; Unit)Unit">reqsToUse</a>) {
      <span class="keyword">import</span> handler._
      // If the user entered an import, then just use it; add an import wrapping
      // level if the import might conflict with some other import
      <span title="Unit" class="keyword">if</span> (<a href="#119675" title="(x$1: Boolean)Boolean">importsWildcard</a> || <a href="#120229" title="scala.collection.mutable.Set[Interpreter.this.compiler.Name]">currentImps</a>.<span title="(p: (Interpreter.this.compiler.Name) =&gt; Boolean)Boolean">exists</span>(<a href="#119677" title="=&gt; Seq[Interpreter.this.compiler.Name]">importedNames</a>.<a href="#121318" title="(elem: Any)Boolean">contains</a>))
        <a href="#120230" title="()Unit">addWrapper</a>()
      
      <span title="Any" class="keyword">if</span> (<a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">member</a>.<span title="[T0]Boolean">isInstanceOf</span><span title="Boolean">[</span><a href="ast/Trees.scala.html#26802" title="Interpreter.this.compiler.Import">Import</a>])
        <a href="#120226" title="(x$1: java.lang.String)java.lang.StringBuffer">code</a> append (<a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">member</a>.<a href="ast/Trees.scala.html#29567" title="(x$1: Any)java.lang.String">toString</a> + <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>)

      // give wildcard imports a import wrapper all to their own
      <span title="Any" class="keyword">if</span> (<a href="#119675" title="=&gt; Boolean">importsWildcard</a>)  <a href="#120230" title="()Unit">addWrapper</a>()  
      <span class="keyword">else</span>                  <a href="#120229" title="(iter: Traversable[Interpreter.this.compiler.Name])currentImps.type">currentImps</a> ++= <a href="#119677" title="=&gt; Seq[Interpreter.this.compiler.Name]">importedNames</a>

      // For other requests, import each bound variable.
      // import them explicitly instead of with _, so that
      // ambiguity errors will not be generated. Also, quote 
      // the name of the variable, so that we don't need to 
      // handle quoting keywords separately. 
      <span class="keyword">for</span> (<a title="Interpreter.this.compiler.Name" id="121386">imv</a> &lt;- <a href="#119672" title="(f: (Interpreter.this.compiler.Name) =&gt; scala.collection.mutable.Set[Interpreter.this.compiler.Name])Unit">boundNames</a>) {
        <span title="Unit" class="keyword">if</span> (<a href="#120229" title="(elem: Interpreter.this.compiler.Name)Boolean">currentImps</a> contains <a href="#121386" title="Interpreter.this.compiler.Name">imv</a>) <a href="#120230" title="()Unit">addWrapper</a>()
        
        <a href="#120226" title="(x$1: java.lang.String)java.lang.StringBuffer">code</a> append (<span title="(x$1: Any)java.lang.String" class="string">&quot;import &quot;</span> + <a href="#121311" title="Interpreter.this.Request">req</a>.<a href="#119479" title="(vname: Interpreter.this.compiler.Name)String">fullPath</a>(<a href="#121386" title="Interpreter.this.compiler.Name">imv</a>))
        <a href="#120229" title="(elem: Interpreter.this.compiler.Name)currentImps.type" id="39695">currentImps</a> += <a href="#121386" title="Interpreter.this.compiler.Name">imv</a>
      }
    }

    // add one extra wrapper, to prevent warnings in the common case of
    // redefining the value bound in the last interpreter request.
    <a href="#120230" title="()Unit">addWrapper</a>()
    <a href="#120154" title="(prepend: String,append: String,access: String)Interpreter.this.ComputedImports">ComputedImports</a>(<a href="#120226" title="java.lang.StringBuffer">code</a>.<span title="()java.lang.String">toString</span>, <a href="#120227" title="java.lang.StringBuffer">trailingBraces</a>.<span title="()java.lang.String">toString</span>, <a href="#120228" title="java.lang.StringBuffer">accessPath</a>.<span title="()java.lang.String">toString</span>)
  }

  /** Parse a line into a sequence of trees. Returns None if the input is incomplete. */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(line: String)Option[List[Interpreter.this.compiler.Tree]]" id="117732">parse</a>(<a title="String" id="121471">line</a>: <span title="String">String</span>): <span title="Option[List[Interpreter.this.compiler.Tree]]">Option</span>[List[Tree]] = {
    <span class="keyword">var</span> <a title="Boolean" id="121473">justNeedsMore</a> = <span title="Boolean(false)" class="keyword">false</span>
    <a href="#117694" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/Reporter.scala.html#39023" title="(handler: (scala.tools.nsc.util.Position, String) =&gt; Unit)(thunk: =&gt; Option[List[Interpreter.this.compiler.Tree]])Option[List[Interpreter.this.compiler.Tree]]">withIncompleteHandler</a>((<a title="scala.tools.nsc.util.Position" id="121495">pos</a>,<a title="String" id="121496">msg</a>) =&gt; {<a href="#121473" title="Boolean">justNeedsMore</a> = <span title="Boolean(true)" class="keyword">true</span>}) {
      // simple parse: just parse it, nothing else
      <span class="keyword">def</span> <a title="(code: String)List[Interpreter.this.compiler.Tree]" id="121500">simpleParse</a>(<a title="String" id="121502">code</a>: <span title="String">String</span>): <span title="List[Interpreter.this.compiler.Tree]">List</span>[Tree] = {
        <a href="#117694" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/AbstractReporter.scala.html#39031" title="=&gt; Unit">reset</a>
        <span class="keyword">val</span> <a title="Interpreter.this.compiler.CompilationUnit" id="121503">unit</a> = <span title="Interpreter.this.compiler.CompilationUnit" class="keyword">new</span> <a href="CompilationUnits.scala.html#39428" title="Interpreter.this.compiler.CompilationUnit">CompilationUnit</a>(<a href="util/SourceFile.scala.html#121515" title="(sourceName: String,cs: Seq[Char])scala.tools.nsc.util.BatchSourceFile" class="keyword">new</a> <a href="util/SourceFile.scala.html#14734" title="scala.tools.nsc.util.BatchSourceFile">BatchSourceFile</a>(<span title="java.lang.String(&quot;&lt;console&gt;&quot;)" class="string">&quot;&lt;console&gt;&quot;</span>, <a href="#121502" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">code</a>))
        <span class="keyword">val</span> <a title="Interpreter.this.compiler.syntaxAnalyzer.UnitParser" id="121504">scanner</a> = <a href="ast/parser/Parsers.scala.html#121830" title="(unit: Interpreter.this.compiler.syntaxAnalyzer.global.CompilationUnit)Interpreter.this.compiler.syntaxAnalyzer.UnitParser" class="keyword">new</a> <a href="#117679" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39332" title="object Interpreter.this.compiler.syntaxAnalyzer">syntaxAnalyzer</a>.<a href="ast/parser/Parsers.scala.html#39941" title="Interpreter.this.compiler.syntaxAnalyzer.UnitParser">UnitParser</a>(<a href="#121503" title="Interpreter.this.compiler.CompilationUnit">unit</a>)
        
        <a href="#121504" title="Interpreter.this.compiler.syntaxAnalyzer.UnitParser">scanner</a>.<a href="ast/parser/Parsers.scala.html#121819" title="(isPre: Boolean)(Interpreter.this.compiler.syntaxAnalyzer.global.ValDef, List[Interpreter.this.compiler.syntaxAnalyzer.global.Tree])">templateStatSeq</a>(<span title="Boolean(false)" class="keyword">false</span>).<span title="=&gt; List[Interpreter.this.compiler.syntaxAnalyzer.global.Tree]">_2</span>
      }
      <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Tree]" id="121501">trees</a> = <a href="#121500" title="(code: String)List[Interpreter.this.compiler.Tree]">simpleParse</a>(<a href="#121471" title="String">line</a>)
      
      <span title="Option[List[Interpreter.this.compiler.Tree]]" class="keyword">if</span> (<a href="#117694" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/Reporter.scala.html#39006" title="=&gt; Boolean">hasErrors</a>)   <span title="(x: object Nil)Some[object Nil]">Some</span>(<span title="object Nil">Nil</span>)  // the result did not parse, so stop
      <span class="keyword">else</span> <span title="Option[List[Interpreter.this.compiler.Tree]]" class="keyword">if</span> (<a href="#121473" title="Boolean">justNeedsMore</a>)   <span title="object None">None</span>
      <span class="keyword">else</span>                      <span title="(x: List[Interpreter.this.compiler.Tree])Some[List[Interpreter.this.compiler.Tree]]">Some</span>(<a href="#121501" title="List[Interpreter.this.compiler.Tree]">trees</a>)
    }
  }

  /** Compile an nsc SourceFile.  Returns true if there are
   *  no compilation errors, or false othrewise.
   */
  <span class="keyword">def</span> <a title="(sources: scala.tools.nsc.util.SourceFile*)Boolean" id="117733">compileSources</a>(<a title="scala.tools.nsc.util.SourceFile*" id="122787">sources</a>: <span title="scala.tools.nsc.util.SourceFile*">SourceFile</span>*): <span title="Boolean">Boolean</span> = {
    <a href="#117694" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/AbstractReporter.scala.html#39031" title="=&gt; Unit">reset</a>
    <a href="Global.scala.html#40450" title="(_sources: List[scala.tools.nsc.util.SourceFile])Unit" class="keyword">new</a> <a href="#117679" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39410" title="Interpreter.this.compiler.Run">Run</a>() compileSources <a href="#122787" title="scala.tools.nsc.util.SourceFile*">sources</a>.<span title="=&gt; List[scala.tools.nsc.util.SourceFile]">toList</span>
    <span title="=&gt; Boolean">!</span><a href="#117694" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/Reporter.scala.html#39006" title="=&gt; Boolean">hasErrors</a>
  }

  /** Compile a string.  Returns true if there are no
   *  compilation errors, or false otherwise.
   */
  <span class="keyword">def</span> <a title="(code: String)Boolean" id="117734">compileString</a>(<a title="String" id="122795">code</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> =
    <a href="#117733" title="(sources: scala.tools.nsc.util.SourceFile*)Boolean">compileSources</a>(<a href="util/SourceFile.scala.html#121515" title="(sourceName: String,cs: Seq[Char])scala.tools.nsc.util.BatchSourceFile" class="keyword">new</a> <a href="util/SourceFile.scala.html#14734" title="scala.tools.nsc.util.BatchSourceFile">BatchSourceFile</a>(<span title="java.lang.String(&quot;&lt;script&gt;&quot;)" class="string">&quot;&lt;script&gt;&quot;</span>, <a href="#122795" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">code</a>))

  /** Build a request from the user. &lt;code&gt;trees&lt;/code&gt; is &lt;code&gt;line&lt;/code&gt;
   *  after being parsed.
   */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(trees: List[Interpreter.this.compiler.Tree],line: String,lineName: String)Interpreter.this.Request" id="117735">buildRequest</a>(<a title="List[Interpreter.this.compiler.Tree]" id="122838">trees</a>: <span title="List[Interpreter.this.compiler.Tree]">List</span>[Tree], <a title="String" id="122839">line</a>: <span title="String">String</span>, <a title="String" id="122840">lineName</a>: <span title="String">String</span>): <a href="#117753" title="Interpreter.this.Request">Request</a> =
    <span title="Interpreter.this.Request" class="keyword">new</span> <a href="#117753" title="Interpreter.this.Request">Request</a>(<a href="#122839" title="String">line</a>, <a href="#122840" title="String">lineName</a>)

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(member: Interpreter.this.compiler.Tree)Interpreter.this.MemberHandler" id="117736">chooseHandler</a>(<a title="Interpreter.this.compiler.Tree" id="122846">member</a>: <a href="ast/Trees.scala.html#26752" title="Interpreter.this.compiler.Tree">Tree</a>): <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a> = <a href="#122846" title="Interpreter.this.compiler.Tree">member</a> <span title="Interpreter.this.MemberHandler" class="keyword">match</span> {
    <span title="Interpreter.this.DefHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.DefDef" id="122848">member</a>: <a href="ast/Trees.scala.html#26785" title="Interpreter.this.compiler.DefDef">DefDef</a>               =&gt; <span title="Interpreter.this.DefHandler" class="keyword">new</span> <a href="#117747" title="Interpreter.this.DefHandler">DefHandler</a>(<a href="#122848" title="Interpreter.this.compiler.DefDef">member</a>)
    <span title="Interpreter.this.ValHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.ValDef" id="122865">member</a>: <a href="ast/Trees.scala.html#26778" title="Interpreter.this.compiler.ValDef">ValDef</a>               =&gt; <span title="Interpreter.this.ValHandler" class="keyword">new</span> <a href="#117746" title="Interpreter.this.ValHandler">ValHandler</a>(<a href="#122865" title="Interpreter.this.compiler.ValDef">member</a>)
    <span title="Interpreter.this.AssignHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.Assign" id="122886">member</a>@Assign(Ident(_), _)   =&gt; <span title="Interpreter.this.AssignHandler" class="keyword">new</span> <a href="#117748" title="Interpreter.this.AssignHandler">AssignHandler</a>(<a href="#122886" title="Interpreter.this.compiler.Assign">member</a>)
    <span title="Interpreter.this.ModuleHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.ModuleDef" id="122910">member</a>: <a href="ast/Trees.scala.html#26773" title="Interpreter.this.compiler.ModuleDef">ModuleDef</a>            =&gt; <span title="Interpreter.this.ModuleHandler" class="keyword">new</span> <a href="#117749" title="Interpreter.this.ModuleHandler">ModuleHandler</a>(<a href="#122910" title="Interpreter.this.compiler.ModuleDef">member</a>)
    <span title="Interpreter.this.ClassHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.ClassDef" id="122926">member</a>: <a href="ast/Trees.scala.html#26768" title="Interpreter.this.compiler.ClassDef">ClassDef</a>             =&gt; <span title="Interpreter.this.ClassHandler" class="keyword">new</span> <a href="#117750" title="Interpreter.this.ClassHandler">ClassHandler</a>(<a href="#122926" title="Interpreter.this.compiler.ClassDef">member</a>)
    <span title="Interpreter.this.TypeAliasHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.TypeDef" id="122942">member</a>: <a href="ast/Trees.scala.html#26793" title="Interpreter.this.compiler.TypeDef">TypeDef</a>              =&gt; <span title="Interpreter.this.TypeAliasHandler" class="keyword">new</span> <a href="#117751" title="Interpreter.this.TypeAliasHandler">TypeAliasHandler</a>(<a href="#122942" title="Interpreter.this.compiler.TypeDef">member</a>)
    <span title="Interpreter.this.ImportHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.Import" id="122959">member</a>: <a href="ast/Trees.scala.html#26802" title="Interpreter.this.compiler.Import">Import</a>               =&gt; <span title="Interpreter.this.ImportHandler" class="keyword">new</span> <a href="#117752" title="Interpreter.this.ImportHandler">ImportHandler</a>(<a href="#122959" title="Interpreter.this.compiler.Import">member</a>)
    <span title="Interpreter.this.MemberHandler" class="keyword">case</span> DocDef(_, <a title="Interpreter.this.compiler.Tree" id="122986">documented</a>)        =&gt; <a href="#117736" title="(member: Interpreter.this.compiler.Tree)Interpreter.this.MemberHandler">chooseHandler</a>(<a href="#122986" title="Interpreter.this.compiler.Tree">documented</a>)
    <span title="Interpreter.this.GenericHandler" class="keyword">case</span> <a title="Interpreter.this.compiler.Tree" id="122991">member</a>                       =&gt; <span title="Interpreter.this.GenericHandler" class="keyword">new</span> <a href="#117745" title="Interpreter.this.GenericHandler">GenericHandler</a>(<a href="#122991" title="Interpreter.this.compiler.Tree">member</a>)
  }

  /** &lt;p&gt;
   *    Interpret one line of input.  All feedback, including parse errors
   *    and evaluation results, are printed via the supplied compiler's 
   *    reporter.  Values defined are available for future interpreted
   *    strings.
   *  &lt;/p&gt;
   *  &lt;p&gt;
   *    The return value is whether the line was interpreter successfully,
   *    e.g. that there were no parse errors.
   *  &lt;/p&gt;
   *
   *  @param line ...
   *  @return     ...
   */
  <span class="keyword">def</span> <a title="(line: String)scala.tools.nsc.InterpreterResults.Result" id="117737">interpret</a>(<a title="String" id="122998">line</a>: <span title="String">String</span>): IR.<a href="InterpreterResults.scala.html#123000" title="scala.tools.nsc.InterpreterResults.Result">Result</a> = {
    // initialize the compiler
    <span title="Any" class="keyword">if</span> (<a href="#117707" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<a title="=&gt; Boolean" id="25891">isEmpty</a>) <span title="Interpreter.this.compiler.Run" class="keyword">new</span> <a href="#117679" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39410" title="Interpreter.this.compiler.Run">Run</a>()

    // parse
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Tree]" id="123009">trees</a> = <a href="#117732" title="(line: String)Option[List[Interpreter.this.compiler.Tree]]">parse</a>(<a href="#117726" title="(code: String)String">indentCode</a>(<a href="#122998" title="String">line</a>)) <span title="List[Interpreter.this.compiler.Tree]" class="keyword">match</span> {
      <span title="Nothing" class="keyword">case</span> <span title="object None">None</span>         =&gt; <span title="Nothing" class="keyword">return</span> <a href="InterpreterResults.scala.html#8446" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#123005" title="object scala.tools.nsc.InterpreterResults.Incomplete">Incomplete</a>
      <span title="Nothing" class="keyword">case</span> Some(<span title="object Nil">Nil</span>)    =&gt; <span title="Nothing" class="keyword">return</span> <a href="InterpreterResults.scala.html#8446" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#123003" title="object scala.tools.nsc.InterpreterResults.Error">Error</a> // parse error or empty input
      <span title="List[Interpreter.this.compiler.Tree]" class="keyword">case</span> Some(<a title="List[Interpreter.this.compiler.Tree]" id="123032">trees</a>)  =&gt; <a href="#123032" title="List[Interpreter.this.compiler.Tree]">trees</a>
    }

    // Treat a single bare expression specially. This is necessary due to it being hard to
    // modify code at a textual level, and it being hard to submit an AST to the compiler.
    <span title="Unit" class="keyword">if</span> (<a href="#123009" title="List[Interpreter.this.compiler.Tree]">trees</a>.<a title="(x$1: Int)Boolean" id="25707">size</a> == <span title="Int(1)" class="int">1</span>) <a href="#123009" title="List[Interpreter.this.compiler.Tree]">trees</a>.<a title="=&gt; Interpreter.this.compiler.Tree" id="25602">head</a> <span title="Unit" class="keyword">match</span> {
      <span title="Unit" class="keyword">case</span> _:<a href="ast/Trees.scala.html#26841" title="Interpreter.this.compiler.Assign">Assign</a>                         =&gt; // we don't want to include assignments
      <span title="Nothing" class="keyword">case</span> _:<a href="ast/Trees.scala.html#26756" title="Interpreter.this.compiler.TermTree">TermTree</a> | _:<a href="ast/Trees.scala.html#26891" title="Interpreter.this.compiler.Ident">Ident</a> | _:<a href="ast/Trees.scala.html#26887" title="Interpreter.this.compiler.Select">Select</a>  =&gt;
        <span title="Nothing" class="keyword">return</span> <a href="#117737" title="(line: String)scala.tools.nsc.InterpreterResults.Result">interpret</a>(<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;val %s =\n%s&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#117966" title="()String">varNameCreator</a>(), <a href="#122998" title="String">line</a>))
      <span title="Unit" class="keyword">case</span> _                                =&gt;
    }
        
    // figure out what kind of request
    <span class="keyword">val</span> <a title="Interpreter.this.Request" id="123010">req</a> = <a href="#117735" title="(trees: List[Interpreter.this.compiler.Tree],line: String,lineName: String)Interpreter.this.Request">buildRequest</a>(<a href="#123009" title="List[Interpreter.this.compiler.Tree]">trees</a>, <a href="#122998" title="String">line</a>, <a href="#117966" title="()String">lineNameCreator</a>())
    // null is a disallowed statement type; otherwise compile and fail if false (implying e.g. a type error)
    <span title="Unit" class="keyword">if</span> (<a href="#123010" title="(x$1: AnyRef)Boolean">req</a> <span title="(x$1: Boolean)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> || <span title="=&gt; Boolean">!</span><a href="#123010" title="Interpreter.this.Request">req</a>.<a href="#119487" title="()Boolean">compile</a>)
      <span title="Nothing" class="keyword">return</span> <a href="InterpreterResults.scala.html#8446" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#123003" title="object scala.tools.nsc.InterpreterResults.Error">Error</a>
        
    <span class="keyword">val</span> <a href="#123012" title="(String, Boolean)">(</a><a href="#123011" title="String" id="123012">result</a>, <a href="#123011" title="Boolean" id="123013">succeeded</a>) = <a href="#123010" title="Interpreter.this.Request">req</a>.<a href="#119489" title="=&gt; (String, Boolean)">loadAndRun</a>
    <span title="Unit" class="keyword">if</span> (<a href="#117687" title="(x$1: Boolean)Boolean">printResults</a> || <span title="=&gt; Boolean">!</span><a href="#123013" title="Boolean">succeeded</a>)
      <a href="#118047" title="(x$1: java.lang.String)Unit">out</a> print <a href="#117723" title="(str: String)String">clean</a>(<a href="#123012" title="String">result</a>)

    <span title="scala.tools.nsc.InterpreterResults.Result" class="keyword">if</span> (<a href="#123013" title="Boolean">succeeded</a>) {
      <a href="#117707" title="(elem: Interpreter.this.Request)Interpreter.this.prevRequests.type" id="108944">prevRequests</a> += <a href="#123010" title="Interpreter.this.Request">req</a>     // book-keeping
      <a href="InterpreterResults.scala.html#8446" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#123001" title="object scala.tools.nsc.InterpreterResults.Success">Success</a>
    }
    <span class="keyword">else</span> <a href="InterpreterResults.scala.html#8446" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#123003" title="object scala.tools.nsc.InterpreterResults.Error">Error</a>
  }

  /** A name creator used for objects created by &lt;code&gt;bind()&lt;/code&gt;. */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Interpreter.this.NameCreator" id="117738">newBinder</a> = <span title="Interpreter.this.NameCreator" class="keyword">new</span> <a href="#117713" title="Interpreter.this.NameCreator">NameCreator</a>(<span title="java.lang.String(&quot;binder&quot;)" class="string">&quot;binder&quot;</span>)

  /** Bind a specified name to a specified value.  The name may
   *  later be used by expressions passed to interpret.
   *
   *  @param name      the variable name to bind
   *  @param boundType the type of the variable, as a string
   *  @param value     the object value to bind to it
   *  @return          an indication of whether the binding succeeded
   */
  <span class="keyword">def</span> <a title="(name: String,boundType: String,value: Any)scala.tools.nsc.InterpreterResults.Result" id="117740">bind</a>(<a title="String" id="123142">name</a>: <span title="String">String</span>, <a title="String" id="123143">boundType</a>: <span title="String">String</span>, <a title="Any" id="123144">value</a>: <a title="Any" id="49">Any</a>): IR.<a href="InterpreterResults.scala.html#123000" title="scala.tools.nsc.InterpreterResults.Result">Result</a> = {
    <span class="keyword">val</span> <a title="String" id="123146">binderName</a> = <a href="#117966" title="()String">newBinder</a>()    // &quot;binder&quot; + binderNum()

    <a href="#117734" title="(code: String)Boolean">compileString</a>(<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;
      | object %s {
      |   var value: %s = _
      |   def set(x: Any) = value = x.asInstanceOf[%s]
      | }
    &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">stripMargin</span>.<span title="(args: Any*)String">format</span>(<a href="#123146" title="String">binderName</a>, <a href="#123143" title="String">boundType</a>, <a href="#123143" title="String">boundType</a>))

    <span class="keyword">val</span> <a title="java.lang.Class[_]" id="123147">binderObject</a> = <a href="#117703" title="(s: String)java.lang.Class[_]">loadByName</a>(<a href="#123146" title="String">binderName</a>)
    <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="123148">setterMethod</a> = <a href="#117704" title="(c: java.lang.Class[_],name: String)java.lang.reflect.Method">methodByName</a>(<a href="#123147" title="java.lang.Class[_]">binderObject</a>, <span title="java.lang.String(&quot;set&quot;)" class="string">&quot;set&quot;</span>)
        
    // this roundabout approach is to ensure the value is boxed
    <span class="keyword">var</span> <a title="Array[Any]" id="123149">argsHolder</a>: <span title="Array[Any]">Array</span>[Any] = <span title="Null(null)" class="keyword">null</span>
    <a href="#123149" title="Array[Any]">argsHolder</a> = <span title="(xs: Any*)List[Any]">List</span>(<a href="#123144" title="Any">value</a>).<a title="(implicit evidence$1: scala.reflect.ClassManifest[Any])Array[Any]" id="27759">toArray</a>
    <a href="#123148" title="java.lang.reflect.Method">setterMethod</a>.<span title="(x$1: Any,x$2: java.lang.Object*)java.lang.Object">invoke</span>(<span title="Null(null)" class="keyword">null</span>, <a href="#123149" title="Array[Any]">argsHolder</a>.<span title="[T0]T0">asInstanceOf</span><span title="Array[AnyRef]">[</span><span title="Array[AnyRef]">Array</span>[AnyRef]]: _*)
    <a href="#117737" title="(line: String)scala.tools.nsc.InterpreterResults.Result">interpret</a>(<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;val %s = %s.value&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#123142" title="String">name</a>, <a href="#123146" title="String">binderName</a>))
  }

  /** Reset this interpreter, forgetting all user-specified requests. */
  <span class="keyword">def</span> <a title="()Unit" id="117741">reset</a>() {
    <a href="#117677" title="=&gt; scala.tools.nsc.io.VirtualDirectory">virtualDirectory</a>.<a href="io/VirtualDirectory.scala.html#117798" title="()Unit">clear</a>
    <a href="#117700" title="(x$1: scala.util.ScalaClassLoader)Unit">classLoader</a> = <a href="#117702" title="()scala.util.ScalaClassLoader">makeClassLoader</a>
    <a href="#117714" title="=&gt; Interpreter.this.NameCreator">lineNameCreator</a>.<a href="#117967" title="()Unit">reset</a>()
    <a href="#117716" title="=&gt; Interpreter.this.NameCreator">varNameCreator</a>.<a href="#117967" title="()Unit">reset</a>()
    <a href="#117707" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<a title="()Unit" id="108941">clear</a>
  }

  /** &lt;p&gt;
   *    This instance is no longer needed, so release any resources
   *    it is using.  The reporter's output gets flushed.
   *  &lt;/p&gt;
   */
  <span class="keyword">def</span> <a title="()Unit" id="117742">close</a>() {
    <a href="#117694" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/ConsoleReporter.scala.html#39062" title="()Unit">flush</a>
  }

  /** A traverser that finds all mentioned identifiers, i.e. things
   *  that need to be imported.  It might return extra names.
   */
  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ImportVarsTraverser extends Interpreter.this.compiler.Traverser with ScalaObject" id="117743">ImportVarsTraverser</a><span title="ScalaObject">(</span><a title="List[Interpreter.this.compiler.Name]" id="123301">definedVars</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name]) <span class="keyword">extends</span> <a href="ast/Trees.scala.html#26933" title="Interpreter.this.compiler.Traverser">Traverser</a> {
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]" id="123294">importVars</a> = <span title="scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]" class="keyword">new</span> <a title="scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]" id="24960">HashSet</a>[Name]()

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ast: Interpreter.this.compiler.Tree)Unit" id="123296">traverse</a>(<a title="Interpreter.this.compiler.Tree" id="123304">ast</a>: <a href="ast/Trees.scala.html#26752" title="Interpreter.this.compiler.Tree">Tree</a>) = <a href="#123304" title="Interpreter.this.compiler.Tree">ast</a> <span title="Unit" class="keyword">match</span> {
      <span title="Unit" class="keyword">case</span> Ident(<a title="Interpreter.this.compiler.Name" id="123313">name</a>)  =&gt; <a href="#123294" title="(elem: Interpreter.this.compiler.Name)ImportVarsTraverser.this.importVars.type" id="39520">importVars</a> <span title="Unit">+=</span> <a href="#123313" title="Interpreter.this.compiler.Name">name</a>
      <span title="Unit" class="keyword">case</span> _            =&gt; <span class="keyword">super</span>.<a href="ast/Trees.scala.html#71109" title="(tree: Interpreter.this.compiler.Tree)Unit">traverse</a>(<a href="#123304" title="Interpreter.this.compiler.Tree">ast</a>)
    }
  }

  /** Class to handle one member among all the members included
   *  in a single interpreter request.
   */
  <span class="keyword">private</span> <span class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class MemberHandler extends java.lang.Object with ScalaObject" id="117744">MemberHandler</a><span title="ScalaObject">(</span><span class="keyword">val</span> <a title="Interpreter.this.compiler.Tree" id="123353">member</a>: <a href="ast/Trees.scala.html#26752" title="Interpreter.this.compiler.Tree">Tree</a>) {
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="119670">usedNames</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name] = {
      <span class="keyword">val</span> <a title="Interpreter.this.ImportVarsTraverser" id="123356">ivt</a> = <span title="Interpreter.this.ImportVarsTraverser" class="keyword">new</span> <a href="#117743" title="Interpreter.this.ImportVarsTraverser">ImportVarsTraverser</a>(<a href="#119672" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>)
      <a href="#123356" title="Interpreter.this.ImportVarsTraverser">ivt</a>.<a href="ast/Trees.scala.html#71110" title="(trees: List[Interpreter.this.compiler.Tree])Unit">traverseTrees</a>(<span title="(xs: Interpreter.this.compiler.Tree*)List[Interpreter.this.compiler.Tree]">List</span>(<a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">member</a>))
      <a href="#123356" title="Interpreter.this.ImportVarsTraverser">ivt</a>.<a href="#123294" title="=&gt; scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]">importVars</a>.<span title="=&gt; List[Interpreter.this.compiler.Name]">toList</span>
    }
    <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="119672">boundNames</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name] = <span title="object Nil">Nil</span>
    <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="119673">valAndVarNames</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name] = <span title="object Nil">Nil</span>
    <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="119674">defNames</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name] = <span title="object Nil">Nil</span>
    <span class="keyword">val</span> <a title="Boolean" id="119675">importsWildcard</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">val</span> <a title="Seq[Interpreter.this.compiler.Name]" id="119677">importedNames</a>: <span title="Seq[Interpreter.this.compiler.Name]">Seq</span>[Name] = <span title="object Nil">Nil</span>
    <span class="keyword">val</span> <a title="Boolean" id="119679">definesImplicit</a> = <a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">member</a> <span title="Boolean" class="keyword">match</span> {
      <span title="Boolean" class="keyword">case</span> <a title="Interpreter.this.compiler.MemberDef" id="120332">tree</a>: <a href="ast/Trees.scala.html#26763" title="Interpreter.this.compiler.MemberDef">MemberDef</a>  =&gt; <a href="#120332" title="Interpreter.this.compiler.MemberDef">tree</a>.<a href="ast/Trees.scala.html#52300" title="(flag: Long)Boolean">mods</a> hasFlag Flags.<span title="Long(512L)">IMPLICIT</span>
      <span title="Boolean(false)" class="keyword">case</span> _                =&gt; <span title="Boolean(false)" class="keyword">false</span>
    }

    <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="119681">extraCodeToEvaluate</a>(<a title="Interpreter.this.Request" id="123377">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123378">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) <span title="Unit">{</span> }
    <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="119682">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123380">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123381">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) <span title="Unit">{</span> }
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class GenericHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117745">GenericHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.Tree" id="122995">member</a>: <a href="ast/Trees.scala.html#26752" title="Interpreter.this.compiler.Tree">Tree</a>) <span class="keyword">extends</span> <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122995" title="Interpreter.this.compiler.Tree">member</a>)
  
  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ValHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117746">ValHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.ValDef" id="122883">member</a>: <a href="ast/Trees.scala.html#26778" title="Interpreter.this.compiler.ValDef">ValDef</a>) <span class="keyword">extends</span> <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122883" title="Interpreter.this.compiler.ValDef">member</a>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> ValDef<a href="#122872" title="(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)" id="122870">(</a><a href="#122869" title="Interpreter.this.compiler.Modifiers" id="122872">mods</a>, <a href="#122869" title="Interpreter.this.compiler.Name" id="122874">vname</a>, _, _) = <a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">member</a>    
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="String" id="122876">prettyName</a> = <span title="object scala.util.NameTransformer">NameTransformer</span>.<span title="(name0: String)String">decode</span>(<a href="#117727" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">vname</a>)
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Boolean" id="122878">isLazy</a> = <a href="ast/Trees.scala.html#52300" title="(flag: Long)Boolean">mods</a> hasFlag Flags.<span title="Long(2147483648L)">LAZY</span>
    
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122880">boundNames</a> = <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122873" title="=&gt; Interpreter.this.compiler.Name">vname</a>)
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="122881">valAndVarNames</a> = <a href="#122879" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122882">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123433">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123434">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) {
      <span class="keyword">val</span> <a title="Boolean" id="123436">isInternal</a> = <a href="#117719" title="(name: String)Boolean">isGeneratedVarName</a><span title="(x$1: Boolean)Boolean">(</span><a href="#117727" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">vname</a>) &amp;&amp; <a href="#123433" title="Interpreter.this.Request">req</a>.<a href="#119485" title="(vname: Interpreter.this.compiler.Name)String">typeOfEnc</a><span title="(x$1: AnyRef)Boolean">(</span><a href="#122873" title="=&gt; Interpreter.this.compiler.Name">vname</a>) == <span title="java.lang.String(&quot;Unit&quot;)" class="string">&quot;Unit&quot;</span>
      <span title="Unit" class="keyword">if</span> (<span title="(x$1: Boolean)Boolean">!</span><a href="#122871" title="=&gt; Interpreter.this.compiler.Modifiers">mods</a>.<a href="ast/Trees.scala.html#52299" title="=&gt; Boolean">isPublic</a> || <a href="#123436" title="Boolean">isInternal</a>) <span title="Nothing" class="keyword">return</span>
      
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="String" id="123438">extractor</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;
        | {
        |    val s = scala.runtime.ScalaRunTime.stringOf(%s)
        |    val nl = if (s.contains('\n')) &quot;\n&quot; else &quot;&quot;
        |    nl + s + &quot;\n&quot;
        | }
      &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">stripMargin</span>.<span title="(args: Any*)String">format</span>(<a href="#119479" title="(vname: Interpreter.this.compiler.Name)String">req</a> fullPath <a href="#122873" title="=&gt; Interpreter.this.compiler.Name">vname</a>)
      
      // if this is a lazy val we avoid evaluating it here
      <span class="keyword">val</span> <a title="String" id="123439">resultString</a> = <span title="String" class="keyword">if</span> (<a href="#122877" title="=&gt; Boolean">isLazy</a>) <a href="#117666" title="(leadingPlus: Boolean,xs: String*)String">codegenln</a>(<span title="Boolean(false)" class="keyword">false</span>, <span title="java.lang.String(&quot;&lt;lazy&gt;&quot;)" class="string">&quot;&lt;lazy&gt;&quot;</span>) <span class="keyword">else</span> <a href="#123437" title="=&gt; String">extractor</a>
      <span class="keyword">val</span> <a title="String" id="123440">codeToPrint</a> = 
        <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot; + &quot;%s: %s = &quot; + %s&quot;&quot;&quot;</span> .
        <span title="(args: Any*)String">format</span>(<a href="#122875" title="=&gt; String">prettyName</a>, <a href="#117670" title="(str: String)String">string2code</a>(<a href="#123433" title="Interpreter.this.Request">req</a>.<a href="#119483" title="(key: Interpreter.this.compiler.Name)String">typeOf</a>(<a href="#122873" title="=&gt; Interpreter.this.compiler.Name">vname</a>)), <a href="#123439" title="String">resultString</a>)

      <a href="#123434" title="(x$1: java.lang.String)Unit">code</a> print <a href="#123440" title="String">codeToPrint</a>
    }
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class DefHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117747">DefHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.DefDef" id="122862">defDef</a>: <a href="ast/Trees.scala.html#26785" title="Interpreter.this.compiler.DefDef">DefDef</a>) <span class="keyword">extends</span> <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122862" title="Interpreter.this.compiler.DefDef">defDef</a>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> DefDef<a href="#122855" title="(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)" id="122853">(</a><a href="#122852" title="Interpreter.this.compiler.Modifiers" id="122855">mods</a>, <a href="#122852" title="Interpreter.this.compiler.Name" id="122857">name</a>, _, _, _, _) = <a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">defDef</a>
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122859">boundNames</a> = <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122856" title="=&gt; Interpreter.this.compiler.Name">name</a>)
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="122860">defNames</a> = <a href="#122858" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122861">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123650">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123651">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <span title="Unit" class="keyword">if</span> (<a href="#122854" title="=&gt; Interpreter.this.compiler.Modifiers">mods</a>.<a href="ast/Trees.scala.html#52299" title="=&gt; Boolean">isPublic</a>) <a href="#123651" title="(x$1: java.lang.String)Unit">code</a> print <a href="#117667" title="(xs: String*)String">codegenln</a>(<a href="#117727" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">name</a>, <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span>, <a href="#123650" title="Interpreter.this.Request">req</a>.<a href="#119483" title="(key: Interpreter.this.compiler.Name)String">typeOf</a>(<a href="#122856" title="=&gt; Interpreter.this.compiler.Name">name</a>))
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class AssignHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117748">AssignHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.Assign" id="122907">member</a>: <a href="ast/Trees.scala.html#26841" title="Interpreter.this.compiler.Assign">Assign</a>) <span class="keyword">extends</span> <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122907" title="Interpreter.this.compiler.Assign">member</a>) {
    <span class="keyword">val</span> <a title="Interpreter.this.compiler.Ident" id="122899">lhs</a> = <a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">member</a>.<a href="ast/Trees.scala.html#73382" title="=&gt; Trees.this.Tree">lhs</a>.<span title="[T0]T0">asInstanceOf</span><span title="Interpreter.this.compiler.Ident">[</span><a href="ast/Trees.scala.html#26891" title="Interpreter.this.compiler.Ident">Ident</a>] // an unfortunate limitation
    <span class="keyword">val</span> <a title="Interpreter.this.compiler.Name" id="122901">helperName</a> = <a href="symtab/Names.scala.html#26207" title="(s: String)Interpreter.this.compiler.Name">newTermName</a>(<a href="#117966" title="()String">synthVarNameCreator</a>())
    <span class="keyword">override</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122903">valAndVarNames</a> = <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122901" title="=&gt; Interpreter.this.compiler.Name">helperName</a>)

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122905">extraCodeToEvaluate</a>(<a title="Interpreter.this.Request" id="123720">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123721">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <a href="#123721" title="(x$1: java.lang.String)Unit">code</a> println <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;val %s = %s&quot;&quot;&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#122901" title="=&gt; Interpreter.this.compiler.Name">helperName</a>, <a href="#122899" title="=&gt; Interpreter.this.compiler.Ident">lhs</a>)

    /** Print out lhs instead of the generated varName */
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122906">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123751">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123752">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) {
      <span class="keyword">val</span> <a title="String" id="123754">lhsType</a> = <a href="#117670" title="(str: String)String">string2code</a>(<a href="#119485" title="(vname: Interpreter.this.compiler.Name)String">req</a> typeOfEnc <a href="#122901" title="=&gt; Interpreter.this.compiler.Name">helperName</a>)
      <span class="keyword">val</span> <a title="String" id="123755">res</a> = <a href="#117670" title="(str: String)String">string2code</a>(<a href="#119479" title="(vname: Interpreter.this.compiler.Name)String">req</a> fullPath <a href="#122901" title="=&gt; Interpreter.this.compiler.Name">helperName</a>)
      <span class="keyword">val</span> <a title="String" id="123756">codeToPrint</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot; + &quot;%s: %s = &quot; + %s + &quot;\n&quot; &quot;&quot;&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#122899" title="=&gt; Interpreter.this.compiler.Ident">lhs</a>, <a href="#123754" title="String">lhsType</a>, <a href="#123755" title="String">res</a>)
          
      <a href="#123752" title="(x$1: java.lang.String)Unit">code</a> println <a href="#123756" title="String">codeToPrint</a>
    }
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ModuleHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117749">ModuleHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.ModuleDef" id="122923">module</a>: <a href="ast/Trees.scala.html#26773" title="Interpreter.this.compiler.ModuleDef">ModuleDef</a>) <span class="keyword">extends</span> <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122923" title="Interpreter.this.compiler.ModuleDef">module</a>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> ModuleDef<a href="#122917" title="(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)" id="122915">(</a><a href="#122914" title="Interpreter.this.compiler.Modifiers" id="122917">mods</a>, <a href="#122914" title="Interpreter.this.compiler.Name" id="122919">name</a>, _) = <a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">module</a>
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122921">boundNames</a> = <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122918" title="=&gt; Interpreter.this.compiler.Name">name</a>)

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122922">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123828">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123829">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <a href="#123829" title="(x$1: java.lang.String)Unit">code</a> println <a href="#117667" title="(xs: String*)String">codegenln</a>(<span title="java.lang.String(&quot;defined module &quot;)" class="string">&quot;defined module &quot;</span>, <a href="#117727" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">name</a>)
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ClassHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117750">ClassHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.ClassDef" id="122939">classdef</a>: <a href="ast/Trees.scala.html#26768" title="Interpreter.this.compiler.ClassDef">ClassDef</a>) <span class="keyword">extends</span> <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122939" title="Interpreter.this.compiler.ClassDef">classdef</a>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> ClassDef<a href="#122933" title="(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)" id="122931">(</a><a href="#122930" title="Interpreter.this.compiler.Modifiers" id="122933">mods</a>, <a href="#122930" title="Interpreter.this.compiler.Name" id="122935">name</a>, _, _) = <a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">classdef</a>
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122937">boundNames</a> = 
      <a href="#122934" title="=&gt; Interpreter.this.compiler.Name">name</a> <a href="#123888" title="Interpreter.this.compiler.Name">::</a> <span title="(x: Interpreter.this.compiler.Name)List[Interpreter.this.compiler.Name]">(</span><span title="List[Interpreter.this.compiler.Name]" class="keyword">if</span> (<a href="ast/Trees.scala.html#52300" title="(flag: Long)Boolean">mods</a> hasFlag Flags.<span title="Long(2048L)">CASE</span>) <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122934" title="=&gt; Interpreter.this.compiler.Name">name</a>.<a href="symtab/Names.scala.html#28387" title="=&gt; Interpreter.this.compiler.Name">toTermName</a>) <span class="keyword">else</span> <span title="object Nil">Nil</span>)
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122938">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="123909">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="123910">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <a href="#123910" title="(x$1: java.lang.String)Unit">code</a> print <a href="#117667" title="(xs: String*)String">codegenln</a>(<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;defined %s %s&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">classdef</a>.<a href="ast/Trees.scala.html#52240" title="=&gt; String">keyword</a>, <a href="#122934" title="=&gt; Interpreter.this.compiler.Name">name</a>))
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class TypeAliasHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117751">TypeAliasHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.TypeDef" id="122956">typeDef</a>: <a href="ast/Trees.scala.html#26793" title="Interpreter.this.compiler.TypeDef">TypeDef</a>) <span class="keyword">extends</span> <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122956" title="Interpreter.this.compiler.TypeDef">typeDef</a>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> TypeDef<a href="#122949" title="(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)" id="122947">(</a><a href="#122946" title="Interpreter.this.compiler.Modifiers" id="122949">mods</a>, <a href="#122946" title="Interpreter.this.compiler.Name" id="122951">name</a>, _, _) = <a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">typeDef</a>
    <span class="keyword">def</span> <a title="()Boolean" id="122952">isAlias</a>() = <a href="#122948" title="=&gt; Interpreter.this.compiler.Modifiers">mods</a>.<a href="ast/Trees.scala.html#52299" title="(x$1: Boolean)Boolean">isPublic</a> &amp;&amp; <a href="#117679" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="ast/Trees.scala.html#26741" title="object Interpreter.this.compiler.treeInfo">treeInfo</a>.<a href="ast/TreeInfo.scala.html#49194" title="(tree: Interpreter.this.compiler.treeInfo.trees.Tree)Boolean">isAliasTypeDef</a>(<a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">typeDef</a>)
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="122954">boundNames</a> = <span title="List[Interpreter.this.compiler.Name]" class="keyword">if</span> (<a href="#122952" title="()Boolean">isAlias</a>) <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span>(<a href="#122950" title="=&gt; Interpreter.this.compiler.Name">name</a>) <span class="keyword">else</span> <span title="object Nil">Nil</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="122955">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="124048">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="124049">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <a href="#124049" title="(x$1: java.lang.String)Unit">code</a> println <a href="#117667" title="(xs: String*)String">codegenln</a>(<span title="java.lang.String(&quot;defined type alias &quot;)" class="string">&quot;defined type alias &quot;</span>, <a href="#117727" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">name</a>)
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ImportHandler extends Interpreter.this.MemberHandler with ScalaObject" id="117752">ImportHandler</a><span title="ScalaObject">(</span><a title="Interpreter.this.compiler.Import" id="122960">imp</a>: <a href="ast/Trees.scala.html#26802" title="Interpreter.this.compiler.Import">Import</a>) <span class="keyword">extends</span> <a href="#117744" title="Interpreter.this.MemberHandler">MemberHandler</a>(<a href="#122960" title="Interpreter.this.compiler.Import">imp</a>) {
    /** Whether this import includes a wildcard import */
    <span class="keyword">override</span> <span class="keyword">val</span> <a title="Boolean" id="120327">importsWildcard</a> = <a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">imp</a>.<a href="ast/Trees.scala.html#99196" title="=&gt; List[(Trees.this.Name, Trees.this.Name)]">selectors</a>.<span title="(f: ((Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)) =&gt; Interpreter.this.compiler.Name)(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[(Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)]])List[Interpreter.this.compiler.Name]">map</span><span title="(elem: Any)Boolean">(</span><a href="#124092" title="(Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)">_</a>.<span title="=&gt; Interpreter.this.compiler.Name">_1</span>) contains <a href="symtab/StdNames.scala.html#29782" title="=&gt; Interpreter.this.compiler.Name">USCOREkw</a>

    /** The individual names imported by this statement */
    <span class="keyword">override</span> <span class="keyword">val</span> <a title="Seq[Interpreter.this.compiler.Name]" id="120329">importedNames</a>: <span title="Seq[Interpreter.this.compiler.Name]">Seq</span>[Name] = <span class="keyword">for</span> {
      (_, <a title="Interpreter.this.compiler.Name" id="124236">sel</a>) &lt;- <a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">imp</a>.<a href="ast/Trees.scala.html#99196" title="(f: ((Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,Seq[Interpreter.this.compiler.Name],List[(Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)]])Seq[Interpreter.this.compiler.Name]">selectors</a>
      <span class="keyword">if</span> (<a href="#124236" title="(x$1: AnyRef)Boolean">sel</a> <span title="(x$1: Boolean)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> &amp;&amp; <a href="#124236" title="(x$1: AnyRef)Boolean">sel</a> != <a href="symtab/StdNames.scala.html#29782" title="=&gt; Interpreter.this.compiler.Name">USCOREkw</a>)
      <a title="Interpreter.this.compiler.Name" id="124256">name</a> &lt;- <span title="(xs: Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]">List</span><span title="(f: (Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.compiler.Name]])List[Interpreter.this.compiler.Name]">(</span><a href="#124236" title="Interpreter.this.compiler.Name">sel</a>.<a href="symtab/Names.scala.html#28388" title="=&gt; Interpreter.this.compiler.Name">toTypeName</a>, <a href="#124236" title="Interpreter.this.compiler.Name">sel</a>.<a href="symtab/Names.scala.html#28387" title="=&gt; Interpreter.this.compiler.Name">toTermName</a>)
    }
    <span class="keyword">yield</span> <a href="#124256" title="Interpreter.this.compiler.Name">name</a>

    // record the import
    <a href="#117709" title="(x: Interpreter.this.compiler.Import)Interpreter.this.prevImports.type" id="61852">prevImports</a> += <a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">imp</a>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit" id="120331">resultExtractionCode</a>(<a title="Interpreter.this.Request" id="124424">req</a>: <a href="#117753" title="Interpreter.this.Request">Request</a>, <a title="java.io.PrintWriter" id="124425">code</a>: <span title="java.io.PrintWriter">PrintWriter</span>) =
      <a href="#124425" title="(x$1: java.lang.String)Unit">code</a> println <a href="#117667" title="(xs: String*)String">codegenln</a>(<a href="#123353" title="=&gt; Interpreter.this.compiler.Tree">imp</a>.<a href="ast/Trees.scala.html#29567" title="()String">toString</a>)
  }

  /** One line of code submitted by the user for interpretation */
  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class Request extends java.lang.Object with ScalaObject" id="117753">Request</a><span title="ScalaObject">(</span><span class="keyword">val</span> <a title="String" id="122842">line</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="122843">lineName</a>: <span title="String">String</span>) {
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Tree]" id="119461">trees</a> = <a href="#117732" title="(line: String)Option[List[Interpreter.this.compiler.Tree]]">parse</a><span title="(default: =&gt; List[Interpreter.this.compiler.Tree])List[Interpreter.this.compiler.Tree]">(</span><a href="#122842" title="=&gt; String">line</a>) getOrElse <span title="object Nil">Nil</span>

    /** name to use for the object that will compute &quot;line&quot; */
    <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="119463">objectName</a> = <a href="#122843" title="(x$1: Any)java.lang.String">lineName</a> + <a href="symtab/StdNames.scala.html#29814" title="=&gt; java.lang.String">INTERPRETER_WRAPPER_SUFFIX</a>

    /** name of the object that retrieves the result from the above object */
    <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="119464">resultObjectName</a> = <span title="(x$1: Any)java.lang.String" class="string">&quot;RequestResult$&quot;</span> + <a href="#119463" title="=&gt; java.lang.String">objectName</a>

    /** handlers for each tree in this request */
    <span class="keyword">val</span> <a title="List[Interpreter.this.MemberHandler]" id="119465">handlers</a>: <span title="List[Interpreter.this.MemberHandler]">List</span>[MemberHandler] = <a href="#119461" title="(f: (Interpreter.this.compiler.Tree) =&gt; Interpreter.this.MemberHandler)(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.MemberHandler,List[Interpreter.this.MemberHandler],List[Interpreter.this.compiler.Tree]])List[Interpreter.this.MemberHandler]">trees</a> <span title="scala.collection.generic.BuilderFactory[Interpreter.this.MemberHandler,List[Interpreter.this.MemberHandler],List#Coll]">map</span> <a href="#117736" title="(member: Interpreter.this.compiler.Tree)Interpreter.this.MemberHandler">chooseHandler</a>

    /** all (public) names defined by these statements */
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="119467">boundNames</a> = (<a title="(args: Interpreter.this.compiler.Name*)scala.collection.immutable.ListSet[Interpreter.this.compiler.Name]" id="7382">ListSet</a><span title="(elems: Traversable[Interpreter.this.compiler.Name])scala.collection.immutable.ListSet[Interpreter.this.compiler.Name]">(</span>) ++ <a href="#119465" title="=&gt; List[Interpreter.this.MemberHandler]">handlers</a>.<span title="(f: (Interpreter.this.MemberHandler) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.MemberHandler]])List[Interpreter.this.compiler.Name]">flatMap</span><span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">(</span><a href="#119665" title="Interpreter.this.MemberHandler">_</a>.<a href="#119672" title="=&gt; List[Interpreter.this.compiler.Name]">boundNames</a>)).<span title="=&gt; List[Interpreter.this.compiler.Name]">toList</span>

    /** list of names used by this expression */
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Name]" id="119469">usedNames</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name] = <a href="#119465" title="=&gt; List[Interpreter.this.MemberHandler]">handlers</a>.<span title="(f: (Interpreter.this.MemberHandler) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.MemberHandler]])List[Interpreter.this.compiler.Name]">flatMap</span><span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">(</span><a href="#124593" title="Interpreter.this.MemberHandler">_</a>.<a href="#119670" title="=&gt; List[Interpreter.this.compiler.Name]">usedNames</a>) 

    /** Code to import bound names from previous lines - accessPath is code to
      * append to objectName to access anything bound by request. */
    <span class="keyword">val</span> ComputedImports<a href="#119472" title="(String, String, String)">(</a><a href="#119471" title="String" id="119472">importsPreamble</a>, <a href="#119471" title="String" id="119474">importsTrailer</a>, <a href="#119471" title="String" id="119476">accessPath</a>) =
      <a href="#117731" title="(wanted: Set[Interpreter.this.compiler.Name])Interpreter.this.ComputedImports">importsCode</a><a href="#120154" title="Interpreter.this.ComputedImports @unchecked">(</a><a title="=&gt; collection.immutable.Set.type" id="7920">Set</a>.<a title="(elems: Traversable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]" id="54601">empty</a> ++ <a href="#119469" title="=&gt; List[Interpreter.this.compiler.Name]">usedNames</a>)

    /** Code to access a variable with the specified name */
    <span class="keyword">def</span> <a title="(vname: String)String" id="119478">fullPath</a>(<a title="String" id="121400">vname</a>: <span title="String">String</span>): <span title="String">String</span> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;%s.`%s`\n&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#119463" title="(x$1: Any)java.lang.String">objectName</a> + <a href="#119476" title="=&gt; String">accessPath</a>, <a href="#121400" title="String">vname</a>)

    /** Code to access a variable with the specified name */
    <span class="keyword">def</span> <a title="(vname: Interpreter.this.compiler.Name)String" id="119479">fullPath</a>(<a title="Interpreter.this.compiler.Name" id="121398">vname</a>: <a href="symtab/Names.scala.html#26214" title="Interpreter.this.compiler.Name">Name</a>): <span title="String">String</span> = <a href="#119478" title="(vname: String)String">fullPath</a>(<a href="#121398" title="Interpreter.this.compiler.Name">vname</a>.<a href="symtab/Names.scala.html#28391" title="()String">toString</a>)

    /** the line of code to compute */
    <span class="keyword">def</span> <a title="=&gt; String" id="119480">toCompute</a> = <a href="#122842" title="=&gt; String">line</a>

    /** generate the source code for the object that computes this request */
    <span class="keyword">def</span> <a title="=&gt; String" id="119481">objectSourceCode</a>: <span title="String">String</span> = <a href="#117721" title="(writer: (java.io.PrintWriter) =&gt; Unit)String">stringFrom</a> { <a title="java.io.PrintWriter" id="124658">code</a> =&gt; 
      // whitespace compatible with interpreter.scala
      <span class="keyword">val</span> <a title="String" id="124659">preamble</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;object %s {
        |   %s%s
      &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">stripMargin</span>.<span title="(args: Any*)String">format</span>(<a href="#119463" title="=&gt; java.lang.String">objectName</a>, <a href="#119472" title="=&gt; String">importsPreamble</a>, <a href="#117726" title="(code: String)String">indentCode</a>(<a href="#119480" title="=&gt; String">toCompute</a>))     
      // val preamble = &quot;&quot;&quot;
      //   | object %s {
      //   |   %s %s
      // &quot;&quot;&quot;.stripMargin.format(objectName, importsPreamble, indentCode(toCompute))
      <span class="keyword">val</span> <a title="java.lang.String" id="124660">postamble</a> = <a href="#119474" title="(x$1: Any)java.lang.String">importsTrailer</a> + <span title="java.lang.String(&quot;; }&quot;)" class="string">&quot;; }&quot;</span>

      <a href="#124658" title="(x$1: java.lang.String)Unit">code</a> println <a href="#124659" title="String">preamble</a>
      <a href="#119465" title="(f: (Interpreter.this.MemberHandler) =&gt; Unit)Unit">handlers</a> foreach { <a href="#124725" title="Interpreter.this.MemberHandler">_</a>.<a href="#119681" title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit">extraCodeToEvaluate</a>(<a href="#117753" title="Interpreter.this.Request" class="keyword">this</a>, <a href="#124658" title="java.io.PrintWriter">code</a>) }
      <a href="#124658" title="(x$1: java.lang.String)Unit">code</a> println <a href="#124660" title="java.lang.String">postamble</a>
    }
      
    /** Types of variables defined by this request.  They are computed
        after compilation of the main object */
    <span class="keyword">var</span> <a title="Map[Interpreter.this.compiler.Name,String]" id="119483">typeOf</a>: <span title="Map[Interpreter.this.compiler.Name,String]">Map</span>[Name, String] = _
    <span class="keyword">def</span> <a title="(vname: Interpreter.this.compiler.Name)String" id="119485">typeOfEnc</a>(<a title="Interpreter.this.compiler.Name" id="123449">vname</a>: <a href="symtab/Names.scala.html#26214" title="Interpreter.this.compiler.Name">Name</a>) = <a href="#119483" title="(key: Interpreter.this.compiler.Name)String">typeOf</a>(<a href="symtab/StdNames.scala.html#26692" title="(str: String)Interpreter.this.compiler.Name">compiler</a> encode <a href="#117727" title="implicit scala.tools.nsc.Interpreter.name2string : (name: Interpreter.this.compiler.Name)String">vname</a>)

    /** generate source code for the object that retrieves the result
        from objectSourceCode */
    <span class="keyword">def</span> <a title="=&gt; String" id="119486">resultObjectSourceCode</a>: <span title="String">String</span> = <a href="#117721" title="(writer: (java.io.PrintWriter) =&gt; Unit)String">stringFrom</a> { <a title="java.io.PrintWriter" id="124742">code</a> =&gt;
      <span class="keyword">val</span> <a title="String" id="124743">preamble</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;
      | object %s {
      |   val result: String = {
      |     %s    // evaluate object to make sure constructor is run
      |     (&quot;&quot;   // an initial &quot;&quot; so later code can uniformly be: + etc
      &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">stripMargin</span>.<span title="(args: Any*)String">format</span>(<a href="#119464" title="=&gt; java.lang.String">resultObjectName</a>, <a href="#119463" title="(x$1: Any)java.lang.String">objectName</a> + <a href="#119476" title="=&gt; String">accessPath</a>)
      
      <span class="keyword">val</span> <a title="String" id="124744">postamble</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;
      |     )
      |   }
      | }
      &quot;&quot;&quot;</span>.<span title="=&gt; String">stripMargin</span>

      <a href="#124742" title="(x$1: java.lang.String)Unit">code</a> println <a href="#124743" title="String">preamble</a>
      <a href="#119465" title="(f: (Interpreter.this.MemberHandler) =&gt; Unit)Unit">handlers</a> foreach { <a href="#124824" title="Interpreter.this.MemberHandler">_</a>.<a href="#119682" title="(req: Interpreter.this.Request,code: java.io.PrintWriter)Unit">resultExtractionCode</a>(<a href="#117753" title="Interpreter.this.Request" class="keyword">this</a>, <a href="#124742" title="java.io.PrintWriter">code</a>) }
      <a href="#124742" title="(x$1: java.lang.String)Unit">code</a> println <a href="#124744" title="String">postamble</a>
    }

    /** Compile the object file.  Returns whether the compilation succeeded.
     *  If all goes well, the &quot;types&quot; map is computed. */
    <span class="keyword">def</span> <a title="()Boolean" id="119487">compile</a>(): <span title="Boolean">Boolean</span> = {
      // error counting is wrong, hence interpreter may overlook failure - so we reset
      <a href="#117694" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/AbstractReporter.scala.html#39031" title="=&gt; Unit">reset</a>

      // compile the main object
      <span class="keyword">val</span> <a title="Interpreter.this.compiler.Run" id="124838">objRun</a> = <span title="Interpreter.this.compiler.Run" class="keyword">new</span> <a href="#117679" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39410" title="Interpreter.this.compiler.Run">Run</a>()
      <a href="#124838" title="Interpreter.this.compiler.Run">objRun</a>.<a href="Global.scala.html#40450" title="(_sources: List[scala.tools.nsc.util.SourceFile])Unit">compileSources</a>(<span title="(xs: scala.tools.nsc.util.BatchSourceFile*)List[scala.tools.nsc.util.BatchSourceFile]">List</span>(<a href="util/SourceFile.scala.html#121515" title="(sourceName: String,cs: Seq[Char])scala.tools.nsc.util.BatchSourceFile" class="keyword">new</a> <a href="util/SourceFile.scala.html#14734" title="scala.tools.nsc.util.BatchSourceFile">BatchSourceFile</a>(<span title="java.lang.String(&quot;&lt;console&gt;&quot;)" class="string">&quot;&lt;console&gt;&quot;</span>, <a href="#119481" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">objectSourceCode</a>)))
      <span title="Unit" class="keyword">if</span> (<a href="#117694" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/Reporter.scala.html#39006" title="=&gt; Boolean">hasErrors</a>)
        <span title="Nothing" class="keyword">return</span> <span title="Boolean(false)" class="keyword">false</span>

      // extract and remember types 
      <a href="#119483" title="(x$1: Map[Interpreter.this.compiler.Name,String])Unit">typeOf</a> = <a href="#119488" title="(objRun: Interpreter.this.compiler.Run)Map[Interpreter.this.compiler.Name,String]">findTypes</a>(<a href="#124838" title="Interpreter.this.compiler.Run">objRun</a>)

      // compile the result-extraction object
      <span title="Interpreter.this.compiler.Run" class="keyword">new</span> <a href="#117679" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39410" title="Interpreter.this.compiler.Run">Run</a>().<a href="Global.scala.html#40450" title="(_sources: List[scala.tools.nsc.util.SourceFile])Unit">compileSources</a>(<span title="(xs: scala.tools.nsc.util.BatchSourceFile*)List[scala.tools.nsc.util.BatchSourceFile]">List</span>(<a href="util/SourceFile.scala.html#121515" title="(sourceName: String,cs: Seq[Char])scala.tools.nsc.util.BatchSourceFile" class="keyword">new</a> <a href="util/SourceFile.scala.html#14734" title="scala.tools.nsc.util.BatchSourceFile">BatchSourceFile</a>(<span title="java.lang.String(&quot;&lt;console&gt;&quot;)" class="string">&quot;&lt;console&gt;&quot;</span>, <a href="#119486" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">resultObjectSourceCode</a>)))

      // success
      <span title="=&gt; Boolean">!</span><a href="#117694" title="object Interpreter.this.reporter">reporter</a>.<a href="reporters/Reporter.scala.html#39006" title="=&gt; Boolean">hasErrors</a>
    }

    /** Dig the types of all bound variables out of the compiler run.
     *
     *  @param objRun ...
     *  @return       ...
     */
    <span class="keyword">def</span> <a title="(objRun: Interpreter.this.compiler.Run)Map[Interpreter.this.compiler.Name,String]" id="119488">findTypes</a>(<a title="Interpreter.this.compiler.Run" id="124891">objRun</a>: compiler.<a href="Global.scala.html#39410" title="Interpreter.this.compiler.Run">Run</a>): <span title="Map[Interpreter.this.compiler.Name,String]">Map</span>[Name, String] = {
      <span class="keyword">import</span> compiler.definitions.{ EmptyPackage, getMember }
      <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="124950">valAndVarNames</a> = <a href="#119465" title="(f: (Interpreter.this.MemberHandler) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.MemberHandler]])List[Interpreter.this.compiler.Name]">handlers</a> <span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">flatMap</span> { <a href="#124963" title="Interpreter.this.MemberHandler">_</a>.<a href="#119673" title="=&gt; List[Interpreter.this.compiler.Name]">valAndVarNames</a> }
      <span class="keyword">def</span> <a title="=&gt; List[Interpreter.this.compiler.Name]" id="124951">defNames</a> = <a href="#119465" title="(f: (Interpreter.this.MemberHandler) =&gt; Traversable[Interpreter.this.compiler.Name])(implicit bf: scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List[Interpreter.this.MemberHandler]])List[Interpreter.this.compiler.Name]">handlers</a> <span title="scala.collection.generic.BuilderFactory[Interpreter.this.compiler.Name,List[Interpreter.this.compiler.Name],List#Coll]">flatMap</span> { <a href="#125054" title="Interpreter.this.MemberHandler">_</a>.<a href="#119674" title="=&gt; List[Interpreter.this.compiler.Name]">defNames</a> }
      
      <span class="keyword">def</span> <a title="(names: List[Interpreter.this.compiler.Name],nameMap: (Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)Map[Interpreter.this.compiler.Name,String]" id="124952">getTypes</a>(<a title="List[Interpreter.this.compiler.Name]" id="125137">names</a>: <span title="List[Interpreter.this.compiler.Name]">List</span>[Name], <a title="(Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name" id="125138">nameMap</a>: Name =&gt; Name): <span title="Map[Interpreter.this.compiler.Name,String]">Map</span>[Name, String] = {
        <span class="keyword">def</span> <a title="[T](op: =&gt; T)T" id="125139">atNextPhase</a>[<a title="&gt;: Nothing &lt;: Any" id="125141">T</a>](<a title="=&gt; T" id="125144">op</a>: =&gt; T): <a href="#125141" title="T">T</a> = <a href="#117679" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="symtab/SymbolTable.scala.html#26256" title="(ph: scala.tools.nsc.Phase)(op: =&gt; T)T">atPhase</a>(<a href="#124891" title="Interpreter.this.compiler.Run">objRun</a>.<a href="Global.scala.html#40420" title="=&gt; scala.tools.nsc.Phase">typerPhase</a>.<a href="Phase.scala.html#23302" title="=&gt; scala.tools.nsc.Phase">next</a>)(<a href="#125144" title="=&gt; T">op</a>)
        
        /** the outermost wrapper object */
        <span class="keyword">val</span> <a title="Interpreter.this.compiler.Symbol" id="125142">outerResObjSym</a>: <a href="symtab/Symbols.scala.html#26286" title="Interpreter.this.compiler.Symbol">Symbol</a> = <a href="symtab/Definitions.scala.html#28764" title="(owner: Interpreter.this.compiler.Symbol,name: Interpreter.this.compiler.Name)Interpreter.this.compiler.Symbol">getMember</a>(<a href="symtab/Definitions.scala.html#28427" title="=&gt; Interpreter.this.compiler.TermSymbol">EmptyPackage</a>, <a href="symtab/Names.scala.html#26207" title="(s: String)Interpreter.this.compiler.Name">newTermName</a>(<a href="#119463" title="=&gt; java.lang.String">objectName</a>))

        /** the innermost object inside the wrapper, found by
          * following accessPath into the outer one. */
        <span class="keyword">val</span> <a title="Interpreter.this.compiler.Symbol" id="125143">resObjSym</a> =
          <a href="#119476" title="=&gt; String">accessPath</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span>(<span title="java.lang.String(&quot;\.&quot;)" class="string">&quot;\\.&quot;</span>).<a title="(z: Interpreter.this.compiler.Symbol)(op: (Interpreter.this.compiler.Symbol, java.lang.String) =&gt; Interpreter.this.compiler.Symbol)Interpreter.this.compiler.Symbol" id="25912">foldLeft</a>(<a href="#125142" title="Interpreter.this.compiler.Symbol">outerResObjSym</a>) { (<a title="Interpreter.this.compiler.Symbol" id="125184">sym</a>, <a title="java.lang.String" id="125185">name</a>) =&gt;
            <span title="Interpreter.this.compiler.Symbol" class="keyword">if</span> (<a href="#125185" title="(x$1: AnyRef)Boolean">name</a> == <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>) <a href="#125184" title="Interpreter.this.compiler.Symbol">sym</a> <span class="keyword">else</span>
            <a href="#125139" title="(op: =&gt; Interpreter.this.compiler.Symbol)Interpreter.this.compiler.Symbol">atNextPhase</a>(<a href="#125184" title="Interpreter.this.compiler.Symbol">sym</a>.<a href="symtab/Types.scala.html#30403" title="(name: Interpreter.this.compiler.Name)Interpreter.this.compiler.Symbol">info</a> member <a href="symtab/Names.scala.html#26207" title="(s: String)Interpreter.this.compiler.Name">newTermName</a>(<a href="#125185" title="java.lang.String">name</a>))
          }

        <a href="#125137" title="List[Interpreter.this.compiler.Name]">names</a>.<a title="(z: scala.collection.immutable.Map[Interpreter.this.compiler.Name,String])(f: (scala.collection.immutable.Map[Interpreter.this.compiler.Name,String], Interpreter.this.compiler.Name) =&gt; scala.collection.immutable.Map[Interpreter.this.compiler.Name,String])scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]" id="29129">foldLeft</a>(<a title="=&gt; collection.immutable.Map.type" id="7918">Map</a>.<a title="[A, B]scala.collection.immutable.Map[A,B]" id="45080">empty</a><span title="scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]">[</span><a href="symtab/Names.scala.html#26214" title="Interpreter.this.compiler.Name">Name</a>, <span title="String">String</span>]) { (<a title="scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]" id="125221">map</a>, <a title="Interpreter.this.compiler.Name" id="125222">name</a>) =&gt;
          <span class="keyword">val</span> <a title="Interpreter.this.compiler.Type" id="125223">rawType</a> = <a href="#125139" title="(op: =&gt; Interpreter.this.compiler.Type)Interpreter.this.compiler.Type">atNextPhase</a>(<a href="#125143" title="Interpreter.this.compiler.Symbol">resObjSym</a>.<a href="symtab/Symbols.scala.html#27163" title="=&gt; Interpreter.this.compiler.Type">info</a>.<a href="symtab/Types.scala.html#30403" title="(name: Interpreter.this.compiler.Name)Interpreter.this.compiler.Symbol">member</a>(<a href="#125222" title="Interpreter.this.compiler.Name">name</a>).<a href="symtab/Symbols.scala.html#27162" title="=&gt; Interpreter.this.compiler.Type">tpe</a>)
          // the types are all =&gt;T; remove the =&gt;
          <span class="keyword">val</span> <a title="Interpreter.this.compiler.Type" id="125224">cleanedType</a> = <a href="#125223" title="Interpreter.this.compiler.Type">rawType</a> <span title="Interpreter.this.compiler.Type" class="keyword">match</span> { 
            <span title="Interpreter.this.compiler.Type" class="keyword">case</span> compiler.PolyType(<span title="object Nil">Nil</span>, <a title="Interpreter.this.compiler.Type" id="125235">rt</a>) =&gt; <a href="#125235" title="Interpreter.this.compiler.Type">rt</a>
            <span title="Interpreter.this.compiler.Type" class="keyword">case</span> <a title="Interpreter.this.compiler.Type" id="125238">rawType</a> =&gt; <a href="#125238" title="Interpreter.this.compiler.Type">rawType</a>
          }

          <a href="#125221" title="(kv: (Interpreter.this.compiler.Name, String))scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]" id="45064">map</a> + (<a href="#125222" title="(y: String)(Interpreter.this.compiler.Name, String)" id="8021">name</a> -&gt; <a href="#125139" title="(op: =&gt; String)String">atNextPhase</a>(<a href="#125224" title="Interpreter.this.compiler.Type">cleanedType</a>.<a href="symtab/Types.scala.html#30453" title="()String">toString</a>))
        }
      }

      <span class="keyword">val</span> <a title="Map[Interpreter.this.compiler.Name,String]" id="124953">names1</a> = <a href="#124952" title="(names: List[Interpreter.this.compiler.Name],nameMap: (Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)Map[Interpreter.this.compiler.Name,String]">getTypes</a>(<a href="#124950" title="=&gt; List[Interpreter.this.compiler.Name]">valAndVarNames</a>, <a href="symtab/StdNames.scala.html#26690" title="object Interpreter.this.compiler.nme">nme</a>.<a href="symtab/StdNames.scala.html#29850" title="(name: Interpreter.this.compiler.Name)Interpreter.this.compiler.Name">getterToLocal</a>(<a href="#125382" title="Interpreter.this.compiler.Name">_</a>))
      <span class="keyword">val</span> <a title="Map[Interpreter.this.compiler.Name,String]" id="124954">names2</a> = <a href="#124952" title="(names: List[Interpreter.this.compiler.Name],nameMap: (Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)Map[Interpreter.this.compiler.Name,String]">getTypes</a>(<a href="#124951" title="=&gt; List[Interpreter.this.compiler.Name]">defNames</a>, <a href="#125393" title="(x: Interpreter.this.compiler.Name)Interpreter.this.compiler.Name" id="7935">identity</a>)
      <a href="#124953" title="(elems: Traversable[(Interpreter.this.compiler.Name, String)])scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]" id="46976">names1</a> ++ <a href="#124954" title="Map[Interpreter.this.compiler.Name,String]">names2</a>
    }

    /** load and run the code using reflection */
    <span class="keyword">def</span> <a title="=&gt; (String, Boolean)" id="119489">loadAndRun</a>: <span title="(String, Boolean)">(</span>String, Boolean) = {
      <span class="keyword">val</span> <a title="java.lang.Class[_]" id="125570">resultObject</a>: <span title="java.lang.Class[_]">Class</span>[_] = <a href="#117703" title="(s: String)java.lang.Class[_]">loadByName</a>(<a href="#119464" title="=&gt; java.lang.String">resultObjectName</a>)
      <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="125571">resultValMethod</a>: reflect.<span title="java.lang.reflect.Method">Method</span> = <a href="#125570" title="(x$1: java.lang.String,x$2: java.lang.Class[_]*)java.lang.reflect.Method">resultObject</a> getMethod <span title="java.lang.String(&quot;result&quot;)" class="string">&quot;result&quot;</span>
      // XXX if wrapperExceptions isn't type-annotated we crash scalac
      <span class="keyword">val</span> <a title="List[java.lang.Class[_ &lt;: Throwable]]" id="125572">wrapperExceptions</a>: <span title="List[java.lang.Class[_ &lt;: Throwable]]">List</span>[Class[_ &lt;: Throwable]] =
        <span title="(xs: java.lang.Class[_ &gt;: java.lang.ExceptionInInitializerError with java.lang.reflect.InvocationTargetException &lt;: java.lang.Throwable]*)List[java.lang.Class[_ &gt;: java.lang.ExceptionInInitializerError with java.lang.reflect.InvocationTargetException &lt;: java.lang.Throwable]]">List</span>(classOf<span title="java.lang.Class[java.lang.reflect.InvocationTargetException]">[</span>InvocationTargetException], classOf<span title="java.lang.Class[java.lang.ExceptionInInitializerError]">[</span>ExceptionInInitializerError])
      
      <span class="keyword">def</span> <a title="=&gt; util.control.Exception.Catcher[(String, Boolean)]" id="125573">onErr</a>: <a title="util.control.Exception.Catcher[(String, Boolean)]" id="1106">Catcher</a>[(String, Boolean)] = <a href="#125648" title="(String, Boolean)">{</a> <span title="(String, Boolean)" class="keyword">case</span> <a title="java.lang.Throwable" id="125649">t</a>: <a title="Throwable" id="1908">Throwable</a> =&gt;
        <a href="#117689" title="(operation: =&gt; scala.tools.nsc.InterpreterResults.Result)scala.tools.nsc.InterpreterResults.Result">beQuietDuring</a> { <a href="#117740" title="(name: String,boundType: String,value: Any)scala.tools.nsc.InterpreterResults.Result">bind</a>(<span title="java.lang.String(&quot;lastException&quot;)" class="string">&quot;lastException&quot;</span>, <span title="java.lang.String(&quot;java.lang.Throwable&quot;)" class="string">&quot;java.lang.Throwable&quot;</span>, <a href="#125649" title="java.lang.Throwable">t</a>) }
        <span title="(_1: String,_2: Boolean)(String, Boolean)">(</span><a href="#117721" title="(writer: (java.io.PrintWriter) =&gt; Unit)String">stringFrom</a>(<a href="#125649" title="java.lang.Throwable">t</a>.<a title="(x$1: java.io.PrintWriter)Unit" id="26094">printStackTrace</a>(<a href="#125662" title="java.io.PrintWriter">_</a>)), <span title="Boolean(false)" class="keyword">false</span>)
      }
      
      <a title="(c: util.control.Exception.Catcher[(String, Boolean)])util.control.Exception.Catch[(String, Boolean)]" id="117615">catching</a><span title="(body: =&gt; (String, Boolean))(String, Boolean)">(</span><a href="#125573" title="=&gt; util.control.Exception.Catcher[(String, Boolean)]">onErr</a>) {
        <a title="(exceptions: Class[_]*)util.control.Exception.Catch[Nothing]" id="117645">unwrapping</a><span title="(body: =&gt; (java.lang.String, Boolean))(java.lang.String, Boolean)">(</span><a href="#125572" title="List[java.lang.Class[_ &lt;: Throwable]]">wrapperExceptions</a>: _*) {
          <span title="(_1: java.lang.String,_2: Boolean)(java.lang.String, Boolean)">(</span><a href="#125571" title="java.lang.reflect.Method">resultValMethod</a>.<span title="(x$1: Any,x$2: java.lang.Object*)java.lang.Object">invoke</span>(<a href="#125570" title="java.lang.Class[_]">resultObject</a>).<span title="()java.lang.String">toString</span>, <span title="Boolean(true)" class="keyword">true</span>)
        }
      }
    }
  }
  
  /** These methods are exposed so REPL commands can access them.
   *  The command infrastructure is in InterpreterLoop.
   */
  <span class="keyword">def</span> <a title="(xs: List[String])String" id="117754">dumpState</a>(<a title="List[String]" id="125726">xs</a>: <span title="List[String]">List</span>[String]): <span title="String">String</span> = {
    // println(&quot;Imports for &quot; + req + &quot; =&gt; &quot; + req.importsPreamble)
    // req.handlers foreach { h =&gt; println(&quot;Handler &quot; + h + &quot; used names: &quot; + h.usedNames) }
    // req.trees foreach { x =&gt; println(&quot;Tree: &quot; + x) }
    // xs foreach { x =&gt; println(&quot;membersOfIdentifier(&quot; + x + &quot;) = &quot; + membersOfIdentifier(x)) }
    <span title="(xs: java.lang.Object*)List[java.lang.Object]">List</span>(
      <span title="(x$1: Any)java.lang.String" class="string">&quot;allUsedNames = &quot;</span> + <a href="#117711" title="=&gt; List[Interpreter.this.compiler.Name]">allUsedNames</a>,
      <span title="(x$1: Any)java.lang.String" class="string">&quot;allBoundNames = &quot;</span> + <a href="#117712" title="=&gt; List[Interpreter.this.compiler.Name]">allBoundNames</a>,
      <a href="#117707" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<span title="=&gt; List[Interpreter.this.Request]">toList</span>.<span title="(f: (Interpreter.this.Request) =&gt; java.lang.String)(implicit bf: scala.collection.generic.BuilderFactory[java.lang.String,List[java.lang.String],List[Interpreter.this.Request]])List[java.lang.String]">map</span><span title="scala.collection.generic.BuilderFactory[java.lang.String,List[java.lang.String],List#Coll]">(</span><a title="Interpreter.this.Request" id="125746">req</a> =&gt; <span title="(x$1: Any)java.lang.String" class="string">&quot;  \&quot;&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#125746" title="Interpreter.this.Request">req</a>.<a href="#122842" title="=&gt; String">line</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;&quot; =&gt; &quot;)" class="string">&quot;\&quot; =&gt; &quot;</span> + <a href="#125746" title="Interpreter.this.Request">req</a>.<a href="#119481" title="=&gt; String">objectSourceCode</a>)
    ).<span title="(start: String,sep: String,end: String)String">mkString</span>(<span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>, <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>)
  }
      
  // very simple right now, will get more interesting
  <span class="keyword">def</span> <a title="(xs: List[String])String" id="117755">dumpTrees</a>(<a title="List[String]" id="125858">xs</a>: <span title="List[String]">List</span>[String]): <span title="String">String</span> = {
    <span class="keyword">val</span> <a title="List[Interpreter.this.compiler.Tree]" id="125860">treestrs</a> = 
      <span title="object List">List</span>.<a title="(xss: List[List[Interpreter.this.compiler.Tree]])List[Interpreter.this.compiler.Tree]" id="24489">flatten</a>(
        <span class="keyword">for</span> (<a title="String" id="125871">x</a> &lt;- <a href="#125858" title="(f: (String) =&gt; Traversable[List[Interpreter.this.compiler.Tree]])(implicit bf: scala.collection.generic.BuilderFactory[List[Interpreter.this.compiler.Tree],List[List[Interpreter.this.compiler.Tree]],List[String]])List[List[Interpreter.this.compiler.Tree]]">xs</a> ; <a title="Interpreter.this.compiler.Name" id="125891">name</a> &lt;- <a href="#117757" title="(line: String)Option[Interpreter.this.compiler.Name]">nameOfIdent</a><span title="(f: (Interpreter.this.compiler.Name) =&gt; Option[List[Interpreter.this.compiler.Tree]])Option[List[Interpreter.this.compiler.Tree]]">(</span><a href="#125871" title="String">x</a>) ; <a title="Interpreter.this.Request" id="125900">req</a> &lt;- <a href="#117758" title="(name: Interpreter.this.compiler.Name)Option[Interpreter.this.Request]">requestForName</a><span title="(f: (Interpreter.this.Request) =&gt; List[Interpreter.this.compiler.Tree])Option[List[Interpreter.this.compiler.Tree]]">(</span><a href="#125891" title="Interpreter.this.compiler.Name">name</a>))
        <span class="keyword">yield</span> <a href="#125900" title="Interpreter.this.Request">req</a>.<a href="#119461" title="=&gt; List[Interpreter.this.compiler.Tree]">trees</a>
      )

    <span title="String" class="keyword">if</span> (<a href="#125860" title="List[Interpreter.this.compiler.Tree]">treestrs</a>.<a title="=&gt; Boolean" id="25593">isEmpty</a>) <span title="java.lang.String(&quot;No trees found.&quot;)" class="string">&quot;No trees found.&quot;</span>
    <span class="keyword">else</span> <a href="#125860" title="List[Interpreter.this.compiler.Tree]">treestrs</a>.<span title="(f: (Interpreter.this.compiler.Tree) =&gt; java.lang.String)(implicit bf: scala.collection.generic.BuilderFactory[java.lang.String,List[java.lang.String],List[Interpreter.this.compiler.Tree]])List[java.lang.String]">map</span><span title="scala.collection.generic.BuilderFactory[java.lang.String,List[java.lang.String],List#Coll]">(</span><a title="Interpreter.this.compiler.Tree" id="126034">t</a> =&gt; <a href="#126034" title="Interpreter.this.compiler.Tree">t</a>.<a href="ast/Trees.scala.html#29567" title="(x$1: Any)java.lang.String">toString</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; (&quot;)" class="string">&quot; (&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#126034" title="Interpreter.this.compiler.Tree">t</a>.<span title="()java.lang.Class[_]">getClass</span>.<a title="()java.lang.String" id="4899">getSimpleName</a> + <span title="java.lang.String(&quot;)\012&quot;)" class="string">&quot;)\n&quot;</span>).<span title="=&gt; String">mkString</span>
  }
      
  <span class="keyword">def</span> <a title="()String" id="117756">powerUser</a>(): <span title="String">String</span> = {
    <a href="#117689" title="(operation: =&gt; scala.tools.nsc.InterpreterResults.Result)scala.tools.nsc.InterpreterResults.Result">beQuietDuring</a> {
      <span class="keyword">val</span> <a title="java.lang.String" id="126134">mkTypeCmd</a> =
        <span title="java.lang.String(&quot;def mkType(name: String, what: String) = interpreter.interpret(&quot;type &quot; + name + &quot; = &quot; + what)&quot;)" class="string">&quot;&quot;&quot;def mkType(name: String, what: String) = interpreter.interpret(&quot;type &quot; + name + &quot; = &quot; + what)&quot;&quot;&quot;</span>
      
      <a href="#8439" title="Interpreter.this.type" class="keyword">this</a>.<a href="#117740" title="(name: String,boundType: String,value: Any)scala.tools.nsc.InterpreterResults.Result">bind</a>(<span title="java.lang.String(&quot;interpreter&quot;)" class="string">&quot;interpreter&quot;</span>, <span title="java.lang.String(&quot;scala.tools.nsc.Interpreter&quot;)" class="string">&quot;scala.tools.nsc.Interpreter&quot;</span>, <a href="#8439" title="scala.tools.nsc.Interpreter" class="keyword">this</a>)
      <a href="#117737" title="(line: String)scala.tools.nsc.InterpreterResults.Result">interpret</a>(<a href="#126134" title="java.lang.String">mkTypeCmd</a>)
    }
    
    <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;** Power User mode enabled - BEEP BOOP      **
      |** New vals! Try interpreter.&lt;tab&gt;          **
      |** New defs! Try mkType(&quot;T&quot;, &quot;String&quot;)      **
      |** New cmds! :help to discover them         **&quot;&quot;&quot;</span>.<span title="=&gt; String">stripMargin</span>
  }
  
  <span class="keyword">def</span> <a title="(line: String)Option[Interpreter.this.compiler.Name]" id="117757">nameOfIdent</a>(<a title="String" id="125872">line</a>: <span title="String">String</span>): <span title="Option[Interpreter.this.compiler.Name]">Option</span>[Name] = {
    <a href="#117732" title="(line: String)Option[List[Interpreter.this.compiler.Tree]]">parse</a>(<a href="#125872" title="String">line</a>) <span title="Option[Interpreter.this.compiler.Name]" class="keyword">match</span> {
      <span title="Some[Interpreter.this.compiler.Name]" class="keyword">case</span> Some(<a href="#126163" title="(x: List[Interpreter.this.compiler.Tree])Some[List[Interpreter.this.compiler.Tree]]" id="24568">List</a>(Ident(<a title="Interpreter.this.compiler.Name" id="126175">x</a>))) =&gt; <span title="(x: Interpreter.this.compiler.Name)Some[Interpreter.this.compiler.Name]">Some</span>(<a href="#126175" title="Interpreter.this.compiler.Name">x</a>)
      <span title="None.type" class="keyword">case</span> _                    =&gt; <span title="object None">None</span>
    }
  }
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: Interpreter.this.compiler.Name)Option[Interpreter.this.Request]" id="117758">requestForName</a>(<a title="Interpreter.this.compiler.Name" id="125892">name</a>: <a href="symtab/Names.scala.html#26214" title="Interpreter.this.compiler.Name">Name</a>): <span title="Option[Interpreter.this.Request]">Option</span>[Request] = {
    <span class="keyword">for</span> (<a title="Interpreter.this.Request" id="126204">req</a> &lt;- <a href="#117707" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<span title="=&gt; List[Interpreter.this.Request]">toList</span>.<span title="(f: (Interpreter.this.Request) =&gt; Unit)Unit">reverse</span>) {
      <span title="Unit" class="keyword">if</span> (<a href="#126204" title="Interpreter.this.Request">req</a>.<a href="#119465" title="=&gt; List[Interpreter.this.MemberHandler]">handlers</a>.<span title="(p: (Interpreter.this.MemberHandler) =&gt; Boolean)Boolean">exists</span>(<a href="#126209" title="Interpreter.this.MemberHandler">_</a>.<a href="#119672" title="(elem: Any)Boolean">boundNames</a> contains <a href="#125892" title="Interpreter.this.compiler.Name">name</a>))
        <span title="Nothing" class="keyword">return</span> <span title="(x: Interpreter.this.Request)Some[Interpreter.this.Request]">Some</span>(<a href="#126204" title="Interpreter.this.Request">req</a>)
    }
    <span title="object None">None</span>
  }
  
  // XXX at the moment this is imperfect because scala's protected semantics
  // differ from java's, so protected methods appear public via reflection;
  // yet scala enforces the protection.  The result is that protected members
  // appear in completion yet cannot actually be called.  Fixing this 
  // properly requires a scala.reflect.* API.  Fixing it uglily is possible
  // too (cast to structural type!) but I deem poor use of energy.
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Int" id="117759">filterFlags</a>: <a title="Int" id="2198">Int</a> = {
    <span class="keyword">import</span> java.lang.reflect.Modifier._
    STATIC | PRIVATE <span title="Int(14)">|</span> PROTECTED
  }
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="String" id="117761">methodsCode</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot; .
    | asInstanceOf[AnyRef].getClass.getMethods .
    | filter(x =&gt; (x.getModifiers &amp; %d) == 0) .
    | map(_.getName) .
    | mkString(&quot; &quot;)&quot;&quot;&quot;</span>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">stripMargin</span>.<span title="(args: Any*)String">format</span>(<a href="#117759" title="=&gt; Int">filterFlags</a>)  
  
  /** The main entry point for tab-completion.  When the user types x.&lt;tab&gt;
   *  this method is called with &quot;x&quot; as an argument, and it discovers the
   *  fields and methods of x via reflection and returns their names to jline.
   */
  <span class="keyword">def</span> <a title="(line: String)List[String]" id="117763">membersOfIdentifier</a>(<a title="String" id="126286">line</a>: <span title="String">String</span>): <span title="List[String]">List</span>[String] = {
    <span class="keyword">import</span> Completion.{ isValidCompletion }
    <span class="keyword">import</span> NameTransformer.{ decode, encode }   // e.g. $plus$plus =&gt; ++
    
    <span class="keyword">val</span> <a title="Option[List[String]]" id="126290">res</a> = <a href="#117689" title="(operation: =&gt; Option[List[String]])Option[List[String]]">beQuietDuring</a> {
      <span class="keyword">for</span> (<a title="Interpreter.this.compiler.Name" id="126316">name</a> &lt;- <a href="#117757" title="(line: String)Option[Interpreter.this.compiler.Name]">nameOfIdent</a><span title="(f: (Interpreter.this.compiler.Name) =&gt; Option[List[String]])Option[List[String]]">(</span><a href="#126286" title="String">line</a>) ; <a title="Interpreter.this.Request" id="126323">req</a> &lt;- <a href="#117758" title="(name: Interpreter.this.compiler.Name)Option[Interpreter.this.Request]">requestForName</a><span title="(f: (Interpreter.this.Request) =&gt; List[String])Option[List[String]]">(</span><a href="#126316" title="Interpreter.this.compiler.Name">name</a>)) <span class="keyword">yield</span> {
        <span title="List[String]" class="keyword">if</span> (<a href="#117737" title="(line: String)scala.tools.nsc.InterpreterResults.Result">interpret</a><span title="(x$1: AnyRef)Boolean">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;val &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#117966" title="()String">synthVarNameCreator</a>() <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; = &quot;)" class="string">&quot; = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#126316" title="Interpreter.this.compiler.Name">name</a> + <a href="#117761" title="=&gt; String">methodsCode</a>) != <a href="InterpreterResults.scala.html#8446" title="object scala.tools.nsc.InterpreterResults">IR</a>.<a href="InterpreterResults.scala.html#123001" title="object scala.tools.nsc.InterpreterResults.Success">Success</a>) <span title="object Nil">Nil</span>
        <span class="keyword">else</span> {
          <span class="keyword">val</span> <a title="java.lang.String" id="126343">result</a> = <a href="#117707" title="=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]">prevRequests</a>.<a title="=&gt; Interpreter.this.Request" id="25941">last</a>.<a href="#119464" title="=&gt; java.lang.String">resultObjectName</a>
          <span class="keyword">val</span> <a title="Class[Nothing]" id="126344">resultObj</a> = (<a href="#117700" title="(path: String)Option[Class[Nothing]]">classLoader</a> tryToInitializeClass <a href="#126343" title="java.lang.String">result</a>).<span title="=&gt; Class[Nothing]">get</span>
          <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="126345">valMethod</a> = <a href="#126344" title="(x$1: java.lang.String,x$2: java.lang.Class[_]*)java.lang.reflect.Method">resultObj</a> getMethod <span title="java.lang.String(&quot;result&quot;)" class="string">&quot;result&quot;</span>
          <span class="keyword">val</span> <a title="java.lang.String" id="126346">str</a> = <a href="#126345" title="java.lang.reflect.Method">valMethod</a>.<span title="(x$1: Any,x$2: java.lang.Object*)java.lang.Object">invoke</span>(<a href="#126344" title="Class[Nothing]">resultObj</a>).<span title="()java.lang.String">toString</span>
        
          <a href="#126346" title="java.lang.String">str</a>.<a title="(x$1: Int)java.lang.String" id="7083">substring</a>(<a href="#126346" title="java.lang.String">str</a>.<a title="(x$1: Int)Int" id="7047">indexOf</a><span title="(x$1: Int)Int">(</span><span title="Int(61)" class="char">'='</span>) + <span title="Int(1)" class="int">1</span>).<a title="()java.lang.String" id="7120">trim</a> .
          <span title="(x$1: java.lang.String)Array[java.lang.String]">split</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>).<span title="=&gt; List[java.lang.String]">toList</span> .
          <span title="(f: (java.lang.String) =&gt; String)(implicit bf: scala.collection.generic.BuilderFactory[String,List[String],List[java.lang.String]])List[String]">map</span><span title="scala.collection.generic.BuilderFactory[String,List[String],List#Coll]">(</span><a href="#126419" title="(name0: String)String">decode</a>) .
          <span title="(p: (String) =&gt; Boolean)List[String]">filter</span>(<a href="interpreter/Completion.scala.html#126303" title="(x: String)Boolean">isValidCompletion</a>) .
          <span title="=&gt; List[String]">removeDuplicates</span>
        }
      }
    }
      
    <a href="#126290" title="(default: =&gt; List[String])List[String]">res</a> getOrElse <span title="object Nil">Nil</span>
  }
  
  /** Another entry point for tab-completion, ids in scope */
  <span class="keyword">def</span> <a title="()List[String]" id="117764">unqualifiedIds</a>(): <span title="List[String]">List</span>[String] =
    <a href="#117712" title="=&gt; List[Interpreter.this.compiler.Name]">allBoundNames</a> .
      <span title="(f: (Interpreter.this.compiler.Name) =&gt; String)(implicit bf: scala.collection.generic.BuilderFactory[String,List[String],List[Interpreter.this.compiler.Name]])List[String]">map</span><span title="scala.collection.generic.BuilderFactory[String,List[String],List#Coll]">(</span><a href="#127319" title="Interpreter.this.compiler.Name">_</a>.<a href="symtab/Names.scala.html#28391" title="()String">toString</a>) .
      <span title="(p: (String) =&gt; Boolean)List[String]">filter</span>(<span title="=&gt; Boolean">!</span><a href="#117720" title="(name: String)Boolean">isSynthVarName</a>(<a href="#127406" title="String">_</a>))
   
  /** For static/object method completion */ 
  <span class="keyword">def</span> <a title="(path: String)Option[java.lang.Class[_]]" id="117765">getClassObject</a>(<a title="String" id="127411">path</a>: <span title="String">String</span>): <span title="Option[java.lang.Class[_]]">Option</span>[Class[_]] = <a href="#117700" title="(path: String)Option[Class[Nothing]]" id="117910">classLoader</a> tryToLoadClass <a href="#127411" title="String">path</a>
  
  // debugging
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Boolean" id="117767">debuggingOutput</a> = <span title="Boolean(false)" class="keyword">false</span>
  <span class="keyword">def</span> <a title="(s: String)Unit" id="117769">DBG</a>(<a title="String" id="127420">s</a>: <span title="String">String</span>) = <span title="Unit" class="keyword">if</span> (<a href="#117767" title="=&gt; Boolean">debuggingOutput</a>) <a href="#118047" title="(x$1: java.lang.String)Unit">out</a> println <a href="#127420" title="String">s</a> <span class="keyword">else</span> <span title="Unit">(</span>)  
}

/** Utility methods for the Interpreter. */
<span class="keyword">object</span> <a title="object scala.tools.nsc.Interpreter" id="8440">Interpreter</a> <span title="ScalaObject">{</span>
  <span class="keyword">object</span> <a title="object scala.tools.nsc.Interpreter.DebugParam" id="117659">DebugParam</a> <span title="ScalaObject">{</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](x: (String, T))(implicit m: scala.reflect.Manifest[T])scala.tools.nsc.Interpreter.DebugParam[T]" id="127439">tuple2debugparam</a>[<a title="&gt;: Nothing &lt;: Any" id="127441">T</a>](<a title="(String, T)" id="127478">x</a>: <span title="(String, T)">(</span>String, T))(<span class="keyword">implicit</span> <a title="scala.reflect.Manifest[T]" id="127479">m</a>: scala.reflect.<span title="scala.reflect.Manifest[T]">Manifest</span>[T]): <a href="#127906" title="scala.tools.nsc.Interpreter.DebugParam[T]">DebugParam</a>[T] =
      <a href="#127906" title="(name: String,param: T)(implicit m: scala.reflect.Manifest[T])scala.tools.nsc.Interpreter.DebugParam[T]">DebugParam</a><a href="#127479" title="scala.reflect.Manifest[T]">(</a><a href="#127478" title="(String, T)">x</a>.<span title="=&gt; String">_1</span>, <a href="#127478" title="(String, T)">x</a>.<span title="=&gt; T">_2</span>)
    
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](x: T)(implicit m: scala.reflect.Manifest[T])scala.tools.nsc.Interpreter.DebugParam[T]" id="127442">any2debugparam</a>[<a title="&gt;: Nothing &lt;: Any" id="127444">T</a>](<a title="T" id="127502">x</a>: <a href="#127444" title="T">T</a>)(<span class="keyword">implicit</span> <a title="scala.reflect.Manifest[T]" id="127503">m</a>: scala.reflect.<span title="scala.reflect.Manifest[T]">Manifest</span>[T]): <a href="#127906" title="scala.tools.nsc.Interpreter.DebugParam[T]">DebugParam</a>[T] =
      <a href="#127906" title="(name: String,param: T)(implicit m: scala.reflect.Manifest[T])scala.tools.nsc.Interpreter.DebugParam[T]">DebugParam</a><a href="#127503" title="scala.reflect.Manifest[T]">(</a><span title="(x$1: Any)java.lang.String" class="string">&quot;p&quot;</span> + <a href="#127448" title="()Int">getCount</a>(), <a href="#127502" title="T">x</a>)
    
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="127446">counter</a> = <span title="Int(0)" class="int">0</span> 
    <span class="keyword">def</span> <a title="()Int" id="127448">getCount</a>() = { <a href="#127446" title="(x$1: Int)Unit">counter</a> += <span title="Int(1)" class="int">1</span>; <a href="#127446" title="=&gt; Int">counter</a> }
  }
  case <span class="keyword">class</span> <a href="#127834" title="[T](x$0: scala.tools.nsc.Interpreter.DebugParam[T])Some[(String, T)]" id="127906">DebugParam</a>[<a title="&gt;: Nothing &lt;: Any" id="127836">T</a>]<span title="ScalaObject">(</span><a title="String" id="127834">name</a>: <span title="String">String</span>, <a title="T" id="127837">param</a>: <a href="#127836" title="T">T</a>)(<span class="keyword">implicit</span> <a title="scala.reflect.Manifest[T]" id="127840">m</a>: scala.reflect.<span title="scala.reflect.Manifest[T]">Manifest</span>[T]) {
    <span class="keyword">val</span> <a title="scala.reflect.Manifest[T]" id="127461">manifest</a> = <a href="#127840" title="scala.reflect.Manifest[T]">m</a>
    <span class="keyword">val</span> <a title="String" id="127463">typeStr</a> = {
      <span class="keyword">val</span> <a title="java.lang.String" id="127613">str</a> = <a href="#127461" title="=&gt; scala.reflect.Manifest[T]">manifest</a>.<span title="()java.lang.String">toString</span>
      // I'm sure there are more to be discovered...
      <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="127614">regexp1</a> = <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;&quot;&quot;(.*?)\[(.*)\]&quot;&quot;&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="127615">regexp2str</a> = <span title="java.lang.String(&quot;.*\.type#&quot;)" class="string">&quot;&quot;&quot;.*\.type#&quot;&quot;&quot;</span>
      <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="127616">regexp2</a> = (<a href="#127615" title="(x$1: Any)java.lang.String">regexp2str</a> <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">+</span> <span title="java.lang.String(&quot;(.*)&quot;)" class="string">&quot;&quot;&quot;(.*)&quot;&quot;&quot;</span>).<span title="=&gt; scala.util.matching.Regex">r</span>
      
      (<a href="#127613" title="java.lang.String">str</a>.<span title="(x$1: java.lang.String,x$2: java.lang.String)java.lang.String">replaceAll</span>(<span title="java.lang.String(&quot;\n&quot;)" class="string">&quot;&quot;&quot;\n&quot;&quot;&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>)) <span title="String" class="keyword">match</span> {
        <span title="String" class="keyword">case</span> <a href="#127614" title="(target: Any)Option[List[String]]">regexp1</a>(<a title="String" id="127797">clazz</a>, <a title="String" id="127798">typeArgs</a>) =&gt; <span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;%s[%s]&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#127797" title="String">clazz</a>, <a href="#127798" title="String">typeArgs</a>.<span title="(x$1: java.lang.String,x$2: java.lang.String)java.lang.String">replaceAll</span>(<a href="#127615" title="java.lang.String">regexp2str</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>))
        <span title="String" class="keyword">case</span> <a href="#127616" title="(target: Any)Option[List[String]]">regexp2</a>(<a title="String" id="127826">clazz</a>)           =&gt; <a href="#127826" title="String">clazz</a>
        <span title="java.lang.String" class="keyword">case</span> _                        =&gt; <a href="#127613" title="java.lang.String">str</a>
      }
    }
  }
  <span class="keyword">def</span> <a title="(assertion: =&gt; Boolean,args: scala.tools.nsc.Interpreter.DebugParam[_]*)Unit" id="117663">breakIf</a>(<a title="=&gt; Boolean" id="127910">assertion</a>: =&gt; Boolean, <a title="scala.tools.nsc.Interpreter.DebugParam[_]*" id="127911">args</a>: <span title="scala.tools.nsc.Interpreter.DebugParam[_]*">DebugParam</span>[_]*): <span title="Unit">Unit</span> =
    <span title="Unit" class="keyword">if</span> (<a href="#127910" title="=&gt; Boolean">assertion</a>) <a href="#117664" title="(args: List[scala.tools.nsc.Interpreter.DebugParam[_]])Unit">break</a>(<a href="#127911" title="scala.tools.nsc.Interpreter.DebugParam[_]*">args</a>.<span title="=&gt; List[scala.tools.nsc.Interpreter.DebugParam[_]]">toList</span>)

  // start a repl, binding supplied args
  <span class="keyword">def</span> <a title="(args: List[scala.tools.nsc.Interpreter.DebugParam[_]])Unit" id="117664">break</a>(<a title="List[scala.tools.nsc.Interpreter.DebugParam[_]]" id="127916">args</a>: <span title="List[scala.tools.nsc.Interpreter.DebugParam[_]]">List</span>[DebugParam[_]]): <span title="Unit">Unit</span> = {
    <span class="keyword">val</span> <a title="scala.tools.nsc.InterpreterLoop" id="127924">intLoop</a> = <a href="InterpreterLoop.scala.html#127931" title="()scala.tools.nsc.InterpreterLoop" class="keyword">new</a> <a href="InterpreterLoop.scala.html#9141" title="scala.tools.nsc.InterpreterLoop">InterpreterLoop</a>
    <a href="#127924" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127938" title="(x$1: scala.tools.nsc.Settings)Unit">settings</a> = <span title="scala.tools.nsc.Settings" class="keyword">new</span> <a href="Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>(<a title="object Console" id="402">Console</a>.<a href="#128017" title="(x: Any)Unit" id="51576">println</a>)
    <a href="#127924" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127953" title="()Unit">createInterpreter</a>
    <a href="#127924" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127933" title="(x$1: scala.tools.nsc.interpreter.InteractiveReader)Unit">in</a> = <a href="interpreter/InteractiveReader.scala.html#22275" title="object scala.tools.nsc.interpreter.InteractiveReader">InteractiveReader</a>.<a href="interpreter/InteractiveReader.scala.html#128036" title="(interpreter: scala.tools.nsc.Interpreter)scala.tools.nsc.interpreter.InteractiveReader">createDefault</a>(<a href="#127924" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127940" title="=&gt; scala.tools.nsc.Interpreter">interpreter</a>)
    
    // rebind exit so people don't accidentally call System.exit by way of predef
    <a href="#127924" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127940" title="=&gt; scala.tools.nsc.Interpreter">interpreter</a>.<a href="#117689" title="(operation: =&gt; Unit)Unit">beQuietDuring</a> {
      <a href="#127924" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127940" title="=&gt; scala.tools.nsc.Interpreter">interpreter</a>.<a href="#117737" title="(line: String)scala.tools.nsc.InterpreterResults.Result">interpret</a>(<span title="java.lang.String(&quot;def exit = println(&quot;Type :quit to resume program execution.&quot;)&quot;)" class="string">&quot;&quot;&quot;def exit = println(&quot;Type :quit to resume program execution.&quot;)&quot;&quot;&quot;</span>)
      <span class="keyword">for</span> (<a title="scala.tools.nsc.Interpreter.DebugParam[_]" id="128066">p</a> &lt;- <a href="#127916" title="(f: (scala.tools.nsc.Interpreter.DebugParam[_]) =&gt; Unit)Unit">args</a>) {
        <a href="#127924" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127940" title="=&gt; scala.tools.nsc.Interpreter">interpreter</a>.<a href="#117740" title="(name: String,boundType: String,value: Any)scala.tools.nsc.InterpreterResults.Result">bind</a>(<a href="#128066" title="scala.tools.nsc.Interpreter.DebugParam[_]">p</a>.<a href="#127834" title="=&gt; String">name</a>, <a href="#128066" title="scala.tools.nsc.Interpreter.DebugParam[_]">p</a>.<a href="#127463" title="=&gt; String">typeStr</a>, <a href="#128066" title="scala.tools.nsc.Interpreter.DebugParam[_]">p</a>.<a href="#127837" title="=&gt; Any">param</a>)
        <a title="(x: Any)Unit" id="8126">println</a>(<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" class="string">&quot;%s: %s&quot;</span>.<span title="(args: Any*)String">format</span>(<a href="#128066" title="scala.tools.nsc.Interpreter.DebugParam[_]">p</a>.<a href="#127834" title="=&gt; String">name</a>, <a href="#128066" title="scala.tools.nsc.Interpreter.DebugParam[_]">p</a>.<a href="#127463" title="=&gt; String">typeStr</a>))
      }
    }
    <a href="#127924" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127969" title="()Unit">repl</a>()
    <a href="#127924" title="scala.tools.nsc.InterpreterLoop">intLoop</a>.<a href="InterpreterLoop.scala.html#127952" title="()Unit">closeInterpreter</a>
  }

  /** Heuristically strip interpreter wrapper prefixes
   *  from an interpreter output string.
   */
  <span class="keyword">def</span> <a title="(str: String)String" id="117665">stripWrapperGunk</a>(<a title="String" id="118207">str</a>: <span title="String">String</span>): <span title="String">String</span> = {
    <span class="keyword">val</span> <a title="java.lang.String" id="128106">wrapregex</a> = <span title="java.lang.String(&quot;(line[0-9]+\$object[$.])?(\$iw[$.])*&quot;)" class="string">&quot;&quot;&quot;(line[0-9]+\$object[$.])?(\$iw[$.])*&quot;&quot;&quot;</span>
    <a href="#118207" title="String">str</a>.<span title="(x$1: java.lang.String,x$2: java.lang.String)java.lang.String">replaceAll</span>(<a href="#128106" title="java.lang.String">wrapregex</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>)
  }
  
  <span class="keyword">def</span> <a title="(leadingPlus: Boolean,xs: String*)String" id="117666">codegenln</a>(<a title="Boolean" id="123559">leadingPlus</a>: <span title="Boolean">Boolean</span>, <a title="String*" id="123560">xs</a>: <span title="String*">String</span>*): <span title="String">String</span> = <a href="#117669" title="(leadingPlus: Boolean,xs: String*)String">codegen</a>(<a href="#123559" title="Boolean">leadingPlus</a>, (<a href="#123560" title="(that: Traversable[String])(implicit bf: scala.collection.generic.BuilderFactory[String,Sequence[String],Sequence[String]])Sequence[String]">xs</a> <span title="scala.collection.generic.BuilderFactory[String,Sequence[String],Sequence#Coll]">++</span> <a title="(xs: java.lang.String*)(implicit evidence$2: scala.reflect.ClassManifest[java.lang.String])Array[java.lang.String]" id="906">Array</a><a title="(clazz: Class[_])scala.reflect.ClassManifest[java.lang.String]" id="27492">(</a><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>)): _*)
  <span class="keyword">def</span> <a title="(xs: String*)String" id="117667">codegenln</a>(<a title="String*" id="123557">xs</a>: <span title="String*">String</span>*): <span title="String">String</span> = <a href="#117666" title="(leadingPlus: Boolean,xs: String*)String">codegenln</a>(<span title="Boolean(true)" class="keyword">true</span>, <a href="#123557" title="String*">xs</a>: _*)
  <span class="keyword">def</span> <a title="(xs: String*)String" id="117668">codegen</a>(<a title="String*" id="128115">xs</a>: <span title="String*">String</span>*): <span title="String">String</span> = <a href="#117669" title="(leadingPlus: Boolean,xs: String*)String">codegen</a>(<span title="Boolean(true)" class="keyword">true</span>, <a href="#128115" title="String*">xs</a>: _*)
  <span class="keyword">def</span> <a title="(leadingPlus: Boolean,xs: String*)String" id="117669">codegen</a>(<a title="Boolean" id="128112">leadingPlus</a>: <span title="Boolean">Boolean</span>, <a title="String*" id="128113">xs</a>: <span title="String*">String</span>*): <span title="String">String</span> = {
    <span class="keyword">val</span> <a title="java.lang.String" id="128261">front</a> = <span title="java.lang.String" class="keyword">if</span> (<a href="#128112" title="Boolean">leadingPlus</a>) <span title="java.lang.String(&quot;+ &quot;)" class="string">&quot;+ &quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <a href="#128113" title="String*">xs</a>.<span title="(f: (String) =&gt; java.lang.String)(implicit bf: scala.collection.generic.BuilderFactory[java.lang.String,Sequence[java.lang.String],Sequence[String]])Sequence[java.lang.String]">map</span><span title="scala.collection.generic.BuilderFactory[java.lang.String,Sequence[java.lang.String],Sequence#Coll]">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;\&quot;&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#117670" title="(str: String)String">string2code</a>(<a href="#128270" title="String">_</a>) + <span title="java.lang.String(&quot;&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>).<span title="(start: String,sep: String,end: String)String">mkString</span>(<a href="#128261" title="java.lang.String">front</a>, <span title="java.lang.String(&quot; + &quot;)" class="string">&quot; + &quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>)
  }

  /** Convert a string into code that can recreate the string.
   *  This requires replacing all special characters by escape
   *  codes. It does not add the surrounding &quot; marks.  */
  <span class="keyword">def</span> <a title="(str: String)String" id="117670">string2code</a>(<a title="String" id="123585">str</a>: <span title="String">String</span>): <span title="String">String</span> = {
    /** Convert a character to a backslash-u escape */
    <span class="keyword">def</span> <a title="(c: Char)String" id="128316">char2uescape</a>(<a title="Char" id="128318">c</a>: <a title="Char" id="2184">Char</a>): <span title="String">String</span> = {
      <span class="keyword">var</span> <a title="Int" id="128319">rest</a> = <a href="#128318" title="Char">c</a>.<a title="=&gt; Int" id="2660">toInt</a>
      <span class="keyword">val</span> <a title="StringBuilder" id="128320">buf</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span>
      <span class="keyword">for</span> (<a title="Int" id="128367">i</a> &lt;- <a title="(end: Int)Range" id="31892" class="int">1</a> <a title="(f: (Int) =&gt; Unit)Unit" id="56527">to</a> <span title="Int(4)" class="int">4</span>) {
        <a href="#128320" title="(iter: Traversable[Char])buf.type">buf</a> ++= (<a href="#128319" title="(x$1: Int)Int" id="2993">rest</a> <span title="implicit scala.Predef.intWrapper : (x: Int)scala.runtime.RichInt">%</span> <span title="Int(16)" class="int">16</span>).<a title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" id="31905">toHexString</a>
        <a href="#128319" title="Int">rest</a> = <a href="#128319" title="(x$1: Int)Int" id="2991">rest</a> / <span title="Int(16)" class="int">16</span>
      }
      <span title="(x$1: Any)java.lang.String" class="string">&quot;\\u&quot;</span> + <a href="#128320" title="StringBuilder">buf</a>.<span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">toString</span>.<a title="=&gt; scala.runtime.RichString" id="25980">reverse</a>
    }
    
    <span class="keyword">val</span> <a title="StringBuilder" id="128317">res</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span>
    <span class="keyword">for</span> (<a title="Char" id="128534">c</a> &lt;- <a href="#123585" title="(f: (Char) =&gt; StringBuilder)Unit" id="25892">str</a>) <a href="#128534" title="Char">c</a> <span title="res.type" class="keyword">match</span> {
      <span title="res.type" class="keyword">case</span> <span title="Char('&quot;')" class="char">'&quot;'</span> | <span title="Char(''')" class="char">'\''</span> | <span title="Char('\')" class="char">'\\'</span>  =&gt; <a href="#128317" title="(x: Char)res.type">res</a> += <span title="Char('\')" class="char">'\\'</span> ; <a href="#128317" title="(x: Char)res.type">res</a> += <a href="#128534" title="Char">c</a>
      <span title="res.type" class="keyword">case</span> _ <span class="keyword">if</span> <a href="#128534" title="implicit scala.Predef.charWrapper : (c: Char)scala.runtime.RichChar">c</a>.<a title="=&gt; Boolean" id="43555">isControl</a>   =&gt; <a href="#128317" title="(iter: Traversable[Char])res.type">res</a> ++= <a href="#128316" title="(c: Char)String">char2uescape</a><span title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString">(</span><a href="#128534" title="Char">c</a>)
      <span title="res.type" class="keyword">case</span> _                  =&gt; <a href="#128317" title="(x: Char)res.type">res</a> += <a href="#128534" title="Char">c</a>
    }
    <a href="#128317" title="StringBuilder">res</a>.<span title="()String">toString</span>
  }
}

        </pre>
    </body>
</html>