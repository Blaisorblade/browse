<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/Interpreter.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */</span>
<span class="comment">// $Id: Interpreter.scala 17460 2009-04-08 13:21:43Z extempore $</span>

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> java.io.{ File, PrintWriter, StringWriter, Writer }
<span class="keyword">import</span> java.lang.{ Class, ClassLoader }
<span class="keyword">import</span> java.net.{ MalformedURLException, URL, URLClassLoader }
<span class="keyword">import</span> java.lang.reflect
<span class="keyword">import</span> reflect.InvocationTargetException

<span class="keyword">import</span> scala.collection.immutable.ListSet
<span class="keyword">import</span> scala.collection.mutable
<span class="keyword">import</span> scala.collection.mutable.{ ListBuffer, HashSet, ArrayBuffer }

<span class="keyword">import</span> io.{ PlainFile, VirtualDirectory }
<span class="keyword">import</span> reporters.{ ConsoleReporter, Reporter }
<span class="keyword">import</span> symtab.{ Flags, Names }
<span class="keyword">import</span> util.{ SourceFile, BatchSourceFile, ClassPath, NameTransformer }
<span class="keyword">import</span> nsc.{ InterpreterResults =&gt; IR }
<span class="keyword">import</span> nsc.interpreter._
<span class="keyword">import</span> Interpreter._

<span class="comment">/** &lt;p&gt;
 *    An interpreter for Scala code.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    The main public entry points are &lt;code&gt;compile()&lt;/code&gt;,
 *    &lt;code&gt;interpret()&lt;/code&gt;, and &lt;code&gt;bind()&lt;/code&gt;.
 *    The &lt;code&gt;compile()&lt;/code&gt; method loads a
 *    complete Scala file.  The &lt;code&gt;interpret()&lt;/code&gt; method executes one
 *    line of Scala code at the request of the user.  The &lt;code&gt;bind()&lt;/code&gt;
 *    method binds an object to a variable that can then be used by later
 *    interpreted code.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    The overall approach is based on compiling the requested code and then
 *    using a Java classloader and Java reflection to run the code
 *    and access its results.
 *  &lt;/p&gt;
 *  &lt;p&gt;  
 *    In more detail, a single compiler instance is used
 *    to accumulate all successfully compiled or interpreted Scala code.  To
 *    &quot;interpret&quot; a line of code, the compiler generates a fresh object that
 *    includes the line of code and which has public member(s) to export
 *    all variables defined by that code.  To extract the result of an
 *    interpreted line to show the user, a second &quot;result object&quot; is created
 *    which imports the variables exported by the above object and then
 *    exports a single member named &quot;result&quot;.  To accomodate user expressions
 *    that read from variables or methods defined in previous statements, &quot;import&quot;
 *    statements are used.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    This interpreter shares the strengths and weaknesses of using the
 *    full compiler-to-Java.  The main strength is that interpreted code
 *    behaves exactly as does compiled code, including running at full speed.
 *    The main weakness is that redefining classes and methods is not handled
 *    properly, because rebinding at the Java level is technically difficult.
 *  &lt;/p&gt;
 *
 * @author Moez A. Abdel-Gawad
 * @author Lex Spoon
 */</span>
<span class="keyword">class</span> <span class="typed"><span class="type">class Interpreter extends java.lang.Object with ScalaObject</span><a id="6405">Interpreter</a></span>(<span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.Settings</span><span id="75352"><span id="75351"><a id="125537">settings</a></span></span></span>: <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="Settings.scala.html#6744">Settings</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><span id="75353"><a id="125538">out</a></span></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) {
  <span class="comment">/* If running on pre-1.5 JVM, force target setting to 1.4 */</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="75356"><a id="75355">major</a></span></span> = <span class="typed"><span class="type">object java.lang.System</span><a id="1886">System</a></span>.<span class="typed"><span class="type">(java.lang.String)java.lang.String</span><a id="47450">getProperty</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;java.class.version&quot;)</span><span class="string">&quot;java.class.version&quot;</span></span>).<span class="typed"><span class="type">(Int)java.lang.String</span><span id="21509"><a id="5865">split</a></span></span>(<span class="typed"><span class="type">java.lang.String(&quot;\.&quot;)</span><span class="string">&quot;\\.&quot;</span></span>)(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
  <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a href="#75355" id="821">major</a></span></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="23114">toInt</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">Int(49)</span><span class="int">49</span></span>) <span class="typed"><span class="type">Interpreter.this.type</span><a href="#6405" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#75351">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.ChoiceSetting</span><a href="Settings.scala.html#29980">target</a></span>.<span class="typed"><span class="type">(Interpreter.this.settings.target.T)Unit</span><a href="Settings.scala.html#30302">value</a></span> = <span class="typed"><span class="type">java.lang.String(&quot;jvm-1.4&quot;)</span><span class="string">&quot;jvm-1.4&quot;</span></span>

  <span class="comment">/** directory to save .class files to */</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.io.VirtualDirectory</span><span id="75358"><a id="75357">virtualDirectory</a></span></span> = <span class="typed"><span class="type">scala.tools.nsc.io.VirtualDirectory</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.io.VirtualDirectory</span><a href="io/VirtualDirectory.scala.html#12732">VirtualDirectory</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;(memory)&quot;)</span><span class="string">&quot;(memory)&quot;</span></span>, <span class="typed"><span class="type">object None</span><a id="536">None</a></span>)

  <span class="comment">/** the compiler to compile expressions with */</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.Global</span><span id="75360"><a id="75359">compiler</a></span></span>: nsc.<span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="Global.scala.html#6489">Global</a></span> = <span class="typed"><span class="type">(scala.tools.nsc.Settings,scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global</span><a href="#75377">newCompiler</a></span>(<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#75351">settings</a></span>, <span class="typed"><span class="type">object Interpreter.this.reporter</span><a href="#75375">reporter</a></span>)

  <span class="keyword">import</span> compiler.{ Traverser, CompilationUnit, Symbol, Name, Type }
  <span class="keyword">import</span> compiler.{ 
    Tree, TermTree, ValOrDefDef, ValDef, DefDef, Assign, ClassDef,
    ModuleDef, Ident, Select, TypeDef, Import, MemberDef, DocDef }
  <span class="keyword">import</span> compiler.{ nme, newTermName }
  <span class="keyword">import</span> nme.{ 
    INTERPRETER_VAR_PREFIX, INTERPRETER_SYNTHVAR_PREFIX, INTERPRETER_LINE_PREFIX,
    INTERPRETER_IMPORT_WRAPPER, INTERPRETER_WRAPPER_SUFFIX, USCOREkw
  }
  
  <span class="comment">/** construct an interpreter that reports to Console */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.Settings)scala.tools.nsc.Interpreter</span><a id="75365" class="keyword">this</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Settings</span><a id="125529">settings</a></span>: <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="Settings.scala.html#6744">Settings</a></span>) =
    <span class="typed"><span class="type">Interpreter.this.type</span><a href="#6405" class="keyword">this</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="#125529">settings</a></span>, <span class="typed"><span class="type">scala.tools.nsc.NewLinePrintWriter</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.NewLinePrintWriter</span><a href="NewLinePrintWriter.scala.html#6870">NewLinePrintWriter</a></span>(<span class="typed"><span class="type">scala.tools.nsc.ConsoleWriter</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.ConsoleWriter</span><a href="ConsoleWriter.scala.html#7356">ConsoleWriter</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>))

  <span class="comment">/** whether to print out result lines */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="75368"><span id="75366"><span id="75367"><a id="146672">printResults</a></span></span></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>

  <span class="comment">/** Be quiet.  Do not print out the results of each
    * submitted command unless an exception is thrown.  */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="75369">beQuiet</a></span> { <span class="typed"><span class="type">(Boolean)Unit</span><a href="#75367">printResults</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span> }

  <span class="comment">/** Temporarily be quiet */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">[T](=&gt; T)T</span><a id="75370">beQuietDuring</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="75372">T</a></span>](<span class="typed"><span class="type">=&gt; T</span><a id="125542">operation</a></span>: =&gt; T): <span class="typed"><span class="type">T</span><a href="#75372">T</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><a id="146818">wasPrinting</a></span> = <span class="typed"><span class="type">=&gt; Boolean</span><a href="#75366">printResults</a></span>
    <span class="keyword">try</span> {
      <span class="typed"><span class="type">(Boolean)Unit</span><a href="#75367">printResults</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
      <span class="typed"><span class="type">=&gt; T</span><a href="#125542">operation</a></span>
    } <span class="keyword">finally</span> {
      <span class="typed"><span class="type">(Boolean)Unit</span><a href="#75367">printResults</a></span> = <span class="typed"><span class="type">Boolean</span><a href="#146818">wasPrinting</a></span>
    }
  }

  <span class="comment">/** interpreter settings */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.InterpreterSettings</span><a id="75374">isettings</a></span> = <span class="typed"><span class="type">scala.tools.nsc.InterpreterSettings</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.InterpreterSettings</span><a href="InterpreterSettings.scala.html#6441">InterpreterSettings</a></span>

  <span class="keyword">object</span> <span class="typed"><span class="type">object Interpreter.this.reporter</span><a id="75375">reporter</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">scala.tools.nsc.reporters.ConsoleReporter</span><a href="reporters/ConsoleReporter.scala.html#15935">ConsoleReporter</a></span>(<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#75351">settings</a></span>, <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#75353">out</a></span>) {
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="125782">printMessage</a></span>(<span class="typed"><span class="type">String</span><a id="146828">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) {
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#75353">out</a></span>.<span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28701">print</a></span>(<span class="typed"><span class="type">(String)String</span><a href="#75403">clean</a></span>(<span class="typed"><span class="type">String</span><a href="#146828">msg</a></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>); <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#75353">out</a></span>.<span class="typed"><span class="type">()Unit</span><a id="28685">flush</a></span>()
    }
  }

  <span class="comment">/** Instantiate a compiler.  Subclasses can override this to
   *  change the compiler class used by this interpreter. */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.Settings,scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global</span><a id="75377">newCompiler</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Settings</span><a id="146780">settings</a></span>: <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="Settings.scala.html#6744">Settings</a></span>, <span class="typed"><span class="type">scala.tools.nsc.reporters.Reporter</span><a id="146781">reporter</a></span>: <span class="typed"><span class="type">scala.tools.nsc.reporters.Reporter</span><a href="reporters/Reporter.scala.html#15905">Reporter</a></span>) = {
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.Global</span><a id="146783">comp</a></span> = <span class="typed"><span class="type">scala.tools.nsc.Global</span><span class="keyword">new</span></span> nsc.<span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="Global.scala.html#6489">Global</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="#146780">settings</a></span>, <span class="typed"><span class="type">scala.tools.nsc.reporters.Reporter</span><a href="#146781">reporter</a></span>)
    <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="#146783">comp</a></span>.<span class="typed"><span class="type">object comp.genJVM</span><a href="Global.scala.html#21279">genJVM</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.io.AbstractFile)Unit</span><a href="backend/jvm/GenJVM.scala.html#68411">outputDir</a></span> = <span class="typed"><span class="type">=&gt; scala.tools.nsc.io.VirtualDirectory</span><a href="#75357">virtualDirectory</a></span>
    <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="#146783">comp</a></span>
  }

  <span class="comment">/** the compiler's classpath, as URL's */</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">List[java.net.URL]</span><span id="75379"><a id="75378">compilerClasspath</a></span></span>: <span class="typed"><span class="type">List[java.net.URL]</span><a id="526">List</a></span>[URL] = {
    <span class="keyword">val</span> <span class="typed"><span class="type">List[java.net.URL]</span><a id="146834">classpathPart</a></span> = 
      <span class="typed"><span class="type">object scala.tools.nsc.util.ClassPath</span><a href="util/ClassPath.scala.html#8490">ClassPath</a></span>.<span class="typed"><span class="type">(String)List[String]</span><a href="util/ClassPath.scala.html#34568">expandPath</a></span>(<span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#75359">compiler</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#29952">classpath</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting#T</span><a href="Settings.scala.html#30301">value</a></span>).<span class="typed"><span class="type">((String) =&gt; java.net.URL)List[java.net.URL]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">String</span><a id="146843">s</a></span> =&gt; <span class="typed"><span class="type">java.io.File</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.File</span><a id="3669">File</a></span>(<span class="typed"><span class="type">String</span><a href="#146843">s</a></span>).<span class="typed"><span class="type">()java.net.URL</span><a id="40693">toURL</a></span>)
    <span class="keyword">def</span> <span class="typed"><span class="type">(String)Option[java.net.URL]</span><a id="146835">parseURL</a></span>(<span class="typed"><span class="type">String</span><a id="146846">s</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Option[java.net.URL]</span><a id="934">Option</a></span>[URL] =
      <span class="keyword">try</span>   { <span class="typed"><span class="type">(java.net.URL)Some[java.net.URL]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">(java.lang.String)java.net.URL</span><a id="40942" class="keyword">new</a></span> <span class="typed"><span class="type">java.net.URL</span><a id="4391">URL</a></span>(<span class="typed"><span class="type">String</span><a href="#146846">s</a></span>)) }
      <span class="keyword">catch</span> { <span class="typed"><span class="type">None.type</span><span class="keyword">case</span></span> _: <span class="typed"><span class="type">java.net.MalformedURLException</span><a id="4430">MalformedURLException</a></span> =&gt; <span class="typed"><span class="type">object None</span><a id="536">None</a></span> }
      
    <span class="keyword">val</span> <span class="typed"><span class="type">List[java.net.URL]</span><a id="146836">codebasePart</a></span> = (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#75359">compiler</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#30060">Xcodebase</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting#T</span><a href="Settings.scala.html#30301">value</a></span>.<span class="typed"><span class="type">(java.lang.String)Array[java.lang.String]</span><a id="5865">split</a></span>(<span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span>)).<span class="typed"><span class="type">=&gt; List[java.lang.String]</span><a id="21815">toList</a></span> <span class="typed"><span class="type">((java.lang.String) =&gt; Iterable[java.net.URL])List[java.net.URL]</span><a id="21383">flatMap</a></span> <span class="typed"><span class="type">(Option[java.net.URL])Iterable[java.net.URL]</span><span id="25402"><a href="#146835" id="935">parseURL</a></span></span>
    <span class="typed"><span class="type">List[java.net.URL]</span><a href="#146834">classpathPart</a></span> <span class="typed"><span class="type">(List[java.net.URL])List[java.net.URL]</span><a href="#146862" id="21339">:::</a></span> <span class="typed"><span class="type">List[java.net.URL]</span><a href="#146836">codebasePart</a></span>
  }

  <span class="comment">/* A single class loader is used for all commands interpreted by this Interpreter.
     It would also be possible to create a new class loader for each command
     to interpret.  The advantages of the current approach are:

       - Expressions are only evaluated one time.  This is especially
         significant for I/O, e.g. &quot;val x = Console.readLine&quot;

     The main disadvantage is:

       - Objects, classes, and methods cannot be rebound.  Instead, definitions
         shadow the old ones, and old code objects refer to the old
         definitions.
  */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">java.lang.ClassLoader</span><span id="75382"><span id="75380"><span id="75381"><a id="146673">classLoader</a></span></span></span></span> = <span class="typed"><span class="type">()java.lang.ClassLoader</span><a href="#75383">makeClassLoader</a></span>()
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">()java.lang.ClassLoader</span><a id="75383">makeClassLoader</a></span>(): <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="1726">ClassLoader</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Array[java.net.URL]</span><a id="146865">cp</a></span> = <span class="typed"><span class="type">=&gt; List[java.net.URL]</span><a href="#75378">compilerClasspath</a></span>.<span class="typed"><span class="type">Array[java.net.URL]</span><a id="21675">toArray</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">java.net.URLClassLoader</span><a id="146866">parent</a></span> =
      <span class="typed"><span class="type">java.net.URLClassLoader</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; java.lang.ClassLoader</span><a href="#75387">parentClassLoader</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)  <span class="typed"><span class="type">(Array[java.net.URL])java.net.URLClassLoader</span><a id="95633" class="keyword">new</a></span> <span class="typed"><span class="type">java.net.URLClassLoader</span><a id="4412">URLClassLoader</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><a href="#146865">cp</a></span>)
      <span class="keyword">else</span>                            <span class="typed"><span class="type">java.net.URLClassLoader</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.net.URLClassLoader</span><a id="4412">URLClassLoader</a></span>(<span class="typed"><span class="type">Array[java.net.URL]</span><a href="#146865">cp</a></span>, <span class="typed"><span class="type">=&gt; java.lang.ClassLoader</span><a href="#75387">parentClassLoader</a></span>)

    <span class="typed"><span class="type">scala.tools.nsc.interpreter.AbstractFileClassLoader</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.interpreter.AbstractFileClassLoader</span><a href="interpreter/AbstractFileClassLoader.scala.html#17672">AbstractFileClassLoader</a></span>(<span class="typed"><span class="type">=&gt; scala.tools.nsc.io.VirtualDirectory</span><a href="#75357">virtualDirectory</a></span>, <span class="typed"><span class="type">java.net.URLClassLoader</span><a href="#146866">parent</a></span>)
  }
  
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)java.lang.Class[_]</span><a id="75384">loadByName</a></span>(<span class="typed"><span class="type">String</span><a id="146889">s</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">java.lang.Class[_]</span><a id="1672">Class</a></span>[_] = <span class="typed"><span class="type">object java.lang.Class</span><a id="1673">Class</a></span>.<span class="typed"><span class="type">(java.lang.String,Boolean,java.lang.ClassLoader)java.lang.Class[_]</span><a id="3936">forName</a></span>(<span class="typed"><span class="type">String</span><a href="#146889">s</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>, <span class="typed"><span class="type">=&gt; java.lang.ClassLoader</span><a href="#75380">classLoader</a></span>)
  <span class="comment">// XXX how does this differ from getMethod(&quot;set&quot;) ?</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(java.lang.Class[_],String)Option[java.lang.reflect.Method]</span><a id="75385">methodByName</a></span>(<span class="typed"><span class="type">java.lang.Class[_]</span><a id="146903">c</a></span>: <span class="typed"><span class="type">java.lang.Class[_]</span><a id="1672">Class</a></span>[_], <span class="typed"><span class="type">String</span><a id="146904">name</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Option[java.lang.reflect.Method]</span><a id="934">Option</a></span>[reflect.Method] =
    <span class="typed"><span class="type">java.lang.Class[_]</span><a href="#146903">c</a></span>.<span class="typed"><span class="type">()Array[java.lang.reflect.Method]</span><a id="4350">getDeclaredMethods</a></span>.<span class="typed"><span class="type">=&gt; List[java.lang.reflect.Method]</span><a id="21815">toList</a></span>.<span class="typed"><span class="type">((java.lang.reflect.Method) =&gt; Boolean)Option[java.lang.reflect.Method]</span><a id="21374">find</a></span>(<span class="typed"><span class="type">java.lang.reflect.Method</span><a href="#146910">_</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="128472">getName</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">String</span><a href="#146904">name</a></span>)  

  <span class="comment">// Set the current Java &quot;context&quot; class loader to this interpreter's class loader</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="75386">setContextClassLoader</a></span>() = <span class="typed"><span class="type">object java.lang.Thread</span><a id="2084">Thread</a></span>.<span class="typed"><span class="type">()java.lang.Thread</span><a id="29015">currentThread</a></span>.<span class="typed"><span class="type">(java.lang.ClassLoader)Unit</span><a id="29055">setContextClassLoader</a></span>(<span class="typed"><span class="type">=&gt; java.lang.ClassLoader</span><a href="#75380">classLoader</a></span>)

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; java.lang.ClassLoader</span><a id="75387">parentClassLoader</a></span>: <span class="typed"><span class="type">java.lang.ClassLoader</span><a id="1726">ClassLoader</a></span> = <span class="typed"><span class="type">Interpreter.this.type</span><a href="#6405" class="keyword">this</a></span>.<span class="typed"><span class="type">()java.lang.Class[_ &lt;: java.lang.Object]</span><a id="3511">getClass</a></span>.<span class="typed"><span class="type">()java.lang.ClassLoader</span><a id="3949">getClassLoader</a></span>()

  <span class="comment">/** the previous requests this interpreter has processed */</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><span id="75389"><a id="75388">prevRequests</a></span></span> = <span class="typed"><span class="type">scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><a id="20132">ArrayBuffer</a></span>[Request]()
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="75390">allUsedNames</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><a href="#75388">prevRequests</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.Request]</span><a id="21815">toList</a></span>.<span class="typed"><span class="type">((Interpreter.this.Request) =&gt; Iterable[Interpreter.this.compiler.Name])List[Interpreter.this.compiler.Name]</span><a id="21383">flatMap</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#146919">_</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146935">usedNames</a></span>).<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="21405">removeDuplicates</a></span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="75391">allBoundNames</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><a href="#75388">prevRequests</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.Request]</span><a id="21815">toList</a></span>.<span class="typed"><span class="type">((Interpreter.this.Request) =&gt; Iterable[Interpreter.this.compiler.Name])List[Interpreter.this.compiler.Name]</span><a id="21383">flatMap</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#146961">_</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146933">boundNames</a></span>).<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="21405">removeDuplicates</a></span>
  
  <span class="comment">/** counter creator */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)java.lang.Object with () =&gt; String with (String) =&gt; String{def reset(): Unit}</span><a id="75392">mkNameCreator</a></span>(<span class="typed"><span class="type">String</span><a id="146674">s</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = <span class="typed"><span class="type">template $anon extends java.lang.Object with () =&gt; String with (String) =&gt; String</span><a id="146676" class="keyword">new</a></span> <span class="typed"><span class="type">() =&gt; String</span><a id="415">Function0</a></span>[String] <span class="keyword">with</span> <span class="typed"><span class="type">(String) =&gt; String</span><a id="181">Function1</a></span>[String,String] {
    <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="146680"><span id="146678"><span id="146679"><a id="146686">x</a></span></span></span></span> = -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="146681">apply</a></span>(): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = { <span class="typed"><span class="type">(Int)Unit</span><a href="#146679">x</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> ; <span class="typed"><span class="type">String</span><a href="#146674">s</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#146678">x</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="3500">toString</a></span> }
    <span class="comment">// second apply method temp for newInternalVarName's bug compatibility</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(String)java.lang.String</span><a id="146682">apply</a></span>(<span class="typed"><span class="type">String</span><a id="146718">pre</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = { <span class="typed"><span class="type">(Int)Unit</span><a href="#146679">x</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> ; <span class="typed"><span class="type">String</span><a href="#146718">pre</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#146678">x</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="3500">toString</a></span> }
    <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="146683">reset</a></span>(): <span class="typed"><span class="type">Unit</span><a id="2169">Unit</a></span> = <span class="typed"><span class="type">(Int)Unit</span><a href="#146679">x</a></span> = -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>
  }

  <span class="comment">/** allocate a fresh line name */</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <span class="typed"><span class="type">&lt;refinement&gt; extends java.lang.Object with () =&gt; String with (String) =&gt; String</span><span id="75394"><a id="75393">newLineName</a></span></span> = <span class="typed"><span class="type">(String)java.lang.Object with () =&gt; String with (String) =&gt; String{def reset(): Unit}</span><a href="#75392">mkNameCreator</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="symtab/StdNames.scala.html#30534">INTERPRETER_LINE_PREFIX</a></span>)
  
  <span class="comment">/** allocate a fresh var name */</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <span class="typed"><span class="type">&lt;refinement&gt; extends java.lang.Object with () =&gt; String with (String) =&gt; String</span><span id="75396"><a id="75395">newVarName</a></span></span> = <span class="typed"><span class="type">(String)java.lang.Object with () =&gt; String with (String) =&gt; String{def reset(): Unit}</span><a href="#75392">mkNameCreator</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="symtab/StdNames.scala.html#30536">INTERPRETER_VAR_PREFIX</a></span>)
  
  <span class="comment">/** allocate a fresh internal variable name */</span>
  <span class="comment">/** XXX temporarily shares newVarName's creator to be bug-compatible with
    * test case interpreter.scala */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; () =&gt; String</span><a id="75397">newInternalVarName</a></span> = () =&gt; <span class="typed"><span class="type">(String)String</span><a href="#75395" id="21757">newVarName</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="symtab/StdNames.scala.html#30540">INTERPRETER_SYNTHVAR_PREFIX</a></span>)
  <span class="comment">// private val newInternalVarName = mkNameCreator(INTERPRETER_SYNTHVAR_PREFIX)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String,String)Boolean</span><a id="75398">isGenerated</a></span>(<span class="typed"><span class="type">String</span><a id="147004">pre</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>, <span class="typed"><span class="type">String</span><a id="147005">name</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) =
    (<span class="typed"><span class="type">String</span><a href="#147005">name</a></span> <span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5841">startsWith</a></span> <span class="typed"><span class="type">String</span><a href="#147004">pre</a></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> (<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a href="#147005" id="821">name</a></span></span> <span class="typed"><span class="type">(Int)scala.runtime.RichString</span><a id="22826">drop</a></span> <span class="typed"><span class="type">String</span><a href="#147004">pre</a></span>.<span class="typed"><span class="type">()Int</span><a id="5821">length</a></span>).<span class="typed"><span class="type">((Char) =&gt; Boolean)Boolean</span><a id="21793">forall</a></span>(<span class="typed"><span class="type">implicit scala.Predef.charWrapper : (Char)scala.runtime.RichChar</span><span id="6134"><a href="#147016" id="821">_</a></span></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="27430">isDigit</a></span>)

  <span class="comment">/** Check if a name looks like it was generated by newVarName */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="75399">isGeneratedVarName</a></span>(<span class="typed"><span class="type">String</span><a id="147021">name</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = <span class="typed"><span class="type">(String,String)Boolean</span><a href="#75398">isGenerated</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="symtab/StdNames.scala.html#30536">INTERPRETER_VAR_PREFIX</a></span>, <span class="typed"><span class="type">String</span><a href="#147021">name</a></span>)
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="75400">isSynthVarName</a></span>(<span class="typed"><span class="type">String</span><a id="147022">name</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = <span class="typed"><span class="type">(String,String)Boolean</span><a href="#75398">isGenerated</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="symtab/StdNames.scala.html#30540">INTERPRETER_SYNTHVAR_PREFIX</a></span>, <span class="typed"><span class="type">String</span><a href="#147022">name</a></span>)

  <span class="comment">/** generate a string using a routine that wants to write on a stream */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">((java.io.PrintWriter) =&gt; Unit)String</span><a id="75401">stringFrom</a></span>(<span class="typed"><span class="type">(java.io.PrintWriter) =&gt; Unit</span><a id="147023">writer</a></span>: PrintWriter =&gt; Unit): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">java.io.StringWriter</span><a id="147024">stringWriter</a></span> = <span class="typed"><span class="type">java.io.StringWriter</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.StringWriter</span><a id="3621">StringWriter</a></span>()
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.NewLinePrintWriter</span><a id="147025">stream</a></span> = <span class="typed"><span class="type">(java.io.Writer)scala.tools.nsc.NewLinePrintWriter</span><a href="NewLinePrintWriter.scala.html#74898" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.NewLinePrintWriter</span><a href="NewLinePrintWriter.scala.html#6870">NewLinePrintWriter</a></span>(<span class="typed"><span class="type">java.io.StringWriter</span><a href="#147024">stringWriter</a></span>)
    <span class="typed"><span class="type">(java.io.PrintWriter)Unit</span><a href="#147023" id="21757">writer</a></span>(<span class="typed"><span class="type">scala.tools.nsc.NewLinePrintWriter</span><a href="#147025">stream</a></span>)
    <span class="typed"><span class="type">scala.tools.nsc.NewLinePrintWriter</span><a href="#147025">stream</a></span>.<span class="typed"><span class="type">()Unit</span><a id="28686">close</a></span>
    <span class="typed"><span class="type">java.io.StringWriter</span><a href="#147024">stringWriter</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="49037">toString</a></span>
  }

  <span class="comment">/** Truncate a string if it is longer than settings.maxPrintString */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)String</span><a id="75402">truncPrintString</a></span>(<span class="typed"><span class="type">String</span><a id="146832">str</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="147030">maxpr</a></span> = <span class="typed"><span class="type">=&gt; scala.tools.nsc.InterpreterSettings</span><a href="#75373">isettings</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="InterpreterSettings.scala.html#125512">maxPrintString</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="147031">trailer</a></span> = <span class="typed"><span class="type">java.lang.String(&quot;...&quot;)</span><span class="string">&quot;...&quot;</span></span>
    
    <span class="typed"><span class="type">String</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#147030">maxpr</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3144">&lt;=</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> <span class="typed"><span class="type">String</span><a href="#146832">str</a></span>.<span class="typed"><span class="type">()Int</span><a id="5821">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3144">&lt;=</a></span> <span class="typed"><span class="type">Int</span><a href="#147030">maxpr</a></span>) <span class="typed"><span class="type">String</span><a href="#146832">str</a></span>
    <span class="keyword">else</span> <span class="typed"><span class="type">String</span><a href="#146832">str</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5855">substring</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="typed"><span class="type">Int</span><a href="#147030">maxpr</a></span><span class="typed"><span class="type">(Int)Int</span><a id="3148">-</a></span><span class="typed"><span class="type">Int(3)</span><span class="int">3</span></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#147031">trailer</a></span>
  }

  <span class="comment">/** Clean up a string for output */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)String</span><a id="75403">clean</a></span>(<span class="typed"><span class="type">String</span><a id="146830">str</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = <span class="typed"><span class="type">(String)String</span><a href="#75402">truncPrintString</a></span>(<span class="typed"><span class="type">(String)String</span><a href="#114768">stripWrapperGunk</a></span>(<span class="typed"><span class="type">String</span><a href="#146830">str</a></span>))

  <span class="comment">/** Indent some code by the width of the scala&gt; prompt.
   *  This way, compiler error messages read better.
   */</span>
  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">val</span> <span class="typed"><span class="type">String</span><span id="75405"><a id="75404">spaces</a></span></span> = <span class="typed"><span class="type">object List</span><a id="527">List</a></span>.<span class="typed"><span class="type">(Int,java.lang.String)List[java.lang.String]</span><a id="21415">make</a></span>(<span class="typed"><span class="type">Int(7)</span><span class="int">7</span></span>, <span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span>).<span class="typed"><span class="type">=&gt; String</span><a id="21820">mkString</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)String</span><a id="75406">indentCode</a></span>(<span class="typed"><span class="type">String</span><a id="147055">code</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) =
    <span class="typed"><span class="type">((java.io.PrintWriter) =&gt; Unit)String</span><a href="#75401">stringFrom</a></span>(<span class="typed"><span class="type">java.io.PrintWriter</span><a id="147058">str</a></span> =&gt;
      <span class="keyword">for</span> (<span class="typed"><span class="type">((String) =&gt; Unit)Unit</span><span id="32202"><a id="147064">line</a></span></span> &lt;- <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a href="#147055" id="821">code</a></span></span>.<span class="typed"><span class="type">=&gt; Iterator[String]</span><a id="22845">lines</a></span>) {
        <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147058">str</a></span>.<span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28701">print</a></span>(<span class="typed"><span class="type">=&gt; String</span><a href="#75404">spaces</a></span>)
        <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147058">str</a></span>.<span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28701">print</a></span>(<span class="typed"><span class="type">String</span><a href="#147064">line</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>)
        <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147058">str</a></span>.<span class="typed"><span class="type">()Unit</span><a id="28685">flush</a></span>()
      })

  <span class="keyword">implicit</span> <span class="keyword">def</span> <span class="typed"><span class="type">implicit scala.tools.nsc.Interpreter.name2string : (Interpreter.this.compiler.Name)String</span><a id="75407">name2string</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a id="146760">name</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#21103">Name</a></span>) = <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#146760">name</a></span>.<span class="typed"><span class="type">()String</span><a href="symtab/Names.scala.html#23898">toString</a></span>

  <span class="comment">/** Compute imports that allow definitions from previous
   *  requests to be visible in a new request.  Returns
   *  three pieces of related code:
   *
   *  1. An initial code fragment that should go before
   *  the code of the new request.
   *
   *  2. A code fragment that should go after the code
   *  of the new request.
   *
   *  3. An access path which can be traverested to access
   *  any bindings inside code wrapped by #1 and #2 .
   *
   * The argument is a set of Names that need to be imported.
   *
   * Limitations: This method is not as precise as it could be.
   * (1) It does not process wildcard imports to see what exactly
   * they import.
   * (2) If it imports any names from a request, it imports all
   * of them, which is not really necessary.
   * (3) It imports multiple same-named implicits, but only the
   * last one imported is actually usable.
   */</span>
  <span class="keyword">private</span> <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class ComputedImports extends java.lang.Object with ScalaObject with Product</span><span id="2751"><span id="23590"><span id="75408"><span id="147091"><span id="147105"><span id="147103"><span id="147084"><span id="147090"><span id="147087"><span id="147086"><span id="147104"><span id="147085"><span id="147106"><span id="147089"><span id="3509"><span id="147099"><span id="29737"><span id="29814"><span id="3500"><span id="29815"><span id="2750"><span id="29856"><span id="308"><span id="449"><span id="3501"><span id="147098"><span id="147097"><span id="5794"><a id="75409">ComputedImports</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">String</span><span id="147071"><span id="147070"><span id="147081"><a id="147257">prepend</a></span></span></span></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>, <span class="typed"><span class="type">String</span><span id="147073"><span id="147072"><span id="147082"><a id="147258">append</a></span></span></span></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>, <span class="typed"><span class="type">String</span><span id="147075"><span id="147074"><span id="147083"><a id="147259">access</a></span></span></span></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>)
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Set[Interpreter.this.compiler.Name])Interpreter.this.ComputedImports</span><a id="75411">importsCode</a></span>(<span class="typed"><span class="type">Set[Interpreter.this.compiler.Name]</span><a id="147108">wanted</a></span>: <span class="typed"><span class="type">Set[Interpreter.this.compiler.Name]</span><a id="26500">Set</a></span>[Name]): <span class="typed"><span class="type">Interpreter.this.ComputedImports</span><a href="#75408">ComputedImports</a></span> = {
    <span class="comment">/** Narrow down the list of requests from which imports 
     *  should be taken.  Removes requests which cannot contribute
     *  useful imports for the specified set of wanted names.
     */</span>
    <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class ReqAndHandler extends java.lang.Object with ScalaObject with Product</span><span id="2751"><span id="147135"><span id="147146"><span id="147137"><span id="147136"><span id="147133"><span id="147131"><span id="147143"><span id="147132"><span id="3509"><span id="147149"><span id="29737"><span id="29814"><span id="147147"><span id="3500"><span id="29815"><span id="147110"><span id="23625"><span id="2750"><span id="29856"><span id="1379"><span id="308"><span id="147148"><span id="3501"><span id="147109"><span id="147130"><span id="147142"><a id="5794">ReqAndHandler</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><span id="147121"><span id="147120"><span id="147128"><a id="147196">req</a></span></span></span></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><span id="147123"><span id="147122"><span id="147129"><a id="147197">handler</a></span></span></span></span>: <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span>)
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[ReqAndHandler]</span><a id="147112">reqsToUse</a></span>: <span class="typed"><span class="type">List[ReqAndHandler]</span><a id="526">List</a></span>[ReqAndHandler] = {
      <span class="comment">/** Loop through a list of MemberHandlers and select which ones to keep.
        * 'wanted' is the set of names that need to be imported.
       */</span>
      <span class="keyword">def</span> <span class="typed"><span class="type">(List[ReqAndHandler],Set[Interpreter.this.compiler.Name])List[ReqAndHandler]</span><a id="147151">select</a></span>(<span class="typed"><span class="type">List[ReqAndHandler]</span><a id="147153">reqs</a></span>: <span class="typed"><span class="type">List[ReqAndHandler]</span><a id="526">List</a></span>[ReqAndHandler], <span class="typed"><span class="type">Set[Interpreter.this.compiler.Name]</span><a id="147154">wanted</a></span>: <span class="typed"><span class="type">Set[Interpreter.this.compiler.Name]</span><a id="26500">Set</a></span>[Name]): <span class="typed"><span class="type">List[ReqAndHandler]</span><a id="526">List</a></span>[ReqAndHandler] = {
        <span class="keyword">val</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name) =&gt; Boolean</span><a id="147155">isWanted</a></span> = <span class="typed"><span class="type">Set[Interpreter.this.compiler.Name]</span><a href="#147154">wanted</a></span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)Boolean</span><a id="25542">contains</a></span> <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147158">_</a></span>
        <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.MemberHandler)Boolean</span><a id="147156">keepHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a id="147159">handler</a></span>: <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = {
          <span class="keyword">import</span> handler._
          <span class="typed"><span class="type">=&gt; Boolean</span><a href="#146986">definesImplicit</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a href="#146982">importsWildcard</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> (<span class="typed"><span class="type">=&gt; Seq[Interpreter.this.compiler.Name]</span><a href="#146984">importedNames</a></span> <span class="typed"><span class="type">(Iterable[Interpreter.this.compiler.Name])Seq[Interpreter.this.compiler.Name]</span><a id="21653">++</a></span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146979">boundNames</a></span>).<span class="typed"><span class="type">((Interpreter.this.compiler.Name) =&gt; Boolean)Boolean</span><a id="21794">exists</a></span>(<span class="typed"><span class="type">(Interpreter.this.compiler.Name) =&gt; Boolean</span><a href="#147155">isWanted</a></span>)
        }
                   
        <span class="typed"><span class="type">List[ReqAndHandler]</span><a href="#147153">reqs</a></span> <span class="typed"><span class="type">List[ReqAndHandler]</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">Nil.type</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>                                    =&gt; <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>
          <span class="typed"><span class="type">List[ReqAndHandler]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">ReqAndHandler</span><a id="147166">rh</a></span> <a id="1">::</a> <span class="typed"><span class="type">List[ReqAndHandler]</span><a id="147167">rest</a></span> <span class="keyword">if</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">(Interpreter.this.MemberHandler)Boolean</span><a href="#147156">keepHandler</a></span>(<span class="typed"><span class="type">ReqAndHandler</span><a href="#147166">rh</a></span>.<span class="typed"><span class="type">=&gt; Interpreter.this.MemberHandler</span><a href="#147122">handler</a></span>) =&gt; <span class="typed"><span class="type">(List[ReqAndHandler],Set[Interpreter.this.compiler.Name])List[ReqAndHandler]</span><a href="#147151">select</a></span>(<span class="typed"><span class="type">List[ReqAndHandler]</span><a href="#147167">rest</a></span>, <span class="typed"><span class="type">Set[Interpreter.this.compiler.Name]</span><a href="#147154">wanted</a></span>)
          <span class="typed"><span class="type">List[ReqAndHandler]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">ReqAndHandler</span><a id="147168">rh</a></span> <a id="1">::</a> <span class="typed"><span class="type">List[ReqAndHandler]</span><a id="147169">rest</a></span>                             =&gt;
            <span class="keyword">import</span> rh.handler._
            <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.immutable.Set[Interpreter.this.compiler.Name]</span><a id="147171">newWanted</a></span> = <span class="typed"><span class="type">Set[Interpreter.this.compiler.Name]</span><a href="#147154">wanted</a></span> <span class="typed"><span class="type">(Iterable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]</span><a id="31140">++</a></span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146977">usedNames</a></span> <span class="typed"><span class="type">(Iterable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]</span><a id="31146">--</a></span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146979">boundNames</a></span> <span class="typed"><span class="type">(Iterable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]</span><a id="31146">--</a></span> <span class="typed"><span class="type">=&gt; Seq[Interpreter.this.compiler.Name]</span><a href="#146984">importedNames</a></span>
            <span class="typed"><span class="type">ReqAndHandler</span><a href="#147168">rh</a></span> <span class="typed"><span class="type">(ReqAndHandler)List[ReqAndHandler]</span><a href="#147185" id="21335">::</a></span> <span class="typed"><span class="type">(List[ReqAndHandler],Set[Interpreter.this.compiler.Name])List[ReqAndHandler]</span><a href="#147151">select</a></span>(<span class="typed"><span class="type">List[ReqAndHandler]</span><a href="#147169">rest</a></span>, <span class="typed"><span class="type">scala.collection.immutable.Set[Interpreter.this.compiler.Name]</span><a href="#147171">newWanted</a></span>)
        }
      }

      <span class="keyword">val</span> <span class="typed"><span class="type">List[ReqAndHandler]</span><a id="147152">rhpairs</a></span> = <span class="keyword">for</span> {
        <span class="typed"><span class="type">((Interpreter.this.Request) =&gt; Iterable[ReqAndHandler])List[ReqAndHandler]</span><span id="21383"><a id="147192">req</a></span></span> &lt;- <span class="typed"><span class="type">=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><a href="#75388">prevRequests</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.Request]</span><a id="21815">toList</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.Request]</span><a id="21385">reverse</a></span>
        <span class="typed"><span class="type">((Interpreter.this.MemberHandler) =&gt; ReqAndHandler)List[ReqAndHandler]</span><span id="21362"><a id="147195">handler</a></span></span> &lt;- <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147192">req</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.MemberHandler]</span><a href="#146931">handlers</a></span>
      } <span class="keyword">yield</span> <span class="typed"><span class="type">(Interpreter.this.Request,Interpreter.this.MemberHandler)ReqAndHandler</span><a href="#147135">ReqAndHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147192">req</a></span>, <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#147195">handler</a></span>)

      <span class="typed"><span class="type">(List[ReqAndHandler],Set[Interpreter.this.compiler.Name])List[ReqAndHandler]</span><a href="#147151">select</a></span>(<span class="typed"><span class="type">List[ReqAndHandler]</span><a href="#147152">rhpairs</a></span>, <span class="typed"><span class="type">Set[Interpreter.this.compiler.Name]</span><a href="#147108">wanted</a></span>).<span class="typed"><span class="type">=&gt; List[ReqAndHandler]</span><a id="21385">reverse</a></span>
    }

    <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.StringBuffer</span><a id="147113">code</a></span>, <span class="typed"><span class="type">java.lang.StringBuffer</span><a id="147114">trailingBraces</a></span>, <span class="typed"><span class="type">java.lang.StringBuffer</span><a id="147115">accessPath</a></span> = <span class="typed"><span class="type">java.lang.StringBuffer</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.lang.StringBuffer</span><a id="1993">StringBuffer</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.Set[Interpreter.this.compiler.Name]</span><a id="147116">currentImps</a></span> = mutable.<span class="typed"><span class="type">object scala.collection.mutable.Set</span><a id="20148">Set</a></span>.<span class="typed"><span class="type">scala.collection.mutable.Set[Interpreter.this.compiler.Name]</span><a id="25507">empty</a></span>[<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#21103">Name</a></span>]

    <span class="comment">// add code for a new object to hold some imports</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="147117">addWrapper</a></span>() {
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="147214">impname</a></span> = <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="symtab/StdNames.scala.html#30538">INTERPRETER_IMPORT_WRAPPER</a></span>
      <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#147113">code</a></span> <span class="typed"><span class="type">(java.lang.String)java.lang.StringBuffer</span><a id="60997">append</a></span> <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;object %s {\n&quot;</a></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#147214">impname</a></span>)
      <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#147114">trailingBraces</a></span> <span class="typed"><span class="type">(java.lang.String)java.lang.StringBuffer</span><a id="60997">append</a></span> <span class="typed"><span class="type">java.lang.String(&quot;}\012&quot;)</span><span class="string">&quot;}\n&quot;</span></span>
      <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#147115">accessPath</a></span> <span class="typed"><span class="type">(java.lang.String)java.lang.StringBuffer</span><a id="60997">append</a></span> (<span class="typed"><span class="type">java.lang.String(&quot;.&quot;)</span><span class="string">&quot;.&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#147214">impname</a></span>)

      <span class="typed"><span class="type">scala.collection.mutable.Set[Interpreter.this.compiler.Name]</span><a href="#147116">currentImps</a></span>.<span class="typed"><span class="type">()Unit</span><a id="25531">clear</a></span>
    }

    <span class="typed"><span class="type">()Unit</span><a href="#147117">addWrapper</a></span>()

    <span class="comment">// loop through previous requests, adding imports for each one</span>
    <span class="keyword">for</span> (<span class="typed"><span class="type">((ReqAndHandler) =&gt; Unit)Unit</span><span id="21366"><a href="#147227" id="21367">ReqAndHandler</a></span></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><span id="147228"><a id="147233">req</a></span></span>, <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><span id="147229"><a id="147234">handler</a></span></span>) &lt;- <span class="typed"><span class="type">=&gt; List[ReqAndHandler]</span><a href="#147112">reqsToUse</a></span>) {
      <span class="keyword">import</span> handler._
      <span class="comment">// If the user entered an import, then just use it; add an import wrapping</span>
      <span class="comment">// level if the import might conflict with some other import</span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#146982">importsWildcard</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> <span class="typed"><span class="type">scala.collection.mutable.Set[Interpreter.this.compiler.Name]</span><a href="#147116">currentImps</a></span>.<span class="typed"><span class="type">((Interpreter.this.compiler.Name) =&gt; Boolean)Boolean</span><a id="21794">exists</a></span>(<span class="typed"><span class="type">=&gt; Seq[Interpreter.this.compiler.Name]</span><a href="#146984">importedNames</a></span>.<span class="typed"><span class="type">(Any)Boolean</span><a href="#147237" id="21673">contains</a></span>))
        <span class="typed"><span class="type">()Unit</span><a href="#147117">addWrapper</a></span>()
      
      <span class="typed"><span class="type">Any</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">member</a></span>.<span class="typed"><span class="type">Boolean</span><a id="3501">isInstanceOf</a></span>[<span class="typed"><span class="type">Interpreter.this.compiler.Import</span><a href="ast/Trees.scala.html#22421">Import</a></span>])
        <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#147113">code</a></span> <span class="typed"><span class="type">(java.lang.String)java.lang.StringBuffer</span><a id="60997">append</a></span> (<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">member</a></span>.<span class="typed"><span class="type">()String</span><a href="ast/Trees.scala.html#25371">toString</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>)

      <span class="comment">// give wildcard imports a import wrapper all to their own</span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#146982">importsWildcard</a></span>)  <span class="typed"><span class="type">()Unit</span><a href="#147117">addWrapper</a></span>()  
      <span class="keyword">else</span>                  <span class="typed"><span class="type">scala.collection.mutable.Set[Interpreter.this.compiler.Name]</span><a href="#147116">currentImps</a></span> <span class="typed"><span class="type">(Iterable[Interpreter.this.compiler.Name])Unit</span><a id="25513">++=</a></span> <span class="typed"><span class="type">=&gt; Seq[Interpreter.this.compiler.Name]</span><a href="#146984">importedNames</a></span>

      <span class="comment">// For other requests, import each bound variable.</span>
      <span class="comment">// import them explicitly instead of with _, so that</span>
      <span class="comment">// ambiguity errors will not be generated. Also, quote </span>
      <span class="comment">// the name of the variable, so that we don't need to </span>
      <span class="comment">// handle quoting keywords separately. </span>
      <span class="keyword">for</span> (<span class="typed"><span class="type">((Interpreter.this.compiler.Name) =&gt; Unit)Unit</span><span id="21366"><a id="147249">imv</a></span></span> &lt;- <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146979">boundNames</a></span>) {
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.collection.mutable.Set[Interpreter.this.compiler.Name]</span><a href="#147116">currentImps</a></span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)Boolean</span><a id="25542">contains</a></span> <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147249">imv</a></span>) <span class="typed"><span class="type">()Unit</span><a href="#147117">addWrapper</a></span>()
        
        <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#147113">code</a></span> <span class="typed"><span class="type">(java.lang.String)java.lang.StringBuffer</span><a id="60997">append</a></span> (<span class="typed"><span class="type">java.lang.String(&quot;import &quot;)</span><span class="string">&quot;import &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147233">req</a></span>.<span class="typed"><span class="type">(Interpreter.this.compiler.Name)String</span><a href="#146945">fullPath</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147249">imv</a></span>))
        <span class="typed"><span class="type">scala.collection.mutable.Set[Interpreter.this.compiler.Name]</span><a href="#147116">currentImps</a></span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)Unit</span><a id="25511">+=</a></span> <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147249">imv</a></span>
      }
    }

    <span class="comment">// add one extra wrapper, to prevent warnings in the common case of</span>
    <span class="comment">// redefining the value bound in the last interpreter request.</span>
    <span class="typed"><span class="type">()Unit</span><a href="#147117">addWrapper</a></span>()
    <span class="typed"><span class="type">(String,String,String)Interpreter.this.ComputedImports</span><a href="#147089">ComputedImports</a></span>(<span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#147113">code</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="61033">toString</a></span>, <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#147114">trailingBraces</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="61033">toString</a></span>, <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#147115">accessPath</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="61033">toString</a></span>)
  }

  <span class="comment">/** Parse a line into a sequence of trees. Returns None if the input is incomplete. */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)Option[List[Interpreter.this.compiler.Tree]]</span><a id="75412">parse</a></span>(<span class="typed"><span class="type">String</span><a id="147260">line</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Option[List[Interpreter.this.compiler.Tree]]</span><a id="934">Option</a></span>[List[Tree]] = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><a id="147261">justNeedsMore</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
    <span class="typed"><span class="type">object Interpreter.this.reporter</span><a href="#75375">reporter</a></span>.<span class="typed"><span class="type">((scala.tools.nsc.util.Position, String) =&gt; Unit)(=&gt; Option[List[Interpreter.this.compiler.Tree]])Option[List[Interpreter.this.compiler.Tree]]</span><a href="reporters/Reporter.scala.html#34474">withIncompleteHandler</a></span>((<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a id="147264">pos</a></span>,<span class="typed"><span class="type">String</span><a id="147265">msg</a></span>) =&gt; {<span class="typed"><span class="type">Boolean</span><a href="#147261">justNeedsMore</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>}) {
      <span class="comment">// simple parse: just parse it, nothing else</span>
      <span class="keyword">def</span> <span class="typed"><span class="type">(String)List[Interpreter.this.compiler.Tree]</span><a id="147266">simpleParse</a></span>(<span class="typed"><span class="type">String</span><a id="147268">code</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a id="526">List</a></span>[Tree] = {
        <span class="typed"><span class="type">object Interpreter.this.reporter</span><a href="#75375">reporter</a></span>.<span class="typed"><span class="type">=&gt; Unit</span><a href="reporters/AbstractReporter.scala.html#46737">reset</a></span>
        <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.compiler.CompilationUnit</span><a id="147269">unit</a></span> = <span class="typed"><span class="type">Interpreter.this.compiler.CompilationUnit</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.CompilationUnit</span><a href="CompilationUnits.scala.html#22571">CompilationUnit</a></span>(<span class="typed"><span class="type">(String,Seq[Char])scala.tools.nsc.util.BatchSourceFile</span><a href="util/SourceFile.scala.html#22673" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.util.BatchSourceFile</span><a href="util/SourceFile.scala.html#8435">BatchSourceFile</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt;console&gt;&quot;)</span><span class="string">&quot;&lt;console&gt;&quot;</span></span>, <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a href="#147268" id="821">code</a></span></span>))
        <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.compiler.syntaxAnalyzer.UnitParser</span><a id="147270">scanner</a></span> = <span class="typed"><span class="type">Interpreter.this.compiler.syntaxAnalyzer.UnitParser</span><span class="keyword">new</span></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#75359">compiler</a></span>.<span class="typed"><span class="type">object Interpreter.this.compiler.syntaxAnalyzer</span><a href="Global.scala.html#21237">syntaxAnalyzer</a></span>.<span class="typed"><span class="type">Interpreter.this.compiler.syntaxAnalyzer.UnitParser</span><a href="ast/parser/Parsers.scala.html#46837">UnitParser</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.CompilationUnit</span><a href="#147269">unit</a></span>)
        
        <span class="typed"><span class="type">Interpreter.this.compiler.syntaxAnalyzer.UnitParser</span><a href="#147270">scanner</a></span>.<span class="typed"><span class="type">(Boolean)(Interpreter.this.compiler.syntaxAnalyzer.global.ValDef, List[Interpreter.this.compiler.syntaxAnalyzer.global.Tree])</span><a href="ast/parser/Parsers.scala.html#65113">templateStatSeq</a></span>(<span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>).<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.syntaxAnalyzer.global.Tree]</span><a id="23616">_2</a></span>
      }
      <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a id="147267">trees</a></span> = <span class="typed"><span class="type">(String)List[Interpreter.this.compiler.Tree]</span><a href="#147266">simpleParse</a></span>(<span class="typed"><span class="type">String</span><a href="#147260">line</a></span>)
      
      <span class="typed"><span class="type">Option[List[Interpreter.this.compiler.Tree]]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">object Interpreter.this.reporter</span><a href="#75375">reporter</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="reporters/Reporter.scala.html#34460">hasErrors</a></span>)   <span class="typed"><span class="type">(object Nil)Some[object Nil]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>)  <span class="comment">// the result did not parse, so stop</span>
      <span class="keyword">else</span> <span class="typed"><span class="type">Option[List[Interpreter.this.compiler.Tree]]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#147261">justNeedsMore</a></span>)   <span class="typed"><span class="type">object None</span><a id="536">None</a></span>
      <span class="keyword">else</span>                      <span class="typed"><span class="type">(List[Interpreter.this.compiler.Tree])Some[List[Interpreter.this.compiler.Tree]]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a href="#147267">trees</a></span>)
    }
  }

  <span class="comment">/** Compile an nsc SourceFile.  Returns true if there are
   *  no compilation errors, or false othrewise.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.util.SourceFile*)Boolean</span><a id="75413">compileSources</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.SourceFile*</span><a id="147306">sources</a></span>: <span class="typed"><span class="type">scala.tools.nsc.util.SourceFile*</span><a id="2741">SourceFile</a></span>*): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = {
    <span class="typed"><span class="type">object Interpreter.this.reporter</span><a href="#75375">reporter</a></span>.<span class="typed"><span class="type">=&gt; Unit</span><a href="reporters/AbstractReporter.scala.html#46737">reset</a></span>
    <span class="typed"><span class="type">Interpreter.this.compiler.Run</span><span class="keyword">new</span></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#75359">compiler</a></span>.<span class="typed"><span class="type">Interpreter.this.compiler.Run</span><a href="Global.scala.html#21313">Run</a></span>() <span class="typed"><span class="type">(List[scala.tools.nsc.util.SourceFile])Unit</span><a href="Global.scala.html#36587">compileSources</a></span> <span class="typed"><span class="type">scala.tools.nsc.util.SourceFile*</span><a href="#147306">sources</a></span>.<span class="typed"><span class="type">=&gt; List[scala.tools.nsc.util.SourceFile]</span><a id="21815">toList</a></span>
    <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">object Interpreter.this.reporter</span><a href="#75375">reporter</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="reporters/Reporter.scala.html#34460">hasErrors</a></span>
  }

  <span class="comment">/** Compile a string.  Returns true if there are no
   *  compilation errors, or false otherwise.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="75414">compileString</a></span>(<span class="typed"><span class="type">String</span><a id="125544">code</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> =
    <span class="typed"><span class="type">(scala.tools.nsc.util.SourceFile*)Boolean</span><a href="#75413">compileSources</a></span>(<span class="typed"><span class="type">(String,Seq[Char])scala.tools.nsc.util.BatchSourceFile</span><a href="util/SourceFile.scala.html#22673" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.util.BatchSourceFile</span><a href="util/SourceFile.scala.html#8435">BatchSourceFile</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt;script&gt;&quot;)</span><span class="string">&quot;&lt;script&gt;&quot;</span></span>, <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a href="#125544" id="821">code</a></span></span>))

  <span class="comment">/** Build a request from the user. &lt;code&gt;trees&lt;/code&gt; is &lt;code&gt;line&lt;/code&gt;
   *  after being parsed.
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(List[Interpreter.this.compiler.Tree],String,String)Interpreter.this.Request</span><a id="75415">buildRequest</a></span>(<span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a id="147339">trees</a></span>: <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a id="526">List</a></span>[Tree], <span class="typed"><span class="type">String</span><a id="147340">line</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>, <span class="typed"><span class="type">String</span><a id="147341">lineName</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span> =
    <span class="typed"><span class="type">Interpreter.this.Request</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>(<span class="typed"><span class="type">String</span><a href="#147340">line</a></span>, <span class="typed"><span class="type">String</span><a href="#147341">lineName</a></span>)

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Tree)Interpreter.this.MemberHandler</span><a id="75416">chooseHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a id="147344">member</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="ast/Trees.scala.html#22371">Tree</a></span>): <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span> = <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="#147344">member</a></span> <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><span class="keyword">match</span></span> {
    <span class="typed"><span class="type">Interpreter.this.DefHandler</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.DefDef</span><a id="147345">member</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.DefDef</span><a href="ast/Trees.scala.html#22405">DefDef</a></span>               =&gt; <span class="typed"><span class="type">Interpreter.this.DefHandler</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.DefHandler</span><a href="#75427">DefHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.DefDef</span><a href="#147345">member</a></span>)
    <span class="typed"><span class="type">Interpreter.this.ValHandler</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.ValDef</span><a id="147360">member</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.ValDef</span><a href="ast/Trees.scala.html#22398">ValDef</a></span>               =&gt; <span class="typed"><span class="type">Interpreter.this.ValHandler</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.ValHandler</span><a href="#75426">ValHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.ValDef</span><a href="#147360">member</a></span>)
    <span class="typed"><span class="type">Interpreter.this.AssignHandler</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.Assign</span><a id="147379">member</a></span>@<a id="1">Assign</a>(<a id="1">Ident</a>(_), _)   =&gt; <span class="typed"><span class="type">Interpreter.this.AssignHandler</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.AssignHandler</span><a href="#75428">AssignHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Assign</span><a href="#147379">member</a></span>)
    <span class="typed"><span class="type">Interpreter.this.ModuleHandler</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.ModuleDef</span><a id="147393">member</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.ModuleDef</span><a href="ast/Trees.scala.html#22393">ModuleDef</a></span>            =&gt; <span class="typed"><span class="type">Interpreter.this.ModuleHandler</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.ModuleHandler</span><a href="#75429">ModuleHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.ModuleDef</span><a href="#147393">member</a></span>)
    <span class="typed"><span class="type">Interpreter.this.ClassHandler</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.ClassDef</span><a id="147407">member</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.ClassDef</span><a href="ast/Trees.scala.html#22388">ClassDef</a></span>             =&gt; <span class="typed"><span class="type">Interpreter.this.ClassHandler</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.ClassHandler</span><a href="#75430">ClassHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.ClassDef</span><a href="#147407">member</a></span>)
    <span class="typed"><span class="type">Interpreter.this.TypeAliasHandler</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.TypeDef</span><a id="147421">member</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.TypeDef</span><a href="ast/Trees.scala.html#22412">TypeDef</a></span>              =&gt; <span class="typed"><span class="type">Interpreter.this.TypeAliasHandler</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.TypeAliasHandler</span><a href="#75431">TypeAliasHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.TypeDef</span><a href="#147421">member</a></span>)
    <span class="typed"><span class="type">Interpreter.this.ImportHandler</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.Import</span><a id="147436">member</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Import</span><a href="ast/Trees.scala.html#22421">Import</a></span>               =&gt; <span class="typed"><span class="type">Interpreter.this.ImportHandler</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.ImportHandler</span><a href="#75432">ImportHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Import</span><a href="#147436">member</a></span>)
    <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><span class="keyword">case</span></span> <a id="1">DocDef</a>(_, <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a id="147446">documented</a></span>)        =&gt; <span class="typed"><span class="type">(Interpreter.this.compiler.Tree)Interpreter.this.MemberHandler</span><a href="#75416">chooseHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="#147446">documented</a></span>)
    <span class="typed"><span class="type">Interpreter.this.GenericHandler</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a id="147447">member</a></span>                       =&gt; <span class="typed"><span class="type">Interpreter.this.GenericHandler</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.GenericHandler</span><a href="#75425">GenericHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="#147447">member</a></span>)
  }

  <span class="comment">/** &lt;p&gt;
   *    Interpret one line of input.  All feedback, including parse errors
   *    and evaluation results, are printed via the supplied compiler's 
   *    reporter.  Values defined are available for future interpreted
   *    strings.
   *  &lt;/p&gt;
   *  &lt;p&gt;
   *    The return value is whether the line was interpreter successfully,
   *    e.g. that there were no parse errors.
   *  &lt;/p&gt;
   *
   *  @param line ...
   *  @return     ...
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)scala.tools.nsc.InterpreterResults.Result</span><a id="75417">interpret</a></span>(<span class="typed"><span class="type">String</span><a id="125718">line</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): IR.<span class="typed"><span class="type">scala.tools.nsc.InterpreterResults.Result</span><a href="InterpreterResults.scala.html#125552">Result</a></span> = {
    <span class="comment">// initialize the compiler</span>
    <span class="typed"><span class="type">Any</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><a href="#75388">prevRequests</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span>) <span class="typed"><span class="type">Interpreter.this.compiler.Run</span><span class="keyword">new</span></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#75359">compiler</a></span>.<span class="typed"><span class="type">Interpreter.this.compiler.Run</span><a href="Global.scala.html#21313">Run</a></span> 

    <span class="comment">// parse</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a id="147452">trees</a></span> = <span class="typed"><span class="type">(String)Option[List[Interpreter.this.compiler.Tree]]</span><a href="#75412">parse</a></span>(<span class="typed"><span class="type">(String)String</span><a href="#75406">indentCode</a></span>(<span class="typed"><span class="type">String</span><a href="#125718">line</a></span>)) <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span>         =&gt; <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults</span><a href="InterpreterResults.scala.html#6412">IR</a></span>.<span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults.Incomplete</span><a href="InterpreterResults.scala.html#125557">Incomplete</a></span>
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>)    =&gt; <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults</span><a href="InterpreterResults.scala.html#6412">IR</a></span>.<span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults.Error</span><a href="InterpreterResults.scala.html#125555">Error</a></span> <span class="comment">// parse error or empty input</span>
      <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a id="147463">trees</a></span>)  =&gt; <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a href="#147463">trees</a></span>
    }

    <span class="comment">// Treat a single bare expression specially. This is necessary due to it being hard to</span>
    <span class="comment">// modify code at a textual level, and it being hard to submit an AST to the compiler.</span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a href="#147452">trees</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21644">size</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">==</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a href="#147452">trees</a></span>.<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a id="21332">head</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _:<span class="typed"><span class="type">Interpreter.this.compiler.Assign</span><a href="ast/Trees.scala.html#22463">Assign</a></span>                         =&gt; <span class="comment">// we don't want to include assignments</span>
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> _:<span class="typed"><span class="type">Interpreter.this.compiler.TermTree</span><a href="ast/Trees.scala.html#22374">TermTree</a></span> | _:<span class="typed"><span class="type">Interpreter.this.compiler.Ident</span><a href="ast/Trees.scala.html#22510">Ident</a></span> | _:<span class="typed"><span class="type">Interpreter.this.compiler.Select</span><a href="ast/Trees.scala.html#22506">Select</a></span>  =&gt;
        <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">(String)scala.tools.nsc.InterpreterResults.Result</span><a href="#75417">interpret</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;val %s =\n%s&quot;</a></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">()String</span><a href="#75395" id="31093">newVarName</a></span>(), <span class="typed"><span class="type">String</span><a href="#125718">line</a></span>))
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _                                =&gt;
    }
        
    <span class="comment">// figure out what kind of request</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.Request</span><a id="147453">req</a></span> = <span class="typed"><span class="type">(List[Interpreter.this.compiler.Tree],String,String)Interpreter.this.Request</span><a href="#75415">buildRequest</a></span>(<span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a href="#147452">trees</a></span>, <span class="typed"><span class="type">String</span><a href="#125718">line</a></span>, <span class="typed"><span class="type">()String</span><a href="#75393" id="31093">newLineName</a></span>())
    <span class="comment">// null is a disallowed statement type; otherwise compile and fail if false (implying e.g. a type error)</span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147453">req</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147453">req</a></span>.<span class="typed"><span class="type">()Boolean</span><a href="#146953">compile</a></span>)
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults</span><a href="InterpreterResults.scala.html#6412">IR</a></span>.<span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults.Error</span><a href="InterpreterResults.scala.html#125555">Error</a></span>
        
    <span class="keyword">val</span> <span class="typed"><span class="type">(String, Boolean)</span><span id="23625"><a href="#147480" id="1379">(</a></span></span><span class="typed"><span class="type">String</span><span id="147480"><span id="147455"><a href="#147454" id="23614">result</a></span></span></span>, <span class="typed"><span class="type">Boolean</span><span id="147481"><span id="147456"><a href="#147454" id="23616">succeeded</a></span></span></span>) = <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147453">req</a></span>.<span class="typed"><span class="type">=&gt; (String, Boolean)</span><a href="#146955">loadAndRun</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#75366">printResults</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">Boolean</span><a href="#147456">succeeded</a></span>)
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#75353">out</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28701">print</a></span> <span class="typed"><span class="type">(String)String</span><a href="#75403">clean</a></span>(<span class="typed"><span class="type">String</span><a href="#147455">result</a></span>)

    <span class="typed"><span class="type">scala.tools.nsc.InterpreterResults.Result</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#147456">succeeded</a></span>) {
      <span class="typed"><span class="type">=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><a href="#75388">prevRequests</a></span> <span class="typed"><span class="type">(Interpreter.this.Request)Unit</span><a id="41545">+=</a></span> <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147453">req</a></span>     <span class="comment">// book-keeping</span>
      <span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults</span><a href="InterpreterResults.scala.html#6412">IR</a></span>.<span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults.Success</span><a href="InterpreterResults.scala.html#125553">Success</a></span>
    }
    <span class="keyword">else</span> <span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults</span><a href="InterpreterResults.scala.html#6412">IR</a></span>.<span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults.Error</span><a href="InterpreterResults.scala.html#125555">Error</a></span>
  }

  <span class="comment">/** A name creator used for objects created by &lt;code&gt;bind()&lt;/code&gt;. */</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <span class="typed"><span class="type">&lt;refinement&gt; extends java.lang.Object with () =&gt; String with (String) =&gt; String</span><span id="75419"><a id="75418">newBinder</a></span></span> = <span class="typed"><span class="type">(String)java.lang.Object with () =&gt; String with (String) =&gt; String{def reset(): Unit}</span><a href="#75392">mkNameCreator</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;binder&quot;)</span><span class="string">&quot;binder&quot;</span></span>)

  <span class="comment">/** Bind a specified name to a specified value.  The name may
   *  later be used by expressions passed to interpret.
   *
   *  @param name      the variable name to bind
   *  @param boundType the type of the variable, as a string
   *  @param value     the object value to bind to it
   *  @return          an indication of whether the binding succeeded
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String,String,Any)scala.tools.nsc.InterpreterResults.Result</span><a id="75420">bind</a></span>(<span class="typed"><span class="type">String</span><a id="125548">name</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>, <span class="typed"><span class="type">String</span><a id="125549">boundType</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>, <span class="typed"><span class="type">Any</span><a id="125550">value</a></span>: <span class="typed"><span class="type">Any</span><a id="51">Any</a></span>): IR.<span class="typed"><span class="type">scala.tools.nsc.InterpreterResults.Result</span><a href="InterpreterResults.scala.html#125552">Result</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147485">binderName</a></span> = <span class="typed"><span class="type">()String</span><a href="#75418" id="31093">newBinder</a></span>()    <span class="comment">// &quot;binder&quot; + binderNum()</span>

    <span class="typed"><span class="type">(String)Boolean</span><a href="#75414">compileString</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;&quot;&quot;
      | object %s {
      |   var value: %s = _
      |   def set(x: Any) = value = x.asInstanceOf[%s]
      | }
    &quot;&quot;&quot;</a></span></span>.<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><span id="821"><a id="22848">stripMargin</a></span></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">String</span><a href="#147485">binderName</a></span>, <span class="typed"><span class="type">String</span><a href="#125549">boundType</a></span>, <span class="typed"><span class="type">String</span><a href="#125549">boundType</a></span>))

    <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.Class[_]</span><a id="147486">binderObject</a></span> = <span class="typed"><span class="type">(String)java.lang.Class[_]</span><a href="#75384">loadByName</a></span>(<span class="typed"><span class="type">String</span><a href="#147485">binderName</a></span>)
    <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.reflect.Method</span><a id="147487">setterMethod</a></span> = <span class="typed"><span class="type">(java.lang.Class[_],String)Option[java.lang.reflect.Method]</span><a href="#75385">methodByName</a></span>(<span class="typed"><span class="type">java.lang.Class[_]</span><a href="#147486">binderObject</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;set&quot;)</span><span class="string">&quot;set&quot;</span></span>).<span class="typed"><span class="type">=&gt; java.lang.reflect.Method</span><a id="25408">get</a></span>
        
    <span class="comment">// this roundabout approach is to ensure the value is boxed</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Array[Any]</span><a id="147488">argsHolder</a></span>: <span class="typed"><span class="type">Array[Any]</span><a id="1072">Array</a></span>[Any] = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
    <span class="typed"><span class="type">Array[Any]</span><a href="#147488">argsHolder</a></span> = <span class="typed"><span class="type">(Any*)List[Any]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">Any</span><a href="#125550">value</a></span>).<span class="typed"><span class="type">Array[Any]</span><a id="21675">toArray</a></span>
    <span class="typed"><span class="type">java.lang.reflect.Method</span><a href="#147487">setterMethod</a></span>.<span class="typed"><span class="type">(Any,java.lang.Object*)java.lang.Object</span><a id="128492">invoke</a></span>(<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">Array[Any]</span><a href="#147488">argsHolder</a></span>.<span class="typed"><span class="type">Array[AnyRef]</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">Array[AnyRef]</span><a id="1072">Array</a></span>[AnyRef]]: _*)
    <span class="typed"><span class="type">(String)scala.tools.nsc.InterpreterResults.Result</span><a href="#75417">interpret</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;val %s = %s.value&quot;</a></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">String</span><a href="#125548">name</a></span>, <span class="typed"><span class="type">String</span><a href="#147485">binderName</a></span>))
  }

  <span class="comment">/** Reset this interpreter, forgetting all user-specified requests. */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="75421">reset</a></span>() {
    <span class="typed"><span class="type">=&gt; scala.tools.nsc.io.VirtualDirectory</span><a href="#75357">virtualDirectory</a></span>.<span class="typed"><span class="type">()Unit</span><a href="io/VirtualDirectory.scala.html#47699">clear</a></span>
    <span class="typed"><span class="type">(java.lang.ClassLoader)Unit</span><a href="#75381">classLoader</a></span> = <span class="typed"><span class="type">()java.lang.ClassLoader</span><a href="#75383">makeClassLoader</a></span>
    <span class="typed"><span class="type">=&gt; &lt;refinement&gt; extends java.lang.Object with () =&gt; String with (String) =&gt; String</span><a href="#75393">newLineName</a></span>.<span class="typed"><span class="type">()Unit</span><a href="#146752">reset</a></span>()
    <span class="typed"><span class="type">=&gt; &lt;refinement&gt; extends java.lang.Object with () =&gt; String with (String) =&gt; String</span><a href="#75395">newVarName</a></span>.<span class="typed"><span class="type">()Unit</span><a href="#146752">reset</a></span>()
    <span class="typed"><span class="type">=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><a href="#75388">prevRequests</a></span>.<span class="typed"><span class="type">()Unit</span><a id="41556">clear</a></span>
  }

  <span class="comment">/** &lt;p&gt;
   *    This instance is no longer needed, so release any resources
   *    it is using.  The reporter's output gets flushed.
   *  &lt;/p&gt;
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="75422">close</a></span>() {
    <span class="typed"><span class="type">object Interpreter.this.reporter</span><a href="#75375">reporter</a></span>.<span class="typed"><span class="type">()Unit</span><a href="reporters/ConsoleReporter.scala.html#46768">flush</a></span>
  }

  <span class="comment">/** A traverser that finds all mentioned identifiers, i.e. things
   *  that need to be imported.  It might return extra names.
   */</span>
  <span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class ImportVarsTraverser extends Interpreter.this.compiler.Traverser with ScalaObject</span><a id="75423">ImportVarsTraverser</a></span>(<span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><span id="147522"><a id="147529">definedVars</a></span></span>: <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="526">List</a></span>[Name]) <span class="keyword">extends</span> <span class="typed"><span class="type">Interpreter.this.compiler.Traverser</span><a href="ast/Trees.scala.html#22549">Traverser</a></span> {
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]</span><span id="147525"><a id="147524">importVars</a></span></span> = <span class="typed"><span class="type">scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]</span><a id="19895">HashSet</a></span>[Name]()

    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Tree)Unit</span><a id="147526">traverse</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a id="147530">ast</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="ast/Trees.scala.html#22371">Tree</a></span>) = <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="#147530">ast</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Ident</a>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a id="147533">name</a></span>)  =&gt; <span class="typed"><span class="type">=&gt; scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]</span><a href="#147524">importVars</a></span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)Unit</span><a id="25499">+=</a></span> <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147533">name</a></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _            =&gt; <span class="keyword">super</span>.<span class="typed"><span class="type">(Interpreter.this.compiler.Tree)Unit</span><a href="ast/Trees.scala.html#28559">traverse</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="#147530">ast</a></span>)
    }
  }

  <span class="comment">/** Class to handle one member among all the members included
   *  in a single interpreter request.
   */</span>
  <span class="keyword">private</span> <span class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class MemberHandler extends java.lang.Object with ScalaObject</span><a id="75424">MemberHandler</a></span>(<span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><span id="146975"><span id="146974"><a id="147538">member</a></span></span></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="ast/Trees.scala.html#22371">Tree</a></span>) {
    <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><span id="146978"><a id="146977">usedNames</a></span></span>: <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="526">List</a></span>[Name] = {
      <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.ImportVarsTraverser</span><a id="147539">ivt</a></span> = <span class="typed"><span class="type">Interpreter.this.ImportVarsTraverser</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Interpreter.this.ImportVarsTraverser</span><a href="#75423">ImportVarsTraverser</a></span>(<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146979">boundNames</a></span>)
      <span class="typed"><span class="type">Interpreter.this.ImportVarsTraverser</span><a href="#147539">ivt</a></span>.<span class="typed"><span class="type">(List[Interpreter.this.compiler.Tree])Unit</span><a href="ast/Trees.scala.html#28560">traverseTrees</a></span>(<span class="typed"><span class="type">(Interpreter.this.compiler.Tree*)List[Interpreter.this.compiler.Tree]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">member</a></span>))
      <span class="typed"><span class="type">Interpreter.this.ImportVarsTraverser</span><a href="#147539">ivt</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.HashSet[Interpreter.this.compiler.Name]</span><a href="#147524">importVars</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="21815">toList</a></span>
    }
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="146979">boundNames</a></span>: <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="526">List</a></span>[Name] = <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="146980">valAndVarNames</a></span>: <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="526">List</a></span>[Name] = <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="146981">defNames</a></span>: <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="526">List</a></span>[Name] = <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><span id="146983"><a id="146982">importsWildcard</a></span></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Seq[Interpreter.this.compiler.Name]</span><span id="146985"><a id="146984">importedNames</a></span></span>: <span class="typed"><span class="type">Seq[Interpreter.this.compiler.Name]</span><a id="763">Seq</a></span>[Name] = <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><span id="146987"><a id="146986">definesImplicit</a></span></span> = <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">member</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Boolean</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.MemberDef</span><a id="147161">tree</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.MemberDef</span><a href="ast/Trees.scala.html#22382">MemberDef</a></span>  =&gt; <span class="typed"><span class="type">Interpreter.this.compiler.MemberDef</span><a href="#147161">tree</a></span>.<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Modifiers</span><a href="ast/Trees.scala.html#26915">mods</a></span> <span class="typed"><span class="type">(Long)Boolean</span><a href="ast/Trees.scala.html#42017">hasFlag</a></span> Flags.<span class="typed"><span class="type">Long(512L)</span><span >IMPLICIT</span></span>
      <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> _                =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
    }

    <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a id="146988">extraCodeToEvaluate</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="147543">req</a></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147544">code</a></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) <span class="typed"><span class="type">Unit</span><span >{</span></span> }
    <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a id="146989">resultExtractionCode</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="147545">req</a></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147546">code</a></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) <span class="typed"><span class="type">Unit</span><span >{</span></span> }
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class GenericHandler extends Interpreter.this.MemberHandler with ScalaObject</span><a id="75425">GenericHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><span id="147449"><a id="147451">member</a></span></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="ast/Trees.scala.html#22371">Tree</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="#147451">member</a></span>)
  
  <span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class ValHandler extends Interpreter.this.MemberHandler with ScalaObject</span><a id="75426">ValHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.ValDef</span><span id="147362"><a id="147378">member</a></span></span>: <span class="typed"><span class="type">Interpreter.this.compiler.ValDef</span><a href="ast/Trees.scala.html#22398">ValDef</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.ValDef</span><a href="#147378">member</a></span>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)</span><span id="147365"><span id="23625"><a href="#147552" id="1379">ValDef</a></span></span></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Modifiers</span><span id="147552"><span id="147367"><a href="#147364" id="23614">mods</a></span></span></span>, <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><span id="147553"><span id="147369"><a href="#147364" id="23616">vname</a></span></span></span>, _, _) = <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">member</a></span>    
    <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147371">prettyName</a></span> = <span class="typed"><span class="type">object scala.tools.nsc.util.NameTransformer</span><a href="util/NameTransformer.scala.html#8346">NameTransformer</a></span>.<span class="typed"><span class="type">(String)String</span><a href="util/NameTransformer.scala.html#25616">decode</a></span>(<span class="typed"><span class="type">implicit scala.tools.nsc.Interpreter.name2string : (Interpreter.this.compiler.Name)String</span><a href="#75407">vname</a></span>)
    <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><a id="147373">isLazy</a></span> = <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Modifiers</span><a href="#147366">mods</a></span> <span class="typed"><span class="type">(Long)Boolean</span><a href="ast/Trees.scala.html#42017">hasFlag</a></span> Flags.<span class="typed"><span class="type">Long(2147483648L)</span><span >LAZY</span></span>
    
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="147375">boundNames</a></span> = <span class="typed"><span class="type">(Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147368">vname</a></span>)
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="147376">valAndVarNames</a></span> = <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#147374">boundNames</a></span>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a id="147377">resultExtractionCode</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="147559">req</a></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147560">code</a></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><a id="147561">isInternal</a></span> = <span class="typed"><span class="type">(String)Boolean</span><a href="#75399">isGeneratedVarName</a></span>(<span class="typed"><span class="type">implicit scala.tools.nsc.Interpreter.name2string : (Interpreter.this.compiler.Name)String</span><a href="#75407">vname</a></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147559">req</a></span>.<span class="typed"><span class="type">(Interpreter.this.compiler.Name)String</span><a href="#146951">typeOfEnc</a></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147368">vname</a></span>) <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;Unit&quot;)</span><span class="string">&quot;Unit&quot;</span></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Modifiers</span><a href="#147366">mods</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="ast/Trees.scala.html#42016">isPublic</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> <span class="typed"><span class="type">Boolean</span><a href="#147561">isInternal</a></span>) <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span>
      
      <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147563">extractor</a></span> = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;&quot;&quot;
        | {
        |    val s = scala.runtime.ScalaRunTime.stringOf(%s)
        |    val nl = if (s.toSeq.contains('\n')) &quot;\n&quot; else &quot;&quot;
        |    nl + s + &quot;\n&quot;
        | }
      &quot;&quot;&quot;</a></span></span>.<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><span id="821"><a id="22848">stripMargin</a></span></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147559">req</a></span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)String</span><a href="#146945">fullPath</a></span> <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147368">vname</a></span>)
      
      <span class="comment">// if this is a lazy val we avoid evaluating it here</span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147564">resultString</a></span> = <span class="typed"><span class="type">String</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#147372">isLazy</a></span>) <span class="typed"><span class="type">(Boolean,String*)String</span><a href="#114769">codegenln</a></span>(<span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;&lt;lazy&gt;&quot;)</span><span class="string">&quot;&lt;lazy&gt;&quot;</span></span>) <span class="keyword">else</span> <span class="typed"><span class="type">=&gt; String</span><a href="#147562">extractor</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147565">codeToPrint</a></span> = 
        <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;&quot;&quot; + &quot;%s: %s = &quot; + %s&quot;&quot;&quot;</a></span></span> .
        <span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">=&gt; String</span><a href="#147370">prettyName</a></span>, <span class="typed"><span class="type">(String)String</span><a href="#114773">string2code</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147559">req</a></span>.<span class="typed"><span class="type">(Interpreter.this.compiler.Name)String</span><a href="#146948" id="24239">typeOf</a></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147368">vname</a></span>)), <span class="typed"><span class="type">String</span><a href="#147564">resultString</a></span>)

      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147560">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28701">print</a></span> <span class="typed"><span class="type">String</span><a href="#147565">codeToPrint</a></span>
    }
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class DefHandler extends Interpreter.this.MemberHandler with ScalaObject</span><a id="75427">DefHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.DefDef</span><span id="147347"><a id="147359">defDef</a></span></span>: <span class="typed"><span class="type">Interpreter.this.compiler.DefDef</span><a href="ast/Trees.scala.html#22405">DefDef</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.DefDef</span><a href="#147359">defDef</a></span>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)</span><span id="147350"><span id="23625"><a href="#147603" id="1379">DefDef</a></span></span></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Modifiers</span><span id="147603"><span id="147352"><a href="#147349" id="23614">mods</a></span></span></span>, <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><span id="147604"><span id="147354"><a href="#147349" id="23616">name</a></span></span></span>, _, _, _, _) = <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">defDef</a></span>
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="147356">boundNames</a></span> = <span class="typed"><span class="type">(Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147353">name</a></span>)
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="147357">defNames</a></span> = <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#147355">boundNames</a></span>

    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a id="147358">resultExtractionCode</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="147610">req</a></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147611">code</a></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) =
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Modifiers</span><a href="#147351">mods</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="ast/Trees.scala.html#42016">isPublic</a></span>) <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147611">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28701">print</a></span> <span class="typed"><span class="type">(String*)String</span><a href="#114770">codegenln</a></span>(<span class="typed"><span class="type">implicit scala.tools.nsc.Interpreter.name2string : (Interpreter.this.compiler.Name)String</span><a href="#75407">name</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;: &quot;)</span><span class="string">&quot;: &quot;</span></span>, <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147610">req</a></span>.<span class="typed"><span class="type">(Interpreter.this.compiler.Name)String</span><a href="#146948" id="24239">typeOf</a></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147353">name</a></span>))
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class AssignHandler extends Interpreter.this.MemberHandler with ScalaObject</span><a id="75428">AssignHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Assign</span><span id="147382"><a id="147392">member</a></span></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Assign</span><a href="ast/Trees.scala.html#22463">Assign</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Assign</span><a href="#147392">member</a></span>) {
    <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.compiler.Ident</span><span id="147385"><a id="147384">lhs</a></span></span> = <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">member</a></span>.<span class="typed"><span class="type">=&gt; Trees.this.Tree</span><a href="ast/Trees.scala.html#28150">lhs</a></span>.<span class="typed"><span class="type">Interpreter.this.compiler.Ident</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">Interpreter.this.compiler.Ident</span><a href="ast/Trees.scala.html#22510">Ident</a></span>] <span class="comment">// an unfortunate limitation</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><span id="147387"><a id="147386">helperName</a></span></span> = <span class="typed"><span class="type">(String)Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#21096">newTermName</a></span>(<span class="typed"><span class="type">()String</span><a href="#75397" id="31093">newInternalVarName</a></span>())
    <span class="keyword">override</span> <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><span id="147389"><a id="147388">valAndVarNames</a></span></span> = <span class="typed"><span class="type">(Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147386">helperName</a></span>)

    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a id="147390">extraCodeToEvaluate</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="147625">req</a></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147626">code</a></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) =
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147626">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span> <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;&quot;&quot;val %s = %s&quot;&quot;&quot;</a></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147386">helperName</a></span>, <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Ident</span><a href="#147384">lhs</a></span>)

    <span class="comment">/** Print out lhs instead of the generated varName */</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a id="147391">resultExtractionCode</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="147634">req</a></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147635">code</a></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147636">lhsType</a></span> = <span class="typed"><span class="type">(String)String</span><a href="#114773">string2code</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147634">req</a></span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)String</span><a href="#146951">typeOfEnc</a></span> <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147386">helperName</a></span>)
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147637">res</a></span> = <span class="typed"><span class="type">(String)String</span><a href="#114773">string2code</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#147634">req</a></span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)String</span><a href="#146945">fullPath</a></span> <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147386">helperName</a></span>)
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147638">codeToPrint</a></span> = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;&quot;&quot; + &quot;%s: %s = &quot; + %s + &quot;\n&quot; &quot;&quot;&quot;</a></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Ident</span><a href="#147384">lhs</a></span>, <span class="typed"><span class="type">String</span><a href="#147636">lhsType</a></span>, <span class="typed"><span class="type">String</span><a href="#147637">res</a></span>)
          
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147635">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span> <span class="typed"><span class="type">String</span><a href="#147638">codeToPrint</a></span>
    }
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class ModuleHandler extends Interpreter.this.MemberHandler with ScalaObject</span><a id="75429">ModuleHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.ModuleDef</span><span id="147395"><a id="147406">module</a></span></span>: <span class="typed"><span class="type">Interpreter.this.compiler.ModuleDef</span><a href="ast/Trees.scala.html#22393">ModuleDef</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.ModuleDef</span><a href="#147406">module</a></span>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)</span><span id="147398"><span id="23625"><a href="#147649" id="1379">ModuleDef</a></span></span></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Modifiers</span><span id="147649"><span id="147400"><a href="#147397" id="23614">mods</a></span></span></span>, <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><span id="147650"><span id="147402"><a href="#147397" id="23616">name</a></span></span></span>, _) = <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">module</a></span>
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="147404">boundNames</a></span> = <span class="typed"><span class="type">(Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147401">name</a></span>)

    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a id="147405">resultExtractionCode</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="147654">req</a></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147655">code</a></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) =
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147655">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span> <span class="typed"><span class="type">(String*)String</span><a href="#114770">codegenln</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;defined module &quot;)</span><span class="string">&quot;defined module &quot;</span></span>, <span class="typed"><span class="type">implicit scala.tools.nsc.Interpreter.name2string : (Interpreter.this.compiler.Name)String</span><a href="#75407">name</a></span>)
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class ClassHandler extends Interpreter.this.MemberHandler with ScalaObject</span><a id="75430">ClassHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.ClassDef</span><span id="147409"><a id="147420">classdef</a></span></span>: <span class="typed"><span class="type">Interpreter.this.compiler.ClassDef</span><a href="ast/Trees.scala.html#22388">ClassDef</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.ClassDef</span><a href="#147420">classdef</a></span>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)</span><span id="147412"><span id="23625"><a href="#147667" id="1379">ClassDef</a></span></span></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Modifiers</span><span id="147667"><span id="147414"><a href="#147411" id="23614">mods</a></span></span></span>, <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><span id="147668"><span id="147416"><a href="#147411" id="23616">name</a></span></span></span>, _, _) = <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">classdef</a></span>
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="147418">boundNames</a></span> = 
      <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147415">name</a></span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)List[Interpreter.this.compiler.Name]</span><a href="#147671" id="21335">::</a></span> (<span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Modifiers</span><a href="#147413">mods</a></span> <span class="typed"><span class="type">(Long)Boolean</span><a href="ast/Trees.scala.html#42017">hasFlag</a></span> Flags.<span class="typed"><span class="type">Long(2048L)</span><span >CASE</span></span>) <span class="typed"><span class="type">(Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147415">name</a></span>.<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#23894">toTermName</a></span>) <span class="keyword">else</span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>)
    
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a id="147419">resultExtractionCode</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="147675">req</a></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147676">code</a></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) =
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147676">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28701">print</a></span> <span class="typed"><span class="type">(String*)String</span><a href="#114770">codegenln</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;defined %s %s&quot;</a></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">classdef</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="ast/Trees.scala.html#26916">keyword</a></span>, <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147415">name</a></span>))
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class TypeAliasHandler extends Interpreter.this.MemberHandler with ScalaObject</span><a id="75431">TypeAliasHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.TypeDef</span><span id="147423"><a id="147435">typeDef</a></span></span>: <span class="typed"><span class="type">Interpreter.this.compiler.TypeDef</span><a href="ast/Trees.scala.html#22412">TypeDef</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.TypeDef</span><a href="#147435">typeDef</a></span>) {
    <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Modifiers, Interpreter.this.compiler.Name)</span><span id="147426"><span id="23625"><a href="#147687" id="1379">TypeDef</a></span></span></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Modifiers</span><span id="147687"><span id="147428"><a href="#147425" id="23614">mods</a></span></span></span>, <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><span id="147688"><span id="147430"><a href="#147425" id="23616">name</a></span></span></span>, _, _) = <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">typeDef</a></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">()Boolean</span><a id="147431">isAlias</a></span>() = <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Modifiers</span><a href="#147427">mods</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="ast/Trees.scala.html#42016">isPublic</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#75359">compiler</a></span>.<span class="typed"><span class="type">object Interpreter.this.compiler.treeInfo</span><a href="ast/Trees.scala.html#22360">treeInfo</a></span>.<span class="typed"><span class="type">(Interpreter.this.compiler.treeInfo.trees.Tree)Boolean</span><a href="ast/TreeInfo.scala.html#42469">isAliasTypeDef</a></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">typeDef</a></span>)
    <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="147433">boundNames</a></span> = <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">()Boolean</span><a href="#147431">isAlias</a></span>) <span class="typed"><span class="type">(Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="#147429">name</a></span>) <span class="keyword">else</span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>

    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a id="147434">resultExtractionCode</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="147693">req</a></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147694">code</a></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) =
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147694">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span> <span class="typed"><span class="type">(String*)String</span><a href="#114770">codegenln</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;defined type alias &quot;)</span><span class="string">&quot;defined type alias &quot;</span></span>, <span class="typed"><span class="type">implicit scala.tools.nsc.Interpreter.name2string : (Interpreter.this.compiler.Name)String</span><a href="#75407">name</a></span>)
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class ImportHandler extends Interpreter.this.MemberHandler with ScalaObject</span><a id="75432">ImportHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Import</span><span id="147438"><a id="147445">imp</a></span></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Import</span><a href="ast/Trees.scala.html#22421">Import</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#75424">MemberHandler</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Import</span><a href="#147445">imp</a></span>) {
    <span class="comment">/** Whether this import includes a wildcard import */</span>
    <span class="keyword">override</span> <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><span id="147441"><a id="147440">importsWildcard</a></span></span> = <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">imp</a></span>.<span class="typed"><span class="type">=&gt; List[(Trees.this.Name, Trees.this.Name)]</span><a href="ast/Trees.scala.html#28298">selectors</a></span>.<span class="typed"><span class="type">(((Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)) =&gt; Interpreter.this.compiler.Name)List[Interpreter.this.compiler.Name]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">(Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)</span><a href="#147707">_</a></span>.<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a id="23614">_1</a></span>) <span class="typed"><span class="type">(Any)Boolean</span><a id="21673">contains</a></span> <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="symtab/StdNames.scala.html#30500">USCOREkw</a></span>

    <span class="comment">/** The individual names imported by this statement */</span>
    <span class="keyword">override</span> <span class="keyword">val</span> <span class="typed"><span class="type">Seq[Interpreter.this.compiler.Name]</span><span id="147443"><a id="147442">importedNames</a></span></span>: <span class="typed"><span class="type">Seq[Interpreter.this.compiler.Name]</span><a id="763">Seq</a></span>[Name] = <span class="keyword">for</span> {
      <span class="typed"><span class="type">(((Interpreter.this.compiler.Name, Interpreter.this.compiler.Name)) =&gt; Iterable[Interpreter.this.compiler.Name])List[Interpreter.this.compiler.Name]</span><span id="21383"><a href="#147709" id="21367">(</a></span></span>_, <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><span id="147710"><span id="147714"><a id="147721">sel</a></span></span></span>) &lt;- <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">imp</a></span>.<span class="typed"><span class="type">=&gt; List[(Trees.this.Name, Trees.this.Name)]</span><a href="ast/Trees.scala.html#28298">selectors</a></span>
      <span class="keyword">if</span> (<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147714">sel</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147714">sel</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="symtab/StdNames.scala.html#30500">USCOREkw</a></span>)
      <span class="typed"><span class="type">((Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)List[Interpreter.this.compiler.Name]</span><span id="21362"><a id="147726">name</a></span></span> &lt;- <span class="typed"><span class="type">(Interpreter.this.compiler.Name*)List[Interpreter.this.compiler.Name]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147721">sel</a></span>.<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#23895">toTypeName</a></span>, <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147721">sel</a></span>.<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#23894">toTermName</a></span>)
    }
    <span class="keyword">yield</span> <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147726">name</a></span>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a id="147444">resultExtractionCode</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="147727">req</a></span>: <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433">Request</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147728">code</a></span>: <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>) =
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147728">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span> <span class="typed"><span class="type">(String*)String</span><a href="#114770">codegenln</a></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Tree</span><a href="#146974">imp</a></span>.<span class="typed"><span class="type">()String</span><a href="ast/Trees.scala.html#25371">toString</a></span>)
  }

  <span class="comment">/** One line of code submitted by the user for interpretation */</span>
  <span class="keyword">private</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Request extends java.lang.Object with ScalaObject</span><a id="75433">Request</a></span>(<span class="keyword">val</span> <span class="typed"><span class="type">String</span><span id="146923"><span id="146922"><a id="147342">line</a></span></span></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>, <span class="keyword">val</span> <span class="typed"><span class="type">String</span><span id="146925"><span id="146924"><a id="147343">lineName</a></span></span></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) {
    <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><span id="146928"><a id="146927">trees</a></span></span> = <span class="typed"><span class="type">(String)Option[List[Interpreter.this.compiler.Tree]]</span><a href="#75412">parse</a></span>(<span class="typed"><span class="type">=&gt; String</span><a href="#146922">line</a></span>) <span class="typed"><span class="type">(=&gt; List[Interpreter.this.compiler.Tree])List[Interpreter.this.compiler.Tree]</span><a id="25411">getOrElse</a></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>

    <span class="comment">/** name to use for the object that will compute &quot;line&quot; */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; java.lang.String</span><a id="146929">objectName</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#146924">lineName</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="symtab/StdNames.scala.html#30532">INTERPRETER_WRAPPER_SUFFIX</a></span>

    <span class="comment">/** name of the object that retrieves the result from the above object */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; java.lang.String</span><a id="146930">resultObjectName</a></span> = <span class="typed"><span class="type">java.lang.String(&quot;RequestResult$&quot;)</span><span class="string">&quot;RequestResult$&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#146929">objectName</a></span>

    <span class="comment">/** handlers for each tree in this request */</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.MemberHandler]</span><span id="146932"><a id="146931">handlers</a></span></span>: <span class="typed"><span class="type">List[Interpreter.this.MemberHandler]</span><a id="526">List</a></span>[MemberHandler] = <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Tree]</span><a href="#146927">trees</a></span> <span class="typed"><span class="type">((Interpreter.this.compiler.Tree) =&gt; Interpreter.this.MemberHandler)List[Interpreter.this.MemberHandler]</span><a id="21362">map</a></span> <span class="typed"><span class="type">(Interpreter.this.compiler.Tree)Interpreter.this.MemberHandler</span><a href="#75416">chooseHandler</a></span>

    <span class="comment">/** all (public) names defined by these statements */</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><span id="146934"><a id="146933">boundNames</a></span></span> = (<span class="typed"><span class="type">(Interpreter.this.compiler.Name*)scala.collection.immutable.Set[Interpreter.this.compiler.Name]</span><span id="68843"><a id="26288">ListSet</a></span></span>() <span class="typed"><span class="type">(Iterable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]</span><a id="31140">++</a></span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.MemberHandler]</span><a href="#146931">handlers</a></span>.<span class="typed"><span class="type">((Interpreter.this.MemberHandler) =&gt; Iterable[Interpreter.this.compiler.Name])List[Interpreter.this.compiler.Name]</span><a id="21383">flatMap</a></span>(<span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#146972">_</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146979">boundNames</a></span>)).<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="21815">toList</a></span>

    <span class="comment">/** list of names used by this expression */</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><span id="146936"><a id="146935">usedNames</a></span></span>: <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="526">List</a></span>[Name] = <span class="typed"><span class="type">=&gt; List[Interpreter.this.MemberHandler]</span><a href="#146931">handlers</a></span>.<span class="typed"><span class="type">((Interpreter.this.MemberHandler) =&gt; Iterable[Interpreter.this.compiler.Name])List[Interpreter.this.compiler.Name]</span><a id="21383">flatMap</a></span>(<span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#147766">_</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146977">usedNames</a></span>) 

    <span class="comment">/** Code to import bound names from previous lines - accessPath is code to
      * append to objectName to access anything bound by request. */</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">(String, String, String)</span><span id="23590"><a href="#147750" id="449">ComputedImports</a></span></span>(<span class="typed"><span class="type">String</span><span id="147750"><span id="146939"><span id="23578"><a href="#146937" id="146938">importsPreamble</a></span></span></span></span>, <span class="typed"><span class="type">String</span><span id="147751"><span id="146941"><span id="23580"><a href="#146937" id="146940">importsTrailer</a></span></span></span></span>, <span class="typed"><span class="type">String</span><span id="147752"><span id="146943"><span id="23582"><a href="#146937" id="146942">accessPath</a></span></span></span></span>) =
      <span class="typed"><span class="type">(Set[Interpreter.this.compiler.Name])Interpreter.this.ComputedImports</span><a href="#75411">importsCode</a></span>(<span class="typed"><span class="type">=&gt; collection.immutable.Set.type</span><span id="5998"><a id="821">Set</a></span></span>.<span class="typed"><span class="type">scala.collection.immutable.Set[Interpreter.this.compiler.Name]</span><a id="31133">empty</a></span> <span class="typed"><span class="type">(Iterable[Interpreter.this.compiler.Name])scala.collection.immutable.Set[Interpreter.this.compiler.Name]</span><a id="31140">++</a></span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146935">usedNames</a></span>)

    <span class="comment">/** Code to access a variable with the specified name */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(String)String</span><a id="146944">fullPath</a></span>(<span class="typed"><span class="type">String</span><a id="147254">vname</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;%s.`%s`\n&quot;</a></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#146929">objectName</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; String</span><a href="#146942">accessPath</a></span>, <span class="typed"><span class="type">String</span><a href="#147254">vname</a></span>)

    <span class="comment">/** Code to access a variable with the specified name */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)String</span><a id="146945">fullPath</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a id="147253">vname</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#21103">Name</a></span>): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = <span class="typed"><span class="type">(String)String</span><a href="#146944">fullPath</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147253">vname</a></span>.<span class="typed"><span class="type">()String</span><a href="symtab/Names.scala.html#23898">toString</a></span>)

    <span class="comment">/** the line of code to compute */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="146946">toCompute</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#146922">line</a></span>

    <span class="comment">/** generate the source code for the object that computes this request */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="146947">objectSourceCode</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = <span class="typed"><span class="type">((java.io.PrintWriter) =&gt; Unit)String</span><a href="#75401">stringFrom</a></span> { <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147776">code</a></span> =&gt; 
      <span class="comment">// whitespace compatible with interpreter.scala</span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147777">preamble</a></span> = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;&quot;&quot;object %s {
        |   %s%s
      &quot;&quot;&quot;</a></span></span>.<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><span id="821"><a id="22848">stripMargin</a></span></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#146929">objectName</a></span>, <span class="typed"><span class="type">=&gt; String</span><a href="#146938">importsPreamble</a></span>, <span class="typed"><span class="type">(String)String</span><a href="#75406">indentCode</a></span>(<span class="typed"><span class="type">=&gt; String</span><a href="#146946">toCompute</a></span>))     
      <span class="comment">// val preamble = &quot;&quot;&quot;</span>
      <span class="comment">//   | object %s {</span>
      <span class="comment">//   |   %s %s</span>
      <span class="comment">// &quot;&quot;&quot;.stripMargin.format(objectName, importsPreamble, indentCode(toCompute))</span>
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="147778">postamble</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#146940">importsTrailer</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;; }&quot;)</span><span class="string">&quot;; }&quot;</span></span>

      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147776">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span> <span class="typed"><span class="type">String</span><a href="#147777">preamble</a></span>
      <span class="typed"><span class="type">=&gt; List[Interpreter.this.MemberHandler]</span><a href="#146931">handlers</a></span> <span class="typed"><span class="type">((Interpreter.this.MemberHandler) =&gt; Unit)Unit</span><a id="21366">foreach</a></span> { <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#147793">_</a></span>.<span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a href="#146988">extraCodeToEvaluate</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433" class="keyword">this</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147776">code</a></span>) }
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147776">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#147778">postamble</a></span>
    }
      
    <span class="comment">/** Types of variables defined by this request.  They are computed
        after compilation of the main object */</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Map[Interpreter.this.compiler.Name,String]</span><span id="146950"><span id="146948"><span id="146949"><a id="147756">typeOf</a></span></span></span></span>: <span class="typed"><span class="type">Map[Interpreter.this.compiler.Name,String]</span><a id="26197">Map</a></span>[Name, String] = _
    <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)String</span><a id="146951">typeOfEnc</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a id="147566">vname</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#21103">Name</a></span>) = <span class="typed"><span class="type">(Interpreter.this.compiler.Name)String</span><a href="#146948" id="24239">typeOf</a></span>(<span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#75359">compiler</a></span> <span class="typed"><span class="type">(String)Interpreter.this.compiler.Name</span><a href="symtab/StdNames.scala.html#22319">encode</a></span> <span class="typed"><span class="type">implicit scala.tools.nsc.Interpreter.name2string : (Interpreter.this.compiler.Name)String</span><a href="#75407">vname</a></span>)

    <span class="comment">/** generate source code for the object that retrieves the result
        from objectSourceCode */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="146952">resultObjectSourceCode</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = <span class="typed"><span class="type">((java.io.PrintWriter) =&gt; Unit)String</span><a href="#75401">stringFrom</a></span> { <span class="typed"><span class="type">java.io.PrintWriter</span><a id="147798">code</a></span> =&gt;
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147799">preamble</a></span> = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;&quot;&quot;
      | object %s {
      |   val result: String = {
      |     %s    // evaluate object to make sure constructor is run
      |     (&quot;&quot;   // an initial &quot;&quot; so later code can uniformly be: + etc
      &quot;&quot;&quot;</a></span></span>.<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><span id="821"><a id="22848">stripMargin</a></span></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#146930">resultObjectName</a></span>, <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#146929">objectName</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; String</span><a href="#146942">accessPath</a></span>)
      
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="147800">postamble</a></span> = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;&quot;&quot;
      |     )
      |   }
      | }
      &quot;&quot;&quot;</a></span></span>.<span class="typed"><span class="type">=&gt; String</span><a id="22848">stripMargin</a></span>

      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147798">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span> <span class="typed"><span class="type">String</span><a href="#147799">preamble</a></span>
      <span class="typed"><span class="type">=&gt; List[Interpreter.this.MemberHandler]</span><a href="#146931">handlers</a></span> <span class="typed"><span class="type">((Interpreter.this.MemberHandler) =&gt; Unit)Unit</span><a id="21366">foreach</a></span> { <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#147822">_</a></span>.<span class="typed"><span class="type">(Interpreter.this.Request,java.io.PrintWriter)Unit</span><a href="#146989">resultExtractionCode</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#75433" class="keyword">this</a></span>, <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147798">code</a></span>) }
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#147798">code</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span> <span class="typed"><span class="type">String</span><a href="#147800">postamble</a></span>
    }

    <span class="comment">/** Compile the object file.  Returns whether the compilation succeeded.
     *  If all goes well, the &quot;types&quot; map is computed. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">()Boolean</span><a id="146953">compile</a></span>(): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = {
      <span class="comment">// error counting is wrong, hence interpreter may overlook failure - so we reset</span>
      <span class="typed"><span class="type">object Interpreter.this.reporter</span><a href="#75375">reporter</a></span>.<span class="typed"><span class="type">=&gt; Unit</span><a href="reporters/AbstractReporter.scala.html#46737">reset</a></span>

      <span class="comment">// compile the main object</span>
      <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.compiler.Run</span><a id="147825">objRun</a></span> = <span class="typed"><span class="type">Interpreter.this.compiler.Run</span><span class="keyword">new</span></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#75359">compiler</a></span>.<span class="typed"><span class="type">Interpreter.this.compiler.Run</span><a href="Global.scala.html#21313">Run</a></span>()
      <span class="typed"><span class="type">Interpreter.this.compiler.Run</span><a href="#147825">objRun</a></span>.<span class="typed"><span class="type">(List[scala.tools.nsc.util.SourceFile])Unit</span><a href="Global.scala.html#36587">compileSources</a></span>(<span class="typed"><span class="type">(scala.tools.nsc.util.BatchSourceFile*)List[scala.tools.nsc.util.BatchSourceFile]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">(String,Seq[Char])scala.tools.nsc.util.BatchSourceFile</span><a href="util/SourceFile.scala.html#22673" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.util.BatchSourceFile</span><a href="util/SourceFile.scala.html#8435">BatchSourceFile</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt;console&gt;&quot;)</span><span class="string">&quot;&lt;console&gt;&quot;</span></span>, <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a href="#146947" id="821">objectSourceCode</a></span></span>)))
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">object Interpreter.this.reporter</span><a href="#75375">reporter</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="reporters/Reporter.scala.html#34460">hasErrors</a></span>)
        <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>

      <span class="comment">// extract and remember types </span>
      <span class="typed"><span class="type">(Map[Interpreter.this.compiler.Name,String])Unit</span><a href="#146949">typeOf</a></span> = <span class="typed"><span class="type">(Interpreter.this.compiler.Run)Map[Interpreter.this.compiler.Name,String]</span><a href="#146954">findTypes</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Run</span><a href="#147825">objRun</a></span>)

      <span class="comment">// compile the result-extraction object</span>
      <span class="typed"><span class="type">Interpreter.this.compiler.Run</span><span class="keyword">new</span></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#75359">compiler</a></span>.<span class="typed"><span class="type">Interpreter.this.compiler.Run</span><a href="Global.scala.html#21313">Run</a></span>().<span class="typed"><span class="type">(List[scala.tools.nsc.util.SourceFile])Unit</span><a href="Global.scala.html#36587">compileSources</a></span>(<span class="typed"><span class="type">(scala.tools.nsc.util.BatchSourceFile*)List[scala.tools.nsc.util.BatchSourceFile]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">(String,Seq[Char])scala.tools.nsc.util.BatchSourceFile</span><a href="util/SourceFile.scala.html#22673" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.util.BatchSourceFile</span><a href="util/SourceFile.scala.html#8435">BatchSourceFile</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt;console&gt;&quot;)</span><span class="string">&quot;&lt;console&gt;&quot;</span></span>, <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a href="#146952" id="821">resultObjectSourceCode</a></span></span>)))

      <span class="comment">// success</span>
      <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">object Interpreter.this.reporter</span><a href="#75375">reporter</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="reporters/Reporter.scala.html#34460">hasErrors</a></span>
    }

    <span class="comment">/** Dig the types of all bound variables out of the compiler run.
     *
     *  @param objRun ...
     *  @return       ...
     */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Run)Map[Interpreter.this.compiler.Name,String]</span><a id="146954">findTypes</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Run</span><a id="147859">objRun</a></span>: compiler.<span class="typed"><span class="type">Interpreter.this.compiler.Run</span><a href="Global.scala.html#21313">Run</a></span>): <span class="typed"><span class="type">Map[Interpreter.this.compiler.Name,String]</span><a id="26197">Map</a></span>[Name, String] = {
      <span class="keyword">import</span> compiler.definitions.{ EmptyPackage, getMember }
      <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="147894">valAndVarNames</a></span> = <span class="typed"><span class="type">=&gt; List[Interpreter.this.MemberHandler]</span><a href="#146931">handlers</a></span> <span class="typed"><span class="type">((Interpreter.this.MemberHandler) =&gt; Iterable[Interpreter.this.compiler.Name])List[Interpreter.this.compiler.Name]</span><a id="21383">flatMap</a></span> { <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#147901">_</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146980">valAndVarNames</a></span> }
      <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a id="147895">defNames</a></span> = <span class="typed"><span class="type">=&gt; List[Interpreter.this.MemberHandler]</span><a href="#146931">handlers</a></span> <span class="typed"><span class="type">((Interpreter.this.MemberHandler) =&gt; Iterable[Interpreter.this.compiler.Name])List[Interpreter.this.compiler.Name]</span><a id="21383">flatMap</a></span> { <span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#147904">_</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146981">defNames</a></span> }
      
      <span class="keyword">def</span> <span class="typed"><span class="type">(List[Interpreter.this.compiler.Name],(Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)Map[Interpreter.this.compiler.Name,String]</span><a id="147896">getTypes</a></span>(<span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="147905">names</a></span>: <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a id="526">List</a></span>[Name], <span class="typed"><span class="type">(Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name</span><a id="147906">nameMap</a></span>: Name =&gt; Name): <span class="typed"><span class="type">Map[Interpreter.this.compiler.Name,String]</span><a id="26197">Map</a></span>[Name, String] = {
        <span class="keyword">def</span> <span class="typed"><span class="type">[T](=&gt; T)T</span><a id="147907">atNextPhase</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="147909">T</a></span>](<span class="typed"><span class="type">=&gt; T</span><a id="147912">op</a></span>: =&gt; T): <span class="typed"><span class="type">T</span><a href="#147909">T</a></span> = <span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#75359">compiler</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.Phase)(=&gt; T)T</span><a href="symtab/SymbolTable.scala.html#21147">atPhase</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Run</span><a href="#147859">objRun</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Phase</span><a href="Global.scala.html#36558">typerPhase</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Phase</span><a href="Phase.scala.html#27787">next</a></span>)(<span class="typed"><span class="type">=&gt; T</span><a href="#147912">op</a></span>)
        
        <span class="comment">/** the outermost wrapper object */</span>
        <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.compiler.Symbol</span><a id="147910">outerResObjSym</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Symbol</span><a href="symtab/Symbols.scala.html#21866">Symbol</a></span> = <span class="typed"><span class="type">(Interpreter.this.compiler.Symbol,Interpreter.this.compiler.Name)Interpreter.this.compiler.Symbol</span><a href="symtab/Definitions.scala.html#26112">getMember</a></span>(<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Symbol</span><a href="symtab/Definitions.scala.html#25756">EmptyPackage</a></span>, <span class="typed"><span class="type">(String)Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#21096">newTermName</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#146929">objectName</a></span>))

        <span class="comment">/** the innermost object inside the wrapper, found by
          * following accessPath into the outer one. */</span>
        <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.compiler.Symbol</span><a id="147911">resObjSym</a></span> =
          <span class="typed"><span class="type">=&gt; String</span><a href="#146942">accessPath</a></span>.<span class="typed"><span class="type">(java.lang.String)Array[java.lang.String]</span><a id="5865">split</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;\.&quot;)</span><span class="string">&quot;\\.&quot;</span></span>).<span class="typed"><span class="type">(Interpreter.this.compiler.Symbol)((Interpreter.this.compiler.Symbol, java.lang.String) =&gt; Interpreter.this.compiler.Symbol)Interpreter.this.compiler.Symbol</span><a id="21799">foldLeft</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Symbol</span><a href="#147910">outerResObjSym</a></span>) { (<span class="typed"><span class="type">Interpreter.this.compiler.Symbol</span><a id="147918">sym</a></span>, <span class="typed"><span class="type">java.lang.String</span><a id="147919">name</a></span>) =&gt;
            <span class="typed"><span class="type">Interpreter.this.compiler.Symbol</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">java.lang.String</span><a href="#147919">name</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>) <span class="typed"><span class="type">Interpreter.this.compiler.Symbol</span><a href="#147918">sym</a></span> <span class="keyword">else</span>
            <span class="typed"><span class="type">(=&gt; Interpreter.this.compiler.Symbol)Interpreter.this.compiler.Symbol</span><a href="#147907">atNextPhase</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Symbol</span><a href="#147918">sym</a></span>.<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Type</span><a href="symtab/Symbols.scala.html#25231">info</a></span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)Interpreter.this.compiler.Symbol</span><a href="symtab/Types.scala.html#25684">member</a></span> <span class="typed"><span class="type">(String)Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#21096">newTermName</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#147919">name</a></span>))
          }

        <span class="typed"><span class="type">List[Interpreter.this.compiler.Name]</span><a href="#147905">names</a></span>.<span class="typed"><span class="type">(scala.collection.immutable.Map[Interpreter.this.compiler.Name,String])((scala.collection.immutable.Map[Interpreter.this.compiler.Name,String], Interpreter.this.compiler.Name) =&gt; scala.collection.immutable.Map[Interpreter.this.compiler.Name,String])scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]</span><a id="21375">foldLeft</a></span>(<span class="typed"><span class="type">=&gt; collection.immutable.Map.type</span><span id="5996"><a id="821">Map</a></span></span>.<span class="typed"><span class="type">scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]</span><a id="32793">empty</a></span>[<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#21103">Name</a></span>, <span class="typed"><span class="type">String</span><a id="1861">String</a></span>]) { (<span class="typed"><span class="type">scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]</span><a id="147925">map</a></span>, <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a id="147926">name</a></span>) =&gt;
          <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.compiler.Type</span><a id="147927">rawType</a></span> = <span class="typed"><span class="type">(=&gt; Interpreter.this.compiler.Type)Interpreter.this.compiler.Type</span><a href="#147907">atNextPhase</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Symbol</span><a href="#147911">resObjSym</a></span>.<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Type</span><a href="symtab/Symbols.scala.html#25231">info</a></span>.<span class="typed"><span class="type">(Interpreter.this.compiler.Name)Interpreter.this.compiler.Symbol</span><a href="symtab/Types.scala.html#25684">member</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147926">name</a></span>).<span class="typed"><span class="type">=&gt; Interpreter.this.compiler.Type</span><a href="symtab/Symbols.scala.html#25230">tpe</a></span>)
          <span class="comment">// the types are all =&gt;T; remove the =&gt;</span>
          <span class="keyword">val</span> <span class="typed"><span class="type">Interpreter.this.compiler.Type</span><a id="147928">cleanedType</a></span> = <span class="typed"><span class="type">Interpreter.this.compiler.Type</span><a href="#147927">rawType</a></span> <span class="typed"><span class="type">Interpreter.this.compiler.Type</span><span class="keyword">match</span></span> { 
            <span class="typed"><span class="type">Interpreter.this.compiler.Type</span><span class="keyword">case</span></span> compiler.<a id="1">PolyType</a>(<span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>, <span class="typed"><span class="type">Interpreter.this.compiler.Type</span><a id="147930">rt</a></span>) =&gt; <span class="typed"><span class="type">Interpreter.this.compiler.Type</span><a href="#147930">rt</a></span>
            <span class="typed"><span class="type">Interpreter.this.compiler.Type</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Interpreter.this.compiler.Type</span><a id="147931">rawType</a></span> =&gt; <span class="typed"><span class="type">Interpreter.this.compiler.Type</span><a href="#147931">rawType</a></span>
          }

          <span class="typed"><span class="type">scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]</span><a href="#147925">map</a></span> <span class="typed"><span class="type">((Interpreter.this.compiler.Name, String))scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]</span><a id="32801">+</a></span> (<span class="typed"><span class="type">(Interpreter.this.compiler.Name)ArrowAssoc[Interpreter.this.compiler.Name]</span><span id="6054"><a href="#147926" id="821">name</a></span></span> <span class="typed"><span class="type">(String)(Interpreter.this.compiler.Name, String)</span><a id="6050">-&gt;</a></span> <span class="typed"><span class="type">(=&gt; String)String</span><a href="#147907">atNextPhase</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Type</span><a href="#147928">cleanedType</a></span>.<span class="typed"><span class="type">()String</span><a href="symtab/Types.scala.html#25733">toString</a></span>))
        }
      }

      <span class="keyword">val</span> <span class="typed"><span class="type">Map[Interpreter.this.compiler.Name,String]</span><a id="147897">names1</a></span> = <span class="typed"><span class="type">(List[Interpreter.this.compiler.Name],(Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)Map[Interpreter.this.compiler.Name,String]</span><a href="#147896">getTypes</a></span>(<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#147894">valAndVarNames</a></span>, <span class="typed"><span class="type">object Interpreter.this.compiler.nme</span><a href="symtab/StdNames.scala.html#22317">nme</a></span>.<span class="typed"><span class="type">(Interpreter.this.compiler.Name)Interpreter.this.compiler.Name</span><a href="symtab/StdNames.scala.html#30568">getterToLocal</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#147955">_</a></span>))
      <span class="keyword">val</span> <span class="typed"><span class="type">Map[Interpreter.this.compiler.Name,String]</span><a id="147898">names2</a></span> = <span class="typed"><span class="type">(List[Interpreter.this.compiler.Name],(Interpreter.this.compiler.Name) =&gt; Interpreter.this.compiler.Name)Map[Interpreter.this.compiler.Name,String]</span><a href="#147896">getTypes</a></span>(<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#147895">defNames</a></span>, <span class="typed"><span class="type">(Interpreter.this.compiler.Name)Interpreter.this.compiler.Name</span><span id="6129"><a href="#147958" id="821">identity</a></span></span>)
      <span class="typed"><span class="type">Map[Interpreter.this.compiler.Name,String]</span><a href="#147897">names1</a></span> <span class="typed"><span class="type">(Iterable[(Interpreter.this.compiler.Name, String)])scala.collection.immutable.Map[Interpreter.this.compiler.Name,String]</span><a id="32805">++</a></span> <span class="typed"><span class="type">Map[Interpreter.this.compiler.Name,String]</span><a href="#147898">names2</a></span>
    }

    <span class="comment">/** load and run the code using reflection */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; (String, Boolean)</span><a id="146955">loadAndRun</a></span>: <span class="typed"><span class="type">(String, Boolean)</span><a id="1378">(</a></span>String, Boolean) = {
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.Class[_]</span><a id="147985">resultObject</a></span>: <span class="typed"><span class="type">java.lang.Class[_]</span><a id="1672">Class</a></span>[_] = <span class="typed"><span class="type">(String)java.lang.Class[_]</span><a href="#75384">loadByName</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#146930">resultObjectName</a></span>)
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.reflect.Method</span><a id="147986">resultValMethod</a></span>: reflect.<span class="typed"><span class="type">java.lang.reflect.Method</span><a id="3864">Method</a></span> = <span class="typed"><span class="type">java.lang.Class[_]</span><a href="#147985">resultObject</a></span> <span class="typed"><span class="type">(java.lang.String,java.lang.Class[_]*)java.lang.reflect.Method</span><a id="4342">getMethod</a></span> <span class="typed"><span class="type">java.lang.String(&quot;result&quot;)</span><span class="string">&quot;result&quot;</span></span>
      
      <span class="keyword">try</span>   { <span class="typed"><span class="type">(java.lang.String,Boolean)(java.lang.String, Boolean)</span><span id="23625"><a id="1379">(</a></span></span><span class="typed"><span class="type">java.lang.reflect.Method</span><a href="#147986">resultValMethod</a></span>.<span class="typed"><span class="type">(Any,java.lang.Object*)java.lang.Object</span><a id="128492">invoke</a></span>(<span class="typed"><span class="type">java.lang.Class[_]</span><a href="#147985">resultObject</a></span>).<span class="typed"><span class="type">()java.lang.String</span><a id="5785">toString</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>) }
      <span class="keyword">catch</span> { <span class="typed"><span class="type">(String, Boolean)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.Throwable</span><a id="147995">e</a></span> =&gt; 
        <span class="comment">// unwrap unhelpful nested exceptions so the most interesting one is reported</span>
        <span class="keyword">def</span> <span class="typed"><span class="type">(Throwable)Throwable</span><a id="147996">unwrap</a></span>(<span class="typed"><span class="type">Throwable</span><a id="147997">e</a></span>: <span class="typed"><span class="type">Throwable</span><a id="2143">Throwable</a></span>): <span class="typed"><span class="type">Throwable</span><a id="2143">Throwable</a></span> = <span class="typed"><span class="type">Throwable</span><a href="#147997">e</a></span> <span class="typed"><span class="type">Throwable</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">Throwable</span><span class="keyword">case</span></span> (_: <span class="typed"><span class="type">java.lang.reflect.InvocationTargetException</span><a id="3906">InvocationTargetException</a></span> | _: <span class="typed"><span class="type">java.lang.ExceptionInInitializerError</span><a id="1891">ExceptionInInitializerError</a></span>) <span class="keyword">if</span> <span class="typed"><span class="type">Throwable</span><a href="#147997">e</a></span>.<span class="typed"><span class="type">()java.lang.Throwable</span><a id="23648">getCause</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5795">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> =&gt;
            <span class="typed"><span class="type">(Throwable)Throwable</span><a href="#147996">unwrap</a></span>(<span class="typed"><span class="type">Throwable</span><a href="#147997">e</a></span>.<span class="typed"><span class="type">()java.lang.Throwable</span><a id="23648">getCause</a></span>)
          <span class="typed"><span class="type">Throwable</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Throwable</span><a href="#147997">e</a></span>
        }
        <span class="typed"><span class="type">(String,Boolean)(String, Boolean)</span><span id="23625"><a id="1379">(</a></span></span><span class="typed"><span class="type">((java.io.PrintWriter) =&gt; Unit)String</span><a href="#75401">stringFrom</a></span>(<span class="typed"><span class="type">(Throwable)Throwable</span><a href="#147996">unwrap</a></span>(<span class="typed"><span class="type">java.lang.Throwable</span><a href="#147995">e</a></span>).<span class="typed"><span class="type">(java.io.PrintWriter)Unit</span><a id="23653">printStackTrace</a></span>(<span class="typed"><span class="type">java.io.PrintWriter</span><a href="#148006">_</a></span>)), <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
      }
    }
  }
  
  <span class="comment">/** These methods are exposed so REPL commands can access them.
   *  The command infrastructure is in InterpreterLoop.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(List[String])String</span><a id="75434">dumpState</a></span>(<span class="typed"><span class="type">List[String]</span><a id="125627">xs</a></span>: <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String]): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="comment">// println(&quot;Imports for &quot; + req + &quot; =&gt; &quot; + req.importsPreamble)</span>
    <span class="comment">// req.handlers foreach { h =&gt; println(&quot;Handler &quot; + h + &quot; used names: &quot; + h.usedNames) }</span>
    <span class="comment">// req.trees foreach { x =&gt; println(&quot;Tree: &quot; + x) }</span>
    <span class="comment">// xs foreach { x =&gt; println(&quot;membersOfIdentifier(&quot; + x + &quot;) = &quot; + membersOfIdentifier(x)) }</span>
    <span class="typed"><span class="type">(java.lang.Object*)List[java.lang.Object]</span><span id="21328"><a id="527">List</a></span></span>(
      <span class="typed"><span class="type">java.lang.String(&quot;allUsedNames = &quot;)</span><span class="string">&quot;allUsedNames = &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#75390">allUsedNames</a></span>,
      <span class="typed"><span class="type">java.lang.String(&quot;allBoundNames = &quot;)</span><span class="string">&quot;allBoundNames = &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#75391">allBoundNames</a></span>,
      <span class="typed"><span class="type">=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><a href="#75388">prevRequests</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.Request]</span><a id="21815">toList</a></span>.<span class="typed"><span class="type">((Interpreter.this.Request) =&gt; java.lang.String)List[java.lang.String]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a id="148013">req</a></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;  &quot;&quot;)</span><span class="string">&quot;  \&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#148013">req</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="#146922">line</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot; =&gt; &quot;)</span><span class="string">&quot;\&quot; =&gt; &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#148013">req</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="#146947">objectSourceCode</a></span>)
    ).<span class="typed"><span class="type">(String,String,String)String</span><a id="21818">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>)
  }
      
  <span class="comment">// very simple right now, will get more interesting</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(List[String])String</span><a id="75435">dumpTrees</a></span>(<span class="typed"><span class="type">List[String]</span><a id="125631">xs</a></span>: <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String]): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a id="148031">treestrs</a></span> = 
      <span class="typed"><span class="type">object List</span><a id="527">List</a></span>.<span class="typed"><span class="type">(List[List[Interpreter.this.compiler.Tree]])List[Interpreter.this.compiler.Tree]</span><a id="21419">flatten</a></span>(
        <span class="keyword">for</span> (<span class="typed"><span class="type">((String) =&gt; Iterable[List[Interpreter.this.compiler.Tree]])List[List[Interpreter.this.compiler.Tree]]</span><span id="21383"><a id="148035">x</a></span></span> &lt;- <span class="typed"><span class="type">List[String]</span><a href="#125631">xs</a></span> ; <span class="typed"><span class="type">(Option[List[Interpreter.this.compiler.Tree]])Iterable[List[Interpreter.this.compiler.Tree]]</span><span id="25402"><span id="935"><span id="25415"><a id="148044">name</a></span></span></span></span> &lt;- <span class="typed"><span class="type">(String)Option[Interpreter.this.compiler.Name]</span><a href="#75437">nameOfIdent</a></span>(<span class="typed"><span class="type">String</span><a href="#148035">x</a></span>) ; <span class="typed"><span class="type">((Interpreter.this.Request) =&gt; List[Interpreter.this.compiler.Tree])Option[List[Interpreter.this.compiler.Tree]]</span><span id="25413"><a id="148048">req</a></span></span> &lt;- <span class="typed"><span class="type">(Interpreter.this.compiler.Name)Option[Interpreter.this.Request]</span><a href="#75438">requestForName</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#148044">name</a></span>))
        <span class="keyword">yield</span> <span class="typed"><span class="type">Interpreter.this.Request</span><a href="#148048">req</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Tree]</span><a href="#146927">trees</a></span>
      )

    <span class="typed"><span class="type">String</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a href="#148031">treestrs</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span>) <span class="typed"><span class="type">java.lang.String(&quot;No trees found.&quot;)</span><span class="string">&quot;No trees found.&quot;</span></span>
    <span class="keyword">else</span> <span class="typed"><span class="type">List[Interpreter.this.compiler.Tree]</span><a href="#148031">treestrs</a></span>.<span class="typed"><span class="type">((Interpreter.this.compiler.Tree) =&gt; java.lang.String)List[java.lang.String]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a id="148062">t</a></span> =&gt; <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="#148062">t</a></span>.<span class="typed"><span class="type">()String</span><a href="ast/Trees.scala.html#25371">toString</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; (&quot;)</span><span class="string">&quot; (&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">Interpreter.this.compiler.Tree</span><a href="#148062">t</a></span>.<span class="typed"><span class="type">()java.lang.Class[_ &lt;: java.lang.Object]</span><a id="3511">getClass</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="4329">getSimpleName</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;)\012&quot;)</span><span class="string">&quot;)\n&quot;</span></span>).<span class="typed"><span class="type">=&gt; String</span><a id="21820">mkString</a></span>
  }
      
  <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="75436">powerUser</a></span>(): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="typed"><span class="type">(=&gt; scala.tools.nsc.InterpreterResults.Result)scala.tools.nsc.InterpreterResults.Result</span><a href="#75370">beQuietDuring</a></span> {
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="148066">mkTypeCmd</a></span> =
        <span class="typed"><span class="type">java.lang.String(&quot;def mkType(name: String, what: String) = interpreter.interpret(&quot;type &quot; + name + &quot; = &quot; + what)&quot;)</span><span class="string">&quot;&quot;&quot;def mkType(name: String, what: String) = interpreter.interpret(&quot;type &quot; + name + &quot; = &quot; + what)&quot;&quot;&quot;</span></span>
      
      <span class="typed"><span class="type">Interpreter.this.type</span><a href="#6405" class="keyword">this</a></span>.<span class="typed"><span class="type">(String,String,Any)scala.tools.nsc.InterpreterResults.Result</span><a href="#75420">bind</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;interpreter&quot;)</span><span class="string">&quot;interpreter&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;scala.tools.nsc.Interpreter&quot;)</span><span class="string">&quot;scala.tools.nsc.Interpreter&quot;</span></span>, <span class="typed"><span class="type">scala.tools.nsc.Interpreter</span><a href="#6405" class="keyword">this</a></span>)
      <span class="typed"><span class="type">(String)scala.tools.nsc.InterpreterResults.Result</span><a href="#75417">interpret</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#148066">mkTypeCmd</a></span>)
    }
    
    <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;&quot;&quot;** Power User mode enabled - BEEP BOOP      **
      |** New vals! Try interpreter.&lt;tab&gt;          **
      |** New defs! Try mkType(&quot;T&quot;, &quot;String&quot;)      **
      |** New cmds! :help to discover them         **&quot;&quot;&quot;</a></span></span>.<span class="typed"><span class="type">=&gt; String</span><a id="22848">stripMargin</a></span>
  }
  
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Option[Interpreter.this.compiler.Name]</span><a id="75437">nameOfIdent</a></span>(<span class="typed"><span class="type">String</span><a id="148036">line</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Option[Interpreter.this.compiler.Name]</span><a id="934">Option</a></span>[Name] = {
    <span class="typed"><span class="type">(String)Option[List[Interpreter.this.compiler.Tree]]</span><a href="#75412">parse</a></span>(<span class="typed"><span class="type">String</span><a href="#148036">line</a></span>) <span class="typed"><span class="type">Option[Interpreter.this.compiler.Name]</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Some[Interpreter.this.compiler.Name]</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">(List[Interpreter.this.compiler.Tree])Some[List[Interpreter.this.compiler.Tree]]</span><span id="21410"><a href="#148074" id="527">List</a></span></span>(<a id="1">Ident</a>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a id="148078">x</a></span>))) =&gt; <span class="typed"><span class="type">(Interpreter.this.compiler.Name)Some[Interpreter.this.compiler.Name]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#148078">x</a></span>)
      <span class="typed"><span class="type">None.type</span><span class="keyword">case</span></span> _                    =&gt; <span class="typed"><span class="type">object None</span><a id="536">None</a></span>
    }
  }
  
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Interpreter.this.compiler.Name)Option[Interpreter.this.Request]</span><a id="75438">requestForName</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a id="148045">name</a></span>: <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="symtab/Names.scala.html#21103">Name</a></span>): <span class="typed"><span class="type">Option[Interpreter.this.Request]</span><a id="934">Option</a></span>[Request] = {
    <span class="keyword">for</span> (<span class="typed"><span class="type">((Interpreter.this.Request) =&gt; Unit)Unit</span><span id="21366"><a id="148083">req</a></span></span> &lt;- <span class="typed"><span class="type">=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><a href="#75388">prevRequests</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.Request]</span><a id="21815">toList</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.Request]</span><a id="21385">reverse</a></span>) {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#148083">req</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.MemberHandler]</span><a href="#146931">handlers</a></span>.<span class="typed"><span class="type">((Interpreter.this.MemberHandler) =&gt; Boolean)Boolean</span><a id="21373">exists</a></span>(<span class="typed"><span class="type">Interpreter.this.MemberHandler</span><a href="#148085">_</a></span>.<span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#146979">boundNames</a></span> <span class="typed"><span class="type">(Any)Boolean</span><a id="21673">contains</a></span> <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#148045">name</a></span>))
        <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">(Interpreter.this.Request)Some[Interpreter.this.Request]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">Interpreter.this.Request</span><a href="#148083">req</a></span>)
    }
    <span class="typed"><span class="type">object None</span><a id="536">None</a></span>
  }
  
  <span class="comment">// XXX at the moment this is imperfect because scala's protected semantics</span>
  <span class="comment">// differ from java's, so protected methods appear public via reflection;</span>
  <span class="comment">// yet scala enforces the protection.  The result is that protected members</span>
  <span class="comment">// appear in completion yet cannot actually be called.  Fixing this </span>
  <span class="comment">// properly requires a scala.reflect.* API.  Fixing it uglily is possible</span>
  <span class="comment">// too (cast to structural type!) but I deem poor use of energy.</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><span id="75440"><a id="75439">filterFlags</a></span></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = {
    <span class="keyword">import</span> java.lang.reflect.Modifier._
    STATIC | PRIVATE <span class="typed"><span class="type">Int(14)</span><span >|</span></span> PROTECTED
  }
  <span class="keyword">private</span> <span class="keyword">val</span> <span class="typed"><span class="type">String</span><span id="75442"><a id="75441">methodsCode</a></span></span> = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;&quot;&quot; .
    | asInstanceOf[AnyRef].getClass.getMethods .
    | filter(x =&gt; (x.getModifiers &amp; %d) == 0) .
    | map(_.getName) .
    | mkString(&quot; &quot;)&quot;&quot;&quot;</a></span></span>.<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><span id="821"><a id="22848">stripMargin</a></span></span></span>.<span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#75439">filterFlags</a></span>)  
  
  <span class="comment">/** The main entry point for tab-completion.  When the user types x.&lt;tab&gt;
   *  this method is called with &quot;x&quot; as an argument, and it discovers the
   *  fields and methods of x via reflection and returns their names to jline.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)List[String]</span><a id="75443">membersOfIdentifier</a></span>(<span class="typed"><span class="type">String</span><a id="148095">line</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String] = {
    <span class="keyword">import</span> Completion.{ isValidCompletion }
    <span class="keyword">import</span> scala.tools.nsc.util.NameTransformer.{ decode, encode }   <span class="comment">// e.g. $plus$plus =&gt; ++</span>
    
    <span class="keyword">val</span> <span class="typed"><span class="type">Option[List[String]]</span><a id="148098">res</a></span> = <span class="typed"><span class="type">(=&gt; Option[List[String]])Option[List[String]]</span><a href="#75370">beQuietDuring</a></span> {
      <span class="keyword">for</span> (<span class="typed"><span class="type">((Interpreter.this.compiler.Name) =&gt; Option[List[String]])Option[List[String]]</span><span id="25415"><a id="148119">name</a></span></span> &lt;- <span class="typed"><span class="type">(String)Option[Interpreter.this.compiler.Name]</span><a href="#75437">nameOfIdent</a></span>(<span class="typed"><span class="type">String</span><a href="#148095">line</a></span>) ; <span class="typed"><span class="type">((Interpreter.this.Request) =&gt; List[String])Option[List[String]]</span><span id="25413"><a id="148122">req</a></span></span> &lt;- <span class="typed"><span class="type">(Interpreter.this.compiler.Name)Option[Interpreter.this.Request]</span><a href="#75438">requestForName</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#148119">name</a></span>)) <span class="keyword">yield</span> {
        <span class="typed"><span class="type">List[String]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(String)scala.tools.nsc.InterpreterResults.Result</span><a href="#75417">interpret</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;val &quot;)</span><span class="string">&quot;val &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">()String</span><a href="#75397" id="31093">newInternalVarName</a></span>() <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; = &quot;)</span><span class="string">&quot; = &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#148119">name</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; String</span><a href="#75441">methodsCode</a></span>) <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults</span><a href="InterpreterResults.scala.html#6412">IR</a></span>.<span class="typed"><span class="type">object scala.tools.nsc.InterpreterResults.Success</span><a href="InterpreterResults.scala.html#125553">Success</a></span>) <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>
        <span class="keyword">else</span> {
          <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="148125">result</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.mutable.ArrayBuffer[Interpreter.this.Request]</span><a href="#75388">prevRequests</a></span>.<span class="typed"><span class="type">=&gt; Interpreter.this.Request</span><a id="21648">last</a></span>.<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#146930">resultObjectName</a></span>
          <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.Class[_]</span><a id="148126">resultObj</a></span> = <span class="typed"><span class="type">object java.lang.Class</span><a id="1673">Class</a></span>.<span class="typed"><span class="type">(java.lang.String,Boolean,java.lang.ClassLoader)java.lang.Class[_]</span><a id="3936">forName</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#148125">result</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>, <span class="typed"><span class="type">=&gt; java.lang.ClassLoader</span><a href="#75380">classLoader</a></span>)
          <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.reflect.Method</span><a id="148127">valMethod</a></span> = <span class="typed"><span class="type">java.lang.Class[_]</span><a href="#148126">resultObj</a></span>.<span class="typed"><span class="type">(java.lang.String,java.lang.Class[_]*)java.lang.reflect.Method</span><a id="4342">getMethod</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;result&quot;)</span><span class="string">&quot;result&quot;</span></span>)
          <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="148128">str</a></span> = <span class="typed"><span class="type">java.lang.reflect.Method</span><a href="#148127">valMethod</a></span>.<span class="typed"><span class="type">(Any,java.lang.Object*)java.lang.Object</span><a id="128492">invoke</a></span>(<span class="typed"><span class="type">java.lang.Class[_]</span><a href="#148126">resultObj</a></span>).<span class="typed"><span class="type">()java.lang.String</span><a id="5785">toString</a></span>
        
          <span class="typed"><span class="type">java.lang.String</span><a href="#148128">str</a></span>.<span class="typed"><span class="type">(Int)java.lang.String</span><a id="5854">substring</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#148128">str</a></span>.<span class="typed"><span class="type">(Int)Int</span><a id="5844">indexOf</a></span>(<span class="typed"><span class="type">Int(61)</span><span class="char">'='</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>).<span class="typed"><span class="type">()java.lang.String</span><a id="5870">trim</a></span> .
          <span class="typed"><span class="type">(java.lang.String)Array[java.lang.String]</span><a id="5865">split</a></span>(<span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span>).<span class="typed"><span class="type">=&gt; List[java.lang.String]</span><a id="21815">toList</a></span> .
          <span class="typed"><span class="type">((java.lang.String) =&gt; String)List[String]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">(String)String</span><a href="util/NameTransformer.scala.html#25616">decode</a></span>) .
          <span class="typed"><span class="type">((String) =&gt; Boolean)List[String]</span><a id="21367">filter</a></span>(<span class="typed"><span class="type">(String)Boolean</span><a href="interpreter/Completion.scala.html#148111">isValidCompletion</a></span>) .
          <span class="typed"><span class="type">=&gt; List[String]</span><a id="21405">removeDuplicates</a></span>
        }
      }
    }
      
    <span class="typed"><span class="type">Option[List[String]]</span><a href="#148098">res</a></span> <span class="typed"><span class="type">(=&gt; List[String])List[String]</span><a id="25411">getOrElse</a></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>
  }
  
  <span class="comment">/** Another entry point for tab-completion, ids in scope */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()List[String]</span><a id="75444">unqualifiedIds</a></span>(): <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String] =
    <span class="typed"><span class="type">=&gt; List[Interpreter.this.compiler.Name]</span><a href="#75391">allBoundNames</a></span> .
      <span class="typed"><span class="type">((Interpreter.this.compiler.Name) =&gt; String)List[String]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">Interpreter.this.compiler.Name</span><a href="#148181">_</a></span>.<span class="typed"><span class="type">()String</span><a href="symtab/Names.scala.html#23898">toString</a></span>) .
      <span class="typed"><span class="type">((String) =&gt; Boolean)List[String]</span><a id="21367">filter</a></span>(<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">(String)Boolean</span><a href="#75400">isSynthVarName</a></span>(<span class="typed"><span class="type">String</span><a href="#148184">_</a></span>))
   
  <span class="comment">/** For static/object method completion */</span> 
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Option[java.lang.Class[_]]</span><a id="75445">tryToLoadClass</a></span>(<span class="typed"><span class="type">String</span><a id="148185">path</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Option[java.lang.Class[_]]</span><a id="934">Option</a></span>[Class[_]] = { 
    <span class="keyword">try</span>   { <span class="typed"><span class="type">(java.lang.Class[?0])Some[java.lang.Class[?0]]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">object java.lang.Class</span><a id="1673">Class</a></span>.<span class="typed"><span class="type">(java.lang.String,Boolean,java.lang.ClassLoader)java.lang.Class[_]</span><a id="3936">forName</a></span>(<span class="typed"><span class="type">String</span><a href="#148185">path</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>, <span class="typed"><span class="type">=&gt; java.lang.ClassLoader</span><a href="#75380">classLoader</a></span>)) }
    <span class="keyword">catch</span> { <span class="typed"><span class="type">None.type</span><span class="keyword">case</span></span> _: <span class="typed"><span class="type">java.lang.ClassNotFoundException</span><a id="1729">ClassNotFoundException</a></span> | _: <span class="typed"><span class="type">java.lang.NoClassDefFoundError</span><a id="1933">NoClassDefFoundError</a></span> =&gt; <span class="typed"><span class="type">object None</span><a id="536">None</a></span> }
  }  
  
  <span class="comment">// debugging</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="75448"><span id="75446"><span id="75447"><a id="146771">debuggingOutput</a></span></span></span></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="75449">DBG</a></span>(<span class="typed"><span class="type">String</span><a id="148200">s</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#75446">debuggingOutput</a></span>) <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#75353">out</a></span> <span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span> <span class="typed"><span class="type">String</span><a href="#148200">s</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">Unit</span><span >(</span></span>)  
}

<span class="comment">/** Utility methods for the Interpreter. */</span>
<span class="keyword">object</span> <span class="typed"><span class="type">object scala.tools.nsc.Interpreter</span><a id="6406">Interpreter</a></span> {
  <span class="keyword">def</span> <span class="typed"><span class="type">(=&gt; Boolean,Any*)Unit</span><a id="114765">breakIf</a></span>(<span class="typed"><span class="type">=&gt; Boolean</span><a id="148206">assertion</a></span>: =&gt; Boolean, <span class="typed"><span class="type">Any*</span><a id="148207">args</a></span>: <span class="typed"><span class="type">Any*</span><a id="2741">Any</a></span>*): <span class="typed"><span class="type">Unit</span><a id="2169">Unit</a></span> =
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#148206">assertion</a></span>) <span class="typed"><span class="type">(List[Any])Unit</span><a href="#114766">break</a></span>(<span class="typed"><span class="type">Any*</span><a href="#148207">args</a></span>.<span class="typed"><span class="type">=&gt; List[Any]</span><a id="21815">toList</a></span>)

  <span class="comment">// start a repl binding supplied args to p1, p2, etc.</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(List[Any])Unit</span><a id="114766">break</a></span>(<span class="typed"><span class="type">List[Any]</span><a id="121431">args</a></span>: <span class="typed"><span class="type">List[Any]</span><a id="526">List</a></span>[Any]): <span class="typed"><span class="type">Unit</span><a id="2169">Unit</a></span> = {    
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a id="148208">intLoop</a></span> = <span class="typed"><span class="type">()scala.tools.nsc.InterpreterLoop</span><a href="InterpreterLoop.scala.html#58062" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="InterpreterLoop.scala.html#7056">InterpreterLoop</a></span>
    <span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="#148208">intLoop</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.Settings)Unit</span><a href="InterpreterLoop.scala.html#58069">settings</a></span> = <span class="typed"><span class="type">scala.tools.nsc.Settings</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="Settings.scala.html#6744">Settings</a></span>(<span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="#148213" id="27062">println</a></span>)
    <span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="#148208">intLoop</a></span>.<span class="typed"><span class="type">()Unit</span><a href="InterpreterLoop.scala.html#58081">createInterpreter</a></span>
    <span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="#148208">intLoop</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.interpreter.InteractiveReader)Unit</span><a href="InterpreterLoop.scala.html#58064">in</a></span> = <span class="typed"><span class="type">object scala.tools.nsc.interpreter.InteractiveReader</span><a href="interpreter/InteractiveReader.scala.html#17670">InteractiveReader</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.Interpreter)scala.tools.nsc.interpreter.InteractiveReader</span><a href="interpreter/InteractiveReader.scala.html#75914">createDefault</a></span>(<span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="#148208">intLoop</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Interpreter</span><a href="InterpreterLoop.scala.html#58071">interpreter</a></span>)
    
    <span class="comment">// rebind exit so people don't accidentally call System.exit by way of predef</span>
    <span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="#148208">intLoop</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Interpreter</span><a href="InterpreterLoop.scala.html#58071">interpreter</a></span>.<span class="typed"><span class="type">(=&gt; Unit)Unit</span><a href="#75370">beQuietDuring</a></span> {
      <span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="#148208">intLoop</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Interpreter</span><a href="InterpreterLoop.scala.html#58071">interpreter</a></span>.<span class="typed"><span class="type">(String)scala.tools.nsc.InterpreterResults.Result</span><a href="#75417">interpret</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;def exit = println(&quot;Type :quit to resume program execution.&quot;)&quot;)</span><span class="string">&quot;&quot;&quot;def exit = println(&quot;Type :quit to resume program execution.&quot;)&quot;&quot;&quot;</span></span>)
      <span class="typed"><span class="type">(Any)Unit</span><span id="6112"><a id="821">println</a></span></span>(<span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="#148208">intLoop</a></span>.<span class="typed"><span class="type">(List[Any])String</span><a href="InterpreterLoop.scala.html#58108">inject</a></span>(<span class="typed"><span class="type">List[Any]</span><a href="#121431">args</a></span>))
    }
    <span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="#148208">intLoop</a></span>.<span class="typed"><span class="type">()Unit</span><a href="InterpreterLoop.scala.html#58097">repl</a></span>()
    <span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="#148208">intLoop</a></span>.<span class="typed"><span class="type">()Unit</span><a href="InterpreterLoop.scala.html#58080">closeInterpreter</a></span>
  }
  
  <span class="comment">/** Delete a directory tree recursively.  Use with care! */</span>
  <span class="keyword">private</span>[nsc] <span class="keyword">def</span> <span class="typed"><span class="type">(java.io.File)Unit</span><a id="114767">deleteRecursively</a></span>(<span class="typed"><span class="type">java.io.File</span><a id="114838">path</a></span>: <span class="typed"><span class="type">java.io.File</span><a id="3669">File</a></span>): <span class="typed"><span class="type">Unit</span><a id="2169">Unit</a></span> =
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">java.io.File</span><a href="#114838">path</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="40697">exists</a></span>) {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">java.io.File</span><a href="#114838">path</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="40698">isDirectory</a></span>)
        <span class="typed"><span class="type">java.io.File</span><a href="#114838">path</a></span>.<span class="typed"><span class="type">()Array[java.io.File]</span><a id="40708">listFiles</a></span> <span class="typed"><span class="type">((java.io.File) =&gt; Unit)Unit</span><a id="21792">foreach</a></span> <span class="typed"><span class="type">(java.io.File)Unit</span><a href="#114767">deleteRecursively</a></span>
          
      <span class="typed"><span class="type">java.io.File</span><a href="#114838">path</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="40704">delete</a></span>
    }

  <span class="comment">/** Heuristically strip interpreter wrapper prefixes
   *  from an interpreter output string.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)String</span><a id="114768">stripWrapperGunk</a></span>(<span class="typed"><span class="type">String</span><a id="146833">str</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="148221">wrapregex</a></span> = <span class="typed"><span class="type">java.lang.String(&quot;(line[0-9]+\$object[$.])?(\$iw[$.])*&quot;)</span><span class="string">&quot;&quot;&quot;(line[0-9]+\$object[$.])?(\$iw[$.])*&quot;&quot;&quot;</span></span>
    <span class="typed"><span class="type">String</span><a href="#146833">str</a></span>.<span class="typed"><span class="type">(java.lang.String,java.lang.String)java.lang.String</span><a id="5862">replaceAll</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#148221">wrapregex</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>)
  }
  
  <span class="keyword">def</span> <span class="typed"><span class="type">(Boolean,String*)String</span><a id="114769">codegenln</a></span>(<span class="typed"><span class="type">Boolean</span><a id="147588">leadingPlus</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span>, <span class="typed"><span class="type">String*</span><a id="147589">xs</a></span>: <span class="typed"><span class="type">String*</span><a id="2741">String</a></span>*): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = <span class="typed"><span class="type">(Boolean,String*)String</span><a href="#114772">codegen</a></span>(<span class="typed"><span class="type">Boolean</span><a href="#147588">leadingPlus</a></span>, (<span class="typed"><span class="type">String*</span><a href="#147589">xs</a></span> <span class="typed"><span class="type">(Iterable[String])Seq[String]</span><a id="21653">++</a></span> <span class="typed"><span class="type">(java.lang.String*)Array[java.lang.String]</span><span id="21530"><a id="1073">Array</a></span></span>(<span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>)): _*)
  <span class="keyword">def</span> <span class="typed"><span class="type">(String*)String</span><a id="114770">codegenln</a></span>(<span class="typed"><span class="type">String*</span><a id="147587">xs</a></span>: <span class="typed"><span class="type">String*</span><a id="2741">String</a></span>*): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = <span class="typed"><span class="type">(Boolean,String*)String</span><a href="#114769">codegenln</a></span>(<span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>, <span class="typed"><span class="type">String*</span><a href="#147587">xs</a></span>: _*)
  <span class="keyword">def</span> <span class="typed"><span class="type">(String*)String</span><a id="114771">codegen</a></span>(<span class="typed"><span class="type">String*</span><a id="148225">xs</a></span>: <span class="typed"><span class="type">String*</span><a id="2741">String</a></span>*): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = <span class="typed"><span class="type">(Boolean,String*)String</span><a href="#114772">codegen</a></span>(<span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>, <span class="typed"><span class="type">String*</span><a href="#148225">xs</a></span>: _*)
  <span class="keyword">def</span> <span class="typed"><span class="type">(Boolean,String*)String</span><a id="114772">codegen</a></span>(<span class="typed"><span class="type">Boolean</span><a id="148223">leadingPlus</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span>, <span class="typed"><span class="type">String*</span><a id="148224">xs</a></span>: <span class="typed"><span class="type">String*</span><a id="2741">String</a></span>*): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="148239">front</a></span> = <span class="typed"><span class="type">java.lang.String</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#148223">leadingPlus</a></span>) <span class="typed"><span class="type">java.lang.String(&quot;+ &quot;)</span><span class="string">&quot;+ &quot;</span></span> <span class="keyword">else</span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>
    <span class="typed"><span class="type">String*</span><a href="#148224">xs</a></span>.<span class="typed"><span class="type">((String) =&gt; java.lang.String)Seq[java.lang.String]</span><a id="21661">map</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;&quot;)</span><span class="string">&quot;\&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">(String)String</span><a href="#114773">string2code</a></span>(<span class="typed"><span class="type">String</span><a href="#148242">_</a></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;&quot;)</span><span class="string">&quot;\&quot;&quot;</span></span>).<span class="typed"><span class="type">(String,String,String)String</span><a id="21818">mkString</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#148239">front</a></span>, <span class="typed"><span class="type">java.lang.String(&quot; + &quot;)</span><span class="string">&quot; + &quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>)
  }

  <span class="comment">/** Convert a string into code that can recreate the string.
   *  This requires replacing all special characters by escape
   *  codes. It does not add the surrounding &quot; marks.  */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)String</span><a id="114773">string2code</a></span>(<span class="typed"><span class="type">String</span><a id="147594">str</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="comment">/** Convert a character to a backslash-u escape */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(Char)String</span><a id="148248">char2uescape</a></span>(<span class="typed"><span class="type">Char</span><a id="148250">c</a></span>: <span class="typed"><span class="type">Char</span><a id="2389">Char</a></span>): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
      <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="148251">rest</a></span> = <span class="typed"><span class="type">Char</span><a href="#148250">c</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="2976">toInt</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="148252">buf</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a id="23671" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a id="1435">StringBuilder</a></span>
      <span class="keyword">for</span> (<span class="typed"><span class="type">((Int) =&gt; Unit)Unit</span><span id="40475"><a id="148262">i</a></span></span> &lt;- <span class="typed"><span class="type">implicit scala.Predef.intWrapper : (Int)scala.runtime.RichInt</span><span id="6133"><a id="821" class="int">1</a></span></span> <span class="typed"><span class="type">(Int)Range.Inclusive</span><a id="26780">to</a></span> <span class="typed"><span class="type">Int(4)</span><span class="int">4</span></span>) {
        <span class="typed"><span class="type">implicit scala.Predef.stringBuilderWrapper : (StringBuilder)scala.runtime.RichStringBuilder</span><span id="6141"><a href="#148252" id="821">buf</a></span></span> <span class="typed"><span class="type">(Iterable[Char])Unit</span><a id="31608">++=</a></span> (<span class="typed"><span class="type">Int</span><a href="#148251">rest</a></span> <span class="typed"><span class="type">implicit scala.Predef.intWrapper : (Int)scala.runtime.RichInt</span><span id="6133"><span id="821"><a id="3151">%</a></span></span></span> <span class="typed"><span class="type">Int(16)</span><span class="int">16</span></span>).<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><span id="821"><a id="26785">toHexString</a></span></span></span>
        <span class="typed"><span class="type">Int</span><a href="#148251">rest</a></span> = <span class="typed"><span class="type">Int</span><a href="#148251">rest</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3150">/</a></span> <span class="typed"><span class="type">Int(16)</span><span class="int">16</span></span>
      }
      <span class="typed"><span class="type">java.lang.String(&quot;\u&quot;)</span><span class="string">&quot;\\u&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="#148252">buf</a></span>.<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><span id="821"><a id="23723">toString</a></span></span></span>.<span class="typed"><span class="type">=&gt; scala.runtime.RichString</span><a id="22835">reverse</a></span>
    }
    
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="148249">res</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a id="23671" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a id="1435">StringBuilder</a></span>
    <span class="keyword">for</span> (<span class="typed"><span class="type">((Char) =&gt; Unit)Unit</span><span id="21792"><a id="148312">c</a></span></span> &lt;- <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a href="#147594" id="821">str</a></span></span>) <span class="typed"><span class="type">Char</span><a href="#148312">c</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span> | <span class="typed"><span class="type">Char(''')</span><span class="char">'\''</span></span> | <span class="typed"><span class="type">Char('\')</span><span class="char">'\\'</span></span>  =&gt; <span class="typed"><span class="type">implicit scala.Predef.stringBuilderWrapper : (StringBuilder)scala.runtime.RichStringBuilder</span><span id="6141"><a href="#148249" id="821">res</a></span></span> <span class="typed"><span class="type">(Char)Unit</span><a id="31607">+=</a></span> <span class="typed"><span class="type">Char('\')</span><span class="char">'\\'</span></span> ; <span class="typed"><span class="type">implicit scala.Predef.stringBuilderWrapper : (StringBuilder)scala.runtime.RichStringBuilder</span><span id="6141"><a href="#148249" id="821">res</a></span></span> <span class="typed"><span class="type">(Char)Unit</span><a id="31607">+=</a></span> <span class="typed"><span class="type">Char</span><a href="#148312">c</a></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ <span class="keyword">if</span> <span class="typed"><span class="type">implicit scala.Predef.charWrapper : (Char)scala.runtime.RichChar</span><span id="6134"><a href="#148312" id="821">c</a></span></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="27429">isControl</a></span>   =&gt; <span class="typed"><span class="type">implicit scala.Predef.stringBuilderWrapper : (StringBuilder)scala.runtime.RichStringBuilder</span><span id="6141"><a href="#148249" id="821">res</a></span></span> <span class="typed"><span class="type">(Iterable[Char])Unit</span><a id="31608">++=</a></span> <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a href="#148248" id="821">char2uescape</a></span></span>(<span class="typed"><span class="type">Char</span><a href="#148312">c</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _                  =&gt; <span class="typed"><span class="type">implicit scala.Predef.stringBuilderWrapper : (StringBuilder)scala.runtime.RichStringBuilder</span><span id="6141"><a href="#148249" id="821">res</a></span></span> <span class="typed"><span class="type">(Char)Unit</span><a id="31607">+=</a></span> <span class="typed"><span class="type">Char</span><a href="#148312">c</a></span>
    }
    <span class="typed"><span class="type">StringBuilder</span><a href="#148249">res</a></span>.<span class="typed"><span class="type">()String</span><a id="23723">toString</a></span>
  }
}

        </pre>
    </body>
</html>