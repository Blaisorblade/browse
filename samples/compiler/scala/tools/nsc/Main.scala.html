<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/Main.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */</span>
<span class="comment">// $Id: Main.scala 16884 2009-01-09 16:52:09Z cunei $</span>

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> java.io.File

<span class="keyword">import</span> scala.tools.nsc.reporters.{Reporter, ConsoleReporter}
<span class="keyword">import</span> scala.tools.nsc.util.FakePos <span class="comment">//{Position}</span>

<span class="comment">/** The main class for NSC, a compiler for the programming
 *  language Scala.
 */</span>
<span class="keyword">object</span> <span class="typed"><span class="type">object scala.tools.nsc.Main</span><a id="7381">Main</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">java.lang.Object</span><a id="2165">AnyRef</a></span> <span class="keyword">with</span> <span class="typed"><span class="type">scala.tools.nsc.EvalLoop</span><a href="EvalLoop.scala.html#6447">EvalLoop</a></span> {

  <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="53110"><a id="53109">versionMsg</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;Scala compiler &quot;)</span><span class="string">&quot;Scala compiler &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">object scala.tools.nsc.Properties</span><a href="Properties.scala.html#7366">Properties</a></span>.<span class="typed"><span class="type">=&gt; java.lang.String</span><a id="46629">versionString</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; -- &quot;)</span><span class="string">&quot; -- &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">object scala.tools.nsc.Properties</span><a href="Properties.scala.html#7366">Properties</a></span>.<span class="typed"><span class="type">=&gt; String</span><a id="46631">copyrightString</a></span>

  <span class="keyword">val</span> <span class="typed"><span class="type">String</span><span id="53112"><a id="53111">prompt</a></span></span> = <span class="typed"><span class="type">object scala.tools.nsc.Properties</span><a href="Properties.scala.html#7366">Properties</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Properties.scala.html#46662">residentPromptString</a></span>

  <span class="keyword">var</span> <span class="typed"><span class="type">scala.tools.nsc.reporters.ConsoleReporter</span><span id="53115"><span id="53113"><span id="53114"><a id="53130">reporter</a></span></span></span></span>: <span class="typed"><span class="type">scala.tools.nsc.reporters.ConsoleReporter</span><a href="reporters/ConsoleReporter.scala.html#15935">ConsoleReporter</a></span> = _

  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="53116">error</a></span>(<span class="typed"><span class="type">String</span><a id="53131">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) {
    <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a href="reporters/Reporter.scala.html#34470">error</a></span>(<span class="comment">/*new Position */</span><span class="typed"><span class="type">(String)scala.tools.nsc.util.FakePos</span><a href="util/Position.scala.html#53133">FakePos</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;scalac&quot;)</span><span class="string">&quot;scalac&quot;</span></span>),
                   <span class="typed"><span class="type">String</span><a href="#53131">msg</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;\012  scalac -help  gives more information&quot;)</span><span class="string">&quot;\n  scalac -help  gives more information&quot;</span></span>)
  }

  <span class="comment">/* needed ?? */</span>
  <span class="comment">//def errors() = reporter.errors</span>

  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.Global)Unit</span><a id="53117">resident</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Global</span><a id="53141">compiler</a></span>: <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="Global.scala.html#6489">Global</a></span>) {
    <span class="typed"><span class="type">((String) =&gt; Unit)Unit</span><a href="EvalLoop.scala.html#53123">loop</a></span> { <span class="typed"><span class="type">String</span><a id="53144">line</a></span> =&gt;
      <span class="keyword">val</span> <span class="typed"><span class="type">List[String]</span><a id="53145">args</a></span> = <span class="typed"><span class="type">object List</span><a id="527">List</a></span>.<span class="typed"><span class="type">(String,Char)List[String]</span><a id="21444">fromString</a></span>(<span class="typed"><span class="type">String</span><a href="#53144">line</a></span>, <span class="typed"><span class="type">Char(' ')</span><span class="char">' '</span></span>)
      <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a id="53146">command</a></span> = <span class="typed"><span class="type">(List[String],scala.tools.nsc.Settings,(String) =&gt; Unit,Boolean)scala.tools.nsc.CompilerCommand</span><a href="CompilerCommand.scala.html#53165" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="CompilerCommand.scala.html#6909">CompilerCommand</a></span>(<span class="typed"><span class="type">List[String]</span><a href="#53145">args</a></span>, <span class="typed"><span class="type">scala.tools.nsc.Settings</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="Settings.scala.html#6744">Settings</a></span>(<span class="typed"><span class="type">(String)Unit</span><a href="#53116">error</a></span>), <span class="typed"><span class="type">(String)Unit</span><a href="#53116">error</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
      (<span class="typed"><span class="type">compiler.Run</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="#53141">compiler</a></span>.<span class="typed"><span class="type">compiler.Run</span><a href="Global.scala.html#21313">Run</a></span>) <span class="typed"><span class="type">(List[String])Unit</span><a href="Global.scala.html#36590">compile</a></span> <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53146">command</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a href="CompilerCommand.scala.html#53171">files</a></span>
    }
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(Array[String])Unit</span><a id="53118">process</a></span>(<span class="typed"><span class="type">Array[String]</span><a id="53206">args</a></span>: <span class="typed"><span class="type">Array[String]</span><a id="1072">Array</a></span>[String]) {
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a id="53207">settings</a></span> = <span class="typed"><span class="type">scala.tools.nsc.Settings</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="Settings.scala.html#6744">Settings</a></span>(<span class="typed"><span class="type">(String)Unit</span><a href="#53116">error</a></span>)
    <span class="typed"><span class="type">(scala.tools.nsc.reporters.ConsoleReporter)Unit</span><a href="#53114">reporter</a></span> = <span class="typed"><span class="type">(scala.tools.nsc.Settings)scala.tools.nsc.reporters.ConsoleReporter</span><a href="reporters/ConsoleReporter.scala.html#46758" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.reporters.ConsoleReporter</span><a href="reporters/ConsoleReporter.scala.html#15935">ConsoleReporter</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="#53207">settings</a></span>)
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a id="53208">command</a></span> = <span class="typed"><span class="type">(List[String],scala.tools.nsc.Settings,(String) =&gt; Unit,Boolean)scala.tools.nsc.CompilerCommand</span><a href="CompilerCommand.scala.html#53165" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="CompilerCommand.scala.html#6909">CompilerCommand</a></span>(<span class="typed"><span class="type">object List</span><a id="527">List</a></span>.<span class="typed"><span class="type">(Array[String])List[String]</span><a id="21440">fromArray</a></span>(<span class="typed"><span class="type">Array[String]</span><a href="#53206">args</a></span>), <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="#53207">settings</a></span>, <span class="typed"><span class="type">(String)Unit</span><a href="#53116">error</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="CompilerCommand.scala.html#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#29988">version</a></span>.<span class="typed"><span class="type">=&gt; command.settings.version.T</span><a href="Settings.scala.html#30301">value</a></span>)
      <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.util.Position,String,Boolean)Unit</span><a href="reporters/Reporter.scala.html#34468">info</a></span>(<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#53109">versionMsg</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
    <span class="keyword">else</span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="CompilerCommand.scala.html#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.ChoiceSetting</span><a href="Settings.scala.html#29980">target</a></span>.<span class="typed"><span class="type">=&gt; command.settings.target.T</span><a href="Settings.scala.html#30301">value</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;msil&quot;)</span><span class="string">&quot;msil&quot;</span></span>) {
        <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="53226">libpath</a></span> = <span class="typed"><span class="type">object java.lang.System</span><a id="1886">System</a></span>.<span class="typed"><span class="type">(java.lang.String)java.lang.String</span><a id="47450">getProperty</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;msil.libpath&quot;)</span><span class="string">&quot;msil.libpath&quot;</span></span>)
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">java.lang.String</span><a href="#53226">libpath</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)
          <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="CompilerCommand.scala.html#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#29994">assemrefs</a></span>.<span class="typed"><span class="type">(command.settings.assemrefs.T)Unit</span><a href="Settings.scala.html#30302">value</a></span> =
            <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="CompilerCommand.scala.html#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#29994">assemrefs</a></span>.<span class="typed"><span class="type">=&gt; command.settings.assemrefs.T</span><a href="Settings.scala.html#30301">value</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">object java.io.File</span><a id="3670">File</a></span>.<span class="typed"><span class="type">java.lang.String</span><a id="40677">pathSeparator</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#53226">libpath</a></span>
      }
      <span class="keyword">try</span> {
        <span class="keyword">object</span> <span class="typed"><span class="type">object compiler</span><a id="53256">compiler</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="Global.scala.html#6489">Global</a></span>(<span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="CompilerCommand.scala.html#53159">settings</a></span>, <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>)
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="reporters/Reporter.scala.html#34460">hasErrors</a></span>) {
          <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>.<span class="typed"><span class="type">()Unit</span><a href="reporters/ConsoleReporter.scala.html#46768">flush</a></span>()
          <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span>
        }
        
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="CompilerCommand.scala.html#53183">shouldStopWithInfo</a></span>) {
          <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.util.Position,String,Boolean)Unit</span><a href="reporters/Reporter.scala.html#34468">info</a></span>(<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.Global)String</span><a href="CompilerCommand.scala.html#53184">getInfoMessage</a></span>(<span class="typed"><span class="type">object compiler</span><a href="#53256">compiler</a></span>), <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
        } <span class="keyword">else</span> {
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="CompilerCommand.scala.html#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#30038">resident</a></span>.<span class="typed"><span class="type">=&gt; command.settings.resident.T</span><a href="Settings.scala.html#30301">value</a></span>)
            <span class="typed"><span class="type">(scala.tools.nsc.Global)Unit</span><a href="#53117">resident</a></span>(<span class="typed"><span class="type">object compiler</span><a href="#53256">compiler</a></span>)
          <span class="keyword">else</span> <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a href="CompilerCommand.scala.html#53171">files</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span>) {
            <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.util.Position,String,Boolean)Unit</span><a href="reporters/Reporter.scala.html#34468">info</a></span>(<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="CompilerCommand.scala.html#53178">usageMsg</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
            <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.util.Position,String,Boolean)Unit</span><a href="reporters/Reporter.scala.html#34468">info</a></span>(<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">object compiler</span><a href="#53256">compiler</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="plugins/Plugins.scala.html#22586">pluginOptionsHelp</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
          } <span class="keyword">else</span> {
            <span class="keyword">val</span> <span class="typed"><span class="type">compiler.Run</span><a id="53285">run</a></span> = <span class="typed"><span class="type">compiler.Run</span><span class="keyword">new</span></span> <span class="typed"><span class="type">object compiler</span><a href="#53256">compiler</a></span>.<span class="typed"><span class="type">compiler.Run</span><a href="Global.scala.html#21313">Run</a></span>
            <span class="typed"><span class="type">compiler.Run</span><a href="#53285">run</a></span> <span class="typed"><span class="type">(List[String])Unit</span><a href="Global.scala.html#36590">compile</a></span> <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a href="CompilerCommand.scala.html#53171">files</a></span>
            <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>.<span class="typed"><span class="type">()Unit</span><a href="reporters/ConsoleReporter.scala.html#46765">printSummary</a></span>()
          }
        }
      } <span class="keyword">catch</span> {
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">scala.tools.nsc.FatalError</span><a id="53286">ex</a></span> @ <a id="1">FatalError</a>(<span class="typed"><span class="type">String</span><a id="53294">msg</a></span>) =&gt;
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="#53208">command</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="CompilerCommand.scala.html#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#30066">debug</a></span>.<span class="typed"><span class="type">=&gt; command.settings.debug.T</span><a href="Settings.scala.html#30301">value</a></span>)
            <span class="typed"><span class="type">scala.tools.nsc.FatalError</span><a href="#53286">ex</a></span>.<span class="typed"><span class="type">()Unit</span><a id="23651">printStackTrace</a></span>();
        <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a href="reporters/Reporter.scala.html#34470">error</a></span>(<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;fatal error: &quot;)</span><span class="string">&quot;fatal error: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">String</span><a href="#53294">msg</a></span>)
      }
    }
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(Array[String])Unit</span><a id="53119">main</a></span>(<span class="typed"><span class="type">Array[String]</span><a id="53296">args</a></span>: <span class="typed"><span class="type">Array[String]</span><a id="1072">Array</a></span>[String]) {
    <span class="typed"><span class="type">(Array[String])Unit</span><a href="#53118">process</a></span>(<span class="typed"><span class="type">Array[String]</span><a href="#53296">args</a></span>)
    <span class="typed"><span class="type">(Int)Nothing</span><span id="6002"><a id="821">exit</a></span></span>(<span class="typed"><span class="type">Int</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.ConsoleReporter</span><a href="#53113">reporter</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="reporters/Reporter.scala.html#34460">hasErrors</a></span>) <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> <span class="keyword">else</span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
  }

}

        </pre>
    </body>
</html>