<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/CompilerCommand.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */</span>
<span class="comment">// $Id: CompilerCommand.scala 17313 2009-03-16 13:03:02Z extempore $</span>

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> Settings.Setting
<span class="keyword">import</span> java.io.IOException

<span class="comment">/** A class representing command line info for scalac */</span>
<span class="keyword">class</span> <span class="typed"><span class="type">class CompilerCommand extends java.lang.Object with ScalaObject</span><a id="6909">CompilerCommand</a></span>(
  <span class="typed"><span class="type">List[String]</span><span id="53158"><a id="53194">arguments</a></span></span>: <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String],
  <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.Settings</span><span id="53160"><span id="53159"><a id="53195">settings</a></span></span></span>: <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="Settings.scala.html#6744">Settings</a></span>,
  <span class="typed"><span class="type">(String) =&gt; Unit</span><span id="53161"><a id="53196">error</a></span></span>: String =&gt; Unit,
  <span class="typed"><span class="type">Boolean</span><span id="53162"><a id="53197">interactive</a></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span>,
  <span class="typed"><span class="type">Boolean</span><span id="53163"><a id="53198">shouldProcessArguments</a></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span>)
{
  <span class="keyword">def</span> <span class="typed"><span class="type">(List[String],scala.tools.nsc.Settings,(String) =&gt; Unit,Boolean)scala.tools.nsc.CompilerCommand</span><a id="53165" class="keyword">this</a></span>(<span class="typed"><span class="type">List[String]</span><a id="53190">arguments</a></span>: <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String], <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a id="53191">settings</a></span>: <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="Settings.scala.html#6744">Settings</a></span>, <span class="typed"><span class="type">(String) =&gt; Unit</span><a id="53192">error</a></span>: String =&gt; Unit, <span class="typed"><span class="type">Boolean</span><a id="53193">interactive</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span>) =
    <span class="typed"><span class="type">CompilerCommand.this.type</span><a href="#6909" class="keyword">this</a></span>(<span class="typed"><span class="type">List[String]</span><a href="#53190">arguments</a></span>, <span class="typed"><span class="type">scala.tools.nsc.Settings</span><a href="#53191">settings</a></span>, <span class="typed"><span class="type">(String) =&gt; Unit</span><a href="#53192">error</a></span>, <span class="typed"><span class="type">Boolean</span><a href="#53193">interactive</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
    
  <span class="comment">/** file extensions of files that the compiler can process */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">List[java.lang.String]</span><a id="53167">fileEndings</a></span> = <span class="typed"><span class="type">object scala.tools.nsc.Properties</span><a href="Properties.scala.html#7366">Properties</a></span>.<span class="typed"><span class="type">=&gt; List[java.lang.String]</span><a href="Properties.scala.html#46668">fileEndings</a></span>

  <span class="comment">/** Private buffer for accumulating files to compile */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">List[String]</span><span id="53170"><span id="53168"><span id="53169"><a id="126628">fs</a></span></span></span></span>: <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String] = <span class="typed"><span class="type">object Nil</span><a id="335">List</a></span>()

  <span class="comment">/** Public list of files to compile */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[String]</span><a id="53171">files</a></span>: <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String] = <span class="typed"><span class="type">=&gt; List[String]</span><a href="#53168">fs</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a id="21385">reverse</a></span>

  <span class="comment">/** The name of the command */</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="53173"><a id="53172">cmdName</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;scalac&quot;)</span><span class="string">&quot;scalac&quot;</span></span>

  <span class="keyword">private</span> <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><span id="53175"><a id="53174">helpSyntaxColumnWidth</a></span></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> =
    <span class="typed"><span class="type">object Iterable</span><a id="404">Iterable</a></span>.<span class="typed"><span class="type">(Iterable[Int])(implicit (Int) =&gt; Ordered[Int])Int</span><span id="21842"><span id="6133"><a href="#126676" id="821">max</a></span></span></span>(<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; List[scala.tools.nsc.Settings.Setting]</span><a href="Settings.scala.html#29944">allSettings</a></span> <span class="typed"><span class="type">((scala.tools.nsc.Settings.Setting) =&gt; Int)List[Int]</span><a id="21362">map</a></span> (<span class="typed"><span class="type">scala.tools.nsc.Settings.Setting</span><a href="#126671">_</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Settings.scala.html#30254">helpSyntax</a></span>.<span class="typed"><span class="type">()Int</span><a id="5821">length</a></span>))

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)String</span><a id="53176">format</a></span>(<span class="typed"><span class="type">String</span><a id="126680">s</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="126681">buf</a></span> = <span class="typed"><span class="type">(String)StringBuilder</span><a id="23673" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a id="1435">StringBuilder</a></span>(<span class="typed"><span class="type">String</span><a href="#126680">s</a></span>)
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="126682">i</a></span> = <span class="typed"><span class="type">String</span><a href="#126680">s</a></span>.<span class="typed"><span class="type">()Int</span><a id="5821">length</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#126683" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#126682">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#53174">helpSyntaxColumnWidth</a></span>) { <span class="typed"><span class="type">StringBuilder</span><a href="#126681">buf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a id="23697">append</a></span>(<span class="typed"><span class="type">Char(' ')</span><span class="char">' '</span></span>); <span class="typed"><span class="type">Int</span><a href="#126682">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> }
    <span class="typed"><span class="type">StringBuilder</span><a href="#126681">buf</a></span>.<span class="typed"><span class="type">()String</span><a id="23723">toString</a></span>()
  }
  
  <span class="comment">/** Creates a help message for a subset of options based on cond */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String,(scala.tools.nsc.Settings.Setting) =&gt; Boolean)String</span><a id="53177">createUsageMsg</a></span>(<span class="typed"><span class="type">String</span><a id="53279">label</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>, <span class="typed"><span class="type">(scala.tools.nsc.Settings.Setting) =&gt; Boolean</span><a id="53280">cond</a></span>: (Setting) =&gt; Boolean): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> =
    <span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; List[scala.tools.nsc.Settings.Setting]</span><a href="Settings.scala.html#29944">allSettings</a></span> .
      <span class="typed"><span class="type">((scala.tools.nsc.Settings.Setting) =&gt; Boolean)List[scala.tools.nsc.Settings.Setting]</span><a id="21367">filter</a></span>(<span class="typed"><span class="type">(scala.tools.nsc.Settings.Setting) =&gt; Boolean</span><a href="#53280">cond</a></span>) .
      <span class="typed"><span class="type">((scala.tools.nsc.Settings.Setting) =&gt; java.lang.String)List[java.lang.String]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Settings.Setting</span><a id="126715">s</a></span> =&gt; <span class="typed"><span class="type">(String)String</span><a href="#53176">format</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Settings.Setting</span><a href="#126715">s</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Settings.scala.html#30254">helpSyntax</a></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;  &quot;)</span><span class="string">&quot;  &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">scala.tools.nsc.Settings.Setting</span><a href="#126715">s</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Settings.scala.html#30261">helpDescription</a></span>) . 
      <span class="typed"><span class="type">(String,String,String)String</span><a id="21818">mkString</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><span id="6140"><a id="821" class="string">&quot;Usage: %s &lt;options&gt; &lt;source files&gt;\n%s options include:\n  &quot;</a></span></span> .
        <span class="typed"><span class="type">(Any*)String</span><a id="23119">format</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#53172">cmdName</a></span>, <span class="typed"><span class="type">String</span><a href="#53279">label</a></span>), <span class="typed"><span class="type">java.lang.String(&quot;\012  &quot;)</span><span class="string">&quot;\n  &quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>)

  <span class="comment">/** Messages explaining usage and options */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="53178">usageMsg</a></span>    = <span class="typed"><span class="type">(String,(scala.tools.nsc.Settings.Setting) =&gt; Boolean)String</span><a href="#53177">createUsageMsg</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;where possible standard&quot;)</span><span class="string">&quot;where possible standard&quot;</span></span>, <span class="typed"><span class="type">scala.tools.nsc.Settings.Setting</span><a href="#53282">_</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="Settings.scala.html#30268">isStandard</a></span>)
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="53179">xusageMsg</a></span>   = <span class="typed"><span class="type">(String,(scala.tools.nsc.Settings.Setting) =&gt; Boolean)String</span><a href="#53177">createUsageMsg</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Possible advanced&quot;)</span><span class="string">&quot;Possible advanced&quot;</span></span>, <span class="typed"><span class="type">scala.tools.nsc.Settings.Setting</span><a href="#125842">_</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="Settings.scala.html#30269">isAdvanced</a></span>)
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="53180">yusageMsg</a></span>   = <span class="typed"><span class="type">(String,(scala.tools.nsc.Settings.Setting) =&gt; Boolean)String</span><a href="#53177">createUsageMsg</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Possible private&quot;)</span><span class="string">&quot;Possible private&quot;</span></span>, <span class="typed"><span class="type">scala.tools.nsc.Settings.Setting</span><a href="#126647">_</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="Settings.scala.html#30270">isPrivate</a></span>)

  <span class="comment">// If any of these settings is set, the compiler shouldn't start;</span>
  <span class="comment">// an informative message of some sort should be printed instead.</span>
  <span class="comment">// (note: do not add &quot;files.isEmpty&quot; do this list)</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">List[(() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)]</span><span id="53182"><a id="53181">stopSettings</a></span></span> = <span class="typed"><span class="type">((() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)*)List[(() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)]</span><span id="21328"><a id="527">List</a></span></span>[<span class="typed"><span class="type">(() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)</span><a id="1378">(</a></span>() =&gt; Boolean, (Global) =&gt; String)](
    <span class="typed"><span class="type">(() =&gt; CompilerCommand.this.settings.help.T,(scala.tools.nsc.Global) =&gt; java.lang.String)(() =&gt; CompilerCommand.this.settings.help.T, (scala.tools.nsc.Global) =&gt; java.lang.String)</span><span id="23625"><a id="1379">(</a></span></span><span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#29968">help</a></span>.<span class="typed"><span class="type">=&gt; CompilerCommand.this.settings.help.T</span><a href="Settings.scala.html#30301">value</a></span> _,         <span class="typed"><span class="type">=&gt; String</span><a href="#53178">usageMsg</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="#126633">_</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="plugins/Plugins.scala.html#22586">pluginOptionsHelp</a></span>),
    <span class="typed"><span class="type">(() =&gt; CompilerCommand.this.settings.Xhelp.T,(scala.tools.nsc.Global) =&gt; String)(() =&gt; CompilerCommand.this.settings.Xhelp.T, (scala.tools.nsc.Global) =&gt; String)</span><span id="23625"><a id="1379">(</a></span></span><span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#29990">Xhelp</a></span>.<span class="typed"><span class="type">=&gt; CompilerCommand.this.settings.Xhelp.T</span><a href="Settings.scala.html#30301">value</a></span> _,        <span class="typed"><span class="type">scala.tools.nsc.Global</span><a id="126638">_</a></span> =&gt; <span class="typed"><span class="type">=&gt; String</span><a href="#53179">xusageMsg</a></span>),
    <span class="typed"><span class="type">(() =&gt; CompilerCommand.this.settings.Yhelp.T,(scala.tools.nsc.Global) =&gt; String)(() =&gt; CompilerCommand.this.settings.Yhelp.T, (scala.tools.nsc.Global) =&gt; String)</span><span id="23625"><a id="1379">(</a></span></span><span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#30052">Yhelp</a></span>.<span class="typed"><span class="type">=&gt; CompilerCommand.this.settings.Yhelp.T</span><a href="Settings.scala.html#30301">value</a></span> _,        <span class="typed"><span class="type">scala.tools.nsc.Global</span><a id="126643">_</a></span> =&gt; <span class="typed"><span class="type">=&gt; String</span><a href="#53180">yusageMsg</a></span>),
    <span class="typed"><span class="type">(() =&gt; CompilerCommand.this.settings.showPlugins.T,(scala.tools.nsc.Global) =&gt; String)(() =&gt; CompilerCommand.this.settings.showPlugins.T, (scala.tools.nsc.Global) =&gt; String)</span><span id="23625"><a id="1379">(</a></span></span><span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#30022">showPlugins</a></span>.<span class="typed"><span class="type">=&gt; CompilerCommand.this.settings.showPlugins.T</span><a href="Settings.scala.html#30301">value</a></span> _,  <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="#126653">_</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="plugins/Plugins.scala.html#22584">pluginDescriptions</a></span>),
    <span class="typed"><span class="type">(() =&gt; CompilerCommand.this.settings.showPhases.T,(scala.tools.nsc.Global) =&gt; String)(() =&gt; CompilerCommand.this.settings.showPhases.T, (scala.tools.nsc.Global) =&gt; String)</span><span id="23625"><a id="1379">(</a></span></span><span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#30046">showPhases</a></span>.<span class="typed"><span class="type">=&gt; CompilerCommand.this.settings.showPhases.T</span><a href="Settings.scala.html#30301">value</a></span> _,   <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="#126658">_</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Global.scala.html#21301">phaseDescriptions</a></span>)
  )
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="53183">shouldStopWithInfo</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = <span class="typed"><span class="type">=&gt; List[(() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)]</span><a href="#53181">stopSettings</a></span> <span class="typed"><span class="type">(((() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)) =&gt; Boolean)Boolean</span><a id="21373">exists</a></span> { <span class="typed"><span class="type">(() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)</span><a href="#126728">_</a></span>.<span class="typed"><span class="type">()Boolean</span><span id="31093"><a id="23614">_1</a></span></span>() }

  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.Global)String</span><a id="53184">getInfoMessage</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Global</span><a id="53275">compiler</a></span>: <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="Global.scala.html#6489">Global</a></span>): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> =
    <span class="typed"><span class="type">=&gt; List[(() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)]</span><a href="#53181">stopSettings</a></span>.<span class="typed"><span class="type">(((() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)) =&gt; Boolean)Option[(() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)]</span><a id="21374">find</a></span>(<span class="typed"><span class="type">(() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)</span><a id="126730">pair</a></span> =&gt; (<span class="typed"><span class="type">(() =&gt; Boolean, (scala.tools.nsc.Global) =&gt; String)</span><a href="#126730">pair</a></span>.<span class="typed"><span class="type">()Boolean</span><span id="31093"><a id="23614">_1</a></span></span>)()) <span class="typed"><span class="type">String</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">String</span><span class="keyword">case</span></span> <a id="1">Some</a>(<a id="1">(</a><span class="typed"><span class="type">() =&gt; Boolean</span><a id="126731">test</a></span>, <span class="typed"><span class="type">(scala.tools.nsc.Global) =&gt; String</span><a id="126732">getMessage</a></span>)) =&gt; <span class="typed"><span class="type">(scala.tools.nsc.Global)String</span><a href="#126732" id="21757">getMessage</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="#53275">compiler</a></span>)
      <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span> =&gt; <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>
    }

  <span class="comment">/** Whether the command was processed okay */</span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="53187"><span id="53185"><span id="53186"><a id="126659">ok</a></span></span></span></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>

  <span class="comment">/** Process the arguments and update the settings accordingly.
      This method is called only once, during initialization.  */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="53188">processArguments</a></span>() {
    <span class="comment">// initialization</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">List[String]</span><a id="126733">args</a></span> = <span class="typed"><span class="type">List[String]</span><a href="#53158">arguments</a></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="126734">errorAndNotOk</a></span>(<span class="typed"><span class="type">String</span><a id="126739">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = { <span class="typed"><span class="type">(String)Unit</span><a href="#53161" id="21757">error</a></span>(<span class="typed"><span class="type">String</span><a href="#126739">msg</a></span>) ; <span class="typed"><span class="type">(Boolean)Unit</span><a href="#53186">ok</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span> }
    
    <span class="comment">// given a @ argument expands it out</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="126735">doExpand</a></span>(<span class="typed"><span class="type">String</span><a id="126740">x</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = 
      <span class="keyword">try</span>   { <span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span> = util.<span class="typed"><span class="type">object scala.tools.nsc.util.ArgumentsExpander</span><a href="util/ArgumentsExpander.scala.html#8265">ArgumentsExpander</a></span>.<span class="typed"><span class="type">(String)List[String]</span><a href="util/ArgumentsExpander.scala.html#74944">expandArg</a></span>(<span class="typed"><span class="type">String</span><a href="#126740">x</a></span>) <span class="typed"><span class="type">(List[String])List[String]</span><a href="#126741" id="21339">:::</a></span> <span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a id="21334">tail</a></span> }
      <span class="keyword">catch</span> { <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.io.IOException</span><a id="126744">ex</a></span>: <span class="typed"><span class="type">java.io.IOException</span><a id="3519">IOException</a></span>  =&gt; <span class="typed"><span class="type">(String)Unit</span><a href="#126734">errorAndNotOk</a></span>(<span class="typed"><span class="type">java.io.IOException</span><a href="#126744">ex</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="23646">getMessage</a></span>) }
    
    <span class="comment">// true if it's a legit looking source file</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="126736">isSourceFile</a></span>(<span class="typed"><span class="type">String</span><a id="126745">x</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) =
      (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#30040">script</a></span>.<span class="typed"><span class="type">=&gt; CompilerCommand.this.settings.script.T</span><a href="Settings.scala.html#30301">value</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span>
      (<span class="typed"><span class="type">=&gt; List[java.lang.String]</span><a href="#53166">fileEndings</a></span> <span class="typed"><span class="type">((java.lang.String) =&gt; Boolean)Boolean</span><a id="21373">exists</a></span> (<span class="typed"><span class="type">String</span><a href="#126745">x</a></span> <span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5842">endsWith</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#126749">_</a></span>))
    
    <span class="comment">// given an option for scalac finds out what it is</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="126737">doOption</a></span>(<span class="typed"><span class="type">String</span><a id="126750">x</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Unit</span><a id="2169">Unit</a></span> = {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#53162">interactive</a></span>)
        <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">(String)Unit</span><a href="#126734">errorAndNotOk</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;no options can be given in interactive mode&quot;)</span><span class="string">&quot;no options can be given in interactive mode&quot;</span></span>)
        
      <span class="keyword">val</span> <span class="typed"><span class="type">List[String]</span><a id="126751">argsLeft</a></span> = <span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#53159">settings</a></span>.<span class="typed"><span class="type">(List[String])List[String]</span><a href="Settings.scala.html#30126">parseParams</a></span>(<span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">List[String]</span><a href="#126751">argsLeft</a></span>) <span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span> = <span class="typed"><span class="type">List[String]</span><a href="#126751">argsLeft</a></span>
      <span class="keyword">else</span> <span class="typed"><span class="type">(String)Unit</span><a href="#126734">errorAndNotOk</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;bad option: '&quot;)</span><span class="string">&quot;bad option: '&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">String</span><a href="#126750">x</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;'&quot;)</span><span class="string">&quot;'&quot;</span></span>)
    }      
    
    <span class="comment">// cycle through args until empty or error</span>
    <span class="typed"><span class="type">Unit</span><a href="#126738" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a href="#53185">ok</a></span>) <span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span>.<span class="typed"><span class="type">=&gt; String</span><a id="21332">head</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">String</span><a id="126756">x</a></span> <span class="keyword">if</span> <span class="typed"><span class="type">String</span><a href="#126756">x</a></span> <span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5841">startsWith</a></span> <span class="typed"><span class="type">java.lang.String(&quot;@&quot;)</span><span class="string">&quot;@&quot;</span></span>  =&gt; <span class="typed"><span class="type">(String)Unit</span><a href="#126735">doExpand</a></span>(<span class="typed"><span class="type">String</span><a href="#126756">x</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">String</span><a id="126758">x</a></span> <span class="keyword">if</span> <span class="typed"><span class="type">String</span><a href="#126758">x</a></span> <span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5841">startsWith</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-&quot;)</span><span class="string">&quot;-&quot;</span></span>  =&gt; <span class="typed"><span class="type">(String)Unit</span><a href="#126737">doOption</a></span>(<span class="typed"><span class="type">String</span><a href="#126758">x</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">String</span><a id="126760">x</a></span> <span class="keyword">if</span> <span class="typed"><span class="type">(String)Boolean</span><a href="#126736">isSourceFile</a></span>(<span class="typed"><span class="type">String</span><a href="#126760">x</a></span>)   =&gt; <span class="typed"><span class="type">(List[String])Unit</span><a href="#53169">fs</a></span> = <span class="typed"><span class="type">String</span><a href="#126760">x</a></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#126761" id="21335">::</a></span> <span class="typed"><span class="type">=&gt; List[String]</span><a href="#53168">fs</a></span> ; <span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span> = <span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a id="21334">tail</a></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>                     =&gt; <span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span> = <span class="typed"><span class="type">List[String]</span><a href="#126733">args</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a id="21334">tail</a></span> <span class="comment">// quick fix [martin: for what?]</span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">String</span><a id="126764">x</a></span>                      =&gt; <span class="typed"><span class="type">(String)Unit</span><a href="#126734">errorAndNotOk</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;don't know what to do with &quot;)</span><span class="string">&quot;don't know what to do with &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">String</span><a href="#126764">x</a></span>)
    }

    <span class="typed"><span class="type">(Boolean)Unit</span><a href="#53186">ok</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;=</a></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="#53159">settings</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="Settings.scala.html#30124">checkDependencies</a></span>
  }

  <span class="comment">// CompilerCommand needs processArguments called at the end of its constructor,</span>
  <span class="comment">// as does its subclass GenericRunnerCommand, but it cannot be called twice as it</span>
  <span class="comment">// accumulates arguments.  The fact that it's called from within the constructors</span>
  <span class="comment">// makes initialization order an obstacle to simplicity.</span>
  <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#53163">shouldProcessArguments</a></span>)
    <span class="typed"><span class="type">()Unit</span><a href="#53188">processArguments</a></span>()
}

        </pre>
    </body>
</html>