<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/GenericRunnerCommand.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2007 LAMP/EPFL
 * @author  Lex Spoon
 */</span>

<span class="comment">// $Id: GenericRunnerCommand.scala 17288 2009-03-12 18:15:25Z extempore $</span>

<span class="keyword">package</span> scala.tools.nsc

<span class="comment">/** A command for ScriptRunner */</span>
<span class="keyword">class</span> <span class="typed"><span class="type">class GenericRunnerCommand extends scala.tools.nsc.CompilerCommand with ScalaObject</span><a id="7401">GenericRunnerCommand</a></span>(
  <span class="typed"><span class="type">List[String]</span><span id="57706"><a id="57737">allargs</a></span></span>: <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String], 
  <span class="keyword">override</span> <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><span id="57708"><span id="57707"><a href="CompilerCommand.scala.html#53159" id="57738">settings</a></span></span></span>: <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="GenericRunnerSettings.scala.html#7302">GenericRunnerSettings</a></span>,
  <span class="typed"><span class="type">(String) =&gt; Unit</span><span id="57709"><a id="57739">error</a></span></span>: String =&gt; Unit)
<span class="keyword">extends</span> <span class="typed"><span class="type">scala.tools.nsc.CompilerCommand</span><a href="CompilerCommand.scala.html#6909">CompilerCommand</a></span>(<span class="typed"><span class="type">List[String]</span><a href="#57737">allargs</a></span>, <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57738">settings</a></span>, <span class="typed"><span class="type">(String) =&gt; Unit</span><a href="#57739">error</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
{
  <span class="keyword">def</span> <span class="typed"><span class="type">(List[String],(String) =&gt; Unit)scala.tools.nsc.GenericRunnerCommand</span><a id="57711" class="keyword">this</a></span>(<span class="typed"><span class="type">List[String]</span><a id="57735">allargs</a></span>: <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String], <span class="typed"><span class="type">(String) =&gt; Unit</span><a id="57736">error</a></span>: String=&gt;Unit) =
    <span class="typed"><span class="type">GenericRunnerCommand.this.type</span><a href="#7401" class="keyword">this</a></span>(<span class="typed"><span class="type">List[String]</span><a href="#57735">allargs</a></span>, <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="GenericRunnerSettings.scala.html#7302">GenericRunnerSettings</a></span>(<span class="typed"><span class="type">(String) =&gt; Unit</span><a href="#57736">error</a></span>), <span class="typed"><span class="type">(String) =&gt; Unit</span><a href="#57736">error</a></span>)

  <span class="keyword">def</span> <span class="typed"><span class="type">(List[String])scala.tools.nsc.GenericRunnerCommand</span><a id="57712" class="keyword">this</a></span>(<span class="typed"><span class="type">List[String]</span><a id="57724">allargs</a></span>: <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String]) = 
    <span class="typed"><span class="type">(List[String],(String) =&gt; Unit)scala.tools.nsc.GenericRunnerCommand</span><a href="#57711" class="keyword">this</a></span>(<span class="typed"><span class="type">List[String]</span><a href="#57724">allargs</a></span>, <span class="typed"><span class="type">String</span><a id="158100">str</a></span> =&gt; <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Error: &quot;)</span><span class="string">&quot;Error: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">String</span><a href="#158100">str</a></span>))

  <span class="comment">/** name of the associated compiler command */</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="57714"><a id="57713">compCmdName</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;scalac&quot;)</span><span class="string">&quot;scalac&quot;</span></span>

  <span class="comment">/** What to run.  If it is None, then the interpreter should be started */</span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Option[String]</span><span id="57717"><span id="57715"><span id="57716"><a id="158067">thingToRun</a></span></span></span></span>: <span class="typed"><span class="type">Option[String]</span><a id="934">Option</a></span>[String] = <span class="typed"><span class="type">object None</span><a id="536">None</a></span>

  <span class="comment">/** Arguments to pass to the object or script to run */</span>
  <span class="keyword">var</span> <span class="typed"><span class="type">List[String]</span><span id="57720"><span id="57718"><span id="57719"><a id="158068">arguments</a></span></span></span></span>: <span class="typed"><span class="type">List[String]</span><a id="526">List</a></span>[String] = <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="57721">processArguments</a></span>() {
    <span class="keyword">var</span> <span class="typed"><span class="type">List[String]</span><a id="158103">args</a></span> = <span class="typed"><span class="type">List[String]</span><a href="#57706">allargs</a></span>

    <span class="typed"><span class="type">Unit</span><a href="#158104" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">List[String]</span><a href="#158103">args</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a href="CompilerCommand.scala.html#53185">ok</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">List[String]</span><a href="#158103">args</a></span>.<span class="typed"><span class="type">=&gt; String</span><a id="21332">head</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5841">startsWith</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;-&quot;)</span><span class="string">&quot;-&quot;</span></span>)) {
      <span class="keyword">val</span> <span class="typed"><span class="type">List[String]</span><a id="158107">args0</a></span> = <span class="typed"><span class="type">List[String]</span><a href="#158103">args</a></span>
      <span class="typed"><span class="type">List[String]</span><a href="#158103">args</a></span> = <span class="typed"><span class="type">=&gt; scala.tools.nsc.GenericRunnerSettings</span><a href="#57707">settings</a></span> <span class="typed"><span class="type">(List[String])List[String]</span><a href="Settings.scala.html#30126">parseParams</a></span> <span class="typed"><span class="type">List[String]</span><a href="#158103">args</a></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">List[String]</span><a href="#158103">args</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">List[String]</span><a href="#158107">args0</a></span>) {
        <span class="typed"><span class="type">(String)Unit</span><a href="#57709" id="21757">error</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;bad option: '&quot;)</span><span class="string">&quot;bad option: '&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">List[String]</span><a href="#158103">args</a></span>.<span class="typed"><span class="type">=&gt; String</span><a id="21332">head</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;'&quot;)</span><span class="string">&quot;'&quot;</span></span>)
        <span class="typed"><span class="type">(Boolean)Unit</span><a href="CompilerCommand.scala.html#53186">ok</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
      }
    }

    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">List[String]</span><a href="#158103">args</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span>) {
      <span class="typed"><span class="type">(Option[String])Unit</span><a href="#57716">thingToRun</a></span> = <span class="typed"><span class="type">(String)Some[String]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">List[String]</span><a href="#158103">args</a></span>.<span class="typed"><span class="type">=&gt; String</span><a id="21332">head</a></span>)
      <span class="typed"><span class="type">(List[String])Unit</span><a href="#57719">arguments</a></span> = <span class="typed"><span class="type">List[String]</span><a href="#158103">args</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a id="21334">tail</a></span>
    }
  }

  <span class="comment">// we can safely call processArguments since we passed the superclass shouldProcessArguments=false</span>
  <span class="typed"><span class="type">()Unit</span><a href="#57721">processArguments</a></span>()

  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; java.lang.String</span><a id="57722">usageMsg</a></span> = {
    <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="CompilerCommand.scala.html#53172">cmdName</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; [ &lt;option&gt; ]... [&lt;torun&gt; &lt;arguments&gt;]\012&quot;)</span><span class="string">&quot; [ &lt;option&gt; ]... [&lt;torun&gt; &lt;arguments&gt;]\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;All options to &quot;)</span><span class="string">&quot;All options to &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span><span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#57713">compCmdName</a></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span><span class="typed"><span class="type">java.lang.String(&quot; are allowed.  See &quot;)</span><span class="string">&quot; are allowed.  See &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span><span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#57713">compCmdName</a></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span><span class="typed"><span class="type">java.lang.String(&quot; -help.\012&quot;)</span><span class="string">&quot; -help.\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;&lt;torun&gt;, if present, is an object or script file to run.\012&quot;)</span><span class="string">&quot;&lt;torun&gt;, if present, is an object or script file to run.\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;If no &lt;torun&gt; is present, run an interactive shell.\012&quot;)</span><span class="string">&quot;If no &lt;torun&gt; is present, run an interactive shell.\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;Option -howtorun allows explicitly specifying how to run &lt;torun&gt;:\012&quot;)</span><span class="string">&quot;Option -howtorun allows explicitly specifying how to run &lt;torun&gt;:\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;    script: it is a script file\012&quot;)</span><span class="string">&quot;    script: it is a script file\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;    object: it is an object name\012&quot;)</span><span class="string">&quot;    object: it is an object name\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;    guess: (the default) try to guess\012&quot;)</span><span class="string">&quot;    guess: (the default) try to guess\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;Option -i requests that a file be pre-loaded.  It is only\012&quot;)</span><span class="string">&quot;Option -i requests that a file be pre-loaded.  It is only\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;meaningful for interactive shells.\012&quot;)</span><span class="string">&quot;meaningful for interactive shells.\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;Option -e requests that its argument be executed as Scala code.\012&quot;)</span><span class="string">&quot;Option -e requests that its argument be executed as Scala code.\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;Option -savecompiled requests that the compiled script be saved\012&quot;)</span><span class="string">&quot;Option -savecompiled requests that the compiled script be saved\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;for future use.\012&quot;)</span><span class="string">&quot;for future use.\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;Option -nocompdaemon requests that the fsc offline compiler not be used.\012&quot;)</span><span class="string">&quot;Option -nocompdaemon requests that the fsc offline compiler not be used.\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
    <span class="typed"><span class="type">java.lang.String(&quot;Option -Dproperty=value sets a Java system property.\012&quot;)</span><span class="string">&quot;Option -Dproperty=value sets a Java system property.\n&quot;</span></span>
  }
}

        </pre>
    </body>
</html>