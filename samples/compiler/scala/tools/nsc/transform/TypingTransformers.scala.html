<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/transform/TypingTransformers.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author Martin Odersky
 */
// $Id: TypingTransformers.scala 18387 2009-07-24 15:28:37Z odersky $

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> transform

<span class="keyword">import</span> util.Position
<span class="keyword">import</span> scala.collection.mutable.{Map, HashMap}

/** A base class for transforms.
 *  A transform contains a compiler phase which applies a tree transformer.
 */
<span class="keyword">trait</span> <a title="trait TypingTransformers extends java.lang.Object with ScalaObject" id="14308">TypingTransformers</a> <span title="ScalaObject">{</span>

  <span class="keyword">val</span> <a title="=&gt; scala.tools.nsc.Global" id="79305">global</a>: <a href="../Global.scala.html#8460" title="scala.tools.nsc.Global">Global</a>
  <span class="keyword">import</span> global._

  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class TypingTransformer extends TypingTransformers.this.global.Transformer with ScalaObject" id="79307">TypingTransformer</a><span title="ScalaObject">(</span><a title="TypingTransformers.this.global.CompilationUnit" id="98909">unit</a>: <a href="../CompilationUnits.scala.html#39196" title="TypingTransformers.this.global.CompilationUnit">CompilationUnit</a>) <span class="keyword">extends</span> <a href="../ast/Trees.scala.html#26773" title="TypingTransformers.this.global.Transformer">Transformer</a> {
    <span class="keyword">var</span> <a title="TypingTransformers.this.global.analyzer.Typer" id="98843">localTyper</a>: analyzer.<a href="../typechecker/Typers.scala.html#39921" title="TypingTransformers.this.global.analyzer.Typer">Typer</a> = <a href="../Global.scala.html#39102" title="object TypingTransformers.this.global.analyzer">analyzer</a>.<a href="../typechecker/Typers.scala.html#39880" title="(context: TypingTransformers.this.global.analyzer.Context)TypingTransformers.this.global.analyzer.Typer">newTyper</a>(
      <a href="../Global.scala.html#39102" title="object TypingTransformers.this.global.analyzer">analyzer</a>.<a href="../typechecker/Contexts.scala.html#39819" title="(unit: TypingTransformers.this.global.analyzer.global.CompilationUnit,tree: TypingTransformers.this.global.analyzer.global.Tree,erasedTypes: Boolean)TypingTransformers.this.global.analyzer.Context">rootContext</a>(<a href="#98909" title="TypingTransformers.this.global.CompilationUnit">unit</a>, <a href="../ast/Trees.scala.html#26602" title="object TypingTransformers.this.global.EmptyTree">EmptyTree</a>, <span title="Boolean(true)" class="keyword">true</span>))
    <span class="keyword">protected</span> <span class="keyword">var</span> <a title="TypingTransformers.this.global.Tree" id="98846">curTree</a>: <a href="../ast/Trees.scala.html#26593" title="TypingTransformers.this.global.Tree">Tree</a> = _
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(pos: scala.tools.nsc.util.Position)(tree: TypingTransformers.this.global.Tree)TypingTransformers.this.global.analyzer.global.Tree" id="98848">typedPos</a>(<a title="scala.tools.nsc.util.Position" id="575234">pos</a>: <a href="../util/Position.scala.html#14710" title="scala.tools.nsc.util.Position">Position</a>)(<a title="TypingTransformers.this.global.Tree" id="575235">tree</a>: <a href="../ast/Trees.scala.html#26593" title="TypingTransformers.this.global.Tree">Tree</a>) = <a href="../typechecker/Typers.scala.html#42640" title="(tree: TypingTransformers.this.global.analyzer.global.Tree)TypingTransformers.this.global.analyzer.global.Tree">localTyper</a> typed { <a href="../ast/Trees.scala.html#26784" title="(pos: scala.tools.nsc.util.Position)(tree: TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree">atPos</a>(<a href="#575234" title="scala.tools.nsc.util.Position">pos</a>)(<a href="#575235" title="TypingTransformers.this.global.Tree">tree</a>) }

    /** a typer for each enclosing class */
    <span class="keyword">var</span> <a title="scala.collection.mutable.Map[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]" id="98850">typers</a>: <a title="scala.collection.mutable.Map[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]" id="24789">Map</a>[Symbol, analyzer.Typer] = <span title="scala.collection.mutable.HashMap[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]" class="keyword">new</span> <a title="scala.collection.mutable.HashMap[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]" id="24954">HashMap</a>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="[A](owner: TypingTransformers.this.global.Symbol)(trans: =&gt; A)A" id="98852">atOwner</a>[<a title="&gt;: Nothing &lt;: Any" id="98854">A</a>](<a title="TypingTransformers.this.global.Symbol" id="99805">owner</a>: <a href="../symtab/Symbols.scala.html#26127" title="TypingTransformers.this.global.Symbol">Symbol</a>)(<a title="=&gt; A" id="99806">trans</a>: =&gt; A): <a href="#98854" title="A">A</a> = <a href="#98855" title="(tree: TypingTransformers.this.global.Tree,owner: TypingTransformers.this.global.Symbol)(trans: =&gt; A)A">atOwner</a>(<a href="#98846" title="=&gt; TypingTransformers.this.global.Tree">curTree</a>, <a href="#99805" title="TypingTransformers.this.global.Symbol">owner</a>)(<a href="#99806" title="=&gt; A">trans</a>)

    <span class="keyword">def</span> <a title="[A](tree: TypingTransformers.this.global.Tree,owner: TypingTransformers.this.global.Symbol)(trans: =&gt; A)A" id="98855">atOwner</a>[<a title="&gt;: Nothing &lt;: Any" id="98857">A</a>](<a title="TypingTransformers.this.global.Tree" id="99820">tree</a>: <a href="../ast/Trees.scala.html#26593" title="TypingTransformers.this.global.Tree">Tree</a>, <a title="TypingTransformers.this.global.Symbol" id="99821">owner</a>: <a href="../symtab/Symbols.scala.html#26127" title="TypingTransformers.this.global.Symbol">Symbol</a>)(<a title="=&gt; A" id="99822">trans</a>: =&gt; A): <a href="#98857" title="A">A</a> = {
      <span class="keyword">val</span> <a title="TypingTransformers.this.global.analyzer.Typer" id="584879">savedLocalTyper</a> = <a href="#98843" title="=&gt; TypingTransformers.this.global.analyzer.Typer">localTyper</a>
//      println(&quot;ttransformer atOwner: &quot; + owner + &quot; isPackage? &quot; + owner.isPackage)
      <a href="#98843" title="(x$1: TypingTransformers.this.global.analyzer.Typer)Unit">localTyper</a> = <a href="#98843" title="=&gt; TypingTransformers.this.global.analyzer.Typer">localTyper</a>.<a href="../typechecker/Typers.scala.html#42639" title="(tree: TypingTransformers.this.global.analyzer.global.Tree,owner: TypingTransformers.this.global.analyzer.global.Symbol)TypingTransformers.this.global.analyzer.Typer">atOwner</a>(<a href="#99820" title="TypingTransformers.this.global.Tree">tree</a>, <span title="TypingTransformers.this.global.analyzer.global.Symbol" class="keyword">if</span> (<a href="#99821" title="TypingTransformers.this.global.Symbol">owner</a>.<a href="../symtab/Symbols.scala.html#26917" title="=&gt; Boolean">isModule</a>) <a href="#99821" title="TypingTransformers.this.global.Symbol">owner</a>.<a href="../symtab/Symbols.scala.html#27059" title="=&gt; TypingTransformers.this.global.Symbol">moduleClass</a> <span class="keyword">else</span> <a href="#99821" title="TypingTransformers.this.global.Symbol">owner</a>)
      <a href="#98850" title="(kv: (TypingTransformers.this.global.Symbol, TypingTransformers.this.global.analyzer.Typer))scala.collection.mutable.Map[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]" id="44523">typers</a> += <a title="(x: TypingTransformers.this.global.Symbol,y: TypingTransformers.this.global.analyzer.Typer)(TypingTransformers.this.global.Symbol, TypingTransformers.this.global.analyzer.Typer)" id="693">Pair</a>(<a href="#99821" title="TypingTransformers.this.global.Symbol">owner</a>, <a href="#98843" title="=&gt; TypingTransformers.this.global.analyzer.Typer">localTyper</a>)
      <span class="keyword">val</span> <a title="A" id="584880">result</a> = <span class="keyword">super</span>.<a href="../ast/Trees.scala.html#45485" title="(owner: TypingTransformers.this.global.Symbol)(trans: =&gt; A)A">atOwner</a>(<a href="#99821" title="TypingTransformers.this.global.Symbol">owner</a>)(<a href="#99822" title="=&gt; A">trans</a>)
      <a href="#98843" title="(x$1: TypingTransformers.this.global.analyzer.Typer)Unit">localTyper</a> = <a href="#584879" title="TypingTransformers.this.global.analyzer.Typer">savedLocalTyper</a>
      <a href="#98850" title="(key: TypingTransformers.this.global.Symbol)scala.collection.mutable.Map[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]" id="44544">typers</a> -= <a href="#99821" title="TypingTransformers.this.global.Symbol">owner</a>
      <a href="#584880" title="A">result</a>
    }

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree" id="98858">transform</a>(<a title="TypingTransformers.this.global.Tree" id="99006">tree</a>: <a href="../ast/Trees.scala.html#26593" title="TypingTransformers.this.global.Tree">Tree</a>): <a href="../ast/Trees.scala.html#26593" title="TypingTransformers.this.global.Tree">Tree</a> = {
      <a href="#98846" title="(x$1: TypingTransformers.this.global.Tree)Unit">curTree</a> = <a href="#99006" title="TypingTransformers.this.global.Tree">tree</a>
      <a href="#99006" title="TypingTransformers.this.global.Tree">tree</a> <span title="TypingTransformers.this.global.Tree" class="keyword">match</span> {
        <span title="TypingTransformers.this.global.Tree" class="keyword">case</span> Template(_, _, _) =&gt;
          // enter template into context chain
          <a href="#98852" title="(owner: TypingTransformers.this.global.Symbol)(trans: =&gt; TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree">atOwner</a>(<a href="../ast/Trees.scala.html#45467" title="=&gt; TypingTransformers.this.global.Symbol">currentOwner</a>) { <a href="#784445" title="(tree: TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree" class="keyword">super</a>.<a title="(tree: TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree" id="784445">transform</a>(<a href="#99006" title="TypingTransformers.this.global.Tree">tree</a>) }
        <span title="TypingTransformers.this.global.Tree" class="keyword">case</span> PackageDef(_, _) =&gt;
          <a href="#98852" title="(owner: TypingTransformers.this.global.Symbol)(trans: =&gt; TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree">atOwner</a>(<a href="#99006" title="TypingTransformers.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="=&gt; TypingTransformers.this.global.Symbol">symbol</a>) { <a href="#784445" title="(tree: TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree" class="keyword">super</a>.transform(<a href="#99006" title="TypingTransformers.this.global.Tree">tree</a>) }
        <span title="TypingTransformers.this.global.Tree" class="keyword">case</span> _ =&gt;
          <span class="keyword">super</span>.<a href="../ast/Trees.scala.html#45473" title="(tree: TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree">transform</a>(<a href="#99006" title="TypingTransformers.this.global.Tree">tree</a>)
      }
    }
  }
}


        </pre>
    </body>
</html>