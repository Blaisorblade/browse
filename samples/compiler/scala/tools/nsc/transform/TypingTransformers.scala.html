<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/transform/TypingTransformers.scala</title>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author Martin Odersky
 */</span>
<span class="comment">// $Id: TypingTransformers.scala 16884 2009-01-09 16:52:09Z cunei $</span>

<span class="keyword">package</span> scala.tools.nsc.transform

<span class="keyword">import</span> scala.collection.mutable.{Map, HashMap}

<span class="comment">/** A base class for transforms.
 *  A transform contains a compiler phase which applies a tree transformer.
 */</span>
<span class="keyword">trait</span> <span class="typed"><span class="type">trait TypingTransformers extends java.lang.Object with ScalaObject</span><a id="13471">TypingTransformers</a></span> {

  <span class="keyword">val</span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a id="29601">global</a></span>: <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="../Global.scala.html#6489">Global</a></span>
  <span class="keyword">import</span> global._

  <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class TypingTransformer extends TypingTransformers.this.global.Transformer with ScalaObject</span><a id="29603">TypingTransformer</a></span>(<span class="typed"><span class="type">TypingTransformers.this.global.CompilationUnit</span><span id="47802"><a id="48284">unit</a></span></span>: <span class="typed"><span class="type">TypingTransformers.this.global.CompilationUnit</span><a href="../CompilationUnits.scala.html#22571">CompilationUnit</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">TypingTransformers.this.global.Transformer</span><a href="../ast/Trees.scala.html#22548">Transformer</a></span> {
    <span class="keyword">var</span> <span class="typed"><span class="type">TypingTransformers.this.global.analyzer.Typer</span><span id="47806"><span id="47804"><span id="47805"><a id="129823">localTyper</a></span></span></span></span>: analyzer.<span class="typed"><span class="type">TypingTransformers.this.global.analyzer.Typer</span><a href="../typechecker/Typers.scala.html#28453">Typer</a></span> = <span class="typed"><span class="type">object TypingTransformers.this.global.analyzer</span><a href="../Global.scala.html#21239">analyzer</a></span>.<span class="typed"><span class="type">(TypingTransformers.this.global.analyzer.Context)TypingTransformers.this.global.analyzer.Typer</span><a href="../typechecker/Typers.scala.html#28411">newTyper</a></span>(
      <span class="typed"><span class="type">object TypingTransformers.this.global.analyzer</span><a href="../Global.scala.html#21239">analyzer</a></span>.<span class="typed"><span class="type">(TypingTransformers.this.global.analyzer.global.CompilationUnit,TypingTransformers.this.global.analyzer.global.Tree,Boolean)TypingTransformers.this.global.analyzer.Context</span><a href="../typechecker/Contexts.scala.html#28357">rootContext</a></span>(<span class="typed"><span class="type">TypingTransformers.this.global.CompilationUnit</span><a href="#47802">unit</a></span>, <span class="typed"><span class="type">object TypingTransformers.this.global.EmptyTree</span><a href="../ast/Trees.scala.html#22380">EmptyTree</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>))
    <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><span id="47809"><span id="47807"><span id="47808"><a id="129824">curTree</a></span></span></span></span>: <span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a href="../ast/Trees.scala.html#22371">Tree</a></span> = _

    <span class="comment">/** a typer for each enclosing class */</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.collection.mutable.Map[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]</span><span id="47812"><span id="47810"><span id="47811"><a id="129825">typers</a></span></span></span></span>: <span class="typed"><span class="type">scala.collection.mutable.Map[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]</span><a id="19880">Map</a></span>[Symbol, analyzer.Typer] = <span class="typed"><span class="type">scala.collection.mutable.HashMap[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]</span><a id="20081">HashMap</a></span>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">[A](TypingTransformers.this.global.Symbol)(=&gt; A)A</span><a id="47813">atOwner</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="47815">A</a></span>](<span class="typed"><span class="type">TypingTransformers.this.global.Symbol</span><a id="52333">owner</a></span>: <span class="typed"><span class="type">TypingTransformers.this.global.Symbol</span><a href="../symtab/Symbols.scala.html#21866">Symbol</a></span>)(<span class="typed"><span class="type">=&gt; A</span><a id="52334">trans</a></span>: =&gt; A): <span class="typed"><span class="type">A</span><a href="#47815">A</a></span> = <span class="typed"><span class="type">(TypingTransformers.this.global.Tree,TypingTransformers.this.global.Symbol)(=&gt; A)A</span><a href="#47816">atOwner</a></span>(<span class="typed"><span class="type">=&gt; TypingTransformers.this.global.Tree</span><a href="#47807">curTree</a></span>, <span class="typed"><span class="type">TypingTransformers.this.global.Symbol</span><a href="#52333">owner</a></span>)(<span class="typed"><span class="type">=&gt; A</span><a href="#52334">trans</a></span>)

    <span class="keyword">def</span> <span class="typed"><span class="type">[A](TypingTransformers.this.global.Tree,TypingTransformers.this.global.Symbol)(=&gt; A)A</span><a id="47816">atOwner</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="47818">A</a></span>](<span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a id="52336">tree</a></span>: <span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a href="../ast/Trees.scala.html#22371">Tree</a></span>, <span class="typed"><span class="type">TypingTransformers.this.global.Symbol</span><a id="52337">owner</a></span>: <span class="typed"><span class="type">TypingTransformers.this.global.Symbol</span><a href="../symtab/Symbols.scala.html#21866">Symbol</a></span>)(<span class="typed"><span class="type">=&gt; A</span><a id="52338">trans</a></span>: =&gt; A): <span class="typed"><span class="type">A</span><a href="#47818">A</a></span> = {
      <span class="keyword">val</span> <span class="typed"><span class="type">TypingTransformers.this.global.analyzer.Typer</span><a id="129842">savedLocalTyper</a></span> = <span class="typed"><span class="type">=&gt; TypingTransformers.this.global.analyzer.Typer</span><a href="#47804">localTyper</a></span>
      <span class="typed"><span class="type">(TypingTransformers.this.global.analyzer.Typer)Unit</span><a href="#47805">localTyper</a></span> = <span class="typed"><span class="type">=&gt; TypingTransformers.this.global.analyzer.Typer</span><a href="#47804">localTyper</a></span>.<span class="typed"><span class="type">(TypingTransformers.this.global.analyzer.global.Tree,TypingTransformers.this.global.analyzer.global.Symbol)TypingTransformers.this.global.analyzer.Typer</span><a href="../typechecker/Typers.scala.html#31829">atOwner</a></span>(<span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a href="#52336">tree</a></span>, <span class="typed"><span class="type">TypingTransformers.this.global.Symbol</span><a href="#52337">owner</a></span>)
      <span class="typed"><span class="type">=&gt; scala.collection.mutable.Map[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]</span><a href="#47810">typers</a></span> <span class="typed"><span class="type">((TypingTransformers.this.global.Symbol, TypingTransformers.this.global.analyzer.Typer))Unit</span><a id="24189">+=</a></span> <span class="typed"><span class="type">(TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer)(TypingTransformers.this.global.Symbol, TypingTransformers.this.global.analyzer.Typer)</span><span id="6015"><span id="6013"><a id="821">Pair</a></span></span></span>(<span class="typed"><span class="type">TypingTransformers.this.global.Symbol</span><a href="#52337">owner</a></span>, <span class="typed"><span class="type">=&gt; TypingTransformers.this.global.analyzer.Typer</span><a href="#47804">localTyper</a></span>)
      <span class="keyword">val</span> <span class="typed"><span class="type">A</span><a id="129843">result</a></span> = <span class="keyword">super</span>.<span class="typed"><span class="type">(TypingTransformers.this.global.Symbol)(=&gt; A)A</span><a href="../ast/Trees.scala.html#43107">atOwner</a></span>(<span class="typed"><span class="type">TypingTransformers.this.global.Symbol</span><a href="#52337">owner</a></span>)(<span class="typed"><span class="type">=&gt; A</span><a href="#52338">trans</a></span>)
      <span class="typed"><span class="type">(TypingTransformers.this.global.analyzer.Typer)Unit</span><a href="#47805">localTyper</a></span> = <span class="typed"><span class="type">TypingTransformers.this.global.analyzer.Typer</span><a href="#129842">savedLocalTyper</a></span>
      <span class="typed"><span class="type">=&gt; scala.collection.mutable.Map[TypingTransformers.this.global.Symbol,TypingTransformers.this.global.analyzer.Typer]</span><a href="#47810">typers</a></span> <span class="typed"><span class="type">(TypingTransformers.this.global.Symbol)Unit</span><a id="24197">-=</a></span> <span class="typed"><span class="type">TypingTransformers.this.global.Symbol</span><a href="#52337">owner</a></span>
      <span class="typed"><span class="type">A</span><a href="#129843">result</a></span>
    }

    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree</span><a id="47819">transform</a></span>(<span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a id="48522">tree</a></span>: <span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a href="../ast/Trees.scala.html#22371">Tree</a></span>): <span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a href="../ast/Trees.scala.html#22371">Tree</a></span> = {
      <span class="typed"><span class="type">(TypingTransformers.this.global.Tree)Unit</span><a href="#47808">curTree</a></span> = <span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a href="#48522">tree</a></span>
      <span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a href="#48522">tree</a></span> <span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><span class="keyword">case</span></span> <a id="1">Template</a>(_, _, _) =&gt;
          <span class="comment">// enter template into context chain</span>
          <span class="typed"><span class="type">(TypingTransformers.this.global.Symbol)(=&gt; TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree</span><a href="#47813">atOwner</a></span>(<span class="typed"><span class="type">=&gt; TypingTransformers.this.global.Symbol</span><a href="../ast/Trees.scala.html#43090">currentOwner</a></span>) { <span class="typed"><span class="type">(TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree</span><a href="#171300" class="keyword">super</a></span>.<span class="typed"><span class="type">(TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree</span><span id="171300"><a id="171301">transform</a></span></span>(<span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a href="#48522">tree</a></span>) }
        <span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><span class="keyword">case</span></span> _ =&gt;
          <span class="keyword">super</span>.<span class="typed"><span class="type">(TypingTransformers.this.global.Tree)TypingTransformers.this.global.Tree</span><a href="../ast/Trees.scala.html#43096">transform</a></span>(<span class="typed"><span class="type">TypingTransformers.this.global.Tree</span><a href="#48522">tree</a></span>)
      }
    }
  }
}


        </pre>
    </body>
</html>