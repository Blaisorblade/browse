<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/MainGenericRunner.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2006-2009 LAMP/EPFL
 * @author  Lex Spoon
 */</span>

<span class="comment">// $Id: MainGenericRunner.scala 17313 2009-03-16 13:03:02Z extempore $</span>

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> java.io.{File, IOException}
<span class="keyword">import</span> java.lang.{ClassNotFoundException, NoSuchMethodException}
<span class="keyword">import</span> java.lang.reflect.InvocationTargetException
<span class="keyword">import</span> java.net.URL

<span class="keyword">import</span> util.ClassPath
<span class="keyword">import</span> File.pathSeparator

<span class="comment">/** An object that runs Scala code.  It has three possible
  * sources for the code to run: pre-compiled code, a script file,
  * or interactive entry.
  */</span>
<span class="keyword">object</span> <span class="typed"><span class="type">object scala.tools.nsc.MainGenericRunner</span><a id="6757">MainGenericRunner</a></span> {
  <span class="comment">/** Append jars found in ${scala.home}/lib to
   *  a specified classpath.  Also append &quot;.&quot; if the
   *  input classpath is empty; otherwise do not.
   *
   *  @param  classpath
   *  @return ...
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)String</span><a id="57458">addClasspathExtras</a></span>(<span class="typed"><span class="type">String</span><a id="57461">classpath</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="57462">scalaHome</a></span> = <span class="typed"><span class="type">object scala.tools.nsc.Properties</span><a href="Properties.scala.html#7366">Properties</a></span>.<span class="typed"><span class="type">=&gt; String</span><a id="46651">scalaHome</a></span>

    <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="57463">extraClassPath</a></span> =
      <span class="typed"><span class="type">java.lang.String</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#57462">scalaHome</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)
        <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>
      <span class="keyword">else</span> {
        <span class="keyword">def</span> <span class="typed"><span class="type">(String)Array[java.io.File]</span><a id="57464">listDir</a></span>(<span class="typed"><span class="type">String</span><a id="57465">name</a></span>:<span class="typed"><span class="type">String</span><a id="1861">String</a></span>):<span class="typed"><span class="type">Array[java.io.File]</span><a id="1072">Array</a></span>[File] = {
          <span class="keyword">val</span> <span class="typed"><span class="type">java.io.File</span><a id="57466">libdir</a></span> = <span class="typed"><span class="type">(java.io.File,java.lang.String)java.io.File</span><a id="40682" class="keyword">new</a></span> <span class="typed"><span class="type">java.io.File</span><a id="3669">File</a></span>(<span class="typed"><span class="type">java.io.File</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.File</span><a id="3669">File</a></span>(<span class="typed"><span class="type">String</span><a href="#57462">scalaHome</a></span>), <span class="typed"><span class="type">String</span><a href="#57465">name</a></span>)
          <span class="typed"><span class="type">Array[java.io.File]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">java.io.File</span><a href="#57466">libdir</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="40697">exists</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> <span class="typed"><span class="type">java.io.File</span><a href="#57466">libdir</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="40699">isFile</a></span>)
            <span class="typed"><span class="type">(java.io.File*)Array[java.io.File]</span><span id="21530"><a id="1073">Array</a></span></span>()
          <span class="keyword">else</span>       
            <span class="typed"><span class="type">java.io.File</span><a href="#57466">libdir</a></span>.<span class="typed"><span class="type">()Array[java.io.File]</span><a id="40708">listFiles</a></span>
        }
        {
          <span class="keyword">val</span> <span class="typed"><span class="type">Array[java.io.File]</span><a id="57671">filesInLib</a></span> = <span class="typed"><span class="type">(String)Array[java.io.File]</span><a href="#57464">listDir</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;lib&quot;)</span><span class="string">&quot;lib&quot;</span></span>)
          <span class="keyword">val</span> <span class="typed"><span class="type">Array[java.io.File]</span><a id="57672">jarsInLib</a></span> = 
            <span class="typed"><span class="type">Array[java.io.File]</span><a href="#57671">filesInLib</a></span>.<span class="typed"><span class="type">((java.io.File) =&gt; Boolean)Array[java.io.File]</span><a id="21513">filter</a></span>(<span class="typed"><span class="type">java.io.File</span><a id="57674">f</a></span> =&gt; 
              <span class="typed"><span class="type">java.io.File</span><a href="#57674">f</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="40699">isFile</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">java.io.File</span><a href="#57674">f</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="40684">getName</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5842">endsWith</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;.jar&quot;)</span><span class="string">&quot;.jar&quot;</span></span>))
          <span class="typed"><span class="type">Array[java.io.File]</span><a href="#57672">jarsInLib</a></span>.<span class="typed"><span class="type">=&gt; List[java.io.File]</span><a id="21815">toList</a></span>
        } <span class="typed"><span class="type">(List[java.io.File])List[java.io.File]</span><a href="#57670" id="21339">:::</a></span> {
          <span class="keyword">val</span> <span class="typed"><span class="type">Array[java.io.File]</span><a id="57675">filesInClasses</a></span> = <span class="typed"><span class="type">(String)Array[java.io.File]</span><a href="#57464">listDir</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;classes&quot;)</span><span class="string">&quot;classes&quot;</span></span>)
          <span class="keyword">val</span> <span class="typed"><span class="type">Array[java.io.File]</span><a id="57676">dirsInClasses</a></span> = 
            <span class="typed"><span class="type">Array[java.io.File]</span><a href="#57675">filesInClasses</a></span>.<span class="typed"><span class="type">((java.io.File) =&gt; Boolean)Array[java.io.File]</span><a id="21513">filter</a></span>(<span class="typed"><span class="type">java.io.File</span><a id="57678">f</a></span> =&gt; <span class="typed"><span class="type">java.io.File</span><a href="#57678">f</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="40698">isDirectory</a></span>)
          <span class="typed"><span class="type">Array[java.io.File]</span><a href="#57676">dirsInClasses</a></span>.<span class="typed"><span class="type">=&gt; List[java.io.File]</span><a id="21815">toList</a></span>
        }
      }.<span class="typed"><span class="type">(String,String,String)String</span><a id="21818">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>, <span class="typed"><span class="type">java.lang.String</span><span id="40677"><a id="3670">pathSeparator</a></span></span>, <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>)

    <span class="typed"><span class="type">String</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#57461">classpath</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>)
      <span class="typed"><span class="type">java.lang.String</span><a href="#57463">extraClassPath</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String</span><span id="40677"><a id="3670">pathSeparator</a></span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;.&quot;)</span><span class="string">&quot;.&quot;</span></span>
    <span class="keyword">else</span>
      <span class="typed"><span class="type">String</span><a href="#57461">classpath</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String</span><span id="40677"><a id="3670">pathSeparator</a></span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#57463">extraClassPath</a></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(Array[String])Unit</span><a id="57459">main</a></span>(<span class="typed"><span class="type">Array[String]</span><a id="57687">args</a></span>: <span class="typed"><span class="type">Array[String]</span><a id="1072">Array</a></span>[String]) {
    <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="57688">error</a></span>(<span class="typed"><span class="type">String</span><a id="57701">str</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">String</span><a href="#57701">str</a></span>)
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a id="57689">command</a></span> = <span class="typed"><span class="type">(List[String],(String) =&gt; Unit)scala.tools.nsc.GenericRunnerCommand</span><a href="GenericRunnerCommand.scala.html#57711" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="GenericRunnerCommand.scala.html#7401">GenericRunnerCommand</a></span>(<span class="typed"><span class="type">Array[String]</span><a href="#57687">args</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a id="21815">toList</a></span>, <span class="typed"><span class="type">(String)Unit</span><a href="#57688">error</a></span>)

    <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a id="57690">settings</a></span> = <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="#57689">command</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.GenericRunnerSettings</span><a href="GenericRunnerCommand.scala.html#57707">settings</a></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a id="57691">sampleCompiler</a></span> = <span class="typed"><span class="type">(scala.tools.nsc.Settings)scala.tools.nsc.Global</span><a href="Global.scala.html#21165" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="Global.scala.html#6489">Global</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>)

    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="#57689">command</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="CompilerCommand.scala.html#53185">ok</a></span>) {
      <span class="typed"><span class="type">(Any)Unit</span><span id="6112"><a id="821">println</a></span></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="#57689">command</a></span>.<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="GenericRunnerCommand.scala.html#57722">usageMsg</a></span>)
      <span class="typed"><span class="type">(Any)Unit</span><span id="6112"><a id="821">println</a></span></span>(<span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#57691">sampleCompiler</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="plugins/Plugins.scala.html#22586">pluginOptionsHelp</a></span>)
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span>
    }

    <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#29952">classpath</a></span>.<span class="typed"><span class="type">(settings.classpath.T)Unit</span><a href="Settings.scala.html#30302">value</a></span> =
      <span class="typed"><span class="type">(String)String</span><a href="#57458">addClasspathExtras</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#29952">classpath</a></span>.<span class="typed"><span class="type">=&gt; settings.classpath.T</span><a href="Settings.scala.html#30301">value</a></span>)
    
    <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.DefinesSetting</span><a href="GenericRunnerSettings.scala.html#57755">defines</a></span>.<span class="typed"><span class="type">=&gt; Unit</span><a href="Settings.scala.html#57773">applyToCurrentJVM</a></span>

    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#29988">version</a></span>.<span class="typed"><span class="type">=&gt; settings.version.T</span><a href="Settings.scala.html#30301">value</a></span>) {
      <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(
        <span class="typed"><span class="type">java.lang.String(&quot;Scala code runner &quot;)</span><span class="string">&quot;Scala code runner &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
        <span class="typed"><span class="type">object scala.tools.nsc.Properties</span><a href="Properties.scala.html#7366">Properties</a></span>.<span class="typed"><span class="type">=&gt; java.lang.String</span><a id="46629">versionString</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; -- &quot;)</span><span class="string">&quot; -- &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
        <span class="typed"><span class="type">object scala.tools.nsc.Properties</span><a href="Properties.scala.html#7366">Properties</a></span>.<span class="typed"><span class="type">=&gt; String</span><a id="46631">copyrightString</a></span>)
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span>
    }

    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="#57689">command</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="CompilerCommand.scala.html#53183">shouldStopWithInfo</a></span>) {
      <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="#57689">command</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.Global)String</span><a href="CompilerCommand.scala.html#53184">getInfoMessage</a></span>(<span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a href="#57691">sampleCompiler</a></span>))
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span>
    }
  
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Nothing</span><a id="57692">exitSuccess</a></span> : <span class="typed"><span class="type">Nothing</span><a id="2167">Nothing</a></span> = <span class="typed"><span class="type">(Int)Nothing</span><span id="6002"><a id="821">exit</a></span></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Nothing</span><a id="57693">exitFailure</a></span> : <span class="typed"><span class="type">Nothing</span><a id="2167">Nothing</a></span> = <span class="typed"><span class="type">(Int)Nothing</span><span id="6002"><a id="821">exit</a></span></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
    <span class="keyword">def</span> <span class="typed"><span class="type">(Boolean)Nothing</span><a id="57694">exitCond</a></span>(<span class="typed"><span class="type">Boolean</span><a id="57898">b</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span>) : <span class="typed"><span class="type">Nothing</span><a id="2167">Nothing</a></span> = <span class="typed"><span class="type">Nothing</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Boolean</span><a href="#57898">b</a></span>) <span class="typed"><span class="type">=&gt; Nothing</span><a href="#57692">exitSuccess</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">=&gt; Nothing</span><a href="#57693">exitFailure</a></span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(java.io.File)Option[java.net.URL]</span><a id="57695">fileToURL</a></span>(<span class="typed"><span class="type">java.io.File</span><a id="57899">f</a></span>: <span class="typed"><span class="type">java.io.File</span><a id="3669">File</a></span>): <span class="typed"><span class="type">Option[java.net.URL]</span><a id="934">Option</a></span>[URL] =
      <span class="keyword">try</span> { <span class="typed"><span class="type">(java.net.URL)Some[java.net.URL]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">java.io.File</span><a href="#57899">f</a></span>.<span class="typed"><span class="type">()java.net.URL</span><a id="40693">toURL</a></span>) }
      <span class="keyword">catch</span> { <span class="typed"><span class="type">None.type</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.Throwable</span><a id="57901">e</a></span> =&gt; <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.Throwable</span><a href="#57901">e</a></span>); <span class="typed"><span class="type">object None</span><a id="536">None</a></span> }

    <span class="keyword">def</span> <span class="typed"><span class="type">(String)List[java.net.URL]</span><a id="57696">paths</a></span>(<span class="typed"><span class="type">String</span><a id="57903">str</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">List[java.net.URL]</span><a id="526">List</a></span>[URL] =
      <span class="keyword">for</span> (
        <span class="typed"><span class="type">(((java.io.File, Option[java.net.URL])) =&gt; java.net.URL)List[java.net.URL]</span><span id="57920"><span id="57927"><span id="21362"><span id="23625"><span id="21367"><span id="57916"><span id="1379"><a id="57933">file</a></span></span></span></span></span></span></span></span> &lt;- <span class="typed"><span class="type">object scala.tools.nsc.util.ClassPath</span><a href="util/ClassPath.scala.html#8490">ClassPath</a></span>.<span class="typed"><span class="type">(String)List[String]</span><a href="util/ClassPath.scala.html#34568">expandPath</a></span>(<span class="typed"><span class="type">String</span><a href="#57903">str</a></span>) <span class="typed"><span class="type">((String) =&gt; java.io.File)List[java.io.File]</span><a id="21362">map</a></span> (<span class="typed"><span class="type">java.io.File</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.File</span><a id="3669">File</a></span>(<span class="typed"><span class="type">String</span><a href="#57911">_</a></span>)) <span class="keyword">if</span> <span class="typed"><span class="type">java.io.File</span><a href="#57916">file</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="40697">exists</a></span>;
        <span class="keyword">val</span> <span class="typed"><span class="type">Option[java.net.URL]</span><span id="57921"><span id="57928"><a id="57934">url</a></span></span></span> = <span class="typed"><span class="type">(java.io.File)Option[java.net.URL]</span><a href="#57695">fileToURL</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#57920">file</a></span>); <span class="keyword">if</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">Option[java.net.URL]</span><a href="#57928">url</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="25406">isEmpty</a></span>
      ) <span class="keyword">yield</span> <span class="typed"><span class="type">Option[java.net.URL]</span><a href="#57934">url</a></span>.<span class="typed"><span class="type">=&gt; java.net.URL</span><a id="25408">get</a></span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(String)List[java.net.URL]</span><a id="57697">jars</a></span>(<span class="typed"><span class="type">String</span><a id="57937">dirs</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">List[java.net.URL]</span><a id="526">List</a></span>[URL] =
      <span class="keyword">for</span> (
        <span class="typed"><span class="type">((java.io.File) =&gt; Iterable[java.net.URL])List[java.net.URL]</span><span id="21383"><span id="21367"><span id="57947"><a id="57951">libdir</a></span></span></span></span> &lt;- <span class="typed"><span class="type">object scala.tools.nsc.util.ClassPath</span><a href="util/ClassPath.scala.html#8490">ClassPath</a></span>.<span class="typed"><span class="type">(String)List[String]</span><a href="util/ClassPath.scala.html#34568">expandPath</a></span>(<span class="typed"><span class="type">String</span><a href="#57937">dirs</a></span>) <span class="typed"><span class="type">((String) =&gt; java.io.File)List[java.io.File]</span><a id="21362">map</a></span> (<span class="typed"><span class="type">java.io.File</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.File</span><a id="3669">File</a></span>(<span class="typed"><span class="type">String</span><a href="#57942">_</a></span>)) <span class="keyword">if</span> <span class="typed"><span class="type">java.io.File</span><a href="#57947">libdir</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="40698">isDirectory</a></span>;
        <span class="typed"><span class="type">(((java.io.File, Option[java.net.URL])) =&gt; java.net.URL)Array[java.net.URL]</span><span id="57959"><span id="57955"><span id="57966"><span id="57972"><span id="21513"><span id="21516"><span id="23625"><a id="1379">jarfile</a></span></span></span></span></span></span></span></span> &lt;- <span class="typed"><span class="type">java.io.File</span><a href="#57951">libdir</a></span>.<span class="typed"><span class="type">()Array[java.io.File]</span><a id="40708">listFiles</a></span> <span class="keyword">if</span> <span class="typed"><span class="type">java.io.File</span><a href="#57955">jarfile</a></span>.<span class="typed"><span class="type">()Boolean</span><a id="40699">isFile</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">java.io.File</span><a href="#57955">jarfile</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="40684">getName</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5842">endsWith</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;.jar&quot;)</span><span class="string">&quot;.jar&quot;</span></span>);
        <span class="keyword">val</span> <span class="typed"><span class="type">Option[java.net.URL]</span><span id="57960"><span id="57967"><a id="57973">url</a></span></span></span> = <span class="typed"><span class="type">(java.io.File)Option[java.net.URL]</span><a href="#57695">fileToURL</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#57959">jarfile</a></span>); <span class="keyword">if</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">Option[java.net.URL]</span><a href="#57967">url</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="25406">isEmpty</a></span>
      ) <span class="keyword">yield</span> <span class="typed"><span class="type">Option[java.net.URL]</span><a href="#57973">url</a></span>.<span class="typed"><span class="type">=&gt; java.net.URL</span><a id="25408">get</a></span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(String)Option[java.net.URL]</span><a id="57698">specToURL</a></span>(<span class="typed"><span class="type">String</span><a id="57976">spec</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Option[java.net.URL]</span><a id="934">Option</a></span>[URL] =
      <span class="keyword">try</span> { <span class="typed"><span class="type">(java.net.URL)Some[java.net.URL]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">(java.lang.String)java.net.URL</span><a id="40942" class="keyword">new</a></span> <span class="typed"><span class="type">java.net.URL</span><a id="4391">URL</a></span>(<span class="typed"><span class="type">String</span><a href="#57976">spec</a></span>)) }
      <span class="keyword">catch</span> { <span class="typed"><span class="type">None.type</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.Throwable</span><a id="57992">e</a></span> =&gt; <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.Throwable</span><a href="#57992">e</a></span>); <span class="typed"><span class="type">object None</span><a id="536">None</a></span> }

    <span class="keyword">def</span> <span class="typed"><span class="type">(String)List[java.net.URL]</span><a id="57699">urls</a></span>(<span class="typed"><span class="type">String</span><a id="57994">specs</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">List[java.net.URL]</span><a id="526">List</a></span>[URL] =
      <span class="typed"><span class="type">List[java.net.URL]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#57994">specs</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> <span class="typed"><span class="type">String</span><a href="#57994">specs</a></span>.<span class="typed"><span class="type">()Int</span><a id="5821">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">==</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>
      <span class="keyword">else</span> <span class="keyword">for</span> (
        <span class="typed"><span class="type">(((java.lang.String, Option[java.net.URL])) =&gt; java.net.URL)List[java.net.URL]</span><span id="21362"><span id="58015"><span id="23625"><span id="21367"><span id="1379"><span id="58009"><a id="58002">spec</a></span></span></span></span></span></span></span> &lt;- <span class="typed"><span class="type">String</span><a href="#57994">specs</a></span>.<span class="typed"><span class="type">(java.lang.String)Array[java.lang.String]</span><a id="5865">split</a></span>(<span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span>).<span class="typed"><span class="type">=&gt; List[java.lang.String]</span><a id="21815">toList</a></span>;
        <span class="keyword">val</span> <span class="typed"><span class="type">Option[java.net.URL]</span><span id="58003"><span id="58010"><a id="58016">url</a></span></span></span> = <span class="typed"><span class="type">(String)Option[java.net.URL]</span><a href="#57698">specToURL</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#58002">spec</a></span>); <span class="keyword">if</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">Option[java.net.URL]</span><a href="#58010">url</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="25406">isEmpty</a></span>
      ) <span class="keyword">yield</span> <span class="typed"><span class="type">Option[java.net.URL]</span><a href="#58016">url</a></span>.<span class="typed"><span class="type">=&gt; java.net.URL</span><a id="25408">get</a></span>

    <span class="keyword">val</span> <span class="typed"><span class="type">List[java.net.URL]</span><a id="57700">classpath</a></span>: <span class="typed"><span class="type">List[java.net.URL]</span><a id="526">List</a></span>[URL] =
      <span class="typed"><span class="type">(String)List[java.net.URL]</span><a href="#57696">paths</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#29950">bootclasspath</a></span>.<span class="typed"><span class="type">=&gt; settings.bootclasspath.T</span><a href="Settings.scala.html#30301">value</a></span>) <span class="typed"><span class="type">(List[java.net.URL])List[java.net.URL]</span><a href="#58019" id="21339">:::</a></span>
      <span class="typed"><span class="type">(String)List[java.net.URL]</span><a href="#57696">paths</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#29952">classpath</a></span>.<span class="typed"><span class="type">=&gt; settings.classpath.T</span><a href="Settings.scala.html#30301">value</a></span>) <span class="typed"><span class="type">(List[java.net.URL])List[java.net.URL]</span><a href="#58020" id="21339">:::</a></span>
      <span class="typed"><span class="type">(String)List[java.net.URL]</span><a href="#57697">jars</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#29964">extdirs</a></span>.<span class="typed"><span class="type">=&gt; settings.extdirs.T</span><a href="Settings.scala.html#30301">value</a></span>) <span class="typed"><span class="type">(List[java.net.URL])List[java.net.URL]</span><a href="#58021" id="21339">:::</a></span>
      <span class="typed"><span class="type">(String)List[java.net.URL]</span><a href="#57699">urls</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="Settings.scala.html#30060">Xcodebase</a></span>.<span class="typed"><span class="type">=&gt; settings.Xcodebase.T</span><a href="Settings.scala.html#30301">value</a></span>)

    <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="#57689">command</a></span>.<span class="typed"><span class="type">=&gt; Option[String]</span><a href="GenericRunnerCommand.scala.html#57715">thingToRun</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> _ <span class="keyword">if</span> <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="GenericRunnerSettings.scala.html#57749">execute</a></span>.<span class="typed"><span class="type">=&gt; settings.execute.T</span><a href="Settings.scala.html#30301">value</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span> =&gt;
        <span class="keyword">val</span> <span class="typed"><span class="type">List[String]</span><a id="58030">fullArgs</a></span> =
	  <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="#57689">command</a></span>.<span class="typed"><span class="type">=&gt; Option[String]</span><a href="GenericRunnerCommand.scala.html#57715">thingToRun</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a id="25422">toList</a></span> <span class="typed"><span class="type">(List[String])List[String]</span><a href="#58031" id="21339">:::</a></span> <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="#57689">command</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a href="GenericRunnerCommand.scala.html#57718">arguments</a></span>
        <span class="typed"><span class="type">(Boolean)Nothing</span><a href="#57694">exitCond</a></span>(<span class="typed"><span class="type">object scala.tools.nsc.ScriptRunner</span><a href="ScriptRunner.scala.html#7207">ScriptRunner</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.GenericRunnerSettings,String,List[String])Boolean</span><a href="ScriptRunner.scala.html#58052">runCommand</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>, 
		  			 <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="GenericRunnerSettings.scala.html#57749">execute</a></span>.<span class="typed"><span class="type">=&gt; settings.execute.T</span><a href="Settings.scala.html#30301">value</a></span>,
					 <span class="typed"><span class="type">List[String]</span><a href="#58030">fullArgs</a></span>))

      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span> =&gt;
        (<span class="typed"><span class="type">()scala.tools.nsc.InterpreterLoop</span><a href="InterpreterLoop.scala.html#58062" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.InterpreterLoop</span><a href="InterpreterLoop.scala.html#7056">InterpreterLoop</a></span>).<span class="typed"><span class="type">(scala.tools.nsc.Settings)Unit</span><a href="InterpreterLoop.scala.html#58106">main</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>)

      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">String</span><a id="58137">thingToRun</a></span>) =&gt;
        <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><a id="58138">isObjectName</a></span> =
          <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.ChoiceSetting</span><a href="GenericRunnerSettings.scala.html#57745">howtorun</a></span>.<span class="typed"><span class="type">=&gt; settings.howtorun.T</span><a href="Settings.scala.html#30301">value</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;object&quot;)</span><span class="string">&quot;object&quot;</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
            <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;script&quot;)</span><span class="string">&quot;script&quot;</span></span> =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
            <span class="typed"><span class="type">Boolean</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;guess&quot;)</span><span class="string">&quot;guess&quot;</span></span> =&gt;
              <span class="typed"><span class="type">object scala.tools.nsc.ObjectRunner</span><a href="ObjectRunner.scala.html#6826">ObjectRunner</a></span>.<span class="typed"><span class="type">(List[java.net.URL],String)Boolean</span><a href="ObjectRunner.scala.html#58143">classExists</a></span>(<span class="typed"><span class="type">List[java.net.URL]</span><a href="#57700">classpath</a></span>, <span class="typed"><span class="type">String</span><a href="#58137">thingToRun</a></span>)
          }

        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#58138">isObjectName</a></span>) {
          <span class="keyword">try</span> {
            <span class="typed"><span class="type">object scala.tools.nsc.ObjectRunner</span><a href="ObjectRunner.scala.html#6826">ObjectRunner</a></span>.<span class="typed"><span class="type">(List[java.net.URL],String,Seq[String])Unit</span><a href="ObjectRunner.scala.html#58147">run</a></span>(<span class="typed"><span class="type">List[java.net.URL]</span><a href="#57700">classpath</a></span>, <span class="typed"><span class="type">String</span><a href="#58137">thingToRun</a></span>, <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="#57689">command</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a href="GenericRunnerCommand.scala.html#57718">arguments</a></span>)
          } <span class="keyword">catch</span> {
            <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.ClassNotFoundException</span><a id="58153">e</a></span>: <span class="typed"><span class="type">java.lang.ClassNotFoundException</span><a id="1729">ClassNotFoundException</a></span> =&gt;
              <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.ClassNotFoundException</span><a href="#58153">e</a></span>)
              <span class="typed"><span class="type">=&gt; Nothing</span><a href="#57693">exitFailure</a></span>
            <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.NoSuchMethodException</span><a id="58160">e</a></span>: <span class="typed"><span class="type">java.lang.NoSuchMethodException</span><a id="2089">NoSuchMethodException</a></span> =&gt;
              <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.NoSuchMethodException</span><a href="#58160">e</a></span>)
              <span class="typed"><span class="type">=&gt; Nothing</span><a href="#57693">exitFailure</a></span>
            <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.reflect.InvocationTargetException</span><a id="58164">e</a></span>: <span class="typed"><span class="type">java.lang.reflect.InvocationTargetException</span><a id="3906">InvocationTargetException</a></span> =&gt;
              <span class="typed"><span class="type">java.lang.reflect.InvocationTargetException</span><a href="#58164">e</a></span>.<span class="typed"><span class="type">()java.lang.Throwable</span><a id="58169">getCause</a></span>.<span class="typed"><span class="type">()Unit</span><a id="23651">printStackTrace</a></span>
              <span class="typed"><span class="type">=&gt; Nothing</span><a href="#57693">exitFailure</a></span>
          }
        } <span class="keyword">else</span> {
          <span class="keyword">try</span> {
            <span class="typed"><span class="type">(Boolean)Nothing</span><a href="#57694">exitCond</a></span>(<span class="typed"><span class="type">object scala.tools.nsc.ScriptRunner</span><a href="ScriptRunner.scala.html#7207">ScriptRunner</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.GenericRunnerSettings,String,List[String])Boolean</span><a href="ScriptRunner.scala.html#58051">runScript</a></span>(<span class="typed"><span class="type">scala.tools.nsc.GenericRunnerSettings</span><a href="#57690">settings</a></span>, 
					    <span class="typed"><span class="type">String</span><a href="#58137">thingToRun</a></span>, 
					    <span class="typed"><span class="type">scala.tools.nsc.GenericRunnerCommand</span><a href="#57689">command</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a href="GenericRunnerCommand.scala.html#57718">arguments</a></span>))
          } <span class="keyword">catch</span> {
	    <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.io.IOException</span><a id="58174">e</a></span>: <span class="typed"><span class="type">java.io.IOException</span><a id="3519">IOException</a></span> =&gt;
              <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.io.IOException</span><a href="#58174">e</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="23646">getMessage</a></span>())
              <span class="typed"><span class="type">=&gt; Nothing</span><a href="#57693">exitFailure</a></span>
            <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.SecurityException</span><a id="58176">e</a></span>: <span class="typed"><span class="type">java.lang.SecurityException</span><a id="1858">SecurityException</a></span> =&gt;
              <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.SecurityException</span><a href="#58176">e</a></span>)
              <span class="typed"><span class="type">=&gt; Nothing</span><a href="#57693">exitFailure</a></span>
          }
        }
    }
  }
}

        </pre>
    </body>
</html>