<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/symtab/BaseTypeSeqs.scala</title>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */</span>
<span class="keyword">package</span> scala.tools.nsc.symtab

<span class="comment">// todo implement in terms of BitSet</span>
<span class="keyword">import</span> scala.collection.mutable.ListBuffer
<span class="keyword">import</span> scala.collection.immutable.Map
<span class="keyword">import</span> Math.max

<span class="comment">/** A base type sequence (BaseTypeSeq) is an ordered sequence spanning all the base types
 *  of a type. It characterized by the following two laws:
 *
 *  (1) Each element of `tp.baseTypeSeq'  is a basetype of `tp'
 *  (2) For each basetype `bt1' of `tp' there is an element `bt' in `tp.baseTypeSeq' such that
 *
 *      bt.typeSymbol = bt1.typeSymbol
 *      bt &lt;: bt1
 *
 *  (3) The type symbols of different elements are different.
 *  
 *  Elements in the sequence are ordered by Symbol.isLess. 
 *  @note base type sequences were called closures up to 2.7.1. The name has been changed
 *  to avoid confusion with function closures.
 */</span>
<span class="keyword">trait</span> <span class="typed"><span class="type">trait BaseTypeSeqs extends java.lang.Object with ScalaObject</span><a id="8976">BaseTypeSeqs</a></span> { 
  <span class="keyword">this</span>: SymbolTable =&gt;
  <span class="keyword">import</span> definitions._

  <span class="keyword">class</span> <span class="typed"><span class="type">class BaseTypeSeq extends java.lang.Object with ScalaObject</span><a id="22305">BaseTypeSeq</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><span id="63208"><a id="80984">parents</a></span></span>: <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="526">List</a></span>[Type], <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><span id="63209"><a id="80985">elems</a></span></span>: <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a id="1072">Array</a></span>[Type]) {

    <span class="comment">/** The number of types in the sequence */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="63211">length</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#63209">elems</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21508">length</a></span>

    <span class="keyword">var</span> <span class="typed"><span class="type">scala.collection.immutable.Map[Int,BaseTypeSeqs.this.Type]</span><span id="63214"><span id="63212"><span id="63213"><a id="80983">pending</a></span></span></span></span>: <span class="typed"><span class="type">scala.collection.immutable.Map[Int,BaseTypeSeqs.this.Type]</span><a id="26197">Map</a></span>[Int, Type] = <span class="typed"><span class="type">((Int, Nothing)*)scala.collection.immutable.Map[Int,Nothing]</span><span id="32836"><a id="26198">Map</a></span></span>()

    <span class="comment">/** The type at i'th position in this sequence; lazy types are returned evaluated. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Type</span><a id="63215">apply</a></span>(<span class="typed"><span class="type">Int</span><a id="80988">i</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>): <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="Types.scala.html#21944">Type</a></span> = <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Type</span><a href="#63209" id="21509">elems</a></span>(<span class="typed"><span class="type">Int</span><a href="#80988">i</a></span>) <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object BaseTypeSeqs.this.NoType</span><a href="Types.scala.html#21963">NoType</a></span> =&gt;
        <span class="typed"><span class="type">(scala.collection.immutable.Map[Int,BaseTypeSeqs.this.Type])Unit</span><a href="#63213">pending</a></span> = <span class="typed"><span class="type">((Int, Nothing)*)scala.collection.immutable.Map[Int,Nothing]</span><span id="32836"><a id="26198">Map</a></span></span>()
        <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#63209">elems</a></span>(<span class="typed"><span class="type">Int</span><a href="#80988">i</a></span>) = <span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Symbol</span><a href="Definitions.scala.html#25769">AnyClass</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Type</span><a href="Symbols.scala.html#25230">tpe</a></span>
        <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">=&gt; java.lang.Throwable</span><a href="#22310">CyclicInheritance</a></span> 
      <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><span class="keyword">case</span></span> <span class="typed"><span class="type">BaseTypeSeqs.this.RefinedType</span><a id="80994">rtp</a></span> @ <a id="1">RefinedType</a>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="80995">variants</a></span>, <span class="typed"><span class="type">BaseTypeSeqs.this.Scope</span><a id="80996">decls</a></span>) =&gt;
        <span class="comment">// can't assert decls.isEmpty; see t0764</span>
        <span class="comment">//if (!decls.isEmpty) assert(false, &quot;computing closure of &quot;+this+&quot;:&quot;+this.isInstanceOf[RefinedType]+&quot;/&quot;+closureCache(j))</span>
        <span class="comment">//Console.println(&quot;compute closure of &quot;+this+&quot; =&gt; glb(&quot;+variants+&quot;)&quot;)</span>
        <span class="typed"><span class="type">(scala.collection.immutable.Map[Int,BaseTypeSeqs.this.Type])Unit</span><a href="#63213">pending</a></span> <span class="typed"><span class="type">((Int, BaseTypeSeqs.this.Type))scala.collection.immutable.Map[Int,BaseTypeSeqs.this.Type]</span><a id="32801">+=</a></span> (<span class="typed"><span class="type">(Int)ArrowAssoc[Int]</span><span id="6054"><a href="#80988" id="821">i</a></span></span> <span class="typed"><span class="type">(BaseTypeSeqs.this.RefinedType)(Int, BaseTypeSeqs.this.RefinedType)</span><a id="6050">-&gt;</a></span> <span class="typed"><span class="type">BaseTypeSeqs.this.RefinedType</span><a href="#80994">rtp</a></span>)
        <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#63209">elems</a></span>(<span class="typed"><span class="type">Int</span><a href="#80988">i</a></span>) = <span class="typed"><span class="type">object BaseTypeSeqs.this.NoType</span><a href="Types.scala.html#21963">NoType</a></span>
        <span class="keyword">try</span> {
          <span class="typed"><span class="type">(List[BaseTypeSeqs.this.Type],Int,Int)Option[BaseTypeSeqs.this.Type]</span><a href="Types.scala.html#22176">mergePrefixAndArgs</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#80995">variants</a></span>, -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>, <span class="typed"><span class="type">(List[BaseTypeSeqs.this.Type])Int</span><a href="Types.scala.html#22106">lubDepth</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#80995">variants</a></span>)) <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81058">tp0</a></span>) =&gt;
              <span class="typed"><span class="type">(scala.collection.immutable.Map[Int,BaseTypeSeqs.this.Type])Unit</span><a href="#63213">pending</a></span> <span class="typed"><span class="type">(Int)scala.collection.immutable.Map[Int,BaseTypeSeqs.this.Type]</span><a id="32809">-=</a></span> <span class="typed"><span class="type">Int</span><a href="#80988">i</a></span>
              <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#63209">elems</a></span>(<span class="typed"><span class="type">Int</span><a href="#80988">i</a></span>) = <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81058">tp0</a></span>
              <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81058">tp0</a></span>
            <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span> =&gt; 
              <span class="typed"><span class="type">(String)Nothing</span><a href="#63230">typeError</a></span>(
                <span class="typed"><span class="type">java.lang.String(&quot;no common type instance of base types &quot;)</span><span class="string">&quot;no common type instance of base types &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#80995">variants</a></span> <span class="typed"><span class="type">(String)String</span><a id="21819">mkString</a></span> <span class="typed"><span class="type">java.lang.String(&quot;, and &quot;)</span><span class="string">&quot;, and &quot;</span></span>)<span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span><span class="typed"><span class="type">java.lang.String(&quot; exists.&quot;)</span><span class="string">&quot; exists.&quot;</span></span>)
          }
        } <span class="keyword">catch</span> {
          <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">=&gt; java.lang.Throwable</span><a href="#22310">CyclicInheritance</a></span> =&gt;
            <span class="typed"><span class="type">(String)Nothing</span><a href="#63230">typeError</a></span>(
              <span class="typed"><span class="type">java.lang.String(&quot;computing the common type instance of base types &quot;)</span><span class="string">&quot;computing the common type instance of base types &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#80995">variants</a></span> <span class="typed"><span class="type">(String)String</span><a id="21819">mkString</a></span> <span class="typed"><span class="type">java.lang.String(&quot;, and &quot;)</span><span class="string">&quot;, and &quot;</span></span>)<span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span><span class="typed"><span class="type">java.lang.String(&quot; leads to a cycle.&quot;)</span><span class="string">&quot; leads to a cycle.&quot;</span></span>)
        } 
      <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><span class="keyword">case</span></span> <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81073">tp</a></span> =&gt;
        <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81073">tp</a></span>
    }

    <span class="keyword">def</span> <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Type</span><a id="63216">rawElem</a></span>(<span class="typed"><span class="type">Int</span><a id="81074">i</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>) = <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Type</span><a href="#63209" id="21509">elems</a></span>(<span class="typed"><span class="type">Int</span><a href="#81074">i</a></span>)

    <span class="comment">/** The type symbol of the type at i'th position in this sequence;
     *  no evaluation needed.
     */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Symbol</span><a id="63217">typeSymbol</a></span>(<span class="typed"><span class="type">Int</span><a id="81079">i</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>): <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="Symbols.scala.html#21866">Symbol</a></span> = {
      <span class="keyword">def</span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)BaseTypeSeqs.this.Symbol</span><a id="81080">tsym</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81081">tp</a></span>: <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="Types.scala.html#21944">Type</a></span>) = <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81081">tp</a></span> <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><span class="keyword">case</span></span> <a id="1">RefinedType</a>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81082">v</a></span> <a id="1">::</a> <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="81083">vs</a></span>, _) =&gt; <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81082">v</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Symbol</span><a href="Types.scala.html#25650">typeSymbol</a></span>
        <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81081">tp</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Symbol</span><a href="Types.scala.html#25650">typeSymbol</a></span>
      }
      <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Type</span><a href="#63209" id="21509">elems</a></span>(<span class="typed"><span class="type">Int</span><a href="#81079">i</a></span>) <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object BaseTypeSeqs.this.NoType</span><a href="Types.scala.html#21963">NoType</a></span> =&gt; 
          <span class="typed"><span class="type">=&gt; scala.collection.immutable.Map[Int,BaseTypeSeqs.this.Type]</span><a href="#63212">pending</a></span> <span class="typed"><span class="type">(Int)Option[BaseTypeSeqs.this.Type]</span><a id="24235">get</a></span> <span class="typed"><span class="type">Int</span><a href="#81079">i</a></span> <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81087">tp</a></span>) =&gt; <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)BaseTypeSeqs.this.Symbol</span><a href="#81080">tsym</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81087">tp</a></span>)
            <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">object BaseTypeSeqs.this.NoType</span><a href="Types.scala.html#21963">NoType</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Symbol</span><a href="Types.scala.html#25650">typeSymbol</a></span>
          }
        <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><span class="keyword">case</span></span> <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81088">tp</a></span> =&gt; <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)BaseTypeSeqs.this.Symbol</span><a href="#81080">tsym</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81088">tp</a></span>)
      }
    }

    <span class="comment">/** Return all evaluated types in this sequence as a list */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[BaseTypeSeqs.this.Type]</span><a id="63218">toList</a></span>: <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="526">List</a></span>[Type] = <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#63209">elems</a></span>.<span class="typed"><span class="type">=&gt; List[BaseTypeSeqs.this.Type]</span><a id="21815">toList</a></span>

    <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type,Int)BaseTypeSeqs.this.BaseTypeSeq</span><a id="63219">copy</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81090">head</a></span>: <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="Types.scala.html#21944">Type</a></span>, <span class="typed"><span class="type">Int</span><a id="81091">offset</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>): <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span> = {
      <span class="keyword">val</span> <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a id="81092">arr</a></span> = <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a id="1072">Array</a></span>[Type](<span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#63209">elems</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21508">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int</span><a href="#81091">offset</a></span>)
      <span class="typed"><span class="type">object Array</span><a id="1073">Array</a></span>.<span class="typed"><span class="type">(AnyRef,Int,AnyRef,Int,Int)Unit</span><a id="21467">copy</a></span>(<span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#63209">elems</a></span>, <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#81092">arr</a></span>, <span class="typed"><span class="type">Int</span><a href="#81091">offset</a></span>, <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#63209">elems</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21508">length</a></span>)
      <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#81092">arr</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) = <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81090">head</a></span>
      <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><span class="keyword">new</span></span> <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#63208">parents</a></span>, <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#81092">arr</a></span>)
    }

    <span class="comment">/** Compute new base type sequence with `tp' prepended to this sequence */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)BaseTypeSeqs.this.BaseTypeSeq</span><a id="63220">prepend</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81112">tp</a></span>: <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="Types.scala.html#21944">Type</a></span>): <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span> = <span class="typed"><span class="type">(BaseTypeSeqs.this.Type,Int)BaseTypeSeqs.this.BaseTypeSeq</span><a href="#63219">copy</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81112">tp</a></span>, <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
      
    <span class="comment">/** Compute new base type sequence with `tp' replacing the head of this sequence */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)BaseTypeSeqs.this.BaseTypeSeq</span><a id="63221">updateHead</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81113">tp</a></span>: <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="Types.scala.html#21944">Type</a></span>): <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span> = <span class="typed"><span class="type">(BaseTypeSeqs.this.Type,Int)BaseTypeSeqs.this.BaseTypeSeq</span><a href="#63219">copy</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81113">tp</a></span>, <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)

    <span class="comment">/** Compute new base type sequence where every element is mapped
     *  with function `f'. Lazy types are mapped but not evaluated */</span> 
    <span class="keyword">def</span> <span class="typed"><span class="type">((BaseTypeSeqs.this.Type) =&gt; BaseTypeSeqs.this.Type)BaseTypeSeqs.this.BaseTypeSeq</span><a id="63222">map</a></span>(<span class="typed"><span class="type">(BaseTypeSeqs.this.Type) =&gt; BaseTypeSeqs.this.Type</span><a id="81114">f</a></span>: Type =&gt; Type): <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span> = {
	  <span class="comment">// inlined `elems map f' for performance</span>
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="81115">len</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#63211">length</a></span>
      <span class="keyword">var</span> <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a id="81116">arr</a></span> = <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a id="1072">Array</a></span>[Type](<span class="typed"><span class="type">Int</span><a href="#81115">len</a></span>)
      <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="81117">i</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
      <span class="typed"><span class="type">Unit</span><a href="#81118" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#81117">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#81115">len</a></span>) {
        <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#81116">arr</a></span>(<span class="typed"><span class="type">Int</span><a href="#81117">i</a></span>) = <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)BaseTypeSeqs.this.Type</span><a href="#81114" id="21757">f</a></span>(<span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Type</span><a href="#63209" id="21509">elems</a></span>(<span class="typed"><span class="type">Int</span><a href="#81117">i</a></span>))
        <span class="typed"><span class="type">Int</span><a href="#81117">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      }
      <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><span class="keyword">new</span></span> <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#63208">parents</a></span>, <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#81116">arr</a></span>)
    }

    <span class="keyword">def</span> <span class="typed"><span class="type">((BaseTypeSeqs.this.Type) =&gt; Boolean)Boolean</span><a id="63223">exists</a></span>(<span class="typed"><span class="type">(BaseTypeSeqs.this.Type) =&gt; Boolean</span><a id="81147">p</a></span>: Type =&gt; Boolean): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#63209">elems</a></span> <span class="typed"><span class="type">((BaseTypeSeqs.this.Type) =&gt; Boolean)Boolean</span><a id="21794">exists</a></span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type) =&gt; Boolean</span><a href="#81147">p</a></span>
<span class="comment">//      (0 until length) exists (i =&gt; p(this(i)))</span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(List[BaseTypeSeqs.this.Type])Unit</span><a id="63224">normalize</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="81148">parents</a></span>: <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="526">List</a></span>[Type]) <span class="typed"><span class="type">Unit</span><span >{</span></span>}
<span class="comment">/*
      var j = 0
      while (j &lt; elems.length) {
        elems(j) match {
          case RefinedType(variants, decls) =&gt;
            // can't assert decls.isEmpty; see t0764
            //if (!decls.isEmpty) assert(false, &quot;computing closure of &quot;+this+&quot;:&quot;+this.isInstanceOf[RefinedType]+&quot;/&quot;+closureCache(j))
            //Console.println(&quot;compute closure of &quot;+this+&quot; =&gt; glb(&quot;+variants+&quot;)&quot;)
            elems(j) = mergePrefixAndArgs(variants, -1, maxBaseTypeSeqDepth(variants) + LubGlbMargin) match {
              case Some(tp0) =&gt; tp0
              case None =&gt; throw new TypeError(
                &quot;the type intersection &quot;+(parents mkString &quot; with &quot;)+&quot; is malformed&quot;+
                &quot;\n --- because ---&quot;+
                &quot;\n no common type instance of base types &quot;+(variants mkString &quot;, and &quot;)+&quot; exists.&quot;)
            }
          case _ =&gt;
        }
        j += 1
      }
    }
*/</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="63226">maxDepth</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = {
      <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="81149">d</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
      <span class="keyword">for</span> (<span class="typed"><span class="type">((Int) =&gt; Unit)Unit</span><span id="40475"><a id="81159">i</a></span></span> &lt;- <span class="typed"><span class="type">implicit scala.Predef.intWrapper : (Int)scala.runtime.RichInt</span><span id="6133"><a id="821" class="int">0</a></span></span> <span class="typed"><span class="type">(Int)Range</span><a id="26778">until</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#63211">length</a></span>) <span class="typed"><span class="type">Int</span><a href="#81149">d</a></span> = <span class="typed"><span class="type">object Math</span><a id="608">Math</a></span>.<span class="typed"><span class="type">(Int,Int)Int</span><a id="40053">max</a></span>(<span class="typed"><span class="type">Int</span><a href="#81149">d</a></span>, <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Int</span><a href="#63227">maxDpth</a></span>(<span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Type</span><a href="#63209" id="21509">elems</a></span>(<span class="typed"><span class="type">Int</span><a href="#81159">i</a></span>)))
      <span class="typed"><span class="type">Int</span><a href="#81149">d</a></span>
    }

    <span class="comment">/** The maximum depth of type `tp' */</span> 
    <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Int</span><a id="63227">maxDpth</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81175">tp</a></span>: <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="Types.scala.html#21944">Type</a></span>): <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81175">tp</a></span> <span class="typed"><span class="type">Int</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <a id="1">TypeRef</a>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81179">pre</a></span>, <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a id="81180">sym</a></span>, <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="81181">args</a></span>) =&gt; 
        <span class="typed"><span class="type">(Int,Int)Int</span><span id="40053"><a id="608">max</a></span></span>(<span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Int</span><a href="#63227">maxDpth</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81179">pre</a></span>), <span class="typed"><span class="type">(Seq[BaseTypeSeqs.this.Type])Int</span><a href="#63228">maxDpth</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81181">args</a></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <a id="1">RefinedType</a>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="81215">parents</a></span>, <span class="typed"><span class="type">BaseTypeSeqs.this.Scope</span><a id="81216">decls</a></span>) =&gt;
        <span class="typed"><span class="type">(Int,Int)Int</span><span id="40053"><a id="608">max</a></span></span>(<span class="typed"><span class="type">(Seq[BaseTypeSeqs.this.Type])Int</span><a href="#63228">maxDpth</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81215">parents</a></span>), <span class="typed"><span class="type">(Seq[BaseTypeSeqs.this.Type])Int</span><a href="#63228">maxDpth</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Scope</span><a href="#81216">decls</a></span>.<span class="typed"><span class="type">=&gt; List[BaseTypeSeqs.this.Symbol]</span><a href="Scopes.scala.html#34629">toList</a></span>.<span class="typed"><span class="type">((BaseTypeSeqs.this.Symbol) =&gt; BaseTypeSeqs.this.Type)List[BaseTypeSeqs.this.Type]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81235">_</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Type</span><a href="Symbols.scala.html#25231">info</a></span>)) <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <a id="1">TypeBounds</a>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81254">lo</a></span>, <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81255">hi</a></span>) =&gt;
        <span class="typed"><span class="type">(Int,Int)Int</span><span id="40053"><a id="608">max</a></span></span>(<span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Int</span><a href="#63227">maxDpth</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81254">lo</a></span>), <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Int</span><a href="#63227">maxDpth</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81255">hi</a></span>))
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <a id="1">MethodType</a>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="81271">paramtypes</a></span>, <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81272">result</a></span>) =&gt;
        <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Int</span><a href="#63227">maxDpth</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81272">result</a></span>)
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <a id="1">PolyType</a>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Symbol]</span><a id="81274">tparams</a></span>, <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81275">result</a></span>) =&gt;
        <span class="typed"><span class="type">(Int,Int)Int</span><span id="40053"><a id="608">max</a></span></span>(<span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Int</span><a href="#63227">maxDpth</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81275">result</a></span>), <span class="typed"><span class="type">(Seq[BaseTypeSeqs.this.Type])Int</span><a href="#63228">maxDpth</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Symbol]</span><a href="#81274">tparams</a></span> <span class="typed"><span class="type">((BaseTypeSeqs.this.Symbol) =&gt; BaseTypeSeqs.this.Type)List[BaseTypeSeqs.this.Type]</span><a id="21362">map</a></span> (<span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81293">_</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Type</span><a href="Symbols.scala.html#25231">info</a></span>)) <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <a id="1">ExistentialType</a>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Symbol]</span><a id="81312">tparams</a></span>, <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81313">result</a></span>) =&gt;
        <span class="typed"><span class="type">(Int,Int)Int</span><span id="40053"><a id="608">max</a></span></span>(<span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Int</span><a href="#63227">maxDpth</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81313">result</a></span>), <span class="typed"><span class="type">(Seq[BaseTypeSeqs.this.Type])Int</span><a href="#63228">maxDpth</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Symbol]</span><a href="#81312">tparams</a></span> <span class="typed"><span class="type">((BaseTypeSeqs.this.Symbol) =&gt; BaseTypeSeqs.this.Type)List[BaseTypeSeqs.this.Type]</span><a id="21362">map</a></span> (<span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81331">_</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Type</span><a href="Symbols.scala.html#25231">info</a></span>)) <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
      <span class="typed"><span class="type">Int(1)</span><span class="keyword">case</span></span> _ =&gt;
        <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    }

    <span class="comment">/** The maximum depth of all types `tps' */</span> 
    <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Seq[BaseTypeSeqs.this.Type])Int</span><a id="63228">maxDpth</a></span>(<span class="typed"><span class="type">Seq[BaseTypeSeqs.this.Type]</span><a id="81174">tps</a></span>: <span class="typed"><span class="type">Seq[BaseTypeSeqs.this.Type]</span><a id="763">Seq</a></span>[Type]): <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = {
      <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="81350">d</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
      <span class="keyword">for</span> (<span class="typed"><span class="type">((BaseTypeSeqs.this.Type) =&gt; Unit)Unit</span><span id="21792"><a id="81352">tp</a></span></span> &lt;- <span class="typed"><span class="type">Seq[BaseTypeSeqs.this.Type]</span><a href="#81174">tps</a></span>) <span class="typed"><span class="type">Int</span><a href="#81350">d</a></span> = <span class="typed"><span class="type">(Int,Int)Int</span><span id="40053"><a id="608">max</a></span></span>(<span class="typed"><span class="type">Int</span><a href="#81350">d</a></span>, <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Int</span><a href="#63227">maxDpth</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81352">tp</a></span>))
      <span class="typed"><span class="type">Int</span><a href="#81350">d</a></span>
    }

    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="63229">toString</a></span> = <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#63209">elems</a></span>.<span class="typed"><span class="type">(String,String,String)String</span><a id="21818">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;BTS(&quot;)</span><span class="string">&quot;BTS(&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;,&quot;)</span><span class="string">&quot;,&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;)&quot;)</span><span class="string">&quot;)&quot;</span></span>)

    <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)Nothing</span><a id="63230">typeError</a></span>(<span class="typed"><span class="type">String</span><a id="81070">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Nothing</span><a id="2167">Nothing</a></span> =
      <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(String)BaseTypeSeqs.this.TypeError</span><a href="Types.scala.html#34646" class="keyword">new</a></span> <span class="typed"><span class="type">BaseTypeSeqs.this.TypeError</span><a href="Types.scala.html#22181">TypeError</a></span>(
        <span class="typed"><span class="type">java.lang.String(&quot;the type intersection &quot;)</span><span class="string">&quot;the type intersection &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#63208">parents</a></span> <span class="typed"><span class="type">(String)String</span><a id="21819">mkString</a></span> <span class="typed"><span class="type">java.lang.String(&quot; with &quot;)</span><span class="string">&quot; with &quot;</span></span>)<span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span><span class="typed"><span class="type">java.lang.String(&quot; is malformed&quot;)</span><span class="string">&quot; is malformed&quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
        <span class="typed"><span class="type">java.lang.String(&quot;\012 --- because ---\012&quot;)</span><span class="string">&quot;\n --- because ---\n&quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span><span class="typed"><span class="type">String</span><a href="#81070">msg</a></span>)
  }

  <span class="comment">/** A merker object for a base type sequence that's no yet computed. 
   *  used to catch inheritance cycles 
   */</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><span id="22307"><a id="22306">undetBaseTypeSeq</a></span></span>: <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span> = <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><span class="keyword">new</span></span> <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span>(<span class="typed"><span class="type">object Nil</span><a id="335">List</a></span>(), <span class="typed"><span class="type">(BaseTypeSeqs.this.Type*)Array[BaseTypeSeqs.this.Type]</span><span id="21530"><a id="1073">Array</a></span></span>())

  <span class="comment">/** Create a base type sequence consisting of a single type */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)BaseTypeSeqs.this.BaseTypeSeq</span><a id="22308">baseTypeSingletonSeq</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81543">tp</a></span>: <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="Types.scala.html#21944">Type</a></span>): <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span> = <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><span class="keyword">new</span></span> <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span>(<span class="typed"><span class="type">object Nil</span><a id="335">List</a></span>(), <span class="typed"><span class="type">(BaseTypeSeqs.this.Type*)Array[BaseTypeSeqs.this.Type]</span><span id="21530"><a id="1073">Array</a></span></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81543">tp</a></span>))

  <span class="comment">/** Create the base type sequence of a compound type wuth given tp.parents */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)BaseTypeSeqs.this.BaseTypeSeq</span><a id="22309">compoundBaseTypeSeq</a></span>(<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81711">tp</a></span>: <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="Types.scala.html#21944">Type</a></span><span class="comment">/*tsym: Symbol, parents: List[Type]*/</span>): <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a id="81712">tsym</a></span> = <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81711">tp</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Symbol</span><a href="Types.scala.html#25650">typeSymbol</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="81713">parents</a></span> = <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81711">tp</a></span>.<span class="typed"><span class="type">=&gt; List[BaseTypeSeqs.this.Type]</span><a href="Types.scala.html#25659">parents</a></span>
<span class="comment">//    Console.println(&quot;computing baseTypeSeq of &quot; + tsym.tpe + &quot; &quot; + parents)//DEBUG</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[BaseTypeSeqs.this.Type]</span><a id="81714">buf</a></span> = <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[BaseTypeSeqs.this.Type]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[BaseTypeSeqs.this.Type]</span><a id="19925">ListBuffer</a></span>[Type]
    <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[BaseTypeSeqs.this.Type]</span><a href="#81714">buf</a></span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Unit</span><a id="33306">+=</a></span> <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81712">tsym</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Type</span><a href="Symbols.scala.html#25230">tpe</a></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="81715">btsSize</a></span> = <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="81716">nparents</a></span> = <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81713">parents</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21345">length</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#81716">nparents</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3142">!=</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">Array[BaseTypeSeqs.this.BaseTypeSeq]</span><a id="81719">pbtss</a></span> = <span class="typed"><span class="type">Array[BaseTypeSeqs.this.BaseTypeSeq]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Array[BaseTypeSeqs.this.BaseTypeSeq]</span><a id="1072">Array</a></span>[BaseTypeSeq](<span class="typed"><span class="type">Int</span><a href="#81716">nparents</a></span>)
      <span class="keyword">val</span> <span class="typed"><span class="type">Array[Int]</span><a id="81720">index</a></span> = <span class="typed"><span class="type">Array[Int]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Array[Int]</span><a id="1072">Array</a></span>[Int](<span class="typed"><span class="type">Int</span><a href="#81716">nparents</a></span>)
      <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="81721">i</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
      <span class="keyword">for</span> (<span class="typed"><span class="type">((BaseTypeSeqs.this.Type) =&gt; Unit)Unit</span><span id="21366"><a id="81728">p</a></span></span> &lt;- <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81713">parents</a></span>) {
        <span class="typed"><span class="type">Array[BaseTypeSeqs.this.BaseTypeSeq]</span><a href="#81719">pbtss</a></span>(<span class="typed"><span class="type">Int</span><a href="#81721">i</a></span>) = 
          <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81728">p</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.BaseTypeSeq</span><a href="Types.scala.html#25706">baseTypeSeq</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22306">undetBaseTypeSeq</a></span>) <span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Symbol</span><a href="Definitions.scala.html#25769">AnyClass</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Type</span><a href="Symbols.scala.html#25231">info</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.BaseTypeSeq</span><a href="Types.scala.html#25706">baseTypeSeq</a></span> 
          <span class="keyword">else</span> <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81728">p</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.BaseTypeSeq</span><a href="Types.scala.html#25706">baseTypeSeq</a></span>
        <span class="typed"><span class="type">Array[Int]</span><a href="#81720">index</a></span>(<span class="typed"><span class="type">Int</span><a href="#81721">i</a></span>) = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
        <span class="typed"><span class="type">Int</span><a href="#81721">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      }
      <span class="keyword">def</span> <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Symbol</span><a id="81722">nextTypeSymbol</a></span>(<span class="typed"><span class="type">Int</span><a id="81751">i</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>): <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="Symbols.scala.html#21866">Symbol</a></span> = {
        <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="81752">j</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#81720" id="21509">index</a></span>(<span class="typed"><span class="type">Int</span><a href="#81751">i</a></span>)
        <span class="keyword">val</span> <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a id="81753">pbts</a></span> = <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.BaseTypeSeq</span><a href="#81719" id="21509">pbtss</a></span>(<span class="typed"><span class="type">Int</span><a href="#81751">i</a></span>)
        <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#81752">j</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#81753">pbts</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="#63211">length</a></span>) <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#81753">pbts</a></span>.<span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Symbol</span><a href="#63217">typeSymbol</a></span>(<span class="typed"><span class="type">Int</span><a href="#81752">j</a></span>) <span class="keyword">else</span> <span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Symbol</span><a href="Definitions.scala.html#25769">AnyClass</a></span>
      }
      <span class="keyword">def</span> <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Type</span><a id="81723">nextRawElem</a></span>(<span class="typed"><span class="type">Int</span><a id="81761">i</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>): <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="Types.scala.html#21944">Type</a></span> = {
        <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="81762">j</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#81720" id="21509">index</a></span>(<span class="typed"><span class="type">Int</span><a href="#81761">i</a></span>)
        <span class="keyword">val</span> <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a id="81763">pbts</a></span> = <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.BaseTypeSeq</span><a href="#81719" id="21509">pbtss</a></span>(<span class="typed"><span class="type">Int</span><a href="#81761">i</a></span>)
        <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#81762">j</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#81763">pbts</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="#63211">length</a></span>) <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#81763">pbts</a></span>.<span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Type</span><a href="#63216">rawElem</a></span>(<span class="typed"><span class="type">Int</span><a href="#81762">j</a></span>) <span class="keyword">else</span> <span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Symbol</span><a href="Definitions.scala.html#25769">AnyClass</a></span>.<span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Type</span><a href="Symbols.scala.html#25230">tpe</a></span>
      }
      <span class="keyword">var</span> <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a id="81724">minSym</a></span>: <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="Symbols.scala.html#21866">Symbol</a></span> = <span class="typed"><span class="type">object BaseTypeSeqs.this.NoSymbol</span><a href="Symbols.scala.html#21873">NoSymbol</a></span>
      <span class="typed"><span class="type">Unit</span><a href="#81771" class="keyword">while</a></span> (<span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81724">minSym</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">=&gt; BaseTypeSeqs.this.Symbol</span><a href="Definitions.scala.html#25769">AnyClass</a></span>) {
        <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81724">minSym</a></span> = <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Symbol</span><a href="#81722">nextTypeSymbol</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
        <span class="typed"><span class="type">Int</span><a href="#81721">i</a></span> = <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        <span class="typed"><span class="type">Unit</span><a href="#81775" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#81721">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#81716">nparents</a></span>) {
          <span class="keyword">val</span> <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a id="81778">nextSym</a></span> = <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Symbol</span><a href="#81722">nextTypeSymbol</a></span>(<span class="typed"><span class="type">Int</span><a href="#81721">i</a></span>)
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81778">nextSym</a></span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Symbol)Boolean</span><a href="Symbols.scala.html#25247">isLess</a></span> <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81724">minSym</a></span>)
            <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81724">minSym</a></span> = <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81778">nextSym</a></span>
          <span class="typed"><span class="type">Int</span><a href="#81721">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        }
        <span class="keyword">var</span> <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="81774">minTypes</a></span>: <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="526">List</a></span>[Type] = <span class="typed"><span class="type">object Nil</span><a id="335">List</a></span>()
        <span class="typed"><span class="type">Int</span><a href="#81721">i</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
        <span class="typed"><span class="type">Unit</span><a href="#81776" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#81721">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#81716">nparents</a></span>) {
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Symbol</span><a href="#81722">nextTypeSymbol</a></span>(<span class="typed"><span class="type">Int</span><a href="#81721">i</a></span>) <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">BaseTypeSeqs.this.Symbol</span><a href="#81724">minSym</a></span>) {
            <span class="typed"><span class="type">(Int)BaseTypeSeqs.this.Type</span><a href="#81723">nextRawElem</a></span>(<span class="typed"><span class="type">Int</span><a href="#81721">i</a></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
              <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">RefinedType</a>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a id="81805">variants</a></span>, <span class="typed"><span class="type">BaseTypeSeqs.this.Scope</span><a id="81806">decls</a></span>) =&gt;
                <span class="keyword">for</span> (<span class="typed"><span class="type">((BaseTypeSeqs.this.Type) =&gt; Unit)Unit</span><span id="21366"><a id="81808">tp</a></span></span> &lt;- <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81805">variants</a></span>) 
                  <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81774">minTypes</a></span> <span class="typed"><span class="type">((BaseTypeSeqs.this.Type) =&gt; Boolean)Boolean</span><a id="21373">exists</a></span> (<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81808">tp</a></span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Boolean</span><a href="Types.scala.html#25702">=:=</a></span>))) <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81774">minTypes</a></span> = <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81808">tp</a></span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)List[BaseTypeSeqs.this.Type]</span><a href="#81812" id="21335">::</a></span> <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81774">minTypes</a></span>
              <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a id="81815">tp</a></span> =&gt;
                <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81774">minTypes</a></span> <span class="typed"><span class="type">((BaseTypeSeqs.this.Type) =&gt; Boolean)Boolean</span><a id="21373">exists</a></span> (<span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81815">tp</a></span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Boolean</span><a href="Types.scala.html#25702">=:=</a></span>))) <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81774">minTypes</a></span> = <span class="typed"><span class="type">BaseTypeSeqs.this.Type</span><a href="#81815">tp</a></span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)List[BaseTypeSeqs.this.Type]</span><a href="#81819" id="21335">::</a></span> <span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81774">minTypes</a></span>
            }
            <span class="typed"><span class="type">Array[Int]</span><a href="#81720">index</a></span>(<span class="typed"><span class="type">Int</span><a href="#81721">i</a></span>) = <span class="typed"><span class="type">(Int)Int</span><a href="#81720" id="21509">index</a></span>(<span class="typed"><span class="type">Int</span><a href="#81721">i</a></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
          }
          <span class="typed"><span class="type">Int</span><a href="#81721">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        }
        <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[BaseTypeSeqs.this.Type]</span><a href="#81714">buf</a></span> <span class="typed"><span class="type">(BaseTypeSeqs.this.Type)Unit</span><a id="33306">+=</a></span> <span class="typed"><span class="type">(List[BaseTypeSeqs.this.Type])BaseTypeSeqs.this.Type</span><a href="Types.scala.html#22036">intersectionType</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81774">minTypes</a></span>)
        <span class="typed"><span class="type">Int</span><a href="#81715">btsSize</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      }
    }
    <span class="keyword">val</span> <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a id="81717">elems</a></span> = <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a id="1072">Array</a></span>[Type](<span class="typed"><span class="type">Int</span><a href="#81715">btsSize</a></span>)
    <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[BaseTypeSeqs.this.Type]</span><a href="#81714">buf</a></span>.<span class="typed"><span class="type">(Array[BaseTypeSeqs.this.Type],Int)Unit</span><a id="21824">copyToArray</a></span>(<span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#81717">elems</a></span>, <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
<span class="comment">//    Console.println(&quot;computed baseTypeSeq of &quot; + tsym.tpe + &quot; &quot; + parents + &quot;: &quot;+elems.toString)//DEBUG</span>
    <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><span class="keyword">new</span></span> <span class="typed"><span class="type">BaseTypeSeqs.this.BaseTypeSeq</span><a href="#22305">BaseTypeSeq</a></span>(<span class="typed"><span class="type">List[BaseTypeSeqs.this.Type]</span><a href="#81713">parents</a></span>, <span class="typed"><span class="type">Array[BaseTypeSeqs.this.Type]</span><a href="#81717">elems</a></span>)
  }

  <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.Throwable</span><span id="22311"><a id="22310">CyclicInheritance</a></span></span> = <span class="typed"><span class="type">java.lang.Throwable</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.lang.Throwable</span><span id="5973"><a id="821">Throwable</a></span></span>
}

        </pre>
    </body>
</html>