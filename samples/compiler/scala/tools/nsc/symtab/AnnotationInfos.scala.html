<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/symtab/AnnotationInfos.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2007-2009 LAMP/EPFL
 * @author  Martin Odersky
 */
// $Id: AnnotationInfos.scala 18387 2009-07-24 15:28:37Z odersky $

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> symtab

<span class="keyword">import</span> scala.tools.nsc.transform.Reifiers
<span class="keyword">import</span> util._

/** AnnotationInfo and its helpers */
<span class="keyword">trait</span> <a title="trait AnnotationInfos extends java.lang.Object with ScalaObject" id="10076">AnnotationInfos</a> <span title="ScalaObject">{</span>
  self: SymbolTable =&gt;

  /** Arguments to classfile annotations (which are written to
   *  bytecode as java annotations) are either:
   *  &lt;ul&gt;
   *   &lt;li&gt;constants&lt;/li&gt;
   *   &lt;li&gt;arrays of constants&lt;/li&gt;
   *   &lt;li&gt;or nested classfile annotations&lt;/li&gt;
   *  &lt;/ul&gt;
   */
  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class ClassfileAnnotArg extends java.lang.Object with ScalaObject" id="26701">ClassfileAnnotArg</a>

  /** Represents a compile-time Constant (Boolean, Byte, Short,
   *  Char, Int, Long, Float, Double, String, java.lang.Class or
   *  an instance of a Java enumeration value).
   */
  case <span class="keyword">class</span> <a title="class LiteralAnnotArg extends AnnotationInfos.this.ClassfileAnnotArg with ScalaObject with Product" id="86850">LiteralAnnotArg</a><span title="ScalaObject">(</span><a title="AnnotationInfos.this.Constant" id="108782">const</a>: <a href="Constants.scala.html#26672" title="AnnotationInfos.this.Constant">Constant</a>)
  <span class="keyword">extends</span> <a href="#26701" title="AnnotationInfos.this.ClassfileAnnotArg">ClassfileAnnotArg</a> {
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="86855">toString</a> = <a href="#108782" title="=&gt; AnnotationInfos.this.Constant">const</a>.<a href="Constants.scala.html#43055" title="=&gt; String">escapedStringValue</a>
  }

  /** Represents an array of classfile annotation arguments */
  case <span class="keyword">class</span> <a title="class ArrayAnnotArg extends AnnotationInfos.this.ClassfileAnnotArg with ScalaObject with Product" id="87063">ArrayAnnotArg</a><span title="ScalaObject">(</span><a title="Array[AnnotationInfos.this.ClassfileAnnotArg]" id="109149">args</a>: <a title="Array[AnnotationInfos.this.ClassfileAnnotArg]" id="905">Array</a>[ClassfileAnnotArg])
  <span class="keyword">extends</span> <a href="#26701" title="AnnotationInfos.this.ClassfileAnnotArg">ClassfileAnnotArg</a> {
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="87068">toString</a> = <a href="#109149" title="=&gt; Array[AnnotationInfos.this.ClassfileAnnotArg]">args</a>.<span title="(start: String,sep: String,end: String)String">mkString</span>(<span title="java.lang.String(&quot;[&quot;)" class="string">&quot;[&quot;</span>, <span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span>, <span title="java.lang.String(&quot;]&quot;)" class="string">&quot;]&quot;</span>)
  }

  /** Represents a nested classfile annotation */
  case <span class="keyword">class</span> <a title="class NestedAnnotArg extends AnnotationInfos.this.ClassfileAnnotArg with ScalaObject with Product" id="87117">NestedAnnotArg</a><span title="ScalaObject">(</span><a title="AnnotationInfos.this.AnnotationInfo" id="109191">annInfo</a>: <a href="#44986" title="AnnotationInfos.this.AnnotationInfo">AnnotationInfo</a>)
  <span class="keyword">extends</span> <a href="#26701" title="AnnotationInfos.this.ClassfileAnnotArg">ClassfileAnnotArg</a> {
    // The nested annotation should not have any Scala annotation arguments
    <a title="(assertion: Boolean,message: =&gt; Any)Unit" id="7945">assert</a>(<a href="#109191" title="=&gt; AnnotationInfos.this.AnnotationInfo">annInfo</a>.<a href="#44989" title="=&gt; List[AnnotationInfos.this.Tree]">args</a>.<span title="=&gt; Boolean">isEmpty</span>, <a href="#109191" title="=&gt; AnnotationInfos.this.AnnotationInfo">annInfo</a>.<a href="#44989" title="=&gt; List[AnnotationInfos.this.Tree]">args</a>)
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="87122">toString</a> = <a href="#109191" title="=&gt; AnnotationInfos.this.AnnotationInfo">annInfo</a>.<a href="#44977" title="()String">toString</a>
  }

  <span class="keyword">class</span> <a title="class AnnotationInfoBase extends java.lang.Object with ScalaObject" id="26711">AnnotationInfoBase</a>

  /** &lt;p&gt;
   *    Typed information about an annotation. It can be attached to
   *    either a symbol or an annotated type.
   *  &lt;/p&gt;
   *  &lt;p&gt;
   *    Annotations are written to the classfile as java annotations
   *    if &lt;code&gt;atp&lt;/code&gt; conforms to &lt;code&gt;ClassfileAnnotation&lt;/code&gt;
   *    (the classfile parser adds this interface to any Java annotation
   *    class).
   *  &lt;/p&gt;
   *  &lt;p&gt;
   *    Annotations are pickled (written to scala symbtab attribute
   *    in the classfile) if &lt;code&gt;atp&lt;/code&gt; inherits form
   *    &lt;code&gt;StaticAnnotation&lt;/code&gt;.
   *  &lt;/p&gt;
   *  &lt;p&gt;
   *    &lt;code&gt;args&lt;/code&gt; stores arguments to Scala annotations,
   *    represented as  typed trees. Note that these trees are not
   *    transformed by any phases following the type-checker.
   *  &lt;/p&gt;
   *  &lt;p&gt;
   *    &lt;code&gt;assocs&lt;/code&gt; stores arguments to classfile annotations
   *    as name-value pairs.
   *  &lt;/p&gt;
   */
  case <span class="keyword">class</span> <a title="class AnnotationInfo extends AnnotationInfos.this.AnnotationInfoBase with ScalaObject with Product" id="44986">AnnotationInfo</a><span title="ScalaObject">(</span><a title="AnnotationInfos.this.Type" id="44988">atp</a>: <a href="Types.scala.html#26364" title="AnnotationInfos.this.Type">Type</a>, <a title="List[AnnotationInfos.this.Tree]" id="44989">args</a>: <span title="List[AnnotationInfos.this.Tree]">List</span>[Tree],
                            <a title="List[(AnnotationInfos.this.Name, AnnotationInfos.this.ClassfileAnnotArg)]" id="44990">assocs</a>: <span title="List[(AnnotationInfos.this.Name, AnnotationInfos.this.ClassfileAnnotArg)]">List</span>[(Name, ClassfileAnnotArg)])
  <span class="keyword">extends</span> <a href="#26711" title="AnnotationInfos.this.AnnotationInfoBase">AnnotationInfoBase</a> {

    // Classfile annot: args empty. Scala annot: assocs empty.
    <a title="(assertion: Boolean)Unit" id="7943">assert</a>(<a href="#44989" title="=&gt; List[AnnotationInfos.this.Tree]">args</a>.<span title="(x$1: Boolean)Boolean">isEmpty</span> || <a href="#44990" title="=&gt; List[(AnnotationInfos.this.Name, AnnotationInfos.this.ClassfileAnnotArg)]">assocs</a>.<span title="=&gt; Boolean">isEmpty</span>)

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="44977">toString</a>: <a title="String" id="1626">String</a> = <a href="#44988" title="(other: String)java.lang.String">atp</a> <span title="(x$1: Any)java.lang.String">+</span>
      (<span title="String" class="keyword">if</span> (<span title="=&gt; Boolean">!</span><a href="#44989" title="=&gt; List[AnnotationInfos.this.Tree]">args</a>.<span title="=&gt; Boolean">isEmpty</span>) <a href="#44989" title="=&gt; List[AnnotationInfos.this.Tree]">args</a>.<span title="(start: String,sep: String,end: String)String">mkString</span>(<span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span>, <span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span>, <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>) <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>) +
      (<span title="Any" class="keyword">if</span> (<span title="=&gt; Boolean">!</span><a href="#44990" title="=&gt; List[(AnnotationInfos.this.Name, AnnotationInfos.this.ClassfileAnnotArg)]">assocs</a>.<span title="=&gt; Boolean">isEmpty</span>) (<a href="#44990" title="(f: ((AnnotationInfos.this.Name, AnnotationInfos.this.ClassfileAnnotArg)) =&gt; java.lang.String)(implicit bf: scala.collection.generic.BuilderFactory[java.lang.String,List[java.lang.String],List[(AnnotationInfos.this.Name, AnnotationInfos.this.ClassfileAnnotArg)]])List[java.lang.String]">assocs</a> <span title="(start: String,sep: String,end: String)String">map</span> <a href="#694072" title="java.lang.String">{</a> <span title="java.lang.String" class="keyword">case</span> <a id="1">(</a><a title="AnnotationInfos.this.Name" id="694075">x</a>, <a title="AnnotationInfos.this.ClassfileAnnotArg" id="694076">y</a>) =&gt; <a href="#694075" title="(other: String)java.lang.String">x</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot; = &quot;)" class="string">&quot; = &quot;</span>+<a href="#694076" title="AnnotationInfos.this.ClassfileAnnotArg">y</a> } mkString (<span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span>, <span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span>, <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>)) <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>)

    /** Check whether the type or any of the arguments are erroneous */
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="44978">isErroneous</a> = <a href="#44988" title="=&gt; AnnotationInfos.this.Type">atp</a>.<a href="Types.scala.html#30395" title="(x$1: Boolean)Boolean">isErroneous</a> || <a href="#44989" title="=&gt; List[AnnotationInfos.this.Tree]">args</a>.<span title="(p: (AnnotationInfos.this.Tree) =&gt; Boolean)Boolean">exists</span>(<a href="#275855" title="AnnotationInfos.this.Tree">_</a>.<a href="../ast/Trees.scala.html#29561" title="=&gt; Boolean">isErroneous</a>)

    /** Check whether any of the arguments mention a symbol */
    <span class="keyword">def</span> <a title="(sym: AnnotationInfos.this.Symbol)Boolean" id="44979">refsSymbol</a>(<a title="AnnotationInfos.this.Symbol" id="275815">sym</a>: <a href="Symbols.scala.html#26286" title="AnnotationInfos.this.Symbol">Symbol</a>) =
      <a href="#44989" title="=&gt; List[AnnotationInfos.this.Tree]">args</a>.<span title="(p: (AnnotationInfos.this.Tree) =&gt; Boolean)Boolean">exists</span>(<a href="#275822" title="AnnotationInfos.this.Tree">_</a>.<a href="../ast/Trees.scala.html#29565" title="(p: (AnnotationInfos.this.Tree) =&gt; Boolean)Boolean">exists</a>(<a href="#275825" title="AnnotationInfos.this.Tree">_</a>.<a href="../ast/Trees.scala.html#29553" title="(x$1: AnyRef)Boolean">symbol</a> == <a href="#275815" title="AnnotationInfos.this.Symbol">sym</a>))

    /** Change all ident's with Symbol &quot;from&quot; to instead use symbol &quot;to&quot; */
    <span class="keyword">def</span> <a title="(from: AnnotationInfos.this.Symbol,to: AnnotationInfos.this.Symbol)AnnotationInfos.this.AnnotationInfo" id="44980">substIdentSyms</a>(<a title="AnnotationInfos.this.Symbol" id="694189">from</a>: <a href="Symbols.scala.html#26286" title="AnnotationInfos.this.Symbol">Symbol</a>, <a title="AnnotationInfos.this.Symbol" id="694190">to</a>: <a href="Symbols.scala.html#26286" title="AnnotationInfos.this.Symbol">Symbol</a>) = {
      <span class="keyword">val</span> <a title="AnnotationInfos.this.TreeSymSubstituter" id="694193">subs</a> = <span title="AnnotationInfos.this.TreeSymSubstituter" class="keyword">new</span> <a href="../ast/Trees.scala.html#26938" title="AnnotationInfos.this.TreeSymSubstituter">TreeSymSubstituter</a>(<span title="(xs: AnnotationInfos.this.Symbol*)List[AnnotationInfos.this.Symbol]">List</span>(<a href="#694189" title="AnnotationInfos.this.Symbol">from</a>), <span title="(xs: AnnotationInfos.this.Symbol*)List[AnnotationInfos.this.Symbol]">List</span>(<a href="#694190" title="AnnotationInfos.this.Symbol">to</a>))
      <a href="#44986" title="(atp: AnnotationInfos.this.Type,args: List[AnnotationInfos.this.Tree],assocs: List[(AnnotationInfos.this.Name, AnnotationInfos.this.ClassfileAnnotArg)])AnnotationInfos.this.AnnotationInfo">AnnotationInfo</a>(<a href="#44988" title="=&gt; AnnotationInfos.this.Type">atp</a>, <a href="#44989" title="=&gt; List[AnnotationInfos.this.Tree]">args</a>.<span title="(f: (AnnotationInfos.this.Tree) =&gt; AnnotationInfos.this.Tree)(implicit bf: scala.collection.generic.BuilderFactory[AnnotationInfos.this.Tree,List[AnnotationInfos.this.Tree],List[AnnotationInfos.this.Tree]])List[AnnotationInfos.this.Tree]">map</span><span title="scala.collection.generic.BuilderFactory[AnnotationInfos.this.Tree,List[AnnotationInfos.this.Tree],List#Coll]">(</span><a href="../ast/Trees.scala.html#145347" title="(tree: AnnotationInfos.this.Tree)AnnotationInfos.this.Tree">subs</a>(<a href="#694236" title="AnnotationInfos.this.Tree">_</a>)), <a href="#44990" title="=&gt; List[(AnnotationInfos.this.Name, AnnotationInfos.this.ClassfileAnnotArg)]">assocs</a>)
    }
  }

  /** Symbol annotations parsed in Namer (typeCompleter of
   *  definitions) have to be lazy (#1782)
   */
  case <span class="keyword">class</span> <a title="class LazyAnnotationInfo extends AnnotationInfos.this.AnnotationInfoBase with ScalaObject with Product" id="694392">LazyAnnotationInfo</a><span title="ScalaObject">(</span><a title="() =&gt; AnnotationInfos.this.AnnotationInfo" id="694432">annot</a>: () =&gt; AnnotationInfo)
  <span class="keyword">extends</span> <a href="#26711" title="AnnotationInfos.this.AnnotationInfoBase">AnnotationInfoBase</a>
}

        </pre>
    </body>
</html>