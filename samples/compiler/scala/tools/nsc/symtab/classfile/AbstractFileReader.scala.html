<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/symtab/classfile/AbstractFileReader.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */
// $Id: AbstractFileReader.scala 18387 2009-07-24 15:28:37Z odersky $


<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> symtab
<span class="keyword">package</span> classfile

<span class="keyword">import</span> java.lang.Float.intBitsToFloat
<span class="keyword">import</span> java.lang.Double.longBitsToDouble

<span class="keyword">import</span> scala.tools.nsc.io.AbstractFile

/** 
 * This class reads files byte per byte. Only used by ClassFileParser
 *
 * @author Philippe Altherr
 * @version 1.0, 23/03/2004
 */
<span class="keyword">class</span> <a title="class AbstractFileReader extends java.lang.Object with ScalaObject" id="20331">AbstractFileReader</a><a title="ScalaObject" id="959">(</a><span class="keyword">val</span> <a title="scala.tools.nsc.io.AbstractFile" id="102428">file</a>: <a href="../../io/AbstractFile.scala.html#20548" title="scala.tools.nsc.io.AbstractFile">AbstractFile</a>) {

  /** the buffer containing the file
   */
  <span class="keyword">val</span> <a title="Array[Byte]" id="102228">buf</a>: <span title="Array[Byte]">Array</span>[Byte] = <a href="#102428" title="=&gt; scala.tools.nsc.io.AbstractFile">file</a>.<a href="../../io/AbstractFile.scala.html#51397" title="=&gt; Array[Byte]">toByteArray</a>

  /** the current input pointer
   */
  <span class="keyword">var</span> <a title="Int" id="102231">bp</a>: <span title="Int">Int</span> = <span title="Int(0)" class="int">0</span>

  /** return byte at offset 'pos'
   */
  @throws(classOf[IndexOutOfBoundsException])
  <span class="keyword">def</span> <a title="(pos: Int)Byte" id="102233">byteAt</a>(<a title="Int" id="175272">pos</a>: <span title="Int">Int</span>): <span title="Byte">Byte</span> = <a href="#102228" title="(i: Int)Byte">buf</a>(<a href="#175272" title="Int">pos</a>)

  /** read a byte
   */
  @throws(classOf[IndexOutOfBoundsException])
  <span class="keyword">def</span> <a title="=&gt; Byte" id="102234">nextByte</a>: <span title="Byte">Byte</span> = {
    <span class="keyword">val</span> <a title="Byte" id="175283">b</a> = <a href="#102228" title="(i: Int)Byte">buf</a>(<a href="#102231" title="=&gt; Int">bp</a>)
    <a href="#102231" title="(x$1: Int)Unit">bp</a> += <span title="Int(1)" class="int">1</span>
    <a href="#175283" title="Byte">b</a>
  }

  /** read some bytes
   */
  <span class="keyword">def</span> <a title="(len: Int)Array[Byte]" id="102235">nextBytes</a>(<a title="Int" id="175332">len</a>: <span title="Int">Int</span>): <span title="Array[Byte]">Array</span>[Byte] = {
    <a href="#102231" title="(x$1: Int)Unit">bp</a> += <a href="#175332" title="Int">len</a>
    <a href="#102228" title="=&gt; Array[Byte]">buf</a>.<a title="(from: Int,until: Int)Array[Byte]" id="25777">slice</a>(<a href="#102231" title="(x$1: Int)Int" id="2966">bp</a> - <a href="#175332" title="Int">len</a>, <a href="#102231" title="=&gt; Int">bp</a>)
  }

  /** read a character
   */
  <span class="keyword">def</span> <a title="=&gt; Char" id="102236">nextChar</a>: <span title="Char">Char</span> =
    (<span title="(x$1: Int)Int">(</span><span title="(x$1: Int)Int">(</span><a href="#102234" title="(x$1: Int)Int">nextByte</a> &amp; <span title="Int(255)" class="int">0xff</span>) &lt;&lt; <span title="Int(8)" class="int">8</span>) + (<a href="#102234" title="(x$1: Int)Int">nextByte</a> &amp; <span title="Int(255)" class="int">0xff</span>)).<span title="=&gt; Char">toChar</span>

  /** read an integer
   */
  <span class="keyword">def</span> <a title="=&gt; Int" id="102237">nextInt</a>: <span title="Int">Int</span> =
    <span title="(x$1: Int)Int">(</span><span title="(x$1: Int)Int">(</span><a href="#102234" title="(x$1: Int)Int">nextByte</a> &amp; <span title="Int(255)" class="int">0xff</span>) &lt;&lt; <span title="Int(24)" class="int">24</span>) <span title="(x$1: Int)Int">+</span> (<span title="(x$1: Int)Int">(</span><a href="#102234" title="(x$1: Int)Int">nextByte</a> &amp; <span title="Int(255)" class="int">0xff</span>) &lt;&lt; <span title="Int(16)" class="int">16</span>) <span title="(x$1: Int)Int">+</span>
    (<span title="(x$1: Int)Int">(</span><a href="#102234" title="(x$1: Int)Int">nextByte</a> &amp; <span title="Int(255)" class="int">0xff</span>) &lt;&lt;  <span title="Int(8)" class="int">8</span>) +  (<a href="#102234" title="(x$1: Int)Int">nextByte</a> &amp; <span title="Int(255)" class="int">0xff</span>)


  /** extract a character at position bp from buf
   */
  <span class="keyword">def</span> <a title="(mybp: Int)Char" id="102238">getChar</a>(<a title="Int" id="102827">mybp</a>: <span title="Int">Int</span>): <span title="Char">Char</span> =
    (<span title="(x$1: Int)Int">(</span><span title="(x$1: Int)Int">(</span><a href="#102228" title="(i: Int)Byte">buf</a><span title="(x$1: Int)Int">(</span><a href="#102827" title="Int">mybp</a>) &amp; <span title="Int(255)" class="int">0xff</span>) &lt;&lt; <span title="Int(8)" class="int">8</span>) + (<a href="#102228" title="(i: Int)Byte">buf</a><span title="(x$1: Int)Int">(</span><a href="#102827" title="(x$1: Int)Int">mybp</a>+<span title="Int(1)" class="int">1</span>) &amp; <span title="Int(255)" class="int">0xff</span>)).<span title="=&gt; Char">toChar</span>

  /** extract an integer at position bp from buf
   */
  <span class="keyword">def</span> <a title="(mybp: Int)Int" id="102239">getInt</a>(<a title="Int" id="104107">mybp</a>: <span title="Int">Int</span>): <span title="Int">Int</span> =
    <span title="(x$1: Int)Int">(</span><span title="(x$1: Int)Int">(</span><a href="#102228" title="(i: Int)Byte">buf</a><span title="(x$1: Int)Int">(</span><a href="#104107" title="Int">mybp</a>  ) &amp; <span title="Int(255)" class="int">0xff</span>) &lt;&lt; <span title="Int(24)" class="int">24</span>) <span title="(x$1: Int)Int">+</span> (<span title="(x$1: Int)Int">(</span><a href="#102228" title="(i: Int)Byte">buf</a><span title="(x$1: Int)Int">(</span><a href="#104107" title="(x$1: Int)Int">mybp</a>+<span title="Int(1)" class="int">1</span>) &amp; <span title="Int(255)" class="int">0xff</span>) &lt;&lt; <span title="Int(16)" class="int">16</span>) <span title="(x$1: Int)Int">+</span>
    (<span title="(x$1: Int)Int">(</span><a href="#102228" title="(i: Int)Byte">buf</a><span title="(x$1: Int)Int">(</span><a href="#104107" title="(x$1: Int)Int">mybp</a>+<span title="Int(2)" class="int">2</span>) &amp; <span title="Int(255)" class="int">0xff</span>) &lt;&lt; <span title="Int(8)" class="int">8</span>) + (<a href="#102228" title="(i: Int)Byte">buf</a><span title="(x$1: Int)Int">(</span><a href="#104107" title="(x$1: Int)Int">mybp</a>+<span title="Int(3)" class="int">3</span>) &amp; <span title="Int(255)" class="int">0xff</span>)

  /** extract a long integer at position bp from buf
   */
  <span class="keyword">def</span> <a title="(mybp: Int)Long" id="102240">getLong</a>(<a title="Int" id="104171">mybp</a>: <span title="Int">Int</span>): <a title="Long" id="2184">Long</a> =
    <a title="(x$1: Long)Long" id="3200">(</a><a href="#102239" title="(mybp: Int)Int">getInt</a>(<a href="#104171" title="Int">mybp</a>).<a title="(x$1: Int)Long" id="2848">toLong</a> &lt;&lt; <span title="Int(32)" class="int">32</span>) + (<a href="#102239" title="(mybp: Int)Int">getInt</a><a title="(x$1: Long)Long" id="3004">(</a><a href="#104171" title="(x$1: Int)Int">mybp</a> + <span title="Int(4)" class="int">4</span>) &amp; <span title="Long(4294967295L)" class="long">0xffffffffL</span>)

  /** extract a float at position bp from buf
   */
  <span class="keyword">def</span> <a title="(mybp: Int)Float" id="102241">getFloat</a>(<a title="Int" id="104139">mybp</a>: <span title="Int">Int</span>): <a title="Float" id="2191">Float</a> = <a title="(x$1: Int)Float" id="1870">intBitsToFloat</a>(<a href="#102239" title="(mybp: Int)Int">getInt</a>(<a href="#104139" title="Int">mybp</a>))

  /** extract a double at position bp from buf
   */
  <span class="keyword">def</span> <a title="(mybp: Int)Double" id="102242">getDouble</a>(<a title="Int" id="104203">mybp</a>: <span title="Int">Int</span>): <a title="Double" id="2198">Double</a> = <a title="(x$1: Long)Double" id="1879">longBitsToDouble</a>(<a href="#102240" title="(mybp: Int)Long">getLong</a>(<a href="#104203" title="Int">mybp</a>))

  /** skip next 'n' bytes
   */
  <span class="keyword">def</span> <a title="(n: Int)Unit" id="102243">skip</a>(<a title="Int" id="102642">n</a>: <span title="Int">Int</span>) { <a href="#102231" title="(x$1: Int)Unit">bp</a> += <a href="#102642" title="Int">n</a> }

}

        </pre>
    </body>
</html>