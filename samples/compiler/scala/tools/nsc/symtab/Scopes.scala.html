<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/symtab/Scopes.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */
// $Id: Scopes.scala 18431 2009-08-02 18:22:20Z odersky $

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> symtab

// Martin: I am about 1/4 way on a cleanup of scopes.
// The most important change is that scopes are now Iterables.
// This removed the need for the various iterators on ScopeEntries.
// ScopeEntries are conceptually an internal representation detail,
// so it's better not to return them in public iterators.
// It's true that other code also references ScopeEntries but that's
// done for performance (and could be reviewed).
// Another addition is a lookupAll method that returns all symbols with
// a name in a scopein an iterator.
// I still have to remove all the cruft about PackageScope's and the like
// that's a leftover from the old Eclipse plugin days.
//
<span class="keyword">trait</span> <a title="trait Scopes extends java.lang.Object with ScalaObject" id="11030">Scopes</a> <span title="ScalaObject">{</span>
  self: SymbolTable =&gt;

  <span class="keyword">class</span> <a title="class ScopeEntry extends java.lang.Object with ScalaObject" id="25963">ScopeEntry</a><span title="ScalaObject">(</span><span class="keyword">val</span> <a title="Scopes.this.Symbol" id="27654">sym</a>: <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>, <span class="keyword">val</span> <a title="Scopes.this.Scope" id="27655">owner</a>: <a href="#26012" title="Scopes.this.Scope">Scope</a>) {
    /** the next entry in the hash bucket
     */
    <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="26813">tail</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a> = <span title="Null(null)" class="keyword">null</span>

    /** the next entry in this scope
     */
    <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="26816">next</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a> = <span title="Null(null)" class="keyword">null</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Int" id="26818">hashCode</a>(): <span title="Int">Int</span> = <a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="=&gt; Scopes.this.Name">name</a>.<a href="Names.scala.html#28193" title="=&gt; Int">start</a>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="26819">toString</a>(): <span title="String">String</span> = <a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#27091" title="()String">toString</a>()
  }

  /**
   *  @param sym   ...
   *  @param owner ...
   *  @return      ...
   */
  <span class="keyword">def</span> <a title="(sym: Scopes.this.Symbol,owner: Scopes.this.Scope)Scopes.this.ScopeEntry" id="25964">newScopeEntry</a>(<a title="Scopes.this.Symbol" id="28821">sym</a>: <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>, <a title="Scopes.this.Scope" id="28822">owner</a>: <a href="#26012" title="Scopes.this.Scope">Scope</a>): <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a> = {
    <span class="keyword">val</span> <a title="Scopes.this.ScopeEntry" id="28824">e</a> = <span title="Scopes.this.ScopeEntry" class="keyword">new</span> <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>(<a href="#28821" title="Scopes.this.Symbol">sym</a>, <a href="#28822" title="Scopes.this.Scope">owner</a>)
    <a href="#28824" title="Scopes.this.ScopeEntry">e</a>.<a href="#26816" title="(x$1: Scopes.this.ScopeEntry)Unit">next</a> = <a href="#28822" title="Scopes.this.Scope">owner</a>.<a href="#27106" title="=&gt; Scopes.this.ScopeEntry">elems</a>
    <a href="#28822" title="Scopes.this.Scope">owner</a>.<a href="#27106" title="(x$1: Scopes.this.ScopeEntry)Unit">elems</a> = <a href="#28824" title="Scopes.this.ScopeEntry">e</a>
    <a href="#28824" title="Scopes.this.ScopeEntry">e</a>
  }

  // Martin: This code contains a lot of stuff for the old Eclipse plugin.
  // Now it's just needless complexity, which should be eleminated.
  // We should make the elems list doubly-linked,
  // and have scopes inherit from LinearSequence,
  // that way, we need to do way fewer toList than before.

  /**
   *  @param initElems ...
   *  @return          ...
   */
  <span class="keyword">def</span> <a title="(initElems: Scopes.this.ScopeEntry)Scopes.this.Scope" id="25965">newScope</a>(<a title="Scopes.this.ScopeEntry" id="28836">initElems</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>): <a href="#26012" title="Scopes.this.Scope">Scope</a> = <span title="Scopes.this.NormalScope" class="keyword">new</span> <a href="#26010" title="Scopes.this.NormalScope">NormalScope</a>(<a href="#28836" title="Scopes.this.ScopeEntry">initElems</a>)

  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Scopes.this.Scope" id="25966">newScope</a>: <a href="#26012" title="Scopes.this.Scope">Scope</a> = <a href="#25965" title="(initElems: Scopes.this.ScopeEntry)Scopes.this.Scope">newScope</a>(<span title="Null(null)" class="keyword">null</span>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>)

  <span class="keyword">trait</span> <a title="trait PackageScopeDependMap extends java.lang.Object" id="25967">PackageScopeDependMap</a> <a title="java.lang.Object" id="3625">{</a>
    <span class="keyword">def</span> <a title="(from: Scopes.this.Symbol,name: Scopes.this.Name)Unit" id="29027">createDepend</a>(<a title="Scopes.this.Symbol" id="29029">from</a> : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>, <a title="Scopes.this.Name" id="29030">name</a> : <a href="Names.scala.html#26055" title="Scopes.this.Name">Name</a>) : <span title="Unit">Unit</span>
  }
  
  <span class="keyword">def</span> <a title="(depends0: Scopes.this.PackageScopeDependMap)Scopes.this.PackageScope" id="25968">newPackageScope</a>(<a title="Scopes.this.PackageScopeDependMap" id="29031">depends0</a> : <a href="#25967" title="Scopes.this.PackageScopeDependMap">PackageScopeDependMap</a>) : <a href="#26011" title="Scopes.this.PackageScope">PackageScope</a> = {
    <span class="keyword">object</span> <a title="object MyPackageScope" id="29037">MyPackageScope</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#26010" title="Scopes.this.NormalScope">NormalScope</a>(<span title="Null(null)" class="keyword">null</span> : <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>) <span class="keyword">with</span> <a href="#26011" title="Scopes.this.PackageScope">PackageScope</a> {
      <span class="keyword">val</span> <a title="Scopes.this.PackageScopeDependMap" id="29040">depends</a> = <a href="#29031" title="Scopes.this.PackageScopeDependMap">depends0</a>
    }
    <a href="#29037" title="object MyPackageScope">MyPackageScope</a>
  }
   
  <span class="keyword">def</span> <a title="=&gt; Scopes.this.Scope" id="25969">newTempScope</a> = <a href="#25965" title="(initElems: Scopes.this.ScopeEntry)Scopes.this.Scope">newScope</a>(<span title="Null(null)" class="keyword">null</span> : <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>)
  <span class="keyword">class</span> <a title="class ScopeKind extends java.lang.Object with ScalaObject" id="25970">ScopeKind</a><span title="ScalaObject">(</span><a title="String" id="29063">name</a> : <span title="String">String</span>) { <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="29060">toString</a> = <a href="#29063" title="String">name</a> }
  <span class="keyword">def</span> <a title="(name: String)Scopes.this.ScopeKind" id="25971">allocateScopeKind</a>(<a title="String" id="29069">name</a> : <span title="String">String</span>) = <span title="Scopes.this.ScopeKind" class="keyword">new</span> <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a>(<a href="#29069" title="String">name</a>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25973">Constructor0ScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;constructors0&quot;)" class="string">&quot;constructors0&quot;</span>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25975">Constructor1ScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;constructors1&quot;)" class="string">&quot;constructors1&quot;</span>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25977">InnerScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;inner&quot;)" class="string">&quot;inner&quot;</span>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25979">FinishWithScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;finishWith&quot;)" class="string">&quot;finishWith&quot;</span>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25981">TypeSigScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;typeSig&quot;)" class="string">&quot;typeSig&quot;</span>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25983">PolyTypeCompleterScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;polyType&quot;)" class="string">&quot;polyType&quot;</span>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25985">CompoundTreeScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;compoundTree&quot;)" class="string">&quot;compoundTree&quot;</span>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25987">FreshArgScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;freshArgs&quot;)" class="string">&quot;freshArgs&quot;</span>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25989">LabelScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;label&quot;)" class="string">&quot;label&quot;</span>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25991">TypedCasesScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;typedCases&quot;)" class="string">&quot;typedCases&quot;</span>)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25993">TypedDefScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;typedDef&quot;)" class="string">&quot;typedDef&quot;</span>)
  //lazy val ParentTypesScopeKind : ScopeKind = allocateScopeKind(&quot;parentType&quot;)
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Scopes.this.ScopeKind" id="25995">TypedScopeKind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a> = <a href="#25971" title="(name: String)Scopes.this.ScopeKind">allocateScopeKind</a>(<span title="java.lang.String(&quot;typed&quot;)" class="string">&quot;typed&quot;</span>)
  // have to sometimes use constructor depth unfortunately.
  case <span class="keyword">class</span> <a title="class ParentTypesScopeKind extends Scopes.this.ScopeKind with ScalaObject with Product" id="29185">ParentTypesScopeKind</a><span title="ScalaObject">(</span><a title="Scopes.this.Symbol" id="32832">clazz</a> : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) <span class="keyword">extends</span> <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a>(<span title="java.lang.String(&quot;parentType&quot;)" class="string">&quot;parentType&quot;</span>) { <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="29102">toString</a> = <span class="keyword">super</span>.<a href="#29060" title="(x$1: Any)java.lang.String">toString</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;-&quot;)" class="string">&quot;-&quot;</span> + <a href="#32832" title="=&gt; Scopes.this.Symbol">clazz</a> }
  case <span class="keyword">class</span> <a title="class BlockScopeKind extends Scopes.this.ScopeKind with ScalaObject with Product" id="29309">BlockScopeKind</a><span title="ScalaObject">(</span><a title="Int" id="32824">depth</a> : <span title="Int">Int</span>) <span class="keyword">extends</span> <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a>(<span title="java.lang.String(&quot;block&quot;)" class="string">&quot;block&quot;</span>) { <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="29276">toString</a> = <span class="keyword">super</span>.<a href="#29060" title="(x$1: Any)java.lang.String">toString</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;-&quot;)" class="string">&quot;-&quot;</span> + <a href="#32824" title="=&gt; Int">depth</a> }
  
  <span class="keyword">def</span> <a title="(clazz: Scopes.this.Symbol)Scopes.this.Scope" id="26002">newClassScope</a>(<a title="Scopes.this.Symbol" id="29346">clazz</a> : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) = <a href="#25966" title="=&gt; Scopes.this.Scope">newScope</a> // for use in ClassInfoType creation
  <span class="keyword">def</span> <a title="(tree: Scopes.this.Tree,kind: Scopes.this.ScopeKind)Scopes.this.Scope" id="26003">scopeFor</a>(             <a title="Scopes.this.Tree" id="29352">tree</a> : <a href="../ast/Trees.scala.html#26593" title="Scopes.this.Tree">Tree</a>, <a title="Scopes.this.ScopeKind" id="29353">kind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a>) : <a href="#26012" title="Scopes.this.Scope">Scope</a> = <a href="#25966" title="=&gt; Scopes.this.Scope">newScope</a>
  <span class="keyword">def</span> <a title="(old: Scopes.this.Scope,tree: Scopes.this.Tree,kind: Scopes.this.ScopeKind)Scopes.this.Scope" id="26004">scopeFor</a>(<a title="Scopes.this.Scope" id="29393">old</a> : <a href="#26012" title="Scopes.this.Scope">Scope</a>, <a title="Scopes.this.Tree" id="29394">tree</a> : <a href="../ast/Trees.scala.html#26593" title="Scopes.this.Tree">Tree</a>, <a title="Scopes.this.ScopeKind" id="29395">kind</a> : <a href="#25970" title="Scopes.this.ScopeKind">ScopeKind</a>) : <a href="#26012" title="Scopes.this.Scope">Scope</a> = <a href="#26005" title="(base: Scopes.this.Scope)Scopes.this.Scope">newScope</a>(<a href="#29393" title="Scopes.this.Scope">old</a>)
  
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(base: Scopes.this.Scope)Scopes.this.Scope" id="26005">newScope</a>(<a title="Scopes.this.Scope" id="29021">base</a>: <a href="#26012" title="Scopes.this.Scope">Scope</a>) : <a href="#26012" title="Scopes.this.Scope">Scope</a> = <a href="#25965" title="(initElems: Scopes.this.ScopeEntry)Scopes.this.Scope">newScope</a>(<a href="#29021" title="Scopes.this.Scope">base</a>.<a href="#27106" title="=&gt; Scopes.this.ScopeEntry">elems</a>)
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(decls: List[Scopes.this.Symbol])Scopes.this.Scope" id="26006">newScope</a>(<a title="List[Scopes.this.Symbol]" id="28851">decls</a>: <span title="List[Scopes.this.Symbol]">List</span>[Symbol]) : <a href="#26012" title="Scopes.this.Scope">Scope</a> = {
    <span class="keyword">val</span> <a title="Scopes.this.Scope" id="29411">ret</a> = <a href="#25966" title="=&gt; Scopes.this.Scope">newScope</a>
    <a href="#28851" title="(f: (Scopes.this.Symbol) =&gt; Scopes.this.Symbol)Unit">decls</a> foreach <a href="#29411" title="Scopes.this.Scope">ret</a>.<a href="#27131" title="(sym: Scopes.this.Symbol)Scopes.this.Symbol">enter</a>
    <a href="#29411" title="Scopes.this.Scope">ret</a>
  }
  <span class="keyword">def</span> <a title="(decls: List[Scopes.this.Symbol])Scopes.this.Scope" id="26007">newThrowAwayScope</a>(<a title="List[Scopes.this.Symbol]" id="29456">decls</a> : <span title="List[Scopes.this.Symbol]">List</span>[Symbol]) : <a href="#26012" title="Scopes.this.Scope">Scope</a> = <a href="#26006" title="(decls: List[Scopes.this.Symbol])Scopes.this.Scope">newScope</a>(<a href="#29456" title="List[Scopes.this.Symbol]">decls</a>)
  // for symbols that don't exist in scopes! 
  <span class="keyword">def</span> <a title="(sym: Scopes.this.Symbol)Scopes.this.Symbol" id="26008">recycle</a>(<a title="Scopes.this.Symbol" id="29465">sym</a> : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a> = <a href="#29465" title="Scopes.this.Symbol">sym</a>
  <span class="keyword">def</span> <a title="(clazz: Scopes.this.Symbol,pos: scala.tools.nsc.util.Position)Scopes.this.TermSymbol" id="26009">newLocalDummy</a>(<a title="Scopes.this.Symbol" id="29467">clazz</a> : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>, <a title="scala.tools.nsc.util.Position" id="29468">pos</a> : util.<a href="../util/Position.scala.html#14710" title="scala.tools.nsc.util.Position">Position</a>) = <a href="#29467" title="Scopes.this.Symbol">clazz</a>.<a href="Symbols.scala.html#26866" title="(pos: scala.tools.nsc.util.Position)Scopes.this.TermSymbol">newLocalDummy</a>(<a href="#29468" title="scala.tools.nsc.util.Position">pos</a>)

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class NormalScope extends Scopes.this.Scope with ScalaObject" id="26010">NormalScope</a><span title="ScalaObject">(</span><a title="Scopes.this.ScopeEntry" id="28841">initElems</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>) <span class="keyword">extends</span> <a href="#26012" title="Scopes.this.Scope">Scope</a>(<a href="#28841" title="Scopes.this.ScopeEntry">initElems</a>)

  <span class="keyword">trait</span> <a title="trait PackageScope extends Scopes.this.Scope with ScalaObject" id="26011">PackageScope</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#26012" title="Scopes.this.Scope">Scope</a> {
    <span class="keyword">val</span> <a title="=&gt; Scopes.this.PackageScopeDependMap" id="29034">depends</a> : <a href="#25967" title="Scopes.this.PackageScopeDependMap">PackageScopeDependMap</a>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(name: Scopes.this.Name)(from: Scopes.this.Symbol)Scopes.this.ScopeEntry" id="29035">lookupEntryWithContext</a>(<a title="Scopes.this.Name" id="30324">name</a> : <a href="Names.scala.html#26055" title="Scopes.this.Name">Name</a>)(<a title="Scopes.this.Symbol" id="30325">from</a> : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) = {
      <span title="Unit" class="keyword">if</span> (<a href="#30325" title="(x$1: AnyRef)Boolean">from</a> <span title="(x$1: Boolean)Boolean">!=</span> <a href="Symbols.scala.html#26134" title="object Scopes.this.NoSymbol">NoSymbol</a> &amp;&amp; <a href="#29034" title="(x$1: AnyRef)Boolean">depends</a> != <span title="Null(null)" class="keyword">null</span>) {
        <a href="#29034" title="=&gt; Scopes.this.PackageScopeDependMap">depends</a>.<a href="#29027" title="(from: Scopes.this.Symbol,name: Scopes.this.Name)Unit">createDepend</a>(<a href="#30325" title="Scopes.this.Symbol">from</a>,<a href="#30324" title="Scopes.this.Name">name</a>)
      }
      <a href="#783437" title="(name: Scopes.this.Name)(from: Scopes.this.Symbol)Scopes.this.ScopeEntry" class="keyword">super</a>.<a title="(name: Scopes.this.Name)(from: Scopes.this.Symbol)Scopes.this.ScopeEntry" id="783437">lookupEntryWithContext</a>(<a href="#30324" title="Scopes.this.Name">name</a>)(<a href="#30325" title="Scopes.this.Symbol">from</a>)
    }
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(name: Scopes.this.Name)(from: Scopes.this.Symbol)Scopes.this.Symbol" id="29036">lookupWithContext</a>(<a title="Scopes.this.Name" id="30369">name</a> : <a href="Names.scala.html#26055" title="Scopes.this.Name">Name</a>)(<a title="Scopes.this.Symbol" id="30370">from</a> : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) = {
      <span title="Unit" class="keyword">if</span> (<a href="#30370" title="(x$1: AnyRef)Boolean">from</a> <span title="(x$1: Boolean)Boolean">!=</span> <a href="Symbols.scala.html#26134" title="object Scopes.this.NoSymbol">NoSymbol</a> &amp;&amp; <a href="#29034" title="(x$1: AnyRef)Boolean">depends</a> != <span title="Null(null)" class="keyword">null</span>) {
        <a href="#29034" title="=&gt; Scopes.this.PackageScopeDependMap">depends</a>.<a href="#29027" title="(from: Scopes.this.Symbol,name: Scopes.this.Name)Unit">createDepend</a>(<a href="#30370" title="Scopes.this.Symbol">from</a>,<a href="#30369" title="Scopes.this.Name">name</a>)
      }
      <a href="#783440" title="(name: Scopes.this.Name)(from: Scopes.this.Symbol)Scopes.this.Symbol" class="keyword">super</a>.<a title="(name: Scopes.this.Name)(from: Scopes.this.Symbol)Scopes.this.Symbol" id="783440">lookupWithContext</a>(<a href="#30369" title="Scopes.this.Name">name</a>)(<a href="#30370" title="Scopes.this.Symbol">from</a>)
    }
  }
  
  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Scope extends java.lang.Object with Iterable[Scopes.this.Symbol] with ScalaObject" id="26012">Scope</a><span title="ScalaObject">(</span><a title="Scopes.this.ScopeEntry" id="30316">initElems</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>) <span class="keyword">extends</span> <a title="Iterable[Scopes.this.Symbol]" id="4471">Iterable</a>[Symbol] {

    <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="27106">elems</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a> = <a href="#30316" title="Scopes.this.ScopeEntry">initElems</a>

    /** The number of times this scope is neted in another
     */
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="27109">nestinglevel</a> = <span title="Int(0)" class="int">0</span>

    /** the hash table
     */
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Array[Scopes.this.ScopeEntry]" id="27112">hashtable</a>: <span title="Array[Scopes.this.ScopeEntry]">Array</span>[ScopeEntry] = <span title="Null(null)" class="keyword">null</span>

    /** a cache for all elements, to be used by symbol iterator.
     */
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="List[Scopes.this.Symbol]" id="27115">elemsCache</a>: <span title="List[Scopes.this.Symbol]">List</span>[Symbol] = <span title="Null(null)" class="keyword">null</span>

    /** size and mask of hash tables
     *  todo: make hashtables grow?
     */
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="Int" id="27117">HASHSIZE</a> = <span title="Int(128)" class="int">0x80</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="Int" id="27119">HASHMASK</a> = <span title="Int(127)" class="int">0x7f</span>

    /** the threshold number of entries from which a hashtable is constructed.
     */
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="Int" id="27121">MIN_HASH</a> = <span title="Int(8)" class="int">8</span>

    <span title="Unit" class="keyword">if</span> (<a href="#27129" title="(x$1: Int)Boolean">size</a> &gt;= <a href="#27121" title="=&gt; Int">MIN_HASH</a>) <a href="#27133" title="()Unit">createHash</a>()

    <span class="keyword">def</span> <a title="()Scopes.this.Scope" id="27123" class="keyword">this</a>() = <a href="#26012" title="Scope.this.type" class="keyword">this</a>(<span title="Null(null)" class="keyword">null</span>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>)

    <span class="keyword">def</span> <a title="(base: Scopes.this.Scope)Scopes.this.Scope" id="27124" class="keyword">this</a>(<a title="Scopes.this.Scope" id="30315">base</a>: <a href="#26012" title="Scopes.this.Scope">Scope</a>) = <span title="Unit">{</span>
      <a href="#26012" title="Scope.this.type" class="keyword">this</a>(<a href="#30315" title="Scopes.this.Scope">base</a>.<a href="#27106" title="=&gt; Scopes.this.ScopeEntry">elems</a>)
      <a href="#27109" title="(x$1: Int)Unit">nestinglevel</a> = <a href="#30315" title="Scopes.this.Scope">base</a>.<a href="#27109" title="(x$1: Int)Int">nestinglevel</a> + <span title="Int(1)" class="int">1</span>
    }

    <span class="keyword">def</span> <a title="(decls: List[Scopes.this.Symbol])Scopes.this.Scope" id="27125" class="keyword">this</a>(<a title="List[Scopes.this.Symbol]" id="30314">decls</a>: <span title="List[Scopes.this.Symbol]">List</span>[Symbol]) = <span title="Unit">{</span>
      <a href="#27123" title="()Scopes.this.Scope" class="keyword">this</a>()
      <a href="#30314" title="(f: (Scopes.this.Symbol) =&gt; Scopes.this.Symbol)Unit">decls</a> foreach <a href="#27131" title="(sym: Scopes.this.Symbol)Scopes.this.Symbol">enter</a>
    }

    /** Returns a new scope with the same content as this one. */
    <span class="keyword">def</span> <a title="=&gt; Scopes.this.Scope" id="27126">cloneScope</a>: <a href="#26012" title="Scopes.this.Scope">Scope</a> = {
      <span class="keyword">val</span> <a title="Scopes.this.Scope" id="31517">clone</a> = <a href="#25966" title="=&gt; Scopes.this.Scope">newScope</a>
      <a href="#26012" title="Scope.this.type" class="keyword">this</a>.<a href="#27144" title="(f: (Scopes.this.Symbol) =&gt; Scopes.this.Symbol)Unit">toList</a> foreach (<a href="#27131" title="(sym: Scopes.this.Symbol)Scopes.this.Symbol">clone</a> enter <a href="#31540" title="Scopes.this.Symbol">_</a>)
      <a href="#31517" title="Scopes.this.Scope">clone</a>
    }
    /* clear the contents of this scope */
    <span class="keyword">def</span> <a title="=&gt; Unit" id="27127">clear</a> = {
      <a href="#27106" title="(x$1: Scopes.this.ScopeEntry)Unit">elems</a> = <span title="Null(null)" class="keyword">null</span>
      <a href="#27115" title="(x$1: List[Scopes.this.Symbol])Unit">elemsCache</a> = <span title="Null(null)" class="keyword">null</span>
      <a href="#27112" title="(x$1: Array[Scopes.this.ScopeEntry])Unit">hashtable</a> = <span title="Null(null)" class="keyword">null</span>
    }
    

    /** is the scope empty? */
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="27128">isEmpty</a>: <span title="Boolean">Boolean</span> = <a href="#27106" title="(x$1: AnyRef)Boolean">elems</a> eq <span title="Null(null)" class="keyword">null</span>

    /** the number of entries in this scope */
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="27129">size</a>: <span title="Int">Int</span> = {
      <span class="keyword">var</span> <a title="Int" id="31591">s</a> = <span title="Int(0)" class="int">0</span>
      <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="31592">e</a> = <a href="#27106" title="=&gt; Scopes.this.ScopeEntry">elems</a>
      <span title="Unit" class="keyword">while</span> (<a href="#31592" title="(x$1: AnyRef)Boolean">e</a> ne <span title="Null(null)" class="keyword">null</span>) <a href="#31593" title="()Unit">{</a>
        <a href="#31591" title="Int">s</a> += <span title="Int(1)" class="int">1</span>
        <a href="#31592" title="Scopes.this.ScopeEntry">e</a> = <a href="#31592" title="Scopes.this.ScopeEntry">e</a>.<a href="#26816" title="=&gt; Scopes.this.ScopeEntry">next</a>
      }
      <a href="#31591" title="Int">s</a>
    }

    /** enter a scope entry
     *
     *  @param e ...
     */
    <span class="keyword">def</span> <a title="(e: Scopes.this.ScopeEntry)Unit" id="27130">enter</a>(<a title="Scopes.this.ScopeEntry" id="29434">e</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>) {
      <a href="#27115" title="(x$1: List[Scopes.this.Symbol])Unit">elemsCache</a> = <span title="Null(null)" class="keyword">null</span>
      <span title="Unit" class="keyword">if</span> (<a href="#27112" title="(x$1: AnyRef)Boolean">hashtable</a> ne <span title="Null(null)" class="keyword">null</span>) {
        <span class="keyword">val</span> <a title="Int" id="31757">i</a> = <a href="#29434" title="Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="=&gt; Scopes.this.Name">name</a>.<a href="Names.scala.html#28193" title="(x$1: Int)Int">start</a> &amp; <a href="#27119" title="=&gt; Int">HASHMASK</a>
        <a href="#27106" title="=&gt; Scopes.this.ScopeEntry">elems</a>.<a href="#26813" title="(x$1: Scopes.this.ScopeEntry)Unit">tail</a> = <a href="#27112" title="(i: Int)Scopes.this.ScopeEntry">hashtable</a>(<a href="#31757" title="Int">i</a>)
        <a href="#27112" title="(i: Int,x: Scopes.this.ScopeEntry)Unit">hashtable</a>(<a href="#31757" title="Int">i</a>) = <a href="#27106" title="=&gt; Scopes.this.ScopeEntry">elems</a>
      } <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> (<a href="#27129" title="(x$1: Int)Boolean">size</a> &gt;= <a href="#27121" title="=&gt; Int">MIN_HASH</a>) {
        <a href="#27133" title="()Unit">createHash</a>()
      }
    }

    /** enter a symbol
     *
     *  @param sym ...
     */
    <span class="keyword">def</span> <a title="(sym: Scopes.this.Symbol)Scopes.this.Symbol" id="27131">enter</a>(<a title="Scopes.this.Symbol" id="29432">sym</a>: <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a> = { <a href="#27130" title="(e: Scopes.this.ScopeEntry)Unit">enter</a>(<a href="#25964" title="(sym: Scopes.this.Symbol,owner: Scopes.this.Scope)Scopes.this.ScopeEntry">newScopeEntry</a>(<a href="#29432" title="Scopes.this.Symbol">sym</a>, <a href="#26012" title="Scopes.this.Scope" class="keyword">this</a>)); <a href="#29432" title="Scopes.this.Symbol">sym</a> }

    /** enter a symbol, asserting that no symbol with same name exists in scope
     *
     *  @param sym ...
     */
    <span class="keyword">def</span> <a title="(sym: Scopes.this.Symbol)Unit" id="27132">enterUnique</a>(<a title="Scopes.this.Symbol" id="31814">sym</a>: <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) {
      <a title="(assertion: Boolean)Unit" id="7874">assert</a>(<a href="#27138" title="(name: Scopes.this.Name)Scopes.this.Symbol">lookup</a><span title="(x$1: AnyRef)Boolean">(</span><a href="#31814" title="Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="=&gt; Scopes.this.Name">name</a>) == <a href="Symbols.scala.html#26134" title="object Scopes.this.NoSymbol">NoSymbol</a>)
      <a href="#27131" title="(sym: Scopes.this.Symbol)Scopes.this.Symbol">enter</a><span title="Unit">(</span><a href="#31814" title="Scopes.this.Symbol">sym</a>)
    }

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="27133">createHash</a>() {
      <a href="#27112" title="(x$1: Array[Scopes.this.ScopeEntry])Unit">hashtable</a> = <span title="Array[Scopes.this.ScopeEntry]" class="keyword">new</span> <span title="Array[Scopes.this.ScopeEntry]">Array</span>[ScopeEntry](<a href="#27117" title="=&gt; Int">HASHSIZE</a>)
      <a href="#27134" title="(e: Scopes.this.ScopeEntry)Unit">enterInHash</a>(<a href="#27106" title="=&gt; Scopes.this.ScopeEntry">elems</a>)
    }

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(e: Scopes.this.ScopeEntry)Unit" id="27134">enterInHash</a>(<a title="Scopes.this.ScopeEntry" id="31844">e</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>) {
      <span title="Unit" class="keyword">if</span> (<a href="#31844" title="(x$1: AnyRef)Boolean">e</a> ne <span title="Null(null)" class="keyword">null</span>) {
        <a href="#27134" title="(e: Scopes.this.ScopeEntry)Unit">enterInHash</a>(<a href="#31844" title="Scopes.this.ScopeEntry">e</a>.<a href="#26816" title="=&gt; Scopes.this.ScopeEntry">next</a>)
        <span class="keyword">val</span> <a title="Int" id="31850">i</a> = <a href="#31844" title="Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="=&gt; Scopes.this.Name">name</a>.<a href="Names.scala.html#28193" title="(x$1: Int)Int">start</a> &amp; <a href="#27119" title="=&gt; Int">HASHMASK</a>
        <a href="#31844" title="Scopes.this.ScopeEntry">e</a>.<a href="#26813" title="(x$1: Scopes.this.ScopeEntry)Unit">tail</a> = <a href="#27112" title="(i: Int)Scopes.this.ScopeEntry">hashtable</a>(<a href="#31850" title="Int">i</a>)
        <a href="#27112" title="(i: Int,x: Scopes.this.ScopeEntry)Unit">hashtable</a>(<a href="#31850" title="Int">i</a>) = <a href="#31844" title="Scopes.this.ScopeEntry">e</a>
      }
    }

    <span class="keyword">def</span> <a title="(sym: Scopes.this.Symbol,newname: Scopes.this.Name)Unit" id="27135">rehash</a>(<a title="Scopes.this.Symbol" id="31884">sym</a>: <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>, <a title="Scopes.this.Name" id="31885">newname</a>: <a href="Names.scala.html#26055" title="Scopes.this.Name">Name</a>) {
      <span title="Unit" class="keyword">if</span> (<a href="#27112" title="(x$1: AnyRef)Boolean">hashtable</a> ne <span title="Null(null)" class="keyword">null</span>) {
        <span class="keyword">val</span> <a title="Int" id="31889">index</a> = <a href="#31884" title="Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="=&gt; Scopes.this.Name">name</a>.<a href="Names.scala.html#28193" title="(x$1: Int)Int">start</a> &amp; <a href="#27119" title="=&gt; Int">HASHMASK</a>
        <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="31890">e1</a> = <a href="#27112" title="(i: Int)Scopes.this.ScopeEntry">hashtable</a>(<a href="#31889" title="Int">index</a>)
        <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="31891">e</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a> = <span title="Null(null)" class="keyword">null</span>
        <span title="Unit" class="keyword">if</span> (<a href="#31890" title="(x$1: AnyRef)Boolean">e1</a> != <span title="Null(null)" class="keyword">null</span>) {
          <span title="Unit" class="keyword">if</span> (<a href="#31890" title="Scopes.this.ScopeEntry">e1</a>.<a href="#27654" title="(x$1: AnyRef)Boolean">sym</a> == <a href="#31884" title="Scopes.this.Symbol">sym</a>) {
            <a href="#27112" title="(i: Int,x: Scopes.this.ScopeEntry)Unit">hashtable</a>(<a href="#31889" title="Int">index</a>) = <a href="#31890" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26813" title="=&gt; Scopes.this.ScopeEntry">tail</a>
            <a href="#31891" title="Scopes.this.ScopeEntry">e</a> = <a href="#31890" title="Scopes.this.ScopeEntry">e1</a>
          } <span class="keyword">else</span> {
            <span title="Unit" class="keyword">while</span> (<a href="#31890" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26813" title="(x$1: AnyRef)Boolean">tail</a> <span title="(x$1: Boolean)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> &amp;&amp; <a href="#31890" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26813" title="=&gt; Scopes.this.ScopeEntry">tail</a>.<a href="#27654" title="(x$1: AnyRef)Boolean">sym</a> != <a href="#31884" title="Scopes.this.Symbol">sym</a>) <a href="#31890" title="Scopes.this.ScopeEntry">e1</a> = <a href="#31890" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26813" title="=&gt; Scopes.this.ScopeEntry">tail</a>
            <span title="Unit" class="keyword">if</span> (<a href="#31890" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26813" title="(x$1: AnyRef)Boolean">tail</a> != <span title="Null(null)" class="keyword">null</span>) {
              <a href="#31891" title="Scopes.this.ScopeEntry">e</a> = <a href="#31890" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26813" title="=&gt; Scopes.this.ScopeEntry">tail</a>
              <a href="#31890" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26813" title="(x$1: Scopes.this.ScopeEntry)Unit">tail</a> = <a href="#31891" title="Scopes.this.ScopeEntry">e</a>.<a href="#26813" title="=&gt; Scopes.this.ScopeEntry">tail</a>
            }
          }
        }
        <span title="Unit" class="keyword">if</span> (<a href="#31891" title="(x$1: AnyRef)Boolean">e</a> != <span title="Null(null)" class="keyword">null</span>) {
          <span class="keyword">val</span> <a title="Int" id="31970">newindex</a> = <a href="#31885" title="Scopes.this.Name">newname</a>.<a href="Names.scala.html#28193" title="(x$1: Int)Int">start</a> &amp; <a href="#27119" title="=&gt; Int">HASHMASK</a>
          <a href="#31891" title="Scopes.this.ScopeEntry">e</a>.<a href="#26813" title="(x$1: Scopes.this.ScopeEntry)Unit">tail</a> = <a href="#27112" title="(i: Int)Scopes.this.ScopeEntry">hashtable</a>(<a href="#31970" title="Int">newindex</a>)
          <a href="#27112" title="(i: Int,x: Scopes.this.ScopeEntry)Unit">hashtable</a>(<a href="#31970" title="Int">newindex</a>) = <a href="#31891" title="Scopes.this.ScopeEntry">e</a>
        }
      }
    }

    /** remove entry
     *
     *  @param e ...
     */
    <span class="keyword">def</span> <a title="(e: Scopes.this.ScopeEntry)Unit" id="27136">unlink</a>(<a title="Scopes.this.ScopeEntry" id="32002">e</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>) {
      <span title="Unit" class="keyword">if</span> (<a href="#27106" title="(x$1: AnyRef)Boolean">elems</a> == <a href="#32002" title="Scopes.this.ScopeEntry">e</a>) {
        <a href="#27106" title="(x$1: Scopes.this.ScopeEntry)Unit">elems</a> = <a href="#32002" title="Scopes.this.ScopeEntry">e</a>.<a href="#26816" title="=&gt; Scopes.this.ScopeEntry">next</a>
      } <span class="keyword">else</span> {
        <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="32013">e1</a> = <a href="#27106" title="=&gt; Scopes.this.ScopeEntry">elems</a>
        <span title="Unit" class="keyword">while</span> (<a href="#32013" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26816" title="(x$1: AnyRef)Boolean">next</a> != <a href="#32002" title="Scopes.this.ScopeEntry">e</a>) <a href="#32013" title="Scopes.this.ScopeEntry">e1</a> = <a href="#32013" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26816" title="=&gt; Scopes.this.ScopeEntry">next</a>
        <a href="#32013" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26816" title="(x$1: Scopes.this.ScopeEntry)Unit">next</a> = <a href="#32002" title="Scopes.this.ScopeEntry">e</a>.<a href="#26816" title="=&gt; Scopes.this.ScopeEntry">next</a>
      }
      <span title="Unit" class="keyword">if</span> (<a href="#27112" title="(x$1: AnyRef)Boolean">hashtable</a> ne <span title="Null(null)" class="keyword">null</span>) {
        <span class="keyword">val</span> <a title="Int" id="32028">index</a> = <a href="#32002" title="Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="=&gt; Scopes.this.Name">name</a>.<a href="Names.scala.html#28193" title="(x$1: Int)Int">start</a> &amp; <a href="#27119" title="=&gt; Int">HASHMASK</a>
        <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="32029">e1</a> = <a href="#27112" title="(i: Int)Scopes.this.ScopeEntry">hashtable</a>(<a href="#32028" title="Int">index</a>)
        <span title="Unit" class="keyword">if</span> (<a href="#32029" title="(x$1: AnyRef)Boolean">e1</a> == <a href="#32002" title="Scopes.this.ScopeEntry">e</a>) {
          <a href="#27112" title="(i: Int,x: Scopes.this.ScopeEntry)Unit">hashtable</a>(<a href="#32028" title="Int">index</a>) = <a href="#32002" title="Scopes.this.ScopeEntry">e</a>.<a href="#26813" title="=&gt; Scopes.this.ScopeEntry">tail</a>
        } <span class="keyword">else</span> {
          <span title="Unit" class="keyword">while</span> (<a href="#32029" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26813" title="(x$1: AnyRef)Boolean">tail</a> != <a href="#32002" title="Scopes.this.ScopeEntry">e</a>) <a href="#32029" title="Scopes.this.ScopeEntry">e1</a> = <a href="#32029" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26813" title="=&gt; Scopes.this.ScopeEntry">tail</a>;
          <a href="#32029" title="Scopes.this.ScopeEntry">e1</a>.<a href="#26813" title="(x$1: Scopes.this.ScopeEntry)Unit">tail</a> = <a href="#32002" title="Scopes.this.ScopeEntry">e</a>.<a href="#26813" title="=&gt; Scopes.this.ScopeEntry">tail</a>
        }
      }
      <a href="#27115" title="(x$1: List[Scopes.this.Symbol])Unit">elemsCache</a> = <span title="Null(null)" class="keyword">null</span>
    }

    /** remove symbol */
    <span class="keyword">def</span> <a title="(sym: Scopes.this.Symbol)Unit" id="27137">unlink</a>(<a title="Scopes.this.Symbol" id="32080">sym</a>: <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) {
      <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="32082">e</a> = <a href="#27142" title="(name: Scopes.this.Name)Scopes.this.ScopeEntry">lookupEntry</a>(<a href="#32080" title="Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="=&gt; Scopes.this.Name">name</a>)
      <span title="Unit" class="keyword">while</span> (<a href="#32082" title="(x$1: AnyRef)Boolean">e</a> ne <span title="Null(null)" class="keyword">null</span>) <a href="#32087" title="()Unit">{</a>
        <span title="Unit" class="keyword">if</span> (<a href="#32082" title="Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="(x$1: AnyRef)Boolean">sym</a> == <a href="#32080" title="Scopes.this.Symbol">sym</a>) <a href="#27136" title="(e: Scopes.this.ScopeEntry)Unit">unlink</a>(<a href="#32082" title="Scopes.this.ScopeEntry">e</a>);
        <a href="#32082" title="Scopes.this.ScopeEntry">e</a> = <a href="#27143" title="(entry: Scopes.this.ScopeEntry)Scopes.this.ScopeEntry">lookupNextEntry</a>(<a href="#32082" title="Scopes.this.ScopeEntry">e</a>)
      }
    }

    /** lookup a symbol
     *
     *  @param name ...
     *  @return     ...
     */
    <span class="keyword">def</span> <a title="(name: Scopes.this.Name)Scopes.this.Symbol" id="27138">lookup</a>(<a title="Scopes.this.Name" id="31818">name</a>: <a href="Names.scala.html#26055" title="Scopes.this.Name">Name</a>): <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a> = {
      <span class="keyword">val</span> <a title="Scopes.this.ScopeEntry" id="32110">e</a> = <a href="#27142" title="(name: Scopes.this.Name)Scopes.this.ScopeEntry">lookupEntry</a>(<a href="#31818" title="Scopes.this.Name">name</a>)
      <span title="Scopes.this.Symbol" class="keyword">if</span> (<a href="#32110" title="(x$1: AnyRef)Boolean">e</a> eq <span title="Null(null)" class="keyword">null</span>) <a href="Symbols.scala.html#26134" title="object Scopes.this.NoSymbol">NoSymbol</a> <span class="keyword">else</span> <a href="#32110" title="Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>
    }

    /** Returns an iterator eidling every symbol with given name in this scope.
     */
    <span class="keyword">def</span> <a title="(name: Scopes.this.Name)Iterator[Scopes.this.Symbol]" id="27139">lookupAll</a>(<a title="Scopes.this.Name" id="32115">name</a>: <a href="Names.scala.html#26055" title="Scopes.this.Name">Name</a>): <span title="Iterator[Scopes.this.Symbol]">Iterator</span>[Symbol] = <a href="#32387" title="java.lang.Object with Iterator[Scopes.this.Symbol]{ ... }" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with Iterator[Scopes.this.Symbol]" id="32387">Iterator</a>[Symbol] {
      <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="32390">e</a> = <a href="#27142" title="(name: Scopes.this.Name)Scopes.this.ScopeEntry">lookupEntry</a>(<a href="#32115" title="Scopes.this.Name">name</a>)
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="32392">hasNext</a>: <span title="Boolean">Boolean</span> = <a href="#32390" title="(x$1: AnyRef)Boolean">e</a> ne <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">def</span> <a title="()Scopes.this.Symbol" id="32393">next</a>: <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a> = { <span class="keyword">val</span> <a title="Scopes.this.Symbol" id="32407">r</a> = <a href="#32390" title="=&gt; Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>; <a href="#32390" title="(x$1: Scopes.this.ScopeEntry)Unit">e</a> = <a href="#27143" title="(entry: Scopes.this.ScopeEntry)Scopes.this.ScopeEntry">lookupNextEntry</a>(<a href="#32390" title="=&gt; Scopes.this.ScopeEntry">e</a>); <a href="#32407" title="Scopes.this.Symbol">r</a> }
    }

    /** Can lookup symbols and trace who the client is. 
     */
    <span class="keyword">def</span> <a title="(name: Scopes.this.Name)(from: Scopes.this.Symbol)Scopes.this.ScopeEntry" id="27140">lookupEntryWithContext</a>(<a title="Scopes.this.Name" id="30327">name</a> : <a href="Names.scala.html#26055" title="Scopes.this.Name">Name</a>)(<a title="Scopes.this.Symbol" id="30328">from</a> : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) : <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a> = <a href="#27142" title="(name: Scopes.this.Name)Scopes.this.ScopeEntry">lookupEntry</a>(<a href="#30327" title="Scopes.this.Name">name</a>)
    <span class="keyword">def</span> <a title="(name: Scopes.this.Name)(from: Scopes.this.Symbol)Scopes.this.Symbol" id="27141">lookupWithContext</a>(<a title="Scopes.this.Name" id="30372">name</a> : <a href="Names.scala.html#26055" title="Scopes.this.Name">Name</a>)(<a title="Scopes.this.Symbol" id="30373">from</a> : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) : <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a> = <a href="#27138" title="(name: Scopes.this.Name)Scopes.this.Symbol">lookup</a>(<a href="#30372" title="Scopes.this.Name">name</a>)

    /** lookup a symbol entry matching given name.
     *  @note from Martin: I believe this is a hotspot or will be one
     *  in future versions of the type system. I have reverted the previous
     *  change to use iterators as too costly.
     */
    <span class="keyword">def</span> <a title="(name: Scopes.this.Name)Scopes.this.ScopeEntry" id="27142">lookupEntry</a>(<a title="Scopes.this.Name" id="32083">name</a>: <a href="Names.scala.html#26055" title="Scopes.this.Name">Name</a>): <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a> = {
      <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="32418">e</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a> = <span title="Null(null)" class="keyword">null</span>
      <span title="Unit" class="keyword">if</span> (<a href="#27112" title="(x$1: AnyRef)Boolean">hashtable</a> ne <span title="Null(null)" class="keyword">null</span>) {
        <a href="#32418" title="Scopes.this.ScopeEntry">e</a> = <a href="#27112" title="(i: Int)Scopes.this.ScopeEntry">hashtable</a>(<a href="#32083" title="Scopes.this.Name">name</a>.<a href="Names.scala.html#28193" title="(x$1: Int)Int">start</a> &amp; <a href="#27119" title="=&gt; Int">HASHMASK</a>)
        <span title="Unit" class="keyword">while</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#32418" title="(x$1: AnyRef)Boolean">e</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; <a href="#32418" title="Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="(x$1: AnyRef)Boolean">name</a> != <a href="#32083" title="Scopes.this.Name">name</a>) {
          <a href="#32418" title="Scopes.this.ScopeEntry">e</a> = <a href="#32418" title="Scopes.this.ScopeEntry">e</a>.<a href="#26813" title="=&gt; Scopes.this.ScopeEntry">tail</a>
        }
      } <span class="keyword">else</span> {
        <a href="#32418" title="Scopes.this.ScopeEntry">e</a> = <a href="#27106" title="=&gt; Scopes.this.ScopeEntry">elems</a>
        <span title="Unit" class="keyword">while</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#32418" title="(x$1: AnyRef)Boolean">e</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; <a href="#32418" title="Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="(x$1: AnyRef)Boolean">name</a> != <a href="#32083" title="Scopes.this.Name">name</a>) {
          <a href="#32418" title="Scopes.this.ScopeEntry">e</a> = <a href="#32418" title="Scopes.this.ScopeEntry">e</a>.<a href="#26816" title="=&gt; Scopes.this.ScopeEntry">next</a>
        }
      }
      <a href="#32418" title="Scopes.this.ScopeEntry">e</a>
    }

    /** lookup next entry with same name as this one 
     *  @note from Martin: I believe this is a hotspot or will be one
     *  in future versions of the type system. I have reverted the previous
     *  change to use iterators as too costly.
     */
    <span class="keyword">def</span> <a title="(entry: Scopes.this.ScopeEntry)Scopes.this.ScopeEntry" id="27143">lookupNextEntry</a>(<a title="Scopes.this.ScopeEntry" id="32104">entry</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>): <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a> = {      
      <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="32469">e</a> = <a href="#32104" title="Scopes.this.ScopeEntry">entry</a>
      <span title="Unit" class="keyword">if</span> (<a href="#27112" title="(x$1: AnyRef)Boolean">hashtable</a> ne <span title="Null(null)" class="keyword">null</span>)
        <a href="#32472" title="Unit" class="keyword">do</a> { <a href="#32469" title="Scopes.this.ScopeEntry">e</a> = <a href="#32469" title="Scopes.this.ScopeEntry">e</a>.<a href="#26813" title="=&gt; Scopes.this.ScopeEntry">tail</a> } <span class="keyword">while</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#32469" title="(x$1: AnyRef)Boolean">e</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; <a href="#32469" title="Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="(x$1: AnyRef)Boolean">name</a> != <a href="#32104" title="Scopes.this.ScopeEntry">entry</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="=&gt; Scopes.this.Name">name</a>)
      <span class="keyword">else</span>
        <a href="#32486" title="Unit" class="keyword">do</a> { <a href="#32469" title="Scopes.this.ScopeEntry">e</a> = <a href="#32469" title="Scopes.this.ScopeEntry">e</a>.<a href="#26816" title="=&gt; Scopes.this.ScopeEntry">next</a> } <span class="keyword">while</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#32469" title="(x$1: AnyRef)Boolean">e</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; <a href="#32469" title="Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="(x$1: AnyRef)Boolean">name</a> != <a href="#32104" title="Scopes.this.ScopeEntry">entry</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a>.<a href="Symbols.scala.html#26988" title="=&gt; Scopes.this.Name">name</a>);
      <a href="#32469" title="Scopes.this.ScopeEntry">e</a>
    }

    /** Return all symbols as a list in the order they were entered in this scope.
     */
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; List[Scopes.this.Symbol]" id="27144">toList</a>: <span title="List[Scopes.this.Symbol]">List</span>[Symbol] = {
      <span title="Unit" class="keyword">if</span> (<a href="#27115" title="(x$1: AnyRef)Boolean">elemsCache</a> eq <span title="Null(null)" class="keyword">null</span>) {
        <a href="#27115" title="(x$1: List[Scopes.this.Symbol])Unit">elemsCache</a> = <a title="object Nil" id="7634">Nil</a>
        <span class="keyword">var</span> <a title="Scopes.this.ScopeEntry" id="32502">e</a> = <a href="#27106" title="=&gt; Scopes.this.ScopeEntry">elems</a>
        <span title="Unit" class="keyword">while</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#32502" title="(x$1: AnyRef)Boolean">e</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; <a href="#32502" title="Scopes.this.ScopeEntry">e</a>.<a href="#27655" title="(x$1: AnyRef)Boolean">owner</a> == <a href="#26012" title="Scopes.this.Scope" class="keyword">this</a>) <a href="#32505" title="()Unit">{</a>
          <a href="#27115" title="(x$1: List[Scopes.this.Symbol])Unit">elemsCache</a> = <a href="#32502" title="Scopes.this.ScopeEntry">e</a>.<a href="#27654" title="=&gt; Scopes.this.Symbol">sym</a> <a href="#32517" title="Scopes.this.Symbol">::</a> <a href="#27115" title="(x: Scopes.this.Symbol)List[Scopes.this.Symbol]" id="24258">elemsCache</a>
          <a href="#32502" title="Scopes.this.ScopeEntry">e</a> = <a href="#32502" title="Scopes.this.ScopeEntry">e</a>.<a href="#26816" title="=&gt; Scopes.this.ScopeEntry">next</a>
        }
      }
      <a href="#27115" title="=&gt; List[Scopes.this.Symbol]">elemsCache</a>
    }

    /** Return all symbols as an interator in the order they were entered in this scope.
     */
    <span class="keyword">def</span> <a title="=&gt; Iterator[Scopes.this.Symbol]" id="27145">iterator</a>: <span title="Iterator[Scopes.this.Symbol]">Iterator</span>[Symbol] = <a href="#27144" title="=&gt; List[Scopes.this.Symbol]">toList</a>.<a title="=&gt; Iterator[Scopes.this.Symbol]" id="28931">iterator</a>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="[U](p: (Scopes.this.Symbol) =&gt; U)Unit" id="27146">foreach</a>[<a title="&gt;: Nothing &lt;: Any" id="27148">U</a><a id="1">]</a>(<a title="(Scopes.this.Symbol) =&gt; U" id="32532">p</a>: Symbol =&gt; U): <span title="Unit">Unit</span> = <a href="#27144" title="(f: (Scopes.this.Symbol) =&gt; U)Unit">toList</a> foreach <a href="#32532" title="(Scopes.this.Symbol) =&gt; U">p</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(p: (Scopes.this.Symbol) =&gt; Boolean)Scopes.this.Scope" id="27149">filter</a>(<a title="(Scopes.this.Symbol) =&gt; Boolean" id="32563">p</a>: Symbol =&gt; Boolean): <a href="#26012" title="Scopes.this.Scope">Scope</a> =
      <span title="Scopes.this.Scope" class="keyword">if</span> (<a title="=&gt; Boolean" id="2205">!</a>(<a href="#27144" title="(p: (Scopes.this.Symbol) =&gt; Boolean)Boolean" id="28935">toList</a> forall <a href="#32563" title="(Scopes.this.Symbol) =&gt; Boolean">p</a>)) <a href="#26006" title="(decls: List[Scopes.this.Symbol])Scopes.this.Scope">newScope</a>(<a href="#27144" title="(p: (Scopes.this.Symbol) =&gt; Boolean)List[Scopes.this.Symbol]" id="25253">toList</a> filter <a href="#32563" title="(Scopes.this.Symbol) =&gt; Boolean">p</a>) <span class="keyword">else</span> <a href="#26012" title="Scopes.this.Scope" class="keyword">this</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(start: String,sep: String,end: String)String" id="27150">mkString</a>(<a title="String" id="32582">start</a>: <span title="String">String</span>, <a title="String" id="32583">sep</a>: <span title="String">String</span>, <a title="String" id="32584">end</a>: <span title="String">String</span>) =
      <a href="#27144" title="=&gt; List[Scopes.this.Symbol]">toList</a>.<a title="(f: (Scopes.this.Symbol) =&gt; String)(implicit bf: scala.collection.generic.BuilderFactory[String,List[String],List[Scopes.this.Symbol]])List[String]" id="25243">map</a><a title="scala.collection.generic.BuilderFactory[String,List[String],List#Coll]" id="7346">(</a><a href="#32597" title="Scopes.this.Symbol">_</a>.<a href="Symbols.scala.html#27096" title="=&gt; String">defString</a>).<a title="(start: String,sep: String,end: String)String" id="25360">mkString</a>(<a href="#32582" title="String">start</a>, <a href="#32583" title="String">sep</a>, <a href="#32584" title="String">end</a>)

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="27151">toString</a>(): <span title="String">String</span> = <a href="#27150" title="(start: String,sep: String,end: String)String">mkString</a>(<span title="java.lang.String(&quot;{\012  &quot;)" class="string">&quot;{\n  &quot;</span>, <span title="java.lang.String(&quot;;\012  &quot;)" class="string">&quot;;\n  &quot;</span>, <span title="java.lang.String(&quot;\012}&quot;)" class="string">&quot;\n}&quot;</span>)

    /** Return the nesting level of this scope, i.e. the number of times this scope
     *  was nested in another */
    <span class="keyword">def</span> <a title="=&gt; Int" id="27152">nestingLevel</a> = <a href="#27109" title="=&gt; Int">nestinglevel</a>
    
    <span class="keyword">def</span> <a title="(name: Scopes.this.Name)Unit" id="27153">invalidate</a>(<a title="Scopes.this.Name" id="32776">name</a> : <a href="Names.scala.html#26055" title="Scopes.this.Name">Name</a>) = <span title="Unit">{</span>}
  }

  /** The empty scope (immutable).
   */
  <span class="keyword">object</span> <a title="object Scopes.this.EmptyScope" id="26013">EmptyScope</a> <a href="#27123" title="ScalaObject" class="keyword">extends</a> <a href="#26012" title="Scopes.this.Scope">Scope</a> {
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(e: Scopes.this.ScopeEntry)Unit" id="32780">enter</a>(<a title="Scopes.this.ScopeEntry" id="32799">e</a>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>) {
      <span title="Nothing" class="keyword">throw</span> <a title="(x$1: java.lang.String)java.lang.Error" id="25911" class="keyword">new</a> <a title="java.lang.Error" id="7821">Error</a>(<span title="java.lang.String(&quot;EmptyScope.enter&quot;)" class="string">&quot;EmptyScope.enter&quot;</span>)
    }
  }

  /** The error scope.
   */
  <span class="keyword">class</span> <a title="class ErrorScope extends Scopes.this.Scope with ScalaObject" id="26015">ErrorScope</a><span title="ScalaObject">(</span><a title="Scopes.this.Symbol" id="32813">owner</a>: <a href="Symbols.scala.html#26127" title="Scopes.this.Symbol">Symbol</a>) <span class="keyword">extends</span> <a href="#26012" title="Scopes.this.Scope">Scope</a>(<span title="Null(null)" class="keyword">null</span>: <a href="#25963" title="Scopes.this.ScopeEntry">ScopeEntry</a>) {
    /* The following method was intended to be here,
     * but it was written (in two different iterations!) so that
     * it was actually a no-op. That's why I am leaving it comment-out
     * for now.
    override def lookupEntry(name: Name): ScopeEntry = {
      def errorSym = 
        if (name.isTermName) owner newErrorValue name
        else owner newErrorClass name

       super.lookupEntry(name) match {
        case null =&gt; enter(errorSym); lookupEntry(name)
        case e    =&gt; e
      }
    }
     */
  }
}


        </pre>
    </body>
</html>