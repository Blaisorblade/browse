<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/plugins/PluginDescription.scala</title>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2007-2009 LAMP/EPFL
 * @author Lex Spoon
 */</span>
<span class="comment">// $Id: PluginDescription.scala 16884 2009-01-09 16:52:09Z cunei $</span>

<span class="keyword">package</span> scala.tools.nsc.plugins

<span class="keyword">import</span> java.io.File

<span class="keyword">import</span> scala.xml.{Node,NodeSeq}

<span class="comment">/** A description of a compiler plugin, suitable for serialization
 *  to XML for inclusion in the plugin's .jar file.
 *
 * @author Lex Spoon
 * @version 1.0, 2007-5-21
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class PluginDescription extends java.lang.Object with ScalaObject</span><a id="17104">PluginDescription</a></span> {

  <span class="comment">/** A short name of the compiler, used to identify it in
   *  various contexts. The phase defined by the plugin
   *  should have the same name.
   */</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">=&gt; String</span><a id="95680">name</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>

  <span class="comment">/** The name of the main class for the plugin */</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">=&gt; String</span><a id="95681">classname</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>

  <span class="comment">/** An XML representation of this description.  It can be
   *  read back using &lt;code&gt;PluginDescription.fromXML&lt;/code&gt;.
   *  It should be stored inside the jar.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.xml.Node</span><a id="95682">toXML</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a id="39492">Node</a></span> = {
    &lt;plugin&gt;
      &lt;name&gt;{<span class="typed"><span class="type">=&gt; String</span><a href="#95680">name</a></span>}&lt;/name&gt;
      &lt;classname&gt;{<span class="typed"><span class="type">=&gt; String</span><a href="#95681">classname</a></span>}&lt;/classname&gt;
    &lt;/plugin&gt;
  }
}


<span class="comment">/** Utilities for the PluginDescription class.
 *
 *  @author Lex Spoon
 *  @version 1.0, 2007-5-21
 */</span>
<span class="keyword">object</span> <span class="typed"><span class="type">object scala.tools.nsc.plugins.PluginDescription</span><a id="17105">PluginDescription</a></span> {
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.Node)Option[scala.tools.nsc.plugins.PluginDescription]</span><a id="95753">fromXML</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a id="95754">xml</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a id="39492">Node</a></span>): <span class="typed"><span class="type">Option[scala.tools.nsc.plugins.PluginDescription]</span><a id="934">Option</a></span>[PluginDescription] = {
    <span class="comment">// check the top-level tag</span>
    <span class="typed"><span class="type">scala.xml.Node</span><a href="#95754">xml</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> &lt;plugin&gt;{_*}&lt;/plugin&gt;  =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>)
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span>
    }

    <span class="comment">/** Extract one field */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(String)Option[String]</span><a id="126966">getField</a></span>(<span class="typed"><span class="type">String</span><a id="126970">field</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>): <span class="typed"><span class="type">Option[String]</span><a id="934">Option</a></span>[String] = {
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="126971">text</a></span> = (<span class="typed"><span class="type">scala.xml.Node</span><a href="#95754">xml</a></span> <span class="typed"><span class="type">(String)scala.xml.NodeSeq</span><a id="65755">\\</a></span> <span class="typed"><span class="type">String</span><a href="#126970">field</a></span>).<span class="typed"><span class="type">=&gt; String</span><a id="65757">text</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="5870">trim</a></span>
      <span class="typed"><span class="type">Option[String]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">java.lang.String</span><a href="#126971">text</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>) <span class="typed"><span class="type">object None</span><a id="536">None</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">(java.lang.String)Some[java.lang.String]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#126971">text</a></span>)
    }

    <span class="comment">// extract the required fields</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="126967">name1</a></span> = <span class="typed"><span class="type">(String)Option[String]</span><a href="#126966">getField</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;name&quot;)</span><span class="string">&quot;name&quot;</span></span>) <span class="typed"><span class="type">String</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span> =&gt; <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span>
      <span class="typed"><span class="type">String</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">String</span><a id="126974">str</a></span>) =&gt; <span class="typed"><span class="type">String</span><a href="#126974">str</a></span>
    }
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="126968">classname1</a></span> = <span class="typed"><span class="type">(String)Option[String]</span><a href="#126966">getField</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;classname&quot;)</span><span class="string">&quot;classname&quot;</span></span>) <span class="typed"><span class="type">String</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span> =&gt; <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span>
      <span class="typed"><span class="type">String</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">String</span><a id="126975">str</a></span>) =&gt; <span class="typed"><span class="type">String</span><a href="#126975">str</a></span>
    }

    <span class="typed"><span class="type">(scala.tools.nsc.plugins.PluginDescription{ ... })Some[scala.tools.nsc.plugins.PluginDescription{ ... }]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">template $anon extends scala.tools.nsc.plugins.PluginDescription</span><a id="126977" class="keyword">new</a></span> <span class="typed"><span class="type">scala.tools.nsc.plugins.PluginDescription</span><a href="#17104">PluginDescription</a></span> {
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><span id="126980"><a id="126979">name</a></span></span> = <span class="typed"><span class="type">String</span><a href="#126967">name1</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><span id="126982"><a id="126981">classname</a></span></span> = <span class="typed"><span class="type">String</span><a href="#126968">classname1</a></span>
    })
  }
}

        </pre>
    </body>
</html>