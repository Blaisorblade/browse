<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/plugins/Plugins.scala</title>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2007-2009 LAMP/EPFL
 * @author Lex Spoon
 * Updated by Anders Bach Nielsen
 */</span>
<span class="comment">// $Id: Plugins.scala 17274 2009-03-10 11:39:04Z michelou $</span>

<span class="keyword">package</span> scala.tools.nsc.plugins

<span class="keyword">import</span> java.io.File

<span class="comment">/** Support for run-time loading of compiler plugins.
 *
 *  @author Lex Spoon 
 *  @version 1.1, 2009/1/2
 *  Updated 2009/1/2 by Anders Bach Nielsen: Added features to implement SIP 00002
 */</span>
<span class="keyword">trait</span> <span class="typed"><span class="type">trait Plugins extends java.lang.Object with ScalaObject</span><a id="17065">Plugins</a></span> { self: Global =&gt;

  <span class="comment">/** Load a rough list of the plugins.  For speed, it
   *  does not instantiate a compiler run.  Therefore it cannot
   *  test for same-named phases or other problems that are
   *  filtered from the final list of plugins.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">()List[scala.tools.nsc.plugins.Plugin]</span><a id="22574">loadRoughPluginsList</a></span>(): <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a id="526">List</a></span>[Plugin] = {
    <span class="keyword">val</span> <span class="typed"><span class="type">List[java.io.File]</span><a id="121508">jars</a></span> = <span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting</span><a href="../Settings.scala.html#30018">plugin</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting#T</span><a href="../Settings.scala.html#30301">value</a></span>.<span class="typed"><span class="type">((String) =&gt; java.io.File)List[java.io.File]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">java.io.File</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.File</span><a id="3669">File</a></span>(<span class="typed"><span class="type">String</span><a href="#121515">_</a></span>))
    <span class="keyword">val</span> <span class="typed"><span class="type">List[java.io.File]</span><a id="121509">dirs</a></span> =
      <span class="keyword">for</span> (<span class="typed"><span class="type">((java.lang.String) =&gt; java.io.File)List[java.io.File]</span><span id="21362"><a id="121533">name</a></span></span> &lt;- <span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting</span><a href="../Settings.scala.html#30026">pluginsDir</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.StringSetting#T</span><a href="../Settings.scala.html#30301">value</a></span>.<span class="typed"><span class="type">(java.lang.String)Array[java.lang.String]</span><a id="5865">split</a></span>(<span class="typed"><span class="type">object java.io.File</span><a id="3670">File</a></span>.<span class="typed"><span class="type">java.lang.String</span><a id="40677">pathSeparator</a></span>).<span class="typed"><span class="type">=&gt; List[java.lang.String]</span><a id="21815">toList</a></span>)
	<span class="keyword">yield</span> <span class="typed"><span class="type">java.io.File</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.File</span><a id="3669">File</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#121533">name</a></span>)

    <span class="keyword">for</span> (<span class="typed"><span class="type">((scala.tools.nsc.plugins.Plugin.AnyClass) =&gt; scala.tools.nsc.plugins.Plugin)List[scala.tools.nsc.plugins.Plugin]</span><span id="21362"><a id="121542">plugClass</a></span></span> &lt;- <span class="typed"><span class="type">object scala.tools.nsc.plugins.Plugin</span><a href="Plugin.scala.html#17030">Plugin</a></span>.<span class="typed"><span class="type">(List[java.io.File],List[java.io.File],List[String])List[scala.tools.nsc.plugins.Plugin.AnyClass]</span><a href="Plugin.scala.html#95618">loadAllFrom</a></span>(<span class="typed"><span class="type">List[java.io.File]</span><a href="#121508">jars</a></span>, <span class="typed"><span class="type">List[java.io.File]</span><a href="#121509">dirs</a></span>, <span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting</span><a href="../Settings.scala.html#30020">disable</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting#T</span><a href="../Settings.scala.html#30301">value</a></span>))
    <span class="keyword">yield</span> <span class="typed"><span class="type">object scala.tools.nsc.plugins.Plugin</span><a href="Plugin.scala.html#17030">Plugin</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.plugins.Plugin.AnyClass,scala.tools.nsc.Global)scala.tools.nsc.plugins.Plugin</span><a href="Plugin.scala.html#95619">instantiate</a></span>(<span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin.AnyClass</span><a href="#121542">plugClass</a></span>, <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="#17065" class="keyword">this</a></span>)
  }

  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Option[List[scala.tools.nsc.plugins.Plugin]]</span><span id="22577"><span id="22575"><span id="22576"><a id="121505">roughPluginsListCache</a></span></span></span></span>: <span class="typed"><span class="type">Option[List[scala.tools.nsc.plugins.Plugin]]</span><a id="934">Option</a></span>[List[Plugin]] = <span class="typed"><span class="type">object None</span><a id="536">None</a></span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a id="22578">roughPluginsList</a></span>: <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a id="526">List</a></span>[Plugin] =
    <span class="typed"><span class="type">=&gt; Option[List[scala.tools.nsc.plugins.Plugin]]</span><a href="#22575">roughPluginsListCache</a></span> <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a id="121545">list</a></span>) =&gt; <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a href="#121545">list</a></span>
      <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span> =&gt;
	<span class="typed"><span class="type">(Option[List[scala.tools.nsc.plugins.Plugin]])Unit</span><a href="#22576">roughPluginsListCache</a></span> = <span class="typed"><span class="type">(List[scala.tools.nsc.plugins.Plugin])Some[List[scala.tools.nsc.plugins.Plugin]]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">()List[scala.tools.nsc.plugins.Plugin]</span><a href="#22574">loadRoughPluginsList</a></span>)
        <span class="typed"><span class="type">=&gt; Option[List[scala.tools.nsc.plugins.Plugin]]</span><a href="#22575">roughPluginsListCache</a></span>.<span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a id="25408">get</a></span>
    }

  <span class="comment">/** Load all available plugins.  Skips plugins that
   *  either have the same name as another one, or which
   *  define a phase name that another one does.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">()List[scala.tools.nsc.plugins.Plugin]</span><a id="22579">loadPlugins</a></span>(): <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a id="526">List</a></span>[Plugin] = {
    <span class="comment">// remove any with conflicting names or subcomponent names</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(List[scala.tools.nsc.plugins.Plugin],Set[String],Set[String])List[scala.tools.nsc.plugins.Plugin]</span><a id="121549">pick</a></span>(
      <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a id="121551">plugins</a></span>: <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a id="526">List</a></span>[Plugin], 
      <span class="typed"><span class="type">Set[String]</span><a id="121552">plugNames</a></span>: <span class="typed"><span class="type">Set[String]</span><a id="26500">Set</a></span>[String], 
      <span class="typed"><span class="type">Set[String]</span><a id="121553">phaseNames</a></span>: <span class="typed"><span class="type">Set[String]</span><a id="26500">Set</a></span>[String]): <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a id="526">List</a></span>[Plugin] =
    {
      <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a href="#121551">plugins</a></span> <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><span class="keyword">match</span></span> {
	<span class="typed"><span class="type">Nil.type</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span> =&gt; <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>
	<span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a id="121554">plug</a></span> <a id="1">::</a> <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a id="121555">rest</a></span> =&gt;
	  <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.immutable.Set[String]</span><a id="121556">plugPhaseNames</a></span> = <span class="typed"><span class="type">=&gt; collection.immutable.Set.type</span><span id="5998"><a id="821">Set</a></span></span>.<span class="typed"><span class="type">scala.collection.immutable.Set[String]</span><a id="31133">empty</a></span> <span class="typed"><span class="type">(Iterable[String])scala.collection.immutable.Set[String]</span><a id="31140">++</a></span> <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121554">plug</a></span>.<span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.PluginComponent]</span><a href="Plugin.scala.html#95604">components</a></span>.<span class="typed"><span class="type">((scala.tools.nsc.plugins.PluginComponent) =&gt; String)List[String]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">scala.tools.nsc.plugins.PluginComponent</span><a href="#121568">_</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="../SubComponent.scala.html#29450">phaseName</a></span>)
	  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a id="121557">withoutPlug</a></span> = <span class="typed"><span class="type">(List[scala.tools.nsc.plugins.Plugin],Set[String],Set[String])List[scala.tools.nsc.plugins.Plugin]</span><a href="#121549">pick</a></span>(<span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a href="#121555">rest</a></span>, <span class="typed"><span class="type">Set[String]</span><a href="#121552">plugNames</a></span>, <span class="typed"><span class="type">scala.collection.immutable.Set[String]</span><a href="#121556">plugPhaseNames</a></span>)
	  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a id="121558">withPlug</a></span> =
	    (<span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121554">plug</a></span> <span class="typed"><span class="type">(scala.tools.nsc.plugins.Plugin)List[scala.tools.nsc.plugins.Plugin]</span><a href="#121580" id="21335">::</a></span> 
	     <span class="typed"><span class="type">(List[scala.tools.nsc.plugins.Plugin],Set[String],Set[String])List[scala.tools.nsc.plugins.Plugin]</span><a href="#121549">pick</a></span>(<span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a href="#121555">rest</a></span>, 
		  <span class="typed"><span class="type">Set[String]</span><a href="#121552">plugNames</a></span><span class="typed"><span class="type">(String)scala.collection.immutable.Set[String]</span><a id="31138">+</a></span><span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121554">plug</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span>,
		  <span class="typed"><span class="type">Set[String]</span><a href="#121553">phaseNames</a></span><span class="typed"><span class="type">(Iterable[String])scala.collection.immutable.Set[String]</span><a id="31140">++</a></span><span class="typed"><span class="type">scala.collection.immutable.Set[String]</span><a href="#121556">plugPhaseNames</a></span>))

	  <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Set[String]</span><a href="#121552">plugNames</a></span>.<span class="typed"><span class="type">(String)Boolean</span><a id="25542">contains</a></span>(<span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121554">plug</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span>)) {
	    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="../Settings.scala.html#29986">verbose</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="../Settings.scala.html#30301">value</a></span>)
	      <span class="typed"><span class="type">(String)Unit</span><a href="../Global.scala.html#21199">inform</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;[skipping a repeated plugin: &quot;)</span><span class="string">&quot;[skipping a repeated plugin: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121554">plug</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;]&quot;)</span><span class="string">&quot;]&quot;</span></span>)
	    <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a href="#121557">withoutPlug</a></span>
	  } <span class="keyword">else</span> <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting</span><a href="../Settings.scala.html#30020">disable</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting#T</span><a href="../Settings.scala.html#30301">value</a></span> <span class="typed"><span class="type">(Any)Boolean</span><a id="21673">contains</a></span>(<span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121554">plug</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span>)) {
	    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="../Settings.scala.html#29986">verbose</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="../Settings.scala.html#30301">value</a></span>)
	      <span class="typed"><span class="type">(String)Unit</span><a href="../Global.scala.html#21199">inform</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;[disabling plugin: &quot;)</span><span class="string">&quot;[disabling plugin: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121554">plug</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;]&quot;)</span><span class="string">&quot;]&quot;</span></span>)
	    <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a href="#121557">withoutPlug</a></span>
	  } <span class="keyword">else</span> {
	    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.immutable.Set[String]</span><a id="121606">commonPhases</a></span> = <span class="typed"><span class="type">Set[String]</span><a href="#121553">phaseNames</a></span>.<span class="typed"><span class="type">(scala.collection.Set[String])scala.collection.immutable.Set[String]</span><a id="31150">intersect</a></span>(<span class="typed"><span class="type">scala.collection.immutable.Set[String]</span><a href="#121556">plugPhaseNames</a></span>)
	    <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">scala.collection.immutable.Set[String]</span><a href="#121606">commonPhases</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="25544">isEmpty</a></span>) {
	      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="../Settings.scala.html#29986">verbose</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="../Settings.scala.html#30301">value</a></span>)
		<span class="typed"><span class="type">(String)Unit</span><a href="../Global.scala.html#21199">inform</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;[skipping plugin &quot;)</span><span class="string">&quot;[skipping plugin &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121554">plug</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
		       <span class="typed"><span class="type">java.lang.String(&quot;because it repeats phase names: &quot;)</span><span class="string">&quot;because it repeats phase names: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
		       <span class="typed"><span class="type">scala.collection.immutable.Set[String]</span><a href="#121606">commonPhases</a></span>.<span class="typed"><span class="type">(String)String</span><a id="21819">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;, &quot;)</span><span class="string">&quot;, &quot;</span></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;]&quot;)</span><span class="string">&quot;]&quot;</span></span>)
	      <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a href="#121557">withoutPlug</a></span>
	    } <span class="keyword">else</span> {
	      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="../Settings.scala.html#29986">verbose</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="../Settings.scala.html#30301">value</a></span>)
		<span class="typed"><span class="type">(String)Unit</span><a href="../Global.scala.html#21199">inform</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;[loaded plugin &quot;)</span><span class="string">&quot;[loaded plugin &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121554">plug</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;]&quot;)</span><span class="string">&quot;]&quot;</span></span>)
	      <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a href="#121558">withPlug</a></span>
	    }
	  }
      }
    }

    <span class="keyword">val</span> <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a id="121550">plugs</a></span> =
    <span class="typed"><span class="type">(List[scala.tools.nsc.plugins.Plugin],Set[String],Set[String])List[scala.tools.nsc.plugins.Plugin]</span><a href="#121549">pick</a></span>(<span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a href="#22578">roughPluginsList</a></span>,
	 <span class="typed"><span class="type">=&gt; collection.immutable.Set.type</span><span id="5998"><a id="821">Set</a></span></span>.<span class="typed"><span class="type">scala.collection.immutable.Set[String]</span><a id="31133">empty</a></span>,
	 <span class="typed"><span class="type">=&gt; collection.immutable.Set.type</span><span id="5998"><a id="821">Set</a></span></span>.<span class="typed"><span class="type">scala.collection.immutable.Set[String]</span><a id="31133">empty</a></span> <span class="typed"><span class="type">(Iterable[String])scala.collection.immutable.Set[String]</span><a id="31140">++</a></span> <span class="typed"><span class="type">=&gt; scala.collection.mutable.HashSet[scala.tools.nsc.SubComponent]</span><a href="../Global.scala.html#21298">phasesSet</a></span>.<span class="typed"><span class="type">((scala.tools.nsc.SubComponent) =&gt; String)Iterable[String]</span><a id="21782">map</a></span>(<span class="typed"><span class="type">scala.tools.nsc.SubComponent</span><a href="#121631">_</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="../SubComponent.scala.html#29450">phaseName</a></span>))

    <span class="keyword">for</span> (<span class="typed"><span class="type">((String) =&gt; Unit)Unit</span><span id="21366"><span id="21367"><span id="121636"><a id="121642">req</a></span></span></span></span> &lt;- <span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting</span><a href="../Settings.scala.html#30024">require</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting#T</span><a href="../Settings.scala.html#30301">value</a></span>; <span class="keyword">if</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a href="#121550">plugs</a></span>.<span class="typed"><span class="type">((scala.tools.nsc.plugins.Plugin) =&gt; Boolean)Boolean</span><a id="21373">exists</a></span>(<span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a id="121638">p</a></span> =&gt; <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121638">p</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span><span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span><span class="typed"><span class="type">String</span><a href="#121636">req</a></span>))
      <span class="typed"><span class="type">(String)Unit</span><a href="../Global.scala.html#21197">error</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Missing required plugin: &quot;)</span><span class="string">&quot;Missing required plugin: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">String</span><a href="#121642">req</a></span>)

    
    <span class="keyword">for</span> (<span class="typed"><span class="type">((scala.tools.nsc.plugins.Plugin) =&gt; Unit)Unit</span><span id="21366"><a id="121644">plug</a></span></span> &lt;- <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a href="#121550">plugs</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="121645">nameColon</a></span> = <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121644">plug</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;:&quot;)</span><span class="string">&quot;:&quot;</span></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">List[java.lang.String]</span><a id="121646">opts</a></span> = <span class="keyword">for</span> {
	<span class="typed"><span class="type">((String) =&gt; java.lang.String)List[java.lang.String]</span><span id="21362"><span id="21367"><span id="121653"><a id="121658">raw</a></span></span></span></span> &lt;- <span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting</span><a href="../Settings.scala.html#30102">pluginOptions</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting#T</span><a href="../Settings.scala.html#30301">value</a></span>
	<span class="keyword">if</span> <span class="typed"><span class="type">String</span><a href="#121653">raw</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5841">startsWith</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#121645">nameColon</a></span>)
      } <span class="keyword">yield</span> <span class="typed"><span class="type">String</span><a href="#121658">raw</a></span>.<span class="typed"><span class="type">(Int)java.lang.String</span><a id="5854">substring</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#121645">nameColon</a></span>.<span class="typed"><span class="type">()Int</span><a id="5821">length</a></span>)

      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">List[java.lang.String]</span><a href="#121646">opts</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span>)
	<span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121644">plug</a></span>.<span class="typed"><span class="type">(List[String],(String) =&gt; Unit)Unit</span><a href="Plugin.scala.html#95607">processOptions</a></span>(<span class="typed"><span class="type">List[java.lang.String]</span><a href="#121646">opts</a></span>, <span class="typed"><span class="type">(String)Unit</span><a href="../Global.scala.html#21197">error</a></span>)
    }

    <span class="keyword">for</span> {
      <span class="typed"><span class="type">((String) =&gt; Unit)Unit</span><span id="21366"><span id="21367"><span id="121666"><a id="121672">opt</a></span></span></span></span> &lt;- <span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting</span><a href="../Settings.scala.html#30102">pluginOptions</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.MultiStringSetting#T</span><a href="../Settings.scala.html#30301">value</a></span>
      <span class="keyword">if</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a href="#121550">plugs</a></span>.<span class="typed"><span class="type">((scala.tools.nsc.plugins.Plugin) =&gt; Boolean)Boolean</span><a id="21373">exists</a></span>(<span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a id="121668">p</a></span> =&gt; <span class="typed"><span class="type">String</span><a href="#121666">opt</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5841">startsWith</a></span>(<span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121668">p</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;:&quot;)</span><span class="string">&quot;:&quot;</span></span>))
    } <span class="typed"><span class="type">(String)Unit</span><a href="../Global.scala.html#21197">error</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;bad option: -P:&quot;)</span><span class="string">&quot;bad option: -P:&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">String</span><a href="#121672">opt</a></span>)

    <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a href="#121550">plugs</a></span>
  }

  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Option[List[scala.tools.nsc.plugins.Plugin]]</span><span id="22582"><span id="22580"><span id="22581"><a id="121506">pluginsCache</a></span></span></span></span>: <span class="typed"><span class="type">Option[List[scala.tools.nsc.plugins.Plugin]]</span><a id="934">Option</a></span>[List[Plugin]] = <span class="typed"><span class="type">object None</span><a id="536">None</a></span>

  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a id="22583">plugins</a></span>: <span class="typed"><span class="type">List[scala.tools.nsc.plugins.Plugin]</span><a id="526">List</a></span>[Plugin] = {
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Option[List[scala.tools.nsc.plugins.Plugin]]</span><a href="#22580">pluginsCache</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="25406">isEmpty</a></span>)
      <span class="typed"><span class="type">(Option[List[scala.tools.nsc.plugins.Plugin]])Unit</span><a href="#22581">pluginsCache</a></span> = <span class="typed"><span class="type">(List[scala.tools.nsc.plugins.Plugin])Some[List[scala.tools.nsc.plugins.Plugin]]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">()List[scala.tools.nsc.plugins.Plugin]</span><a href="#22579">loadPlugins</a></span>)
    <span class="typed"><span class="type">=&gt; Option[List[scala.tools.nsc.plugins.Plugin]]</span><a href="#22580">pluginsCache</a></span>.<span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a id="25408">get</a></span>
  }

  <span class="comment">/** A description of all the plugins that are loaded */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="22584">pluginDescriptions</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">List[java.lang.String]</span><a id="121678">messages</a></span> =
      <span class="keyword">for</span> (<span class="typed"><span class="type">((scala.tools.nsc.plugins.Plugin) =&gt; java.lang.String)List[java.lang.String]</span><span id="21362"><a id="121682">plugin</a></span></span> &lt;- <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a href="#22578">roughPluginsList</a></span>)
	<span class="keyword">yield</span> <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121682">plugin</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; - &quot;)</span><span class="string">&quot; - &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121682">plugin</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95605">description</a></span>
    <span class="typed"><span class="type">List[java.lang.String]</span><a href="#121678">messages</a></span>.<span class="typed"><span class="type">(String)String</span><a id="21819">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>)
  }

  <span class="comment">/**
   * Extract all phases supplied by plugins and add them to the phasesSet.
   * @see phasesSet
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="22585">computePluginPhases</a></span>() {    
    <span class="keyword">val</span> <span class="typed"><span class="type">List[scala.tools.nsc.plugins.PluginComponent]</span><a id="121684">plugPhases</a></span> = <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a href="#22583">plugins</a></span>.<span class="typed"><span class="type">((scala.tools.nsc.plugins.Plugin) =&gt; Iterable[scala.tools.nsc.plugins.PluginComponent])List[scala.tools.nsc.plugins.PluginComponent]</span><a id="21383">flatMap</a></span>(<span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121688">_</a></span>.<span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.PluginComponent]</span><a href="Plugin.scala.html#95604">components</a></span>)
    <span class="keyword">for</span> (<span class="typed"><span class="type">((scala.tools.nsc.plugins.PluginComponent) =&gt; Unit)Unit</span><span id="21366"><a id="121690">pPhase</a></span></span> &lt;- <span class="typed"><span class="type">List[scala.tools.nsc.plugins.PluginComponent]</span><a href="#121684">plugPhases</a></span>) {
      <span class="typed"><span class="type">=&gt; scala.collection.mutable.HashSet[scala.tools.nsc.SubComponent]</span><a href="../Global.scala.html#21298">phasesSet</a></span> <span class="typed"><span class="type">(scala.tools.nsc.SubComponent)Unit</span><a id="25499">+=</a></span> <span class="typed"><span class="type">scala.tools.nsc.plugins.PluginComponent</span><a href="#121690">pPhase</a></span>
     }
   }

  <span class="comment">/** Summary of the options for all loaded plugins */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="22586">pluginOptionsHelp</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.StringBuffer</span><a id="121692">buf</a></span> = <span class="typed"><span class="type">java.lang.StringBuffer</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.lang.StringBuffer</span><a id="1993">StringBuffer</a></span>
    <span class="keyword">for</span> (<span class="typed"><span class="type">((scala.tools.nsc.plugins.Plugin) =&gt; Unit)Unit</span><span id="21366"><a id="121700">plug</a></span></span> &lt;- <span class="typed"><span class="type">=&gt; List[scala.tools.nsc.plugins.Plugin]</span><a href="#22578">roughPluginsList</a></span>; <span class="typed"><span class="type">((String) =&gt; Unit)Unit</span><span id="25418"><a id="121702">help</a></span></span> &lt;- <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121700">plug</a></span>.<span class="typed"><span class="type">=&gt; Option[String]</span><a href="Plugin.scala.html#95608">optionsHelp</a></span>) {
      <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#121692">buf</a></span> <span class="typed"><span class="type">(java.lang.String)java.lang.StringBuffer</span><a id="60997">append</a></span> (<span class="typed"><span class="type">java.lang.String(&quot;Options for plugin &quot;)</span><span class="string">&quot;Options for plugin &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">scala.tools.nsc.plugins.Plugin</span><a href="#121700">plug</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="Plugin.scala.html#95603">name</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;:\012&quot;)</span><span class="string">&quot;:\n&quot;</span></span>)
      <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#121692">buf</a></span> <span class="typed"><span class="type">(java.lang.String)java.lang.StringBuffer</span><a id="60997">append</a></span> <span class="typed"><span class="type">String</span><a href="#121702">help</a></span>
      <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#121692">buf</a></span> <span class="typed"><span class="type">(java.lang.String)java.lang.StringBuffer</span><a id="60997">append</a></span> <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>
    }
    <span class="typed"><span class="type">java.lang.StringBuffer</span><a href="#121692">buf</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="61033">toString</a></span>
  }
}

        </pre>
    </body>
</html>