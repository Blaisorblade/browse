<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/matching/MatchUtil.scala</title>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 */</span>

<span class="keyword">package</span> scala.tools.nsc.matching

<span class="comment">/**
 *  Utility classes, most of which probably belong somewhere else.
 */</span>
<span class="keyword">object</span> <span class="typed"><span class="type">object scala.tools.nsc.matching.MatchUtil</span><a id="7868">MatchUtil</a></span>
{
  <span class="keyword">import</span> collection.mutable.ListBuffer
  
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Nothing</span><a id="52041">impossible</a></span>:           <span class="typed"><span class="type">Nothing</span><a id="2167">Nothing</a></span> = <span class="typed"><span class="type">(String)Nothing</span><a href="#52042">abort</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;this never happens&quot;)</span><span class="string">&quot;this never happens&quot;</span></span>)
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Nothing</span><a id="52042">abort</a></span>(<span class="typed"><span class="type">String</span><a id="115312">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>):   <span class="typed"><span class="type">Nothing</span><a id="2167">Nothing</a></span> = <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(java.lang.String)java.lang.RuntimeException</span><a id="29859" class="keyword">new</a></span> <span class="typed"><span class="type">java.lang.RuntimeException</span><span id="5976"><a id="821">RuntimeException</a></span></span>(<span class="typed"><span class="type">String</span><a href="#115312">msg</a></span>)
  
  <span class="comment">// def classifyPatString(pat: Tree) = pat match {</span>
  <span class="comment">//   case _: Alternative                 =&gt; &quot;Alternative&quot;</span>
  <span class="comment">//   case Typed(Strip2(_: UnApply), _)   =&gt; &quot;Typed&quot;</span>
  <span class="comment">//   case Ident_Or_Empty()               =&gt; &quot;Ident(_)|EmptyTree&quot;</span>
  <span class="comment">//   case _: Ident                       =&gt; &quot;Ident&quot;</span>
  <span class="comment">//   case _: Select                      =&gt; &quot;Select&quot;</span>
  <span class="comment">//   case UnApply_TypeApply(_, _)        =&gt; &quot;Unapply(...TypeApply...)&quot;</span>
  <span class="comment">//   case UnApply(_: Apply, _)           =&gt; &quot;Unapply(Apply())&quot;</span>
  <span class="comment">//   case Apply_Function(_)              =&gt; &quot;Apply !isCaseClass&quot;</span>
  <span class="comment">//   case Apply_Value(_, _)              =&gt; &quot;Apply_Value&quot;</span>
  <span class="comment">//   case Apply_CaseClass_NoArgs(_)      =&gt; &quot;Apply_CaseClass_NoArgs&quot;</span>
  <span class="comment">//   case Apply_CaseClass_WithArgs()     =&gt; &quot;Apply_CaseClass_WithArgs&quot;</span>
  <span class="comment">//   case _: ArrayValue                  =&gt; &quot;ArrayValue&quot;</span>
  <span class="comment">//   case _                              =&gt; &quot;Unknown!&quot;        </span>
  <span class="comment">// }  </span>
  
  <span class="keyword">object</span> <span class="typed"><span class="type">object scala.tools.nsc.matching.MatchUtil.Implicits</span><a id="52043">Implicits</a></span> {
    <span class="keyword">implicit</span> <span class="keyword">def</span> <span class="typed"><span class="type">[T](List[T])scala.tools.nsc.matching.MatchUtil.ListPlus[T]</span><a id="52050">listPlusOps</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="52052">T</a></span>](<span class="typed"><span class="type">List[T]</span><a id="53003">xs</a></span>: <span class="typed"><span class="type">List[T]</span><a id="526">List</a></span>[T]) = <span class="typed"><span class="type">scala.tools.nsc.matching.MatchUtil.ListPlus[T]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.matching.MatchUtil.ListPlus[T]</span><a href="#52045">ListPlus</a></span>(<span class="typed"><span class="type">List[T]</span><a href="#53003">xs</a></span>)
  }
  
  <span class="comment">// object Flags {</span>
  <span class="comment">//   import symtab.Flags</span>
  <span class="comment">//   import symtab.Symbols</span>
  <span class="comment">// }</span>
  
  <span class="keyword">class</span> <span class="typed"><span class="type">class ListPlus[A] extends java.lang.Object with ScalaObject</span><a id="52045">ListPlus</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="52046">A</a></span>](<span class="typed"><span class="type">List[A]</span><span id="53006"><a id="53015">list</a></span></span>: <span class="typed"><span class="type">List[A]</span><a id="526">List</a></span>[A]) {
    <span class="comment">/** Returns the list without the element at index &lt;code&gt;n&lt;/code&gt;.
     *  If this list has fewer than &lt;code&gt;n&lt;/code&gt; elements, the same list is returned.
     *
     * @param n the index of the element to drop.
     * @return the list without the &lt;code&gt;n&lt;/code&gt;th element.
     */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(Int)List[A]</span><a id="53008">dropIndex</a></span>(<span class="typed"><span class="type">Int</span><a id="103828">n</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>) = <span class="typed"><span class="type">List[A]</span><a href="#53006">list</a></span>.<span class="typed"><span class="type">(Int)List[A]</span><a id="21351">take</a></span>(<span class="typed"><span class="type">Int</span><a href="#103828">n</a></span>) <span class="typed"><span class="type">(List[A])List[A]</span><a href="#103830" id="21339">:::</a></span> <span class="typed"><span class="type">List[A]</span><a href="#53006">list</a></span>.<span class="typed"><span class="type">(Int)List[A]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int</span><a href="#103828">n</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
  
    <span class="comment">/** Returns a list formed from this list and the specified lists &lt;code&gt;list2&lt;/code&gt; 
     *  and &lt;code&gt;list3&lt;/code&gt; by associating each element of the first list with
     *  the elements at the same positions in the other two.
     *  If any of the lists is shorter than the others, later elements in the other two are ignored.
     *
     *  @return     &lt;code&gt;List((a&lt;sub&gt;0&lt;/sub&gt;,b&lt;sub&gt;0&lt;/sub&gt;), ...,
     *              (a&lt;sub&gt;min(m,n)&lt;/sub&gt;,b&lt;sub&gt;min(m,n)&lt;/sub&gt;))&lt;/code&gt; when
     *              &lt;code&gt;List(a&lt;sub&gt;0&lt;/sub&gt;, ..., a&lt;sub&gt;m&lt;/sub&gt;)
     *              zip List(b&lt;sub&gt;0&lt;/sub&gt;, ..., b&lt;sub&gt;n&lt;/sub&gt;)&lt;/code&gt; is invoked.
     */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">[B, C](List[B],List[C])List[(A, B, C)]</span><a id="53009">zip3</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="53012">B</a></span>, <span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="53013">C</a></span>](<span class="typed"><span class="type">List[B]</span><a id="115318">list2</a></span>: <span class="typed"><span class="type">List[B]</span><a id="526">List</a></span>[B], <span class="typed"><span class="type">List[C]</span><a id="115319">list3</a></span>: <span class="typed"><span class="type">List[C]</span><a id="526">List</a></span>[C]): <span class="typed"><span class="type">List[(A, B, C)]</span><a id="526">List</a></span>[(A, B, C)] = {
      <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[(A, B, C)]</span><a id="115320">b</a></span> = <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[(A, B, C)]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[(A, B, C)]</span><a id="19925">ListBuffer</a></span>[(A, B, C)]
      <span class="keyword">var</span> <span class="typed"><span class="type">List[A]</span><a id="115321">xs1</a></span> = <span class="typed"><span class="type">List[A]</span><a href="#53006">list</a></span>
      <span class="keyword">var</span> <span class="typed"><span class="type">List[B]</span><a id="115322">xs2</a></span> = <span class="typed"><span class="type">List[B]</span><a href="#115318">list2</a></span>
      <span class="keyword">var</span> <span class="typed"><span class="type">List[C]</span><a id="115323">xs3</a></span> = <span class="typed"><span class="type">List[C]</span><a href="#115319">list3</a></span>
      <span class="typed"><span class="type">Unit</span><a href="#115324" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">List[A]</span><a href="#115321">xs1</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">List[B]</span><a href="#115322">xs2</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">List[C]</span><a href="#115323">xs3</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span>) {
        <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[(A, B, C)]</span><a href="#115320">b</a></span> <span class="typed"><span class="type">((A, B, C))Unit</span><a id="33306">+=</a></span> (<span class="typed"><span class="type">(A,B,C)(A, B, C)</span><span id="23590"><a id="449">(</a></span></span><span class="typed"><span class="type">List[A]</span><a href="#115321">xs1</a></span>.<span class="typed"><span class="type">=&gt; A</span><a id="21332">head</a></span>, <span class="typed"><span class="type">List[B]</span><a href="#115322">xs2</a></span>.<span class="typed"><span class="type">=&gt; B</span><a id="21332">head</a></span>, <span class="typed"><span class="type">List[C]</span><a href="#115323">xs3</a></span>.<span class="typed"><span class="type">=&gt; C</span><a id="21332">head</a></span>))
        <span class="typed"><span class="type">List[A]</span><a href="#115321">xs1</a></span> = <span class="typed"><span class="type">List[A]</span><a href="#115321">xs1</a></span>.<span class="typed"><span class="type">=&gt; List[A]</span><a id="21334">tail</a></span>
        <span class="typed"><span class="type">List[B]</span><a href="#115322">xs2</a></span> = <span class="typed"><span class="type">List[B]</span><a href="#115322">xs2</a></span>.<span class="typed"><span class="type">=&gt; List[B]</span><a id="21334">tail</a></span>
        <span class="typed"><span class="type">List[C]</span><a href="#115323">xs3</a></span> = <span class="typed"><span class="type">List[C]</span><a href="#115323">xs3</a></span>.<span class="typed"><span class="type">=&gt; List[C]</span><a id="21334">tail</a></span>
      }
      <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[(A, B, C)]</span><a href="#115320">b</a></span>.<span class="typed"><span class="type">=&gt; List[(A, B, C)]</span><a id="33309">toList</a></span>
    }
  }

  <span class="keyword">object</span> <span class="typed"><span class="type">object scala.tools.nsc.matching.MatchUtil.ListPlus</span><a id="52047">ListPlus</a></span> {
    <span class="comment">/** Transforms a list of triples into a triple of lists.
     *
     *  @param xs the list of triples to unzip
     *  @return a triple of lists.
     */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">[A, B, C](List[(A, B, C)])(List[A], List[B], List[C])</span><a id="52054">unzip3</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="52058">A</a></span>,<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="52059">B</a></span>,<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="52060">C</a></span>](<span class="typed"><span class="type">List[(A, B, C)]</span><a id="52911">xs</a></span>: <span class="typed"><span class="type">List[(A, B, C)]</span><a id="526">List</a></span>[(A,B,C)]): <span class="typed"><span class="type">(List[A], List[B], List[C])</span><a id="448">(</a></span>List[A], List[B], List[C]) = {
      <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[A]</span><a id="115332">b1</a></span> = <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[A]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[A]</span><a id="19925">ListBuffer</a></span>[A]
      <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[B]</span><a id="115333">b2</a></span> = <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[B]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[B]</span><a id="19925">ListBuffer</a></span>[B]
      <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[C]</span><a id="115334">b3</a></span> = <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[C]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[C]</span><a id="19925">ListBuffer</a></span>[C]
      <span class="keyword">var</span> <span class="typed"><span class="type">List[(A, B, C)]</span><a id="115335">xc</a></span> = <span class="typed"><span class="type">List[(A, B, C)]</span><a href="#52911">xs</a></span>
      <span class="typed"><span class="type">Unit</span><a href="#115336" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">List[(A, B, C)]</span><a href="#115335">xc</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a id="21645">isEmpty</a></span>) {
        <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[A]</span><a href="#115332">b1</a></span> <span class="typed"><span class="type">(A)Unit</span><a id="33306">+=</a></span> <span class="typed"><span class="type">List[(A, B, C)]</span><a href="#115335">xc</a></span>.<span class="typed"><span class="type">=&gt; (A, B, C)</span><a id="21332">head</a></span>.<span class="typed"><span class="type">=&gt; A</span><a id="23578">_1</a></span>
        <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[B]</span><a href="#115333">b2</a></span> <span class="typed"><span class="type">(B)Unit</span><a id="33306">+=</a></span> <span class="typed"><span class="type">List[(A, B, C)]</span><a href="#115335">xc</a></span>.<span class="typed"><span class="type">=&gt; (A, B, C)</span><a id="21332">head</a></span>.<span class="typed"><span class="type">=&gt; B</span><a id="23580">_2</a></span>
        <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[C]</span><a href="#115334">b3</a></span> <span class="typed"><span class="type">(C)Unit</span><a id="33306">+=</a></span> <span class="typed"><span class="type">List[(A, B, C)]</span><a href="#115335">xc</a></span>.<span class="typed"><span class="type">=&gt; (A, B, C)</span><a id="21332">head</a></span>.<span class="typed"><span class="type">=&gt; C</span><a id="23582">_3</a></span>
        <span class="typed"><span class="type">List[(A, B, C)]</span><a href="#115335">xc</a></span> = <span class="typed"><span class="type">List[(A, B, C)]</span><a href="#115335">xc</a></span>.<span class="typed"><span class="type">=&gt; List[(A, B, C)]</span><a id="21334">tail</a></span>
      }
      <span class="typed"><span class="type">(List[A],List[B],List[C])(List[A], List[B], List[C])</span><span id="23590"><a id="449">(</a></span></span><span class="typed"><span class="type">scala.collection.mutable.ListBuffer[A]</span><a href="#115332">b1</a></span>.<span class="typed"><span class="type">=&gt; List[A]</span><a id="33309">toList</a></span>, <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[B]</span><a href="#115333">b2</a></span>.<span class="typed"><span class="type">=&gt; List[B]</span><a id="33309">toList</a></span>, <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[C]</span><a href="#115334">b3</a></span>.<span class="typed"><span class="type">=&gt; List[C]</span><a id="33309">toList</a></span>)
    }
  }
}

        </pre>
    </body>
</html>