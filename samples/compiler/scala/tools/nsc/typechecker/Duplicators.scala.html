<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/typechecker/Duplicators.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> typechecker

<span class="keyword">import</span> scala.tools.nsc.symtab.Flags

<span class="keyword">import</span> scala.collection.{mutable, immutable}

/** Duplicate trees and re-type check them, taking care to replace
 *  and create fresh symbols for new local definitions.
 */
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Duplicators extends java.lang.Object with scala.tools.nsc.typechecker.Analyzer with ScalaObject" id="16320">Duplicators</a> <span title="ScalaObject" class="keyword">extends</span> <a href="Analyzer.scala.html#17112" title="scala.tools.nsc.typechecker.Analyzer">Analyzer</a> {
  <span class="keyword">import</span> global._

  <span class="keyword">def</span> <a title="(context: Duplicators.this.Context,tree: Duplicators.this.global.Tree)Duplicators.this.global.Tree" id="256250">retyped</a>(<a title="Duplicators.this.Context" id="256274">context</a>: <a href="Contexts.scala.html#39821" title="Duplicators.this.Context">Context</a>, <a title="Duplicators.this.global.Tree" id="256275">tree</a>: <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a>): <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a> = {
    <a href="#256254" title="=&gt; Unit">resetClassOwners</a>
    (<span title="Duplicators.this.BodyDuplicator" class="keyword">new</span> <a href="#256267" title="Duplicators.this.BodyDuplicator">BodyDuplicator</a>(<a href="#256274" title="Duplicators.this.Context">context</a>)).<a href="Typers.scala.html#42640" title="(tree: Duplicators.this.global.Tree)Duplicators.this.global.Tree">typed</a>(<a href="#256275" title="Duplicators.this.global.Tree">tree</a>)
  }

  /** Retype the given tree in the given context. Use this method when retyping
   *  a method in a different class. The typer will replace references to the this of
   *  the old class with the new class, and map symbols through the given 'env'. The
   *  environment is a map from type skolems to concrete types (see SpecializedTypes).
   */
  <span class="keyword">def</span> <a title="(context: Duplicators.this.Context,tree: Duplicators.this.global.Tree,oldThis: Duplicators.this.global.Symbol,newThis: Duplicators.this.global.Symbol,env: scala.collection.Map[Duplicators.this.global.Symbol,Duplicators.this.global.Type])Duplicators.this.global.Tree" id="256251">retyped</a>(<a title="Duplicators.this.Context" id="256318">context</a>: <a href="Contexts.scala.html#39821" title="Duplicators.this.Context">Context</a>, <a title="Duplicators.this.global.Tree" id="256319">tree</a>: <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a>, <a title="Duplicators.this.global.Symbol" id="256320">oldThis</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a>, <a title="Duplicators.this.global.Symbol" id="256321">newThis</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a>, <a title="scala.collection.Map[Duplicators.this.global.Symbol,Duplicators.this.global.Type]" id="256322">env</a>: collection.<a title="scala.collection.Map[Duplicators.this.global.Symbol,Duplicators.this.global.Type]" id="4201">Map</a>[Symbol, Type]): <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a> = {
    <span title="Unit" class="keyword">if</span> (<a href="#256320" title="(x$1: AnyRef)Boolean">oldThis</a> ne <a href="#256321" title="Duplicators.this.global.Symbol">newThis</a>) {
      <a href="#256256" title="(x$1: Duplicators.this.global.Symbol)Unit">oldClassOwner</a> = <a href="#256320" title="Duplicators.this.global.Symbol">oldThis</a>
      <a href="#256259" title="(x$1: Duplicators.this.global.Symbol)Unit">newClassOwner</a> = <a href="#256321" title="Duplicators.this.global.Symbol">newThis</a>
    } <span class="keyword">else</span> <a href="#256254" title="=&gt; Unit">resetClassOwners</a>

    <a href="#256262" title="(x$1: Duplicators.this.global.SubstTypeMap)Unit">envSubstitution</a> = <span title="Duplicators.this.SubstSkolemsTypeMap" class="keyword">new</span> <a href="#256264" title="Duplicators.this.SubstSkolemsTypeMap">SubstSkolemsTypeMap</a>(<a href="#256322" title="scala.collection.Map[Duplicators.this.global.Symbol,Duplicators.this.global.Type]">env</a>.<a title="=&gt; Iterator[Duplicators.this.global.Symbol]" id="44464">keysIterator</a>.<span title="=&gt; List[Duplicators.this.global.Symbol]">toList</span>, <a href="#256322" title="scala.collection.Map[Duplicators.this.global.Symbol,Duplicators.this.global.Type]">env</a>.<a title="=&gt; Iterator[Duplicators.this.global.Type]" id="44474">valuesIterator</a>.<span title="=&gt; List[Duplicators.this.global.Type]">toList</span>)
    <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;retyped with env: &quot;</span> + <a href="#256322" title="scala.collection.Map[Duplicators.this.global.Symbol,Duplicators.this.global.Type]">env</a>)
    (<span title="Duplicators.this.BodyDuplicator" class="keyword">new</span> <a href="#256267" title="Duplicators.this.BodyDuplicator">BodyDuplicator</a>(<a href="#256318" title="Duplicators.this.Context">context</a>)).<a href="Typers.scala.html#42640" title="(tree: Duplicators.this.global.Tree)Duplicators.this.global.Tree">typed</a>(<a href="#256319" title="Duplicators.this.global.Tree">tree</a>)
  }

  <span class="keyword">def</span> <a title="(context: Duplicators.this.Context,tree: Duplicators.this.global.Tree,oldThis: Duplicators.this.global.Symbol,newThis: Duplicators.this.global.Symbol)Duplicators.this.global.Tree" id="256252">retypedMethod</a>(<a title="Duplicators.this.Context" id="256363">context</a>: <a href="Contexts.scala.html#39821" title="Duplicators.this.Context">Context</a>, <a title="Duplicators.this.global.Tree" id="256364">tree</a>: <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a>, <a title="Duplicators.this.global.Symbol" id="256365">oldThis</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a>, <a title="Duplicators.this.global.Symbol" id="256366">newThis</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a>): <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a> =
    (<span title="Duplicators.this.BodyDuplicator" class="keyword">new</span> <a href="#256267" title="Duplicators.this.BodyDuplicator">BodyDuplicator</a>(<a href="#256363" title="Duplicators.this.Context">context</a>)).<a href="#256287" title="(ddef: Duplicators.this.global.DefDef,oldThis: Duplicators.this.global.Symbol,newThis: Duplicators.this.global.Symbol)Duplicators.this.global.Tree">retypedMethod</a>(<a href="#256364" title="Duplicators.this.global.Tree">tree</a>.<span title="[T0]T0">asInstanceOf</span><span title="Duplicators.this.global.DefDef">[</span><a href="../ast/Trees.scala.html#26626" title="Duplicators.this.global.DefDef">DefDef</a>], <a href="#256365" title="Duplicators.this.global.Symbol">oldThis</a>, <a href="#256366" title="Duplicators.this.global.Symbol">newThis</a>)

  /** Return the special typer for duplicate method bodies. */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(context: Duplicators.this.Context)Duplicators.this.Typer" id="256253">newTyper</a>(<a title="Duplicators.this.Context" id="256376">context</a>: <a href="Contexts.scala.html#39821" title="Duplicators.this.Context">Context</a>): <a href="Typers.scala.html#39921" title="Duplicators.this.Typer">Typer</a> = 
    <span title="Duplicators.this.BodyDuplicator" class="keyword">new</span> <a href="#256267" title="Duplicators.this.BodyDuplicator">BodyDuplicator</a>(<a href="#256376" title="Duplicators.this.Context">context</a>)

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Unit" id="256254">resetClassOwners</a> {
    <a href="#256256" title="(x$1: Duplicators.this.global.Symbol)Unit">oldClassOwner</a> = <span title="Null(null)" class="keyword">null</span>
    <a href="#256259" title="(x$1: Duplicators.this.global.Symbol)Unit">newClassOwner</a> = <span title="Null(null)" class="keyword">null</span>
  }

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Duplicators.this.global.Symbol" id="256256">oldClassOwner</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a> = _
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Duplicators.this.global.Symbol" id="256259">newClassOwner</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a> = _
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Duplicators.this.global.SubstTypeMap" id="256262">envSubstitution</a>: <a href="../symtab/Types.scala.html#26342" title="Duplicators.this.global.SubstTypeMap">SubstTypeMap</a> = _

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class SubstSkolemsTypeMap extends Duplicators.this.global.SubstTypeMap with ScalaObject" id="256264">SubstSkolemsTypeMap</a><span title="ScalaObject">(</span><a title="List[Duplicators.this.global.Symbol]" id="256336">from</a>: <span title="List[Duplicators.this.global.Symbol]">List</span>[Symbol], <a title="List[Duplicators.this.global.Type]" id="256337">to</a>: <span title="List[Duplicators.this.global.Type]">List</span>[Type]) <span class="keyword">extends</span> <a href="../symtab/Types.scala.html#26342" title="Duplicators.this.global.SubstTypeMap">SubstTypeMap</a>(<a href="#256336" title="List[Duplicators.this.global.Symbol]">from</a>, <a href="#256337" title="List[Duplicators.this.global.Type]">to</a>) {
    <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">def</span> <a title="(sym1: Duplicators.this.global.Symbol,sym2: Duplicators.this.global.Symbol)Boolean" id="256335">matches</a>(<a title="Duplicators.this.global.Symbol" id="256392">sym1</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a>, <a title="Duplicators.this.global.Symbol" id="256393">sym2</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a>) = 
      <span title="Boolean" class="keyword">if</span> (<a href="#256393" title="Duplicators.this.global.Symbol">sym2</a>.<a href="../symtab/Symbols.scala.html#26925" title="=&gt; Boolean">isTypeSkolem</a>) <a href="#256393" title="Duplicators.this.global.Symbol">sym2</a>.<a href="../symtab/Symbols.scala.html#27071" title="(x$1: AnyRef)Boolean">deSkolemize</a> eq <a href="#256392" title="Duplicators.this.global.Symbol">sym1</a>
      <span class="keyword">else</span> <a href="#256392" title="(x$1: AnyRef)Boolean">sym1</a> eq <a href="#256393" title="Duplicators.this.global.Symbol">sym2</a>
  }

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.Map[Duplicators.this.global.Symbol,Duplicators.this.global.Tree]" id="256265">invalidSyms</a>: mutable.<a title="scala.collection.mutable.Map[Duplicators.this.global.Symbol,Duplicators.this.global.Tree]" id="24789">Map</a>[Symbol, Tree] = mutable.<a title="object scala.collection.mutable.HashMap" id="24955">HashMap</a>.<a title="[A, B]scala.collection.mutable.HashMap[A,B]" id="44400">empty</a><span title="scala.collection.mutable.HashMap[Duplicators.this.global.Symbol,Duplicators.this.global.Tree]">[</span><a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a>, <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a>]
  
  /** A typer that creates new symbols for all definitions in the given tree
   *  and updates references to them while re-typechecking. All types in the 
   *  tree, except for TypeTrees, are erased prior to type checking. TypeTrees
   *  are fixed by substituting invalid symbols for the new ones.
   */
  <span class="keyword">class</span> <a title="class BodyDuplicator extends Duplicators.this.Typer with ScalaObject" id="256267">BodyDuplicator</a><span title="ScalaObject">(</span><a title="Duplicators.this.Context" id="256289">context</a>: <a href="Contexts.scala.html#39821" title="Duplicators.this.Context">Context</a>) <span class="keyword">extends</span> <a href="Typers.scala.html#39921" title="Duplicators.this.Typer">Typer</a>(<a href="#256289" title="Duplicators.this.Context">context</a>: <a href="Contexts.scala.html#39821" title="Duplicators.this.Context">Context</a>) {

    <span class="keyword">class</span> <a title="class FixInvalidSyms extends Duplicators.this.global.TypeMap with ScalaObject" id="256282">FixInvalidSyms</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../symtab/Types.scala.html#26320" title="Duplicators.this.global.TypeMap">TypeMap</a> {

      <span class="keyword">def</span> <a title="(tpe: Duplicators.this.global.Type)Duplicators.this.global.Type" id="256424">apply</a>(<a title="Duplicators.this.global.Type" id="256429">tpe</a>: <a href="../symtab/Types.scala.html#26205" title="Duplicators.this.global.Type">Type</a>): <a href="../symtab/Types.scala.html#26205" title="Duplicators.this.global.Type">Type</a> = {
        <a href="#256425" title="(tpe: Duplicators.this.global.Type)Duplicators.this.global.Type">mapOver</a>(<a href="#256429" title="Duplicators.this.global.Type">tpe</a>)
      }

      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tpe: Duplicators.this.global.Type)Duplicators.this.global.Type" id="256425">mapOver</a>(<a title="Duplicators.this.global.Type" id="256432">tpe</a>: <a href="../symtab/Types.scala.html#26205" title="Duplicators.this.global.Type">Type</a>): <a href="../symtab/Types.scala.html#26205" title="Duplicators.this.global.Type">Type</a> = <a href="#256432" title="Duplicators.this.global.Type">tpe</a> <span title="Duplicators.this.global.Type" class="keyword">match</span> {
        <span title="Duplicators.this.global.Type" class="keyword">case</span> TypeRef(<a href="../symtab/Types.scala.html#26226" title="object Duplicators.this.global.NoPrefix">NoPrefix</a>, <a title="Duplicators.this.global.Symbol" id="256516">sym</a>, <a title="List[Duplicators.this.global.Type]" id="256517">args</a>) <span class="keyword">if</span> <a href="#256516" title="Duplicators.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#26924" title="=&gt; Boolean">isTypeParameterOrSkolem</a> =&gt;
          <span class="keyword">val</span> <a title="Duplicators.this.global.Symbol" id="256520">sym1</a> = <a href="#256289" title="Duplicators.this.Context">context</a>.<a href="Contexts.scala.html#48365" title="=&gt; Duplicators.this.global.Scope">scope</a>.<a href="../symtab/Scopes.scala.html#27138" title="(name: Duplicators.this.global.Name)Duplicators.this.global.Symbol">lookup</a>(<a href="#256516" title="Duplicators.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#26988" title="=&gt; Duplicators.this.global.Name">name</a>)
//          assert(sym1 ne NoSymbol, tpe)
          <span title="Duplicators.this.global.Type" class="keyword">if</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#256520" title="(x$1: AnyRef)Boolean">sym1</a> ne <a href="../symtab/Symbols.scala.html#26134" title="object Duplicators.this.global.NoSymbol">NoSymbol</a>) &amp;&amp; (<a href="#256520" title="(x$1: AnyRef)Boolean">sym1</a> ne <a href="#256516" title="Duplicators.this.global.Symbol">sym</a>)) {
            <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;fixing &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#256516" title="Duplicators.this.global.Symbol">sym</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span> + <a href="#256520" title="Duplicators.this.global.Symbol">sym1</a>)
            <a href="../symtab/Types.scala.html#26295" title="(pre: Duplicators.this.global.Type,sym: Duplicators.this.global.Symbol,args: List[Duplicators.this.global.Type])Duplicators.this.global.Type">typeRef</a>(<a href="../symtab/Types.scala.html#26226" title="object Duplicators.this.global.NoPrefix">NoPrefix</a>, <a href="#256520" title="Duplicators.this.global.Symbol">sym1</a>, <a href="../symtab/Types.scala.html#42723" title="(args: List[Duplicators.this.global.Type],tparams: List[Duplicators.this.global.Symbol])List[Duplicators.this.global.Type]">mapOverArgs</a>(<a href="#256517" title="List[Duplicators.this.global.Type]">args</a>, <a href="#256520" title="Duplicators.this.global.Symbol">sym1</a>.<a href="../symtab/Symbols.scala.html#27016" title="=&gt; List[Duplicators.this.global.Symbol]">typeParams</a>))
          } <span class="keyword">else</span> <span class="keyword">super</span>.<a href="../symtab/Types.scala.html#42722" title="(tp: Duplicators.this.global.Type)Duplicators.this.global.Type">mapOver</a>(<a href="#256432" title="Duplicators.this.global.Type">tpe</a>)

        <span title="Duplicators.this.global.Type" class="keyword">case</span> TypeRef(<a title="Duplicators.this.global.Type" id="256577">pre</a>, <a title="Duplicators.this.global.Symbol" id="256578">sym</a>, <a title="List[Duplicators.this.global.Type]" id="256579">args</a>) =&gt;
          <span class="keyword">val</span> <a title="Duplicators.this.global.Symbol" id="256582">newsym</a> = <a href="#256284" title="(sym: Duplicators.this.global.Symbol)Duplicators.this.global.Symbol">updateSym</a>(<a href="#256578" title="Duplicators.this.global.Symbol">sym</a>)
          <span title="Duplicators.this.global.Type" class="keyword">if</span> (<a href="#256582" title="(x$1: AnyRef)Boolean">newsym</a> ne <a href="#256578" title="Duplicators.this.global.Symbol">sym</a>) {
            <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;fixing &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#256578" title="Duplicators.this.global.Symbol">sym</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span> + <a href="#256582" title="Duplicators.this.global.Symbol">newsym</a>)
            <a href="../symtab/Types.scala.html#26295" title="(pre: Duplicators.this.global.Type,sym: Duplicators.this.global.Symbol,args: List[Duplicators.this.global.Type])Duplicators.this.global.Type">typeRef</a>(<a href="#256425" title="(tpe: Duplicators.this.global.Type)Duplicators.this.global.Type">mapOver</a>(<a href="#256577" title="Duplicators.this.global.Type">pre</a>), <a href="#256582" title="Duplicators.this.global.Symbol">newsym</a>, <a href="../symtab/Types.scala.html#42723" title="(args: List[Duplicators.this.global.Type],tparams: List[Duplicators.this.global.Symbol])List[Duplicators.this.global.Type]">mapOverArgs</a>(<a href="#256579" title="List[Duplicators.this.global.Type]">args</a>, <a href="#256582" title="Duplicators.this.global.Symbol">newsym</a>.<a href="../symtab/Symbols.scala.html#27016" title="=&gt; List[Duplicators.this.global.Symbol]">typeParams</a>))
          } <span class="keyword">else</span> 
            <span class="keyword">super</span>.<a href="../symtab/Types.scala.html#42722" title="(tp: Duplicators.this.global.Type)Duplicators.this.global.Type">mapOver</a>(<a href="#256432" title="Duplicators.this.global.Type">tpe</a>)
        <span title="Duplicators.this.global.Type" class="keyword">case</span> _ =&gt;
          <span class="keyword">super</span>.<a href="../symtab/Types.scala.html#42722" title="(tp: Duplicators.this.global.Type)Duplicators.this.global.Type">mapOver</a>(<a href="#256432" title="Duplicators.this.global.Type">tpe</a>)
      }
    }
    
    /** Fix the given type by replacing invalid symbols with the new ones. */
    <span class="keyword">def</span> <a title="(tpe: Duplicators.this.global.Type)Duplicators.this.global.Type" id="256283">fixType</a>(<a title="Duplicators.this.global.Type" id="256682">tpe</a>: <a href="../symtab/Types.scala.html#26205" title="Duplicators.this.global.Type">Type</a>): <a href="../symtab/Types.scala.html#26205" title="Duplicators.this.global.Type">Type</a> = {
      <span class="keyword">val</span> <a title="Duplicators.this.global.Type" id="256684">tpe1</a> = <a href="../symtab/Types.scala.html#116731" title="(tp0: Duplicators.this.global.Type)Duplicators.this.global.Type">envSubstitution</a>(<a href="#256682" title="Duplicators.this.global.Type">tpe</a>)
      <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;tpe1: &quot;</span> + <a href="#256684" title="Duplicators.this.global.Type">tpe1</a>)
      (<a href="#256424" title="(tpe: Duplicators.this.global.Type)Duplicators.this.global.Type" class="keyword">new</a> <a href="#256282" title="BodyDuplicator.this.FixInvalidSyms">FixInvalidSyms</a>)(<a href="#256684" title="Duplicators.this.global.Type">tpe1</a>)
    }

    /** Return the new symbol corresponding to `sym'. */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: Duplicators.this.global.Symbol)Duplicators.this.global.Symbol" id="256284">updateSym</a>(<a title="Duplicators.this.global.Symbol" id="256583">sym</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a>): <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a> =
      <span title="Duplicators.this.global.Symbol" class="keyword">if</span> (<a href="#256265" title="=&gt; scala.collection.mutable.Map[Duplicators.this.global.Symbol,Duplicators.this.global.Tree]">invalidSyms</a>.<span title="(key: Duplicators.this.global.Symbol)Boolean">isDefinedAt</span>(<a href="#256583" title="Duplicators.this.global.Symbol">sym</a>)) 
        <a href="#256265" title="(key: Duplicators.this.global.Symbol)Duplicators.this.global.Tree" id="44444">invalidSyms</a>(<a href="#256583" title="Duplicators.this.global.Symbol">sym</a>).<a href="../ast/Trees.scala.html#29367" title="=&gt; Duplicators.this.global.Symbol">symbol</a>
      <span class="keyword">else</span>
        <a href="#256583" title="Duplicators.this.global.Symbol">sym</a>
      
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tree: Duplicators.this.global.Tree)Unit" id="256285">invalidate</a>(<a title="Duplicators.this.global.Tree" id="256735">tree</a>: <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a>) {
      <span title="Unit" class="keyword">if</span> (<a href="#256735" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29371" title="(x$1: Boolean)Boolean">isDef</a> &amp;&amp; <a href="#256735" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="(x$1: AnyRef)Boolean">symbol</a> != <a href="../symtab/Symbols.scala.html#26134" title="object Duplicators.this.global.NoSymbol">NoSymbol</a>) {
        <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;invalid &quot;</span> + <a href="#256735" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="=&gt; Duplicators.this.global.Symbol">symbol</a>)
        <a href="#256265" title="(key: Duplicators.this.global.Symbol,value: Duplicators.this.global.Tree)Unit">invalidSyms</a>(<a href="#256735" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="=&gt; Duplicators.this.global.Symbol">symbol</a>) = <a href="#256735" title="Duplicators.this.global.Tree">tree</a>

        <a href="#256735" title="Duplicators.this.global.Tree">tree</a> <span title="Unit" class="keyword">match</span> { 
          <span title="Unit" class="keyword">case</span> <a title="Duplicators.this.global.LabelDef" id="256754">ldef</a> @ LabelDef(<a title="Duplicators.this.global.Name" id="256760">name</a>, <a title="List[Duplicators.this.global.Ident]" id="256761">params</a>, <a title="Duplicators.this.global.Tree" id="256762">rhs</a>) =&gt;        
            <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;LabelDef &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#256760" title="Duplicators.this.global.Name">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; sym.info: &quot;)" class="string">&quot; sym.info: &quot;</span> + <a href="#256754" title="Duplicators.this.global.LabelDef">ldef</a>.<a href="../ast/Trees.scala.html#48485" title="=&gt; Duplicators.this.global.Symbol">symbol</a>.<a href="../symtab/Symbols.scala.html#27004" title="=&gt; Duplicators.this.global.Type">info</a>)
            <a href="#256265" title="(key: Duplicators.this.global.Symbol,value: Duplicators.this.global.Tree)Unit">invalidSyms</a>(<a href="#256754" title="Duplicators.this.global.LabelDef">ldef</a>.<a href="../ast/Trees.scala.html#48485" title="=&gt; Duplicators.this.global.Symbol">symbol</a>) = <a href="#256754" title="Duplicators.this.global.LabelDef">ldef</a>
          //          breakIf(true, this, ldef, context)
            <span class="keyword">val</span> <a title="Duplicators.this.global.Symbol" id="256765">newsym</a> = <a href="#256754" title="Duplicators.this.global.LabelDef">ldef</a>.<a href="../ast/Trees.scala.html#48485" title="=&gt; Duplicators.this.global.Symbol">symbol</a>.<a href="../symtab/Symbols.scala.html#27029" title="(owner: Duplicators.this.global.Symbol)Duplicators.this.global.Symbol">cloneSymbol</a>(<a href="#256289" title="Duplicators.this.Context">context</a>.<a href="Contexts.scala.html#48362" title="=&gt; Duplicators.this.global.Symbol">owner</a>)
            <a href="#256765" title="Duplicators.this.global.Symbol">newsym</a>.<a href="../symtab/Symbols.scala.html#27005" title="(info: Duplicators.this.global.Type)newsym.type">setInfo</a>(<a href="#256283" title="(tpe: Duplicators.this.global.Type)Duplicators.this.global.Type">fixType</a>(<a href="#256754" title="Duplicators.this.global.LabelDef">ldef</a>.<a href="../ast/Trees.scala.html#48485" title="=&gt; Duplicators.this.global.Symbol">symbol</a>.<a href="../symtab/Symbols.scala.html#27004" title="=&gt; Duplicators.this.global.Type">info</a>))
            <a href="#256754" title="Duplicators.this.global.LabelDef">ldef</a>.<a href="../ast/Trees.scala.html#48486" title="(x$1: Duplicators.this.global.Symbol)Unit">symbol</a> = <a href="#256765" title="Duplicators.this.global.Symbol">newsym</a>
            <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;newsym: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#256765" title="Duplicators.this.global.Symbol">newsym</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; info: &quot;)" class="string">&quot; info: &quot;</span> + <a href="#256765" title="Duplicators.this.global.Symbol">newsym</a>.<a href="../symtab/Symbols.scala.html#27004" title="=&gt; Duplicators.this.global.Type">info</a>)

          <span title="Unit" class="keyword">case</span> DefDef(_, _, _, _, _, <a title="Duplicators.this.global.Tree" id="256810">rhs</a>) =&gt;
            // invalidate parameters
            <a href="#256286" title="(stats: List[Duplicators.this.global.Tree])Unit">invalidate</a>(<a href="#256735" title="Duplicators.this.global.Tree">tree</a>.<span title="[T0]T0">asInstanceOf</span><span title="Duplicators.this.global.DefDef">[</span><a href="../ast/Trees.scala.html#26626" title="Duplicators.this.global.DefDef">DefDef</a>].<a href="../ast/Trees.scala.html#52190" title="=&gt; List[Duplicators.this.global.TypeDef]">tparams</a>)
            <a href="#256286" title="(stats: List[Duplicators.this.global.Tree])Unit">invalidate</a>(<span title="object List">List</span>.<span title="(xss: List[List[Duplicators.this.global.ValDef]])List[Duplicators.this.global.ValDef]">flatten</span>(<a href="#256735" title="Duplicators.this.global.Tree">tree</a>.<span title="[T0]T0">asInstanceOf</span><span title="Duplicators.this.global.DefDef">[</span><a href="../ast/Trees.scala.html#26626" title="Duplicators.this.global.DefDef">DefDef</a>].<a href="../ast/Trees.scala.html#52192" title="=&gt; List[List[Duplicators.this.global.ValDef]]">vparamss</a>))
            <a href="#256735" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29368" title="(sym: Duplicators.this.global.Symbol)Unit">symbol</a> = <a href="../symtab/Symbols.scala.html#26134" title="object Duplicators.this.global.NoSymbol">NoSymbol</a>

          <span title="Unit" class="keyword">case</span> _ =&gt; 
            <a href="#256735" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29368" title="(sym: Duplicators.this.global.Symbol)Unit">symbol</a> = <a href="../symtab/Symbols.scala.html#26134" title="object Duplicators.this.global.NoSymbol">NoSymbol</a>
        }
      }
    }

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(stats: List[Duplicators.this.global.Tree])Unit" id="256286">invalidate</a>(<a title="List[Duplicators.this.global.Tree]" id="256816">stats</a>: <span title="List[Duplicators.this.global.Tree]">List</span>[Tree]) {
      <a href="#256816" title="(f: (Duplicators.this.global.Tree) =&gt; Unit)Unit">stats</a> foreach <a href="#256285" title="(tree: Duplicators.this.global.Tree)Unit">invalidate</a>
    }
      

    <span class="keyword">def</span> <a title="(ddef: Duplicators.this.global.DefDef,oldThis: Duplicators.this.global.Symbol,newThis: Duplicators.this.global.Symbol)Duplicators.this.global.Tree" id="256287">retypedMethod</a>(<a title="Duplicators.this.global.DefDef" id="256370">ddef</a>: <a href="../ast/Trees.scala.html#26626" title="Duplicators.this.global.DefDef">DefDef</a>, <a title="Duplicators.this.global.Symbol" id="256371">oldThis</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a>, <a title="Duplicators.this.global.Symbol" id="256372">newThis</a>: <a href="../symtab/Symbols.scala.html#26127" title="Duplicators.this.global.Symbol">Symbol</a>): <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a> = {
      <a href="#256256" title="(x$1: Duplicators.this.global.Symbol)Unit">oldClassOwner</a> = <a href="#256371" title="Duplicators.this.global.Symbol">oldThis</a>
      <a href="#256259" title="(x$1: Duplicators.this.global.Symbol)Unit">newClassOwner</a> = <a href="#256372" title="Duplicators.this.global.Symbol">newThis</a>
      <a href="#256286" title="(stats: List[Duplicators.this.global.Tree])Unit">invalidate</a>(<a href="#256370" title="Duplicators.this.global.DefDef">ddef</a>.<a href="../ast/Trees.scala.html#52190" title="=&gt; List[Duplicators.this.global.TypeDef]">tparams</a>)
      <span class="keyword">for</span> (<a title="Duplicators.this.global.ValDef" id="256902">vdef</a> &lt;- <span title="object List">List</span>.<span title="(xss: List[List[Duplicators.this.global.ValDef]])List[Duplicators.this.global.ValDef]">flatten</span><span title="(f: (Duplicators.this.global.ValDef) =&gt; Unit)Unit">(</span><a href="#256370" title="Duplicators.this.global.DefDef">ddef</a>.<a href="../ast/Trees.scala.html#52192" title="=&gt; List[List[Duplicators.this.global.ValDef]]">vparamss</a>)) {
        <a href="#256285" title="(tree: Duplicators.this.global.Tree)Unit">invalidate</a>(<a href="#256902" title="Duplicators.this.global.ValDef">vdef</a>)
        <a href="#256902" title="Duplicators.this.global.ValDef">vdef</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <span title="Null(null)" class="keyword">null</span>
      }
      <a href="#256370" title="Duplicators.this.global.DefDef">ddef</a>.<a href="../ast/Trees.scala.html#48486" title="(x$1: Duplicators.this.global.Symbol)Unit">symbol</a> = <a href="../symtab/Symbols.scala.html#26134" title="object Duplicators.this.global.NoSymbol">NoSymbol</a>
      <a href="Typers.scala.html#42605" title="(txt: Duplicators.this.Context,tree: Duplicators.this.global.Tree)Duplicators.this.Context">enterSym</a>(<a href="#256289" title="Duplicators.this.Context">context</a>, <a href="#256370" title="Duplicators.this.global.DefDef">ddef</a>)
      <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;remapping this of &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#256256" title="=&gt; Duplicators.this.global.Symbol">oldClassOwner</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; to &quot;)" class="string">&quot; to &quot;</span> + <a href="#256259" title="=&gt; Duplicators.this.global.Symbol">newClassOwner</a>)
      <a href="Typers.scala.html#42640" title="(tree: Duplicators.this.global.Tree)Duplicators.this.global.Tree">typed</a>(<a href="#256370" title="Duplicators.this.global.DefDef">ddef</a>)
    }
    
    /** Special typer method allowing for re-type checking trees. It expects a typed tree.
     *  Returns a typed tree that has fresh symbols for all definitions in the original tree.
     *
     *  Each definition tree is visited and its symbol added to the invalidSyms map (except LabelDefs),
     *  then cleared (forcing the namer to create fresh symbols).
     *  All invalid symbols found in trees are cleared (except for LabelDefs), forcing the
     *  typechecker to look for fresh ones in the context.
     *
     *  Type trees are typed by substituting old symbols for new ones (@see fixType).
     *
     *  LabelDefs are not typable from trees alone, unless they have the type ()Unit. Therefore,
     *  their symbols are recreated ad-hoc and their types are fixed inline, instead of letting the
     *  namer/typer handle them, or Idents that refer to them.
     */
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree" id="256288">typed</a>(<a title="Duplicators.this.global.Tree" id="256293">tree</a>: <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a>, <a title="Int" id="256294">mode</a>: <a title="Int" id="2177">Int</a>, <a title="Duplicators.this.global.Type" id="256295">pt</a>: <a href="../symtab/Types.scala.html#26205" title="Duplicators.this.global.Type">Type</a>): <a href="../ast/Trees.scala.html#26593" title="Duplicators.this.global.Tree">Tree</a> = {
      <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;typing &quot;</span> + <a href="#256293" title="Duplicators.this.global.Tree">tree</a>)
      <span title="Unit" class="keyword">if</span> (<a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29370" title="(x$1: Boolean)Boolean">hasSymbol</a> <span title="(x$1: Boolean)Boolean">&amp;&amp;</span> <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="(x$1: AnyRef)Boolean">symbol</a> != <a href="../symtab/Symbols.scala.html#26134" title="object Duplicators.this.global.NoSymbol">NoSymbol</a> 
          <span title="(x$1: Boolean)Boolean">&amp;&amp;</span> <a title="=&gt; Boolean" id="2205">!</a><a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="=&gt; Duplicators.this.global.Symbol">symbol</a>.<a href="../symtab/Symbols.scala.html#26912" title="=&gt; Boolean">isLabel</a>  // labels cannot be retyped by the type checker as LabelDef has no ValDef/return type trees
          &amp;&amp; <a href="#256265" title="=&gt; scala.collection.mutable.Map[Duplicators.this.global.Symbol,Duplicators.this.global.Tree]">invalidSyms</a>.<span title="(key: Duplicators.this.global.Symbol)Boolean">isDefinedAt</span>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="=&gt; Duplicators.this.global.Symbol">symbol</a>)) {
        <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29368" title="(sym: Duplicators.this.global.Symbol)Unit">symbol</a> = <a href="../symtab/Symbols.scala.html#26134" title="object Duplicators.this.global.NoSymbol">NoSymbol</a>
      }

      <a href="#256293" title="Duplicators.this.global.Tree">tree</a> <span title="Duplicators.this.global.Tree" class="keyword">match</span> {
        <span title="Duplicators.this.global.TypeTree" class="keyword">case</span> <a title="Duplicators.this.global.TypeTree" id="256976">ttree</a> @ TypeTree() =&gt;
          <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;fixing tpe: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29363" title="=&gt; Duplicators.this.global.Type">tpe</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; with sym: &quot;)" class="string">&quot; with sym: &quot;</span> + <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29363" title="=&gt; Duplicators.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#30180" title="=&gt; Duplicators.this.global.Symbol">typeSymbol</a>)
          <a href="#256976" title="Duplicators.this.global.TypeTree">ttree</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <a href="#256283" title="(tpe: Duplicators.this.global.Type)Duplicators.this.global.Type">fixType</a>(<a href="#256976" title="Duplicators.this.global.TypeTree">ttree</a>.<a href="../ast/Trees.scala.html#29363" title="=&gt; Duplicators.this.global.Type">tpe</a>)
          <a href="#256976" title="Duplicators.this.global.TypeTree">ttree</a>
        <span title="Duplicators.this.global.Tree" class="keyword">case</span> Block(<a title="List[Duplicators.this.global.Tree]" id="256996">stats</a>, <a title="Duplicators.this.global.Tree" id="256997">res</a>) =&gt;
          <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="java.lang.String(&quot;invalidating block&quot;)" class="string">&quot;invalidating block&quot;</span>)
          <a href="#256286" title="(stats: List[Duplicators.this.global.Tree])Unit">invalidate</a>(<a href="#256996" title="List[Duplicators.this.global.Tree]">stats</a>)
          <a href="#256285" title="(tree: Duplicators.this.global.Tree)Unit">invalidate</a>(<a href="#256997" title="Duplicators.this.global.Tree">res</a>)
          <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">super</span>.<a href="Typers.scala.html#42637" title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree">typed</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>, <a href="#256294" title="Int">mode</a>, <a href="#256295" title="Duplicators.this.global.Type">pt</a>)
        
        <span title="Duplicators.this.global.Tree" class="keyword">case</span> ClassDef(_, _, _, <a title="Duplicators.this.global.Template" id="257047">tmpl</a> @ Template(<a title="List[Duplicators.this.global.Tree]" id="257053">parents</a>, _, <a title="List[Duplicators.this.global.Tree]" id="257054">stats</a>)) =&gt;
//          log(&quot;invalidating classdef &quot; + tree.tpe)
          <a href="#257047" title="Duplicators.this.global.Template">tmpl</a>.<a href="../ast/Trees.scala.html#48486" title="(x$1: Duplicators.this.global.Symbol)Unit">symbol</a> = <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="=&gt; Duplicators.this.global.Symbol">symbol</a>.<a href="../symtab/Symbols.scala.html#26866" title="(pos: scala.tools.nsc.util.Position)Duplicators.this.global.TermSymbol">newLocalDummy</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29361" title="=&gt; scala.tools.nsc.util.Position">pos</a>)
          <a href="#256286" title="(stats: List[Duplicators.this.global.Tree])Unit">invalidate</a>(<a href="#257054" title="List[Duplicators.this.global.Tree]">stats</a>)
          <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">super</span>.<a href="Typers.scala.html#42637" title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree">typed</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>, <a href="#256294" title="Int">mode</a>, <a href="#256295" title="Duplicators.this.global.Type">pt</a>)

        <span title="Duplicators.this.global.Tree" class="keyword">case</span> <a title="Duplicators.this.global.DefDef" id="257094">ddef</a> @ DefDef(_, _, _, _, <a title="Duplicators.this.global.Tree" id="257103">tpt</a>, <a title="Duplicators.this.global.Tree" id="257104">rhs</a>) =&gt;
          <a href="#257094" title="Duplicators.this.global.DefDef">ddef</a>.<a href="../ast/Trees.scala.html#52194" title="=&gt; Duplicators.this.global.Tree">tpt</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <a href="#256283" title="(tpe: Duplicators.this.global.Type)Duplicators.this.global.Type">fixType</a>(<a href="#257094" title="Duplicators.this.global.DefDef">ddef</a>.<a href="../ast/Trees.scala.html#52194" title="=&gt; Duplicators.this.global.Tree">tpt</a>.<a href="../ast/Trees.scala.html#29363" title="=&gt; Duplicators.this.global.Type">tpe</a>)
          <a href="#257094" title="Duplicators.this.global.DefDef">ddef</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">super</span>.<a href="Typers.scala.html#42637" title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree">typed</a>(<a href="#257094" title="Duplicators.this.global.DefDef">ddef</a>, <a href="#256294" title="Int">mode</a>, <a href="#256295" title="Duplicators.this.global.Type">pt</a>)
          
        <span title="Duplicators.this.global.Tree" class="keyword">case</span> <a title="Duplicators.this.global.ValDef" id="257133">vdef</a> @ ValDef(_, _, <a title="Duplicators.this.global.Tree" id="257140">tpt</a>, <a title="Duplicators.this.global.Tree" id="257141">rhs</a>) =&gt;
//          log(&quot;vdef fixing tpe: &quot; + tree.tpe + &quot; with sym: &quot; + tree.tpe.typeSymbol + &quot; and &quot; + invalidSyms)
          <a href="#257133" title="Duplicators.this.global.ValDef">vdef</a>.<a href="../ast/Trees.scala.html#53526" title="=&gt; Duplicators.this.global.Tree">tpt</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <a href="#256283" title="(tpe: Duplicators.this.global.Type)Duplicators.this.global.Type">fixType</a>(<a href="#257133" title="Duplicators.this.global.ValDef">vdef</a>.<a href="../ast/Trees.scala.html#53526" title="=&gt; Duplicators.this.global.Tree">tpt</a>.<a href="../ast/Trees.scala.html#29363" title="=&gt; Duplicators.this.global.Type">tpe</a>)
          <a href="#257133" title="Duplicators.this.global.ValDef">vdef</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">super</span>.<a href="Typers.scala.html#42637" title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree">typed</a>(<a href="#257133" title="Duplicators.this.global.ValDef">vdef</a>, <a href="#256294" title="Int">mode</a>, <a href="#256295" title="Duplicators.this.global.Type">pt</a>)

        <span title="Duplicators.this.global.Tree" class="keyword">case</span> <a title="Duplicators.this.global.LabelDef" id="257170">ldef</a> @ LabelDef(<a title="Duplicators.this.global.Name" id="257176">name</a>, <a title="List[Duplicators.this.global.Ident]" id="257177">params</a>, <a title="Duplicators.this.global.Tree" id="257178">rhs</a>) =&gt;
          <a href="#257170" title="Duplicators.this.global.LabelDef">ldef</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">val</span> <a title="List[Duplicators.this.global.Ident]" id="257181">params1</a> = <a href="#257177" title="(f: (Duplicators.this.global.Ident) =&gt; Duplicators.this.global.Ident)(implicit bf: scala.collection.generic.BuilderFactory[Duplicators.this.global.Ident,List[Duplicators.this.global.Ident],List[Duplicators.this.global.Ident]])List[Duplicators.this.global.Ident]" id="25243">params</a> <a title="scala.collection.generic.BuilderFactory[Duplicators.this.global.Ident,List[Duplicators.this.global.Ident],List#Coll]" id="24313">map</a> { <a title="Duplicators.this.global.Ident" id="257193">p</a> =&gt; <a href="../ast/Trees.scala.html#26736" title="(sym: Duplicators.this.global.Symbol)Duplicators.this.global.Ident">Ident</a>(<a href="#256284" title="(sym: Duplicators.this.global.Symbol)Duplicators.this.global.Symbol">updateSym</a>(<a href="#257193" title="Duplicators.this.global.Ident">p</a>.<a href="../ast/Trees.scala.html#48485" title="=&gt; Duplicators.this.global.Symbol">symbol</a>)) }
          <span class="keyword">super</span>.<a href="Typers.scala.html#42637" title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree">typed</a>(<a href="../ast/Trees.scala.html#26584" title="=&gt; Duplicators.this.global.LazyTreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#48595" title="(tree: Duplicators.this.global.Tree,name: Duplicators.this.global.Name,params: List[Duplicators.this.global.Ident],rhs: Duplicators.this.global.Tree)Duplicators.this.global.LabelDef">LabelDef</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>, <a href="#257176" title="Duplicators.this.global.Name">name</a>, <a href="#257181" title="List[Duplicators.this.global.Ident]">params1</a>, <a href="#257178" title="Duplicators.this.global.Tree">rhs</a>), <a href="#256294" title="Int">mode</a>, <a href="#256295" title="Duplicators.this.global.Type">pt</a>)

        <span title="Duplicators.this.global.Tree" class="keyword">case</span> Bind(<a title="Duplicators.this.global.Name" id="257328">name</a>, _) =&gt;
          <a href="#256285" title="(tree: Duplicators.this.global.Tree)Unit">invalidate</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>)
          <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">super</span>.<a href="Typers.scala.html#42637" title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree">typed</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>, <a href="#256294" title="Int">mode</a>, <a href="#256295" title="Duplicators.this.global.Type">pt</a>)

        <span title="Duplicators.this.global.Tree" class="keyword">case</span> Ident(_) <span class="keyword">if</span> <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="=&gt; Duplicators.this.global.Symbol">symbol</a>.<a href="../symtab/Symbols.scala.html#26912" title="=&gt; Boolean">isLabel</a> =&gt;
          <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;Ident to labeldef &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#256293" title="Duplicators.this.global.Tree">tree</a> + <span title="java.lang.String(&quot; switched to &quot;)" class="string">&quot; switched to &quot;</span>)
          <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29368" title="(sym: Duplicators.this.global.Symbol)Unit">symbol</a> = <a href="#256284" title="(sym: Duplicators.this.global.Symbol)Duplicators.this.global.Symbol">updateSym</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="=&gt; Duplicators.this.global.Symbol">symbol</a>)
          <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">super</span>.<a href="Typers.scala.html#42637" title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree">typed</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>, <a href="#256294" title="Int">mode</a>, <a href="#256295" title="Duplicators.this.global.Type">pt</a>)

        <span title="Duplicators.this.global.Tree" class="keyword">case</span> Select(<a title="Duplicators.this.global.This" id="257400">th</a> @ This(_), <a title="Duplicators.this.global.Name" id="257406">sel</a>) <span class="keyword">if</span> <span title="(x$1: Boolean)Boolean">(</span><a href="#256256" title="(x$1: AnyRef)Boolean">oldClassOwner</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; (<a href="#257400" title="Duplicators.this.global.This">th</a>.<a href="../ast/Trees.scala.html#48485" title="(x$1: AnyRef)Boolean">symbol</a> == <a href="#256256" title="=&gt; Duplicators.this.global.Symbol">oldClassOwner</a>) =&gt;
          <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="java.lang.String(&quot;selection on this, no type ascription required&quot;)" class="string">&quot;selection on this, no type ascription required&quot;</span>)
          <span class="keyword">super</span>.<a href="Typers.scala.html#42637" title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree">typed</a>(<a href="../ast/Trees.scala.html#26784" title="(pos: scala.tools.nsc.util.Position)(tree: Duplicators.this.global.Select)Duplicators.this.global.Select">atPos</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29361" title="=&gt; scala.tools.nsc.util.Position">pos</a>)(<a href="../ast/Trees.scala.html#50275" title="(qualifier: Duplicators.this.global.Tree,name: Duplicators.this.global.Name)Duplicators.this.global.Select">Select</a>(<a href="../ast/Trees.scala.html#26727" title="(sym: Duplicators.this.global.Symbol)Duplicators.this.global.Tree">This</a>(<a href="#256259" title="=&gt; Duplicators.this.global.Symbol">newClassOwner</a>), <a href="#257406" title="Duplicators.this.global.Name">sel</a>)), <a href="#256294" title="Int">mode</a>, <a href="#256295" title="Duplicators.this.global.Type">pt</a>)

        <span title="Duplicators.this.global.Tree" class="keyword">case</span> This(_) <span class="keyword">if</span> <span title="(x$1: Boolean)Boolean">(</span><a href="#256256" title="(x$1: AnyRef)Boolean">oldClassOwner</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; (<a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="(x$1: AnyRef)Boolean">symbol</a> == <a href="#256256" title="=&gt; Duplicators.this.global.Symbol">oldClassOwner</a>) =&gt;
//          val tree1 = Typed(This(newClassOwner), TypeTree(fixType(tree.tpe.widen)))
          <span class="keyword">val</span> <a title="Duplicators.this.global.Tree" id="257526">tree1</a> = <a href="../ast/Trees.scala.html#26727" title="(sym: Duplicators.this.global.Symbol)Duplicators.this.global.Tree">This</a>(<a href="#256259" title="=&gt; Duplicators.this.global.Symbol">newClassOwner</a>)
          <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;mapped &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#256293" title="Duplicators.this.global.Tree">tree</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; to &quot;)" class="string">&quot; to &quot;</span> + <a href="#257526" title="Duplicators.this.global.Tree">tree1</a>)
          <span class="keyword">super</span>.<a href="Typers.scala.html#42637" title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree">typed</a>(<a href="../ast/Trees.scala.html#26784" title="(pos: scala.tools.nsc.util.Position)(tree: Duplicators.this.global.Tree)Duplicators.this.global.Tree">atPos</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29361" title="=&gt; scala.tools.nsc.util.Position">pos</a>)(<a href="#257526" title="Duplicators.this.global.Tree">tree1</a>), <a href="#256294" title="Int">mode</a>, <a href="#256295" title="Duplicators.this.global.Type">pt</a>)

        <span title="Duplicators.this.global.Tree" class="keyword">case</span> Super(<a title="Duplicators.this.global.Name" id="257585">qual</a>, <a title="Duplicators.this.global.Name" id="257586">mix</a>) <span class="keyword">if</span> <span title="(x$1: Boolean)Boolean">(</span><a href="#256256" title="(x$1: AnyRef)Boolean">oldClassOwner</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; (<a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29367" title="(x$1: AnyRef)Boolean">symbol</a> == <a href="#256256" title="=&gt; Duplicators.this.global.Symbol">oldClassOwner</a>) =&gt;
          <span class="keyword">val</span> <a title="Duplicators.this.global.Super" id="257600">tree1</a> = <a href="../ast/Trees.scala.html#97514" title="(qual: Duplicators.this.global.Name,mix: Duplicators.this.global.Name)Duplicators.this.global.Super">Super</a>(<a href="#257585" title="Duplicators.this.global.Name">qual</a>, <a href="#257586" title="Duplicators.this.global.Name">mix</a>)
          <a href="../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;changed &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#256293" title="Duplicators.this.global.Tree">tree</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; to &quot;)" class="string">&quot; to &quot;</span> + <a href="#257600" title="Duplicators.this.global.Super">tree1</a>)
          <span class="keyword">super</span>.<a href="Typers.scala.html#42640" title="(tree: Duplicators.this.global.Tree)Duplicators.this.global.Tree">typed</a>(<a href="../ast/Trees.scala.html#26784" title="(pos: scala.tools.nsc.util.Position)(tree: Duplicators.this.global.Super)Duplicators.this.global.Super">atPos</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29361" title="=&gt; scala.tools.nsc.util.Position">pos</a>)(<a href="#257600" title="Duplicators.this.global.Super">tree1</a>))

        <span title="Duplicators.this.global.Tree" class="keyword">case</span> _ =&gt;
          <a href="#256293" title="Duplicators.this.global.Tree">tree</a>.<a href="../ast/Trees.scala.html#29364" title="(t: Duplicators.this.global.Type)Unit">tpe</a> = <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">super</span>.<a href="Typers.scala.html#42637" title="(tree: Duplicators.this.global.Tree,mode: Int,pt: Duplicators.this.global.Type)Duplicators.this.global.Tree">typed</a>(<a href="#256293" title="Duplicators.this.global.Tree">tree</a>, <a href="#256294" title="Int">mode</a>, <a href="#256295" title="Duplicators.this.global.Type">pt</a>)
      }
    }
  }
}


        </pre>
    </body>
</html>