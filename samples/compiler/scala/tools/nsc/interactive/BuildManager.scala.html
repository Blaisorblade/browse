<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/interactive/BuildManager.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interactive

<span class="keyword">import</span> scala.collection._

<span class="keyword">import</span> scala.tools.nsc.reporters.{Reporter, ConsoleReporter}
<span class="keyword">import</span> util.FakePos

<span class="keyword">import</span> dependencies._
<span class="keyword">import</span> io.AbstractFile

<span class="keyword">trait</span> <a title="trait BuildManager extends java.lang.Object with ScalaObject" id="18800">BuildManager</a> <span title="ScalaObject">{</span>

  /** Add the given source files to the managed build process. */
  <span class="keyword">def</span> <a title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="166950">addSourceFiles</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="167101">files</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile])

  /** Remove the given files from the managed build process. */
  <span class="keyword">def</span> <a title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="166951">removeFiles</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="167129">files</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile])

  /** The given files have been modified by the user. Recompile
   *  them and their dependent files.
   */
  <span class="keyword">def</span> <a title="(added: scala.collection.Set[scala.tools.nsc.io.AbstractFile],removed: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="166952">update</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="167117">added</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile], <a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="167118">removed</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile])

  /** Notification that the supplied set of files is being built */
  <span class="keyword">def</span> <a title="(included: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="166953">buildingFiles</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="167455">included</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile]) <span title="Unit">{</span>}
  
  /** Load saved dependency information. */
  <span class="keyword">def</span> <a title="(file: scala.tools.nsc.io.AbstractFile,toFile: (String) =&gt; scala.tools.nsc.io.AbstractFile)Boolean" id="166954">loadFrom</a>(<a title="scala.tools.nsc.io.AbstractFile" id="168353">file</a>: <a href="../io/AbstractFile.scala.html#20689" title="scala.tools.nsc.io.AbstractFile">AbstractFile</a>, <a title="(String) =&gt; scala.tools.nsc.io.AbstractFile" id="168354">toFile</a>: String =&gt; AbstractFile) : <a title="Boolean" id="1972">Boolean</a>
  
  /** Save dependency information to `file'. */
  <span class="keyword">def</span> <a title="(file: scala.tools.nsc.io.AbstractFile,fromFile: (scala.tools.nsc.io.AbstractFile) =&gt; String)Unit" id="166955">saveTo</a>(<a title="scala.tools.nsc.io.AbstractFile" id="168501">file</a>: <a href="../io/AbstractFile.scala.html#20689" title="scala.tools.nsc.io.AbstractFile">AbstractFile</a>, <a title="(scala.tools.nsc.io.AbstractFile) =&gt; String" id="168502">fromFile</a>: AbstractFile =&gt; String)

  <span class="keyword">def</span> <a title="=&gt; scala.tools.nsc.Global" id="166956">compiler</a>: scala.tools.nsc.<a href="../Global.scala.html#8529" title="scala.tools.nsc.Global">Global</a>
}


/** Simple driver for testing the build manager. It presents
 *  the user to a 'resident compiler' prompt. Each line is
 *  interpreted as a set of files that have changed. The builder
 *  then derives the dependent files and recompiles them.
 */
<span class="keyword">object</span> <a title="object scala.tools.nsc.interactive.BuildManagerTest" id="18711">BuildManagerTest</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../EvalLoop.scala.html#8484" title="scala.tools.nsc.EvalLoop">EvalLoop</a> {

  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="719879">prompt</a> = <span title="java.lang.String(&quot;builder &gt; &quot;)" class="string">&quot;builder &gt; &quot;</span>

  <span class="keyword">def</span> <a title="(msg: String)Unit" id="719880">error</a>(<a title="String" id="719888">msg</a>: <a title="String" id="1626">String</a>) {
    <a title="(x: Any)Unit" id="8126">println</a>(<a href="#719888" title="(x$1: Any)java.lang.String" id="6622">msg</a> + <span title="java.lang.String(&quot;\012  scalac -help  gives more information&quot;)" class="string">&quot;\n  scalac -help  gives more information&quot;</span>)
  }

  <span class="keyword">def</span> <a title="(args: Array[String])Unit" id="719881">main</a>(<a title="Array[String]" id="719896">args</a>: <a title="Array[String]" id="905">Array</a>[String]) {
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.interactive.BuildManagerTest.filesToSet : (fs: List[String])scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="719898">filesToSet</a>(<a title="List[String]" id="719902">fs</a>: <a title="List[String]" id="7414">List</a>[String]): <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile] =
      <span title="object scala.collection.Set">Set</span>.<a title="(elems: Traversable[scala.tools.nsc.io.AbstractFile])scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="39603">empty</a> ++ (<a href="#719902" title="(f: (String) =&gt; scala.tools.nsc.io.AbstractFile)(implicit bf: scala.collection.generic.BuilderFactory[scala.tools.nsc.io.AbstractFile,List[scala.tools.nsc.io.AbstractFile],List[String]])List[scala.tools.nsc.io.AbstractFile]" id="25402">fs</a> <a title="scala.collection.generic.BuilderFactory[scala.tools.nsc.io.AbstractFile,List[scala.tools.nsc.io.AbstractFile],List#Coll]" id="7415">map</a> <a href="../io/AbstractFile.scala.html#20690" title="object scala.tools.nsc.io.AbstractFile">AbstractFile</a>.<a href="../io/AbstractFile.scala.html#121545" title="(path: String)scala.tools.nsc.io.AbstractFile">getFile</a>)

    <span class="keyword">val</span> <a title="scala.tools.nsc.Settings" id="719899">settings</a> = <span title="scala.tools.nsc.Settings" class="keyword">new</span> <a href="../Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>(<a href="#719880" title="(msg: String)Unit">error</a>)
    <span class="keyword">val</span> <a title="scala.tools.nsc.CompilerCommand" id="719900">command</a> = <a href="../CompilerCommand.scala.html#142575" title="(arguments: List[String],settings: scala.tools.nsc.Settings,error: (String) =&gt; Unit,interactive: Boolean)scala.tools.nsc.CompilerCommand" class="keyword">new</a> <a href="../CompilerCommand.scala.html#8967" title="scala.tools.nsc.CompilerCommand">CompilerCommand</a>(<a href="#719896" title="Array[String]">args</a>.<span title="=&gt; List[String]">toList</span>, <a href="#719899" title="scala.tools.nsc.Settings">settings</a>, <a href="#719880" title="(msg: String)Unit">error</a>, <span title="Boolean(false)" class="keyword">false</span>)
//    settings.make.value = &quot;off&quot;
//    val buildManager: BuildManager = new SimpleBuildManager(settings)
    <span class="keyword">val</span> <a title="scala.tools.nsc.interactive.BuildManager" id="719901">buildManager</a>: <a href="#18800" title="scala.tools.nsc.interactive.BuildManager">BuildManager</a> = <span title="scala.tools.nsc.interactive.RefinedBuildManager" class="keyword">new</span> <a href="RefinedBuildManager.scala.html#18746" title="scala.tools.nsc.interactive.RefinedBuildManager">RefinedBuildManager</a>(<a href="#719899" title="scala.tools.nsc.Settings">settings</a>)

    <a href="#719901" title="scala.tools.nsc.interactive.BuildManager">buildManager</a>.<a href="#166950" title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit">addSourceFiles</a>(<a href="#719900" title="scala.tools.nsc.CompilerCommand">command</a>.<a href="#719898" title="implicit scala.tools.nsc.interactive.BuildManagerTest.filesToSet : (fs: List[String])scala.collection.Set[scala.tools.nsc.io.AbstractFile]">files</a>)

    // enter resident mode
    <a href="../EvalLoop.scala.html#111050" title="(action: (String) =&gt; Unit)Unit">loop</a> { <a title="String" id="720094">line</a> =&gt;
      <span class="keyword">val</span> <a title="List[String]" id="720095">args</a> = <a href="#720094" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" id="8170">line</a>.<a title="(separator: Char)Array[String]" id="30657">split</a>(<span title="Char(' ')" class="char">' '</span>).<span title="=&gt; List[String]">toList</span>
      <span class="keyword">val</span> <a title="scala.tools.nsc.CompilerCommand" id="720096">command</a> = <a href="../CompilerCommand.scala.html#142575" title="(arguments: List[String],settings: scala.tools.nsc.Settings,error: (String) =&gt; Unit,interactive: Boolean)scala.tools.nsc.CompilerCommand" class="keyword">new</a> <a href="../CompilerCommand.scala.html#8967" title="scala.tools.nsc.CompilerCommand">CompilerCommand</a>(<a href="#720095" title="List[String]">args</a>, <span title="scala.tools.nsc.Settings" class="keyword">new</span> <a href="../Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>(<a href="#719880" title="(msg: String)Unit">error</a>), <a href="#719880" title="(msg: String)Unit">error</a>, <span title="Boolean(true)" class="keyword">true</span>)
      <a href="#719901" title="scala.tools.nsc.interactive.BuildManager">buildManager</a>.<a href="#166952" title="(added: scala.collection.Set[scala.tools.nsc.io.AbstractFile],removed: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit">update</a>(<a href="#720096" title="scala.tools.nsc.CompilerCommand">command</a>.<a href="#719898" title="implicit scala.tools.nsc.interactive.BuildManagerTest.filesToSet : (fs: List[String])scala.collection.Set[scala.tools.nsc.io.AbstractFile]">files</a>, <span title="object scala.collection.Set">Set</span>.<span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">empty</span>)
    }

  }
}

        </pre>
    </body>
</html>