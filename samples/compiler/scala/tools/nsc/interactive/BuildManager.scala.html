<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/interactive/BuildManager.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interactive

<span class="keyword">import</span> scala.collection._

<span class="keyword">import</span> scala.tools.nsc.reporters.{Reporter, ConsoleReporter}
<span class="keyword">import</span> util.FakePos

<span class="keyword">import</span> dependencies._
<span class="keyword">import</span> io.AbstractFile

<span class="keyword">trait</span> <a title="trait BuildManager extends java.lang.Object with ScalaObject" id="18665">BuildManager</a> <span title="ScalaObject">{</span>

  /** Add the given source files to the managed build process. */
  <span class="keyword">def</span> <a title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="166314">addSourceFiles</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="166465">files</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile])

  /** Remove the given files from the managed build process. */
  <span class="keyword">def</span> <a title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="166315">removeFiles</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="166493">files</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile])

  /** The given files have been modified by the user. Recompile
   *  them and their dependent files.
   */
  <span class="keyword">def</span> <a title="(added: scala.collection.Set[scala.tools.nsc.io.AbstractFile],removed: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="166316">update</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="166481">added</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile], <a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="166482">removed</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile])

  /** Notification that the supplied set of files is being built */
  <span class="keyword">def</span> <a title="(included: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="166317">buildingFiles</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="166819">included</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile]) <span title="Unit">{</span>}
  
  /** Load saved dependency information. */
  <span class="keyword">def</span> <a title="(file: scala.tools.nsc.io.AbstractFile,toFile: (String) =&gt; scala.tools.nsc.io.AbstractFile)Boolean" id="166318">loadFrom</a>(<a title="scala.tools.nsc.io.AbstractFile" id="167717">file</a>: <a href="../io/AbstractFile.scala.html#20548" title="scala.tools.nsc.io.AbstractFile">AbstractFile</a>, <a title="(String) =&gt; scala.tools.nsc.io.AbstractFile" id="167718">toFile</a>: String =&gt; AbstractFile) : <a title="Boolean" id="1951">Boolean</a>
  
  /** Save dependency information to `file'. */
  <span class="keyword">def</span> <a title="(file: scala.tools.nsc.io.AbstractFile,fromFile: (scala.tools.nsc.io.AbstractFile) =&gt; String)Unit" id="166319">saveTo</a>(<a title="scala.tools.nsc.io.AbstractFile" id="167865">file</a>: <a href="../io/AbstractFile.scala.html#20548" title="scala.tools.nsc.io.AbstractFile">AbstractFile</a>, <a title="(scala.tools.nsc.io.AbstractFile) =&gt; String" id="167866">fromFile</a>: AbstractFile =&gt; String)

  <span class="keyword">def</span> <a title="=&gt; scala.tools.nsc.Global" id="166320">compiler</a>: scala.tools.nsc.<a href="../Global.scala.html#8460" title="scala.tools.nsc.Global">Global</a>
}


/** Simple driver for testing the build manager. It presents
 *  the user to a 'resident compiler' prompt. Each line is
 *  interpreted as a set of files that have changed. The builder
 *  then derives the dependent files and recompiles them.
 */
<span class="keyword">object</span> <a title="object scala.tools.nsc.interactive.BuildManagerTest" id="18576">BuildManagerTest</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../EvalLoop.scala.html#8415" title="scala.tools.nsc.EvalLoop">EvalLoop</a> {

  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="718160">prompt</a> = <span title="java.lang.String(&quot;builder &gt; &quot;)" class="string">&quot;builder &gt; &quot;</span>

  <span class="keyword">def</span> <a title="(msg: String)Unit" id="718161">error</a>(<a title="String" id="718169">msg</a>: <a title="String" id="1605">String</a>) {
    <a title="(x: Any)Unit" id="8057">println</a>(<a href="#718169" title="(x$1: Any)java.lang.String" id="6553">msg</a> + <span title="java.lang.String(&quot;\012  scalac -help  gives more information&quot;)" class="string">&quot;\n  scalac -help  gives more information&quot;</span>)
  }

  <span class="keyword">def</span> <a title="(args: Array[String])Unit" id="718162">main</a>(<a title="Array[String]" id="718177">args</a>: <a title="Array[String]" id="887">Array</a>[String]) {
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.interactive.BuildManagerTest.filesToSet : (fs: List[String])scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="718179">filesToSet</a>(<a title="List[String]" id="718183">fs</a>: <a title="List[String]" id="7345">List</a>[String]): <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile] =
      <span title="object scala.collection.Set">Set</span>.<a title="(elems: Traversable[scala.tools.nsc.io.AbstractFile])scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="39371">empty</a> ++ (<a href="#718183" title="(f: (String) =&gt; scala.tools.nsc.io.AbstractFile)(implicit bf: scala.collection.generic.BuilderFactory[scala.tools.nsc.io.AbstractFile,List[scala.tools.nsc.io.AbstractFile],List[String]])List[scala.tools.nsc.io.AbstractFile]" id="25243">fs</a> <a title="scala.collection.generic.BuilderFactory[scala.tools.nsc.io.AbstractFile,List[scala.tools.nsc.io.AbstractFile],List#Coll]" id="7346">map</a> <a href="../io/AbstractFile.scala.html#20549" title="object scala.tools.nsc.io.AbstractFile">AbstractFile</a>.<a href="../io/AbstractFile.scala.html#121036" title="(path: String)scala.tools.nsc.io.AbstractFile">getFile</a>)

    <span class="keyword">val</span> <a title="scala.tools.nsc.Settings" id="718180">settings</a> = <span title="scala.tools.nsc.Settings" class="keyword">new</span> <a href="../Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>(<a href="#718161" title="(msg: String)Unit">error</a>)
    <span class="keyword">val</span> <a title="scala.tools.nsc.CompilerCommand" id="718181">command</a> = <a href="../CompilerCommand.scala.html#141980" title="(arguments: List[String],settings: scala.tools.nsc.Settings,error: (String) =&gt; Unit,interactive: Boolean)scala.tools.nsc.CompilerCommand" class="keyword">new</a> <a href="../CompilerCommand.scala.html#8898" title="scala.tools.nsc.CompilerCommand">CompilerCommand</a>(<a href="#718177" title="Array[String]">args</a>.<span title="=&gt; List[String]">toList</span>, <a href="#718180" title="scala.tools.nsc.Settings">settings</a>, <a href="#718161" title="(msg: String)Unit">error</a>, <span title="Boolean(false)" class="keyword">false</span>)
//    settings.make.value = &quot;off&quot;
//    val buildManager: BuildManager = new SimpleBuildManager(settings)
    <span class="keyword">val</span> <a title="scala.tools.nsc.interactive.BuildManager" id="718182">buildManager</a>: <a href="#18665" title="scala.tools.nsc.interactive.BuildManager">BuildManager</a> = <span title="scala.tools.nsc.interactive.RefinedBuildManager" class="keyword">new</span> <a href="RefinedBuildManager.scala.html#18611" title="scala.tools.nsc.interactive.RefinedBuildManager">RefinedBuildManager</a>(<a href="#718180" title="scala.tools.nsc.Settings">settings</a>)

    <a href="#718182" title="scala.tools.nsc.interactive.BuildManager">buildManager</a>.<a href="#166314" title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit">addSourceFiles</a>(<a href="#718181" title="scala.tools.nsc.CompilerCommand">command</a>.<a href="#718179" title="implicit scala.tools.nsc.interactive.BuildManagerTest.filesToSet : (fs: List[String])scala.collection.Set[scala.tools.nsc.io.AbstractFile]">files</a>)

    // enter resident mode
    <a href="../EvalLoop.scala.html#110617" title="(action: (String) =&gt; Unit)Unit">loop</a> { <a title="String" id="718372">line</a> =&gt;
      <span class="keyword">val</span> <a title="List[String]" id="718373">args</a> = <a href="#718372" title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" id="8101">line</a>.<a title="(separator: Char)Array[String]" id="30471">split</a>(<span title="Char(' ')" class="char">' '</span>).<span title="=&gt; List[String]">toList</span>
      <span class="keyword">val</span> <a title="scala.tools.nsc.CompilerCommand" id="718374">command</a> = <a href="../CompilerCommand.scala.html#141980" title="(arguments: List[String],settings: scala.tools.nsc.Settings,error: (String) =&gt; Unit,interactive: Boolean)scala.tools.nsc.CompilerCommand" class="keyword">new</a> <a href="../CompilerCommand.scala.html#8898" title="scala.tools.nsc.CompilerCommand">CompilerCommand</a>(<a href="#718373" title="List[String]">args</a>, <span title="scala.tools.nsc.Settings" class="keyword">new</span> <a href="../Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>(<a href="#718161" title="(msg: String)Unit">error</a>), <a href="#718161" title="(msg: String)Unit">error</a>, <span title="Boolean(true)" class="keyword">true</span>)
      <a href="#718182" title="scala.tools.nsc.interactive.BuildManager">buildManager</a>.<a href="#166316" title="(added: scala.collection.Set[scala.tools.nsc.io.AbstractFile],removed: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit">update</a>(<a href="#718374" title="scala.tools.nsc.CompilerCommand">command</a>.<a href="#718179" title="implicit scala.tools.nsc.interactive.BuildManagerTest.filesToSet : (fs: List[String])scala.collection.Set[scala.tools.nsc.io.AbstractFile]">files</a>, <span title="object scala.collection.Set">Set</span>.<span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">empty</span>)
    }

  }
}

        </pre>
    </body>
</html>