<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/interactive/SimpleBuildManager.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interactive

<span class="keyword">import</span> scala.collection._

<span class="keyword">import</span> scala.tools.nsc.reporters.{Reporter, ConsoleReporter}
<span class="keyword">import</span> dependencies._

<span class="keyword">import</span> util.FakePos
<span class="keyword">import</span> io.AbstractFile

/** A simple build manager, using the default scalac dependency tracker.
 *  The transitive closure of all dependent files on a modified file
 *  is recompiled at once.
 *
 *  It is equivalent to using a resident compiler mode with the
 *  '-make:transitive' option.
 */
<span class="keyword">class</span> <a title="class SimpleBuildManager extends java.lang.Object with scala.tools.nsc.interactive.BuildManager with ScalaObject" id="18896">SimpleBuildManager</a><span title="ScalaObject">(</span><span class="keyword">val</span> <a title="scala.tools.nsc.Settings" id="524360">settings</a>: <a href="../Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>) <span class="keyword">extends</span> <a href="BuildManager.scala.html#18800" title="scala.tools.nsc.interactive.BuildManager">BuildManager</a> {

  <span class="keyword">class</span> <a title="class BuilderGlobal extends scala.tools.nsc.Global with ScalaObject" id="524334">BuilderGlobal</a><a href="../Global.scala.html#39258" title="ScalaObject">(</a><a title="scala.tools.nsc.Settings" id="524355">settings</a>: <a href="../Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>) <span class="keyword">extends</span> scala.tools.nsc.<a href="../Global.scala.html#8529" title="scala.tools.nsc.Global">Global</a>(<a href="#524355" title="scala.tools.nsc.Settings">settings</a>)  {
    <span class="keyword">def</span> <a title="()BuilderGlobal.this.Run" id="524354">newRun</a>() = <span title="BuilderGlobal.this.Run" class="keyword">new</span> <a href="../Global.scala.html#39410" title="BuilderGlobal.this.Run">Run</a>()
  }
  
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(settings: scala.tools.nsc.Settings)SimpleBuildManager.this.BuilderGlobal" id="524335">newCompiler</a>(<a title="scala.tools.nsc.Settings" id="524348">settings</a>: <a href="../Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>) = <span title="SimpleBuildManager.this.BuilderGlobal" class="keyword">new</span> <a href="#524334" title="SimpleBuildManager.this.BuilderGlobal">BuilderGlobal</a>(<a href="#524348" title="scala.tools.nsc.Settings">settings</a>) 

  <span class="keyword">val</span> <a title="SimpleBuildManager.this.BuilderGlobal" id="524336">compiler</a> = <a href="#524335" title="(settings: scala.tools.nsc.Settings)SimpleBuildManager.this.BuilderGlobal">newCompiler</a>(<a href="#524360" title="=&gt; scala.tools.nsc.Settings">settings</a>)

  /** Managed source files. */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.Set[scala.tools.nsc.io.AbstractFile]" id="524338">sources</a>: mutable.<a title="scala.collection.mutable.Set[scala.tools.nsc.io.AbstractFile]" id="25170">Set</a>[AbstractFile] = <span title="scala.collection.mutable.HashSet[scala.tools.nsc.io.AbstractFile]" class="keyword">new</span> mutable.<a title="scala.collection.mutable.HashSet[scala.tools.nsc.io.AbstractFile]" id="24960">HashSet</a>[AbstractFile]

  /** Add the given source files to the managed build process. */
  <span class="keyword">def</span> <a title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="524340">addSourceFiles</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="524378">files</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile]) {
    <a href="#524338" title="(iter: Traversable[scala.tools.nsc.io.AbstractFile])SimpleBuildManager.this.sources.type">sources</a> ++= <a href="#524378" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">files</a>
    <a href="#524343" title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit">update</a>(<a href="#524378" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">files</a>)
  }

  /** Remove the given files from the managed build process. */
  <span class="keyword">def</span> <a title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="524341">removeFiles</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="524401">files</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile]) {
    <a href="#524338" title="(iter: Traversable[scala.tools.nsc.io.AbstractFile])SimpleBuildManager.this.sources.type" id="39752">sources</a> <span title="Unit">--=</span> <a href="#524401" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">files</a>
  }

  <span class="keyword">def</span> <a title="(added: scala.collection.Set[scala.tools.nsc.io.AbstractFile],removed: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="524342">update</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="524391">added</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile], <a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="524392">removed</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile]) {
    <a href="#524341" title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit">removeFiles</a>(<a href="#524392" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">removed</a>)
    <a href="#524343" title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit">update</a>(<a href="#524391" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">added</a>)
  }

  /** The given files have been modified by the user. Recompile
   *  them and all files that depend on them. Only files that
   *  have been previously added as source files are recompiled.
   */
  <span class="keyword">def</span> <a title="(files: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit" id="524343">update</a>(<a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="524397">files</a>: <span title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">Set</span>[AbstractFile]) {
    <span class="keyword">val</span> <a title="SimpleBuildManager.this.compiler.dependencyAnalysis.FileDependencies" id="524421">deps</a> = <a href="#524336" title="=&gt; SimpleBuildManager.this.BuilderGlobal">compiler</a>.<a href="../Global.scala.html#39381" title="object SimpleBuildManager.this.compiler.dependencyAnalysis">dependencyAnalysis</a>.<a href="../dependencies/DependencyAnalysis.scala.html#167034" title="=&gt; SimpleBuildManager.this.compiler.dependencyAnalysis.FileDependencies">dependencies</a>
    <span class="keyword">val</span> <a title="SimpleBuildManager.this.compiler.Run" id="524422">run</a> = <a href="#524336" title="=&gt; SimpleBuildManager.this.BuilderGlobal">compiler</a>.<a href="#524354" title="()SimpleBuildManager.this.compiler.Run">newRun</a>()
    <a href="#524336" title="=&gt; SimpleBuildManager.this.BuilderGlobal">compiler</a>.<a href="../Global.scala.html#39294" title="(msg: String)Unit">inform</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;compiling &quot;</span> + <a href="#524397" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">files</a>)

    <span class="keyword">val</span> <a title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="524423">toCompile</a> = 
      <a title="(that: scala.collection.Set[scala.tools.nsc.io.AbstractFile])scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="39573">(</a><a href="#524397" title="(elems: Traversable[scala.tools.nsc.io.AbstractFile])scala.collection.Set[scala.tools.nsc.io.AbstractFile]" id="39603">files</a> ++ <a href="#524421" title="SimpleBuildManager.this.compiler.dependencyAnalysis.FileDependencies">deps</a>.<a href="../dependencies/Files.scala.html#167676" title="(depth: Int,changed: scala.collection.Set[scala.tools.nsc.io.AbstractFile])scala.collection.Set[scala.tools.nsc.io.AbstractFile]">dependentFiles</a>(Int.<span title="Int(2147483647)">MaxValue</span>, <a href="#524397" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">files</a>)) intersect <a href="#524338" title="=&gt; scala.collection.mutable.Set[scala.tools.nsc.io.AbstractFile]">sources</a>
    

    <a href="#524336" title="=&gt; SimpleBuildManager.this.BuilderGlobal">compiler</a>.<a href="../Global.scala.html#39294" title="(msg: String)Unit">inform</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;Recompiling &quot;</span> + 
                    (<span title="Any" class="keyword">if</span>(<a href="#524360" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../Settings.scala.html#37345" title="=&gt; scala.tools.nsc.Settings.BooleanSetting">debug</a>.<a href="../Settings.scala.html#37988" title="=&gt; SimpleBuildManager.this.settings.debug.T">value</a>) <a href="#524423" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">toCompile</a>.<a title="(sep: String)String" id="25523">mkString</a>(<span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span>)
                     <span class="keyword">else</span> <a href="#524423" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">toCompile</a>.<a title="(x$1: java.lang.String)java.lang.String" id="25378">size</a> + <span title="java.lang.String(&quot; files&quot;)" class="string">&quot; files&quot;</span>))
    
    <a href="BuildManager.scala.html#166953" title="(included: scala.collection.Set[scala.tools.nsc.io.AbstractFile])Unit">buildingFiles</a>(<a href="#524423" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">toCompile</a>)

    <a href="#524422" title="SimpleBuildManager.this.compiler.Run">run</a>.<a href="../Global.scala.html#40451" title="(files: List[scala.tools.nsc.io.AbstractFile])Unit">compileFiles</a>(<a href="#524397" title="scala.collection.Set[scala.tools.nsc.io.AbstractFile]">files</a>.<a title="=&gt; List[scala.tools.nsc.io.AbstractFile]" id="25511">toList</a>)
  }

  /** Load saved dependency information. */
  <span class="keyword">def</span> <a title="(file: scala.tools.nsc.io.AbstractFile,toFile: (String) =&gt; scala.tools.nsc.io.AbstractFile)Boolean" id="524344">loadFrom</a>(<a title="scala.tools.nsc.io.AbstractFile" id="524570">file</a>: <a href="../io/AbstractFile.scala.html#20689" title="scala.tools.nsc.io.AbstractFile">AbstractFile</a>, <a title="(String) =&gt; scala.tools.nsc.io.AbstractFile" id="524571">toFile</a>: String =&gt; AbstractFile) : <a title="Boolean" id="1972">Boolean</a> = {
    <span class="keyword">val</span> <a title="Boolean" id="524573">success</a> = <a href="#524336" title="=&gt; SimpleBuildManager.this.BuilderGlobal">compiler</a>.<a href="../Global.scala.html#39381" title="object SimpleBuildManager.this.compiler.dependencyAnalysis">dependencyAnalysis</a>.<a href="../dependencies/DependencyAnalysis.scala.html#167043" title="(f: scala.tools.nsc.io.AbstractFile,toFile: (String) =&gt; scala.tools.nsc.io.AbstractFile)Boolean">loadFrom</a>(<a href="#524570" title="scala.tools.nsc.io.AbstractFile">file</a>, <a href="#524571" title="(String) =&gt; scala.tools.nsc.io.AbstractFile">toFile</a>)
    <span title="Any" class="keyword">if</span> (<a href="#524573" title="Boolean">success</a>)
      <a href="#524338" title="(iter: Traversable[scala.tools.nsc.io.AbstractFile])SimpleBuildManager.this.sources.type">sources</a> ++= <a href="#524336" title="=&gt; SimpleBuildManager.this.BuilderGlobal">compiler</a>.<a href="../Global.scala.html#39381" title="object SimpleBuildManager.this.compiler.dependencyAnalysis">dependencyAnalysis</a>.<a href="../dependencies/DependencyAnalysis.scala.html#167037" title="=&gt; scala.collection.Set[scala.tools.nsc.io.AbstractFile]">managedFiles</a>
    <a href="#524573" title="Boolean">success</a>
  }
  
  /** Save dependency information to `file'. */
  <span class="keyword">def</span> <a title="(file: scala.tools.nsc.io.AbstractFile,fromFile: (scala.tools.nsc.io.AbstractFile) =&gt; String)Unit" id="524345">saveTo</a>(<a title="scala.tools.nsc.io.AbstractFile" id="524593">file</a>: <a href="../io/AbstractFile.scala.html#20689" title="scala.tools.nsc.io.AbstractFile">AbstractFile</a>, <a title="(scala.tools.nsc.io.AbstractFile) =&gt; String" id="524594">fromFile</a>: AbstractFile =&gt; String) {
    <a href="#524336" title="=&gt; SimpleBuildManager.this.BuilderGlobal">compiler</a>.<a href="../Global.scala.html#39381" title="object SimpleBuildManager.this.compiler.dependencyAnalysis">dependencyAnalysis</a>.<a href="../dependencies/DependencyAnalysis.scala.html#167030" title="(file: scala.tools.nsc.io.AbstractFile)Unit">dependenciesFile</a> = <a href="#524593" title="scala.tools.nsc.io.AbstractFile">file</a>
    <a href="#524336" title="=&gt; SimpleBuildManager.this.BuilderGlobal">compiler</a>.<a href="../Global.scala.html#39381" title="object SimpleBuildManager.this.compiler.dependencyAnalysis">dependencyAnalysis</a>.<a href="../dependencies/DependencyAnalysis.scala.html#167042" title="(fromFile: (scala.tools.nsc.io.AbstractFile) =&gt; String)Unit">saveDependencies</a>(<a href="#524594" title="(scala.tools.nsc.io.AbstractFile) =&gt; String">fromFile</a>)
  }
}

        </pre>
    </body>
</html>