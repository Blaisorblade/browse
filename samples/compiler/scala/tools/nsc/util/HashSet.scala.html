<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/util/HashSet.scala</title>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */</span>
<span class="comment">// $Id: HashSet.scala 16893 2009-01-13 13:09:22Z cunei $</span>

<span class="keyword">package</span> scala.tools.nsc.util

<span class="keyword">class</span> <span class="typed"><span class="type">class HashSet[T &gt;: Null &lt;: AnyRef] extends scala.tools.nsc.util.Set[T] with ScalaObject</span><a id="8285">HashSet</a></span>[<span class="typed"><span class="type">&gt;: Null &lt;: AnyRef</span><a id="18368">T</a></span> &gt;: Null &lt;: AnyRef](<span class="typed"><span class="type">Int</span><span id="42846"><a id="42865">initialCapacity</a></span></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">scala.tools.nsc.util.Set[T]</span><a href="Set.scala.html#8294">Set</a></span>[T] {

  <span class="keyword">def</span> <span class="typed"><span class="type">()scala.tools.nsc.util.HashSet[T]</span><a id="42848" class="keyword">this</a></span>() = <span class="typed"><span class="type">HashSet.this.type</span><a href="#8285" class="keyword">this</a></span>(<span class="typed"><span class="type">Int(16)</span><span class="int">16</span></span>)

  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="42851"><span id="42849"><span id="42850"><a id="99340">capacity</a></span></span></span></span> = <span class="typed"><span class="type">Int</span><a href="#42846">initialCapacity</a></span>
  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="42854"><span id="42852"><span id="42853"><a id="99341">used</a></span></span></span></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Array[AnyRef]</span><span id="42857"><span id="42855"><span id="42856"><a id="99343">table</a></span></span></span></span> = <span class="typed"><span class="type">Array[AnyRef]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Array[AnyRef]</span><a id="1072">Array</a></span>[AnyRef](<span class="typed"><span class="type">=&gt; Int</span><a href="#42849">capacity</a></span>)

  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="42858">size</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#42852">used</a></span>

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int)Int</span><a id="42859">index</a></span>(<span class="typed"><span class="type">Int</span><a id="99349">x</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>): <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = <span class="typed"><span class="type">object Math</span><a id="608">Math</a></span>.<span class="typed"><span class="type">(Int)Int</span><a id="40049">abs</a></span>(<span class="typed"><span class="type">Int</span><a href="#99349">x</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3151">%</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#42849">capacity</a></span>)

  <span class="keyword">def</span> <span class="typed"><span class="type">(T)T</span><a id="42860">findEntry</a></span>(<span class="typed"><span class="type">T</span><a id="99378">x</a></span>: <span class="typed"><span class="type">T</span><a href="#18368">T</a></span>): <span class="typed"><span class="type">T</span><a href="#18368">T</a></span> = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="99379">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#42859">index</a></span>(<span class="typed"><span class="type">T</span><a href="#99378">x</a></span>.<span class="typed"><span class="type">()Int</span><a id="5782">hashCode</a></span>())
    <span class="keyword">var</span> <span class="typed"><span class="type">AnyRef</span><a id="99380">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="#42855" id="21509">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#99379">h</a></span>)
    <span class="typed"><span class="type">Unit</span><a href="#99381" class="keyword">while</a></span> ((<span class="typed"><span class="type">AnyRef</span><a href="#99380">entry</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5795">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#99380">entry</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">T</span><a href="#99378">x</a></span>) {
      <span class="typed"><span class="type">Int</span><a href="#99379">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#42859">index</a></span>(<span class="typed"><span class="type">Int</span><a href="#99379">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
      <span class="typed"><span class="type">AnyRef</span><a href="#99380">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="#42855" id="21509">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#99379">h</a></span>)
    }
    <span class="typed"><span class="type">AnyRef</span><a href="#99380">entry</a></span>.<span class="typed"><span class="type">T</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">T</span><a href="#18368">T</a></span>]
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(T)Unit</span><a id="42861">addEntry</a></span>(<span class="typed"><span class="type">T</span><a id="43048">x</a></span>: <span class="typed"><span class="type">T</span><a href="#18368">T</a></span>) {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="99410">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#42859">index</a></span>(<span class="typed"><span class="type">T</span><a href="#43048">x</a></span>.<span class="typed"><span class="type">()Int</span><a id="5782">hashCode</a></span>())
    <span class="keyword">var</span> <span class="typed"><span class="type">AnyRef</span><a id="99411">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="#42855" id="21509">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#99410">h</a></span>)
    <span class="typed"><span class="type">Unit</span><a href="#99412" class="keyword">while</a></span> (<span class="typed"><span class="type">AnyRef</span><a href="#99411">entry</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5795">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">AnyRef</span><a href="#99411">entry</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">T</span><a href="#43048">x</a></span>) <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span>
      <span class="typed"><span class="type">Int</span><a href="#99410">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#42859">index</a></span>((<span class="typed"><span class="type">Int</span><a href="#99410">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>))
      <span class="typed"><span class="type">AnyRef</span><a href="#99411">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="#42855" id="21509">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#99410">h</a></span>)
    }
    <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#42855">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#99410">h</a></span>) = <span class="typed"><span class="type">T</span><a href="#43048">x</a></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#42853">used</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#42852">used</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3146">&gt;=</a></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#42849">capacity</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3094">&gt;&gt;</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>)) <span class="typed"><span class="type">()Unit</span><a href="#42863">growTable</a></span>()
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; &lt;refinement&gt; extends java.lang.Object with Iterator[T]</span><a id="42862">elements</a></span> = <span class="typed"><span class="type">template $anon extends java.lang.Object with Iterator[T]</span><a id="99468" class="keyword">new</a></span> <span class="typed"><span class="type">Iterator[T]</span><a id="1339">Iterator</a></span>[T] {
    <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="99472"><span id="99470"><span id="99471"><a id="99477">i</a></span></span></span></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="99473">hasNext</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = {
      <span class="typed"><span class="type">Unit</span><a href="#99479" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#99470">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#42849">capacity</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> (<span class="typed"><span class="type">(Int)AnyRef</span><a href="#42855" id="21509">table</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#99470">i</a></span>) <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)) <span class="typed"><span class="type">(Int)Unit</span><a href="#99471">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      <span class="typed"><span class="type">=&gt; Int</span><a href="#99470">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#42849">capacity</a></span>
    }
    <span class="keyword">def</span> <span class="typed"><span class="type">()T</span><a id="99474">next</a></span>: <span class="typed"><span class="type">T</span><a href="#18368">T</a></span> =
      <span class="typed"><span class="type">T</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#99473">hasNext</a></span>) { <span class="typed"><span class="type">(Int)Unit</span><a href="#99471">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>; <span class="typed"><span class="type">(Int)AnyRef</span><a href="#42855" id="21509">table</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#99470">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>).<span class="typed"><span class="type">T</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">T</span><a href="#18368">T</a></span>] }
      <span class="keyword">else</span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
  }

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="42863">growTable</a></span>() {
    <span class="keyword">val</span> <span class="typed"><span class="type">Array[AnyRef]</span><a id="99557">oldtable</a></span> = <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#42855">table</a></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#42850">capacity</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3149">*=</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>
    <span class="typed"><span class="type">(Array[AnyRef])Unit</span><a href="#42856">table</a></span> = <span class="typed"><span class="type">Array[AnyRef]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Array[AnyRef]</span><a id="1072">Array</a></span>[AnyRef](<span class="typed"><span class="type">=&gt; Int</span><a href="#42849">capacity</a></span>)
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="99558">i</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">Unit</span><a href="#99578" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#99558">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">Array[AnyRef]</span><a href="#99557">oldtable</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21508">length</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">AnyRef</span><a id="99580">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="#99557" id="21509">oldtable</a></span>(<span class="typed"><span class="type">Int</span><a href="#99558">i</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">AnyRef</span><a href="#99580">entry</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5795">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) <span class="typed"><span class="type">(T)Unit</span><a href="#42861">addEntry</a></span>(<span class="typed"><span class="type">AnyRef</span><a href="#99580">entry</a></span>.<span class="typed"><span class="type">T</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">T</span><a href="#18368">T</a></span>])
      <span class="typed"><span class="type">Int</span><a href="#99558">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    }
  }
}

        </pre>
    </body>
</html>