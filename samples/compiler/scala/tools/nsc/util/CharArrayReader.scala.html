<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/util/CharArrayReader.scala</title>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */</span>
<span class="comment">// $Id: CharArrayReader.scala 16893 2009-01-13 13:09:22Z cunei $</span>

<span class="keyword">package</span> scala.tools.nsc.util

<span class="keyword">import</span> scala.tools.nsc.util.SourceFile.{LF, FF, CR, SU}

<span class="keyword">class</span> <span class="typed"><span class="type">class CharArrayReader extends java.lang.Object with Iterator[Char] with java.lang.Cloneable with ScalaObject</span><a id="8366">CharArrayReader</a></span>(<span class="typed"><span class="type">RandomAccessSeq[Char]</span><span id="73941"><a id="74643">buf</a></span></span>: <span class="typed"><span class="type">RandomAccessSeq[Char]</span><a id="667">RandomAccessSeq</a></span>[Char], <span class="typed"><span class="type">Int</span><span id="73942"><a id="74644">start</a></span></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>, <span class="comment">/* startline: int, startcol: int, */</span>
                      <span class="typed"><span class="type">Boolean</span><span id="73943"><a id="74645">decodeUni</a></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span>, <span class="typed"><span class="type">(String) =&gt; Unit</span><span id="73944"><a id="74646">error</a></span></span>: String =&gt; Unit) <span class="keyword">extends</span> <span class="typed"><span class="type">Iterator[Char]</span><a id="1339">Iterator</a></span>[Char] <span class="keyword">with</span> <span class="typed"><span class="type">java.lang.Cloneable</span><a id="1930">Cloneable</a></span> {

  <span class="keyword">def</span> <span class="typed"><span class="type">(RandomAccessSeq[Char],Boolean,(String) =&gt; Unit)scala.tools.nsc.util.CharArrayReader</span><a id="73946" class="keyword">this</a></span>(<span class="typed"><span class="type">RandomAccessSeq[Char]</span><a id="74640">buf</a></span>: <span class="typed"><span class="type">RandomAccessSeq[Char]</span><a id="667">RandomAccessSeq</a></span>[Char], <span class="typed"><span class="type">Boolean</span><a id="74641">decodeUni</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span>, <span class="typed"><span class="type">(String) =&gt; Unit</span><a id="74642">error</a></span>: String =&gt; Unit) =
    <span class="typed"><span class="type">CharArrayReader.this.type</span><a href="#8366" class="keyword">this</a></span>(<span class="typed"><span class="type">RandomAccessSeq[Char]</span><a href="#74640">buf</a></span>, <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="comment">/* 1, 1, */</span> <span class="typed"><span class="type">Boolean</span><a href="#74641">decodeUni</a></span>, <span class="typed"><span class="type">(String) =&gt; Unit</span><a href="#74642">error</a></span>)

  <span class="comment">/** produce a duplicate of this char array reader which starts reading
    *  at current position, independent of what happens to original reader
	*/</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.util.CharArrayReader</span><a id="73947">dup</a></span>: <span class="typed"><span class="type">scala.tools.nsc.util.CharArrayReader</span><a href="#8366">CharArrayReader</a></span> = <span class="typed"><span class="type">()java.lang.Object</span><a href="#8366" id="5784">clone</a></span>().<span class="typed"><span class="type">scala.tools.nsc.util.CharArrayReader</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">scala.tools.nsc.util.CharArrayReader</span><a href="#8366">CharArrayReader</a></span>]

  <span class="comment">/** layout constant
   */</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><span id="73949"><a id="73948">tabinc</a></span></span> = <span class="typed"><span class="type">Int(8)</span><span class="int">8</span></span>

  <span class="comment">/** the line and column position of the current character
  */</span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Char</span><span id="73952"><span id="73950"><span id="73951"><a id="96681">ch</a></span></span></span></span>: <span class="typed"><span class="type">Char</span><a id="2389">Char</a></span> = _
  <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="73955"><span id="73953"><span id="73954"><a id="96682">bp</a></span></span></span></span> = <span class="typed"><span class="type">Int</span><a href="#73942">start</a></span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="73958"><span id="73956"><span id="73957"><a id="96683">oldBp</a></span></span></span></span> = -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Char</span><span id="73961"><span id="73959"><span id="73960"><a id="96684">oldCh</a></span></span></span></span>: <span class="typed"><span class="type">Char</span><a id="2389">Char</a></span> = _
  
  <span class="comment">//private var cline: Int = _</span>
  <span class="comment">//private var ccol: Int = _</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="73962">cpos</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="73965"><span id="73963"><span id="73964"><a id="96685">isUnicode</a></span></span></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = _
  <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="73968"><span id="73966"><span id="73967"><a id="96686">lastLineStartPos</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="73971"><span id="73969"><span id="73970"><a id="96687">lineStartPos</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="73974"><span id="73972"><span id="73973"><a id="96688">lastBlankLinePos</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>

  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="73977"><span id="73975"><span id="73976"><a id="96689">onlyBlankChars</a></span></span></span></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
  <span class="comment">//private var nextline = startline</span>
  <span class="comment">//private var nextcol = startcol</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="73978">markNewLine</a></span>() {
    <span class="typed"><span class="type">(Int)Unit</span><a href="#73967">lastLineStartPos</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#73969">lineStartPos</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#73975">onlyBlankChars</a></span>) <span class="typed"><span class="type">(Int)Unit</span><a href="#73973">lastBlankLinePos</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#73969">lineStartPos</a></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#73970">lineStartPos</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span>
    <span class="typed"><span class="type">(Boolean)Unit</span><a href="#73976">onlyBlankChars</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
    <span class="comment">//nextline += 1</span>
    <span class="comment">//nextcol = 1</span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="73979">hasNext</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">RandomAccessSeq[Char]</span><a href="#73941">buf</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21642">length</a></span>) <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span> 
  <span class="keyword">else</span> {
    <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Char</span><a id="73980">last</a></span>: <span class="typed"><span class="type">Char</span><a id="2389">Char</a></span> = <span class="typed"><span class="type">Char</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3145">&gt;</a></span> <span class="typed"><span class="type">Int</span><a href="#73942">start</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>) <span class="typed"><span class="type">(Int)Char</span><a href="#73941" id="21757">buf</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">-</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>) <span class="keyword">else</span> <span class="typed"><span class="type">Char(' ')</span><span class="char">' '</span></span> <span class="comment">// XML literals</span>

  <span class="keyword">def</span> <span class="typed"><span class="type">()Char</span><a id="73981">next</a></span>: <span class="typed"><span class="type">Char</span><a id="2389">Char</a></span> = {
    <span class="comment">//cline = nextline</span>
    <span class="comment">//ccol = nextcol</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Array[Char]</span><a id="96713">buf</a></span> = <span class="typed"><span class="type">CharArrayReader.this.type</span><a href="#8366" class="keyword">this</a></span>.<span class="typed"><span class="type">RandomAccessSeq[Char]</span><a href="#73941">buf</a></span>.<span class="typed"><span class="type">scala.runtime.BoxedCharArray</span><a id="3503">asInstanceOf</a></span>[runtime.<span class="typed"><span class="type">scala.runtime.BoxedCharArray</span><a id="2354">BoxedCharArray</a></span>].<span class="typed"><span class="type">=&gt; Array[Char]</span><a id="96714">value</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">=&gt; Boolean</span><a href="#73979">hasNext</a></span>) {
      <span class="typed"><span class="type">(Char)Unit</span><a href="#73951">ch</a></span> = <span class="typed"><span class="type">Char('\032')</span><span >SU</span></span>
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Char('\032')</span><span >SU</span></span>  <span class="comment">// there is an endless stream of SU's at the end </span>
    }
    <span class="typed"><span class="type">(Int)Unit</span><a href="#73957">oldBp</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span>
    <span class="typed"><span class="type">(Char)Unit</span><a href="#73960">oldCh</a></span> = <span class="typed"><span class="type">=&gt; Char</span><a href="#73950">ch</a></span>
    <span class="typed"><span class="type">(Char)Unit</span><a href="#73951">ch</a></span> = <span class="typed"><span class="type">(Int)Char</span><a href="#96713" id="21509">buf</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span>)
    <span class="typed"><span class="type">(Boolean)Unit</span><a href="#73964">isUnicode</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#73954">bp</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">=&gt; Char</span><a href="#73950">ch</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('\011')</span><span class="char">'\t'</span></span> =&gt;
        <span class="comment">// nextcol = ((nextcol - 1) / tabinc * tabinc) + tabinc + 1;</span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('\015')</span><span >CR</span></span> =&gt;
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Int)Char</span><a href="#96713" id="21509">buf</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span>) <span class="typed"><span class="type">(Char)Boolean</span><a id="3018">==</a></span> <span class="typed"><span class="type">Char('\012')</span><span >LF</span></span>) {
          <span class="typed"><span class="type">(Char)Unit</span><a href="#73951">ch</a></span> = <span class="typed"><span class="type">Char('\012')</span><span >LF</span></span>
          <span class="typed"><span class="type">(Int)Unit</span><a href="#73954">bp</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        }
        <span class="typed"><span class="type">()Unit</span><a href="#73978">markNewLine</a></span>()
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('\012')</span><span >LF</span></span> | <span class="typed"><span class="type">Char('\014')</span><span >FF</span></span> =&gt;
        <span class="typed"><span class="type">()Unit</span><a href="#73978">markNewLine</a></span>()
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('\')</span><span class="char">'\\'</span></span> =&gt;
        <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="96817">evenSlashPrefix</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = {
          <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="96819">p</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">-</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>
          <span class="typed"><span class="type">Unit</span><a href="#96820" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#96819">p</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3146">&gt;=</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">(Int)Char</span><a href="#96713" id="21509">buf</a></span>(<span class="typed"><span class="type">Int</span><a href="#96819">p</a></span>) <span class="typed"><span class="type">(Char)Boolean</span><a id="3018">==</a></span> <span class="typed"><span class="type">Char('\')</span><span class="char">'\\'</span></span>) <span class="typed"><span class="type">Int</span><a href="#96819">p</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">-=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
          (<span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">-</a></span> <span class="typed"><span class="type">Int</span><a href="#96819">p</a></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3151">%</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">==</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
        }
        <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="96818">udigit</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = {
          <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="96850">d</a></span> = <span class="typed"><span class="type">(Char,Int)Int</span><a href="#73984">digit2int</a></span>(<span class="typed"><span class="type">(Int)Char</span><a href="#96713" id="21509">buf</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span>), <span class="typed"><span class="type">Int(16)</span><span class="int">16</span></span>)
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#96850">d</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3146">&gt;=</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) { <span class="typed"><span class="type">(Int)Unit</span><a href="#73954">bp</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>; <span class="comment">/* nextcol = nextcol + 1 */</span> }
          <span class="keyword">else</span> <span class="typed"><span class="type">(String)Unit</span><a href="#73944" id="21757">error</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;error in unicode escape&quot;)</span><span class="string">&quot;error in unicode escape&quot;</span></span>);
          <span class="typed"><span class="type">Int</span><a href="#96850">d</a></span>
        }
        <span class="comment">// nextcol += 1</span>
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Int)Char</span><a href="#96713" id="21509">buf</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span>) <span class="typed"><span class="type">(Char)Boolean</span><a id="3018">==</a></span> <span class="typed"><span class="type">Char('u')</span><span class="char">'u'</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">Boolean</span><a href="#73943">decodeUni</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a href="#96817">evenSlashPrefix</a></span>) {
          <span class="typed"><span class="type">Unit</span><a href="#96883" class="keyword">do</a></span> {
            <span class="typed"><span class="type">(Int)Unit</span><a href="#73954">bp</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> <span class="comment">//; nextcol += 1</span>
          } <span class="keyword">while</span> (<span class="typed"><span class="type">(Int)Char</span><a href="#96713" id="21509">buf</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span>) <span class="typed"><span class="type">(Char)Boolean</span><a id="3018">==</a></span> <span class="typed"><span class="type">Char('u')</span><span class="char">'u'</span></span>);
          <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="96882">code</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#96818">udigit</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3090">&lt;&lt;</a></span> <span class="typed"><span class="type">Int(12)</span><span class="int">12</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3152">|</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#96818">udigit</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3090">&lt;&lt;</a></span> <span class="typed"><span class="type">Int(8)</span><span class="int">8</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3152">|</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#96818">udigit</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3090">&lt;&lt;</a></span> <span class="typed"><span class="type">Int(4)</span><span class="int">4</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3152">|</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#96818">udigit</a></span>
          <span class="typed"><span class="type">(Char)Unit</span><a href="#73951">ch</a></span> = <span class="typed"><span class="type">Int</span><a href="#96882">code</a></span>.<span class="typed"><span class="type">Char</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">Char</span><a id="2389">Char</a></span>]
          <span class="typed"><span class="type">(Boolean)Unit</span><a href="#73964">isUnicode</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
        }
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt;
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#73950">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3022">&gt;</a></span> <span class="typed"><span class="type">Char(' ')</span><span class="char">' '</span></span>) <span class="typed"><span class="type">(Boolean)Unit</span><a href="#73976">onlyBlankChars</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
        <span class="comment">// nextcol += 1</span>
    }
    <span class="typed"><span class="type">=&gt; Char</span><a href="#73950">ch</a></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="73982">rewind</a></span> {
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#73956">oldBp</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">==</a></span> -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">java.lang.IllegalArgumentException</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.lang.IllegalArgumentException</span><span id="5983"><a id="821">IllegalArgumentException</a></span></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#73954">bp</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#73956">oldBp</a></span>
    <span class="typed"><span class="type">(Char)Unit</span><a href="#73951">ch</a></span> = <span class="typed"><span class="type">=&gt; Char</span><a href="#73959">oldCh</a></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#73957">oldBp</a></span> = -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">(Char)Unit</span><a href="#73960">oldCh</a></span> = <span class="typed"><span class="type">Char('x')</span><span class="char">'x'</span></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.util.CharArrayReader</span><a id="73983">copy</a></span>: <span class="typed"><span class="type">scala.tools.nsc.util.CharArrayReader</span><a href="#8366">CharArrayReader</a></span> =
    <span class="typed"><span class="type">scala.tools.nsc.util.CharArrayReader</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.util.CharArrayReader</span><a href="#8366">CharArrayReader</a></span>(<span class="typed"><span class="type">RandomAccessSeq[Char]</span><a href="#73941">buf</a></span>, <span class="typed"><span class="type">=&gt; Int</span><a href="#73953">bp</a></span>, <span class="comment">/* nextcol, nextline, */</span> <span class="typed"><span class="type">Boolean</span><a href="#73943">decodeUni</a></span>, <span class="typed"><span class="type">(String) =&gt; Unit</span><a href="#73944">error</a></span>)

  <span class="keyword">def</span> <span class="typed"><span class="type">(Char,Int)Int</span><a id="73984">digit2int</a></span>(<span class="typed"><span class="type">Char</span><a id="74078">ch</a></span>: <span class="typed"><span class="type">Char</span><a id="2389">Char</a></span>, <span class="typed"><span class="type">Int</span><a id="74079">base</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>): <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = {
    <span class="typed"><span class="type">Int</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('0')</span><span class="char">'0'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3021">&lt;=</a></span> <span class="typed"><span class="type">Char</span><a href="#74078">ch</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#74078">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3021">&lt;=</a></span> <span class="typed"><span class="type">Char('9')</span><span class="char">'9'</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#74078">ch</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3034">&lt;</a></span> <span class="typed"><span class="type">Char('0')</span><span class="char">'0'</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3038">+</a></span> <span class="typed"><span class="type">Int</span><a href="#74079">base</a></span>)
      <span class="typed"><span class="type">Char</span><a href="#74078">ch</a></span> <span class="typed"><span class="type">(Char)Int</span><a id="3025">-</a></span> <span class="typed"><span class="type">Char('0')</span><span class="char">'0'</span></span>
    <span class="keyword">else</span> <span class="typed"><span class="type">Int</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('A')</span><span class="char">'A'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3021">&lt;=</a></span> <span class="typed"><span class="type">Char</span><a href="#74078">ch</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#74078">ch</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3034">&lt;</a></span> <span class="typed"><span class="type">Char('A')</span><span class="char">'A'</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3038">+</a></span> <span class="typed"><span class="type">Int</span><a href="#74079">base</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">-</a></span> <span class="typed"><span class="type">Int(10)</span><span class="int">10</span></span>)
      <span class="typed"><span class="type">Char</span><a href="#74078">ch</a></span> <span class="typed"><span class="type">(Char)Int</span><a id="3025">-</a></span> <span class="typed"><span class="type">Char('A')</span><span class="char">'A'</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(10)</span><span class="int">10</span></span>
    <span class="keyword">else</span> <span class="typed"><span class="type">Int</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('a')</span><span class="char">'a'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3021">&lt;=</a></span> <span class="typed"><span class="type">Char</span><a href="#74078">ch</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#74078">ch</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3034">&lt;</a></span> <span class="typed"><span class="type">Char('a')</span><span class="char">'a'</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3038">+</a></span> <span class="typed"><span class="type">Int</span><a href="#74079">base</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">-</a></span> <span class="typed"><span class="type">Int(10)</span><span class="int">10</span></span>)
      <span class="typed"><span class="type">Char</span><a href="#74078">ch</a></span> <span class="typed"><span class="type">(Char)Int</span><a id="3025">-</a></span> <span class="typed"><span class="type">Char('a')</span><span class="char">'a'</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(10)</span><span class="int">10</span></span>
    <span class="keyword">else</span>
      -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>
  }
}

        </pre>
    </body>
</html>