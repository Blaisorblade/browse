<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/backend/icode/analysis/CopyPropagation.scala</title>
        <script type="text/javascript" src="../../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */

// $Id: CopyPropagation.scala 18586 2009-08-27 10:59:03Z dragos $

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> backend.icode.analysis

<span class="keyword">import</span> scala.collection.mutable.{Map, HashMap}
<span class="keyword">import</span> scala.tools.nsc.symtab.Flags.DEFERRED

/** A modified copy-propagation like analysis. It 
 *  is augmented with a record-like value which is used
 *  to represent closures.
 *
 *  @author Iulian Dragos
 */
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class CopyPropagation extends java.lang.Object with ScalaObject" id="16040">CopyPropagation</a> <span title="ScalaObject">{</span>
  <span class="keyword">val</span> <a title="=&gt; scala.tools.nsc.Global" id="154938">global</a>: <a href="../../../Global.scala.html#8460" title="scala.tools.nsc.Global">Global</a>
  <span class="keyword">import</span> global._
  <span class="keyword">import</span> icodes._

  /** Locations can be local variables, this, and fields. */
  <span class="keyword">abstract</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <a title="class Location extends java.lang.Object with ScalaObject" id="154941">Location</a>
  case <span class="keyword">class</span> <a title="class LocalVar extends CopyPropagation.this.Location with ScalaObject with Product" id="155197">LocalVar</a><span title="ScalaObject">(</span><a title="CopyPropagation.this.global.icodes.Local" id="155205">l</a>: <a href="../Members.scala.html#46174" title="CopyPropagation.this.global.icodes.Local">Local</a>) <span class="keyword">extends</span> <a href="#154941" title="CopyPropagation.this.Location">Location</a>
  case <span class="keyword">class</span> <a title="class Field extends CopyPropagation.this.Location with ScalaObject with Product" id="155588">Field</a><span title="ScalaObject">(</span><a title="CopyPropagation.this.Record" id="341428">r</a>: <a href="#155418" title="CopyPropagation.this.Record">Record</a>, <a title="CopyPropagation.this.global.Symbol" id="341429">sym</a>: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>) <span class="keyword">extends</span> <a href="#154941" title="CopyPropagation.this.Location">Location</a>
  case <span class="keyword">object</span> <a href="#340092" title="object CopyPropagation.this.This" id="340103">This</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#154941" title="CopyPropagation.this.Location">Location</a>

  /** Values that can be on the stack. */
  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Value extends java.lang.Object with ScalaObject" id="154950">Value</a> <span title="ScalaObject">{</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="155236">isRecord</a> = <span title="Boolean(false)" class="keyword">false</span>
  }
  case <span class="keyword">class</span> <a title="class Record extends CopyPropagation.this.Value with ScalaObject with Product" id="155418">Record</a><span title="ScalaObject">(</span><a title="CopyPropagation.this.global.Symbol" id="342082">cls</a>: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>, <a title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" id="342083">bindings</a>: <span title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">Map</span>[Symbol, Value]) <span class="keyword">extends</span> <a href="#154950" title="CopyPropagation.this.Value">Value</a> {
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="155410">isRecord</a> = <span title="Boolean(true)" class="keyword">true</span>
  }
  /** The value of some location in memory. */
  case <span class="keyword">class</span> <a title="class Deref extends CopyPropagation.this.Value with ScalaObject with Product" id="155238">Deref</a><span title="ScalaObject">(</span><a title="CopyPropagation.this.Location" id="340473">l</a>: <a href="#154941" title="CopyPropagation.this.Location">Location</a>) <span class="keyword">extends</span> <a href="#154950" title="CopyPropagation.this.Value">Value</a>
  
  /** The boxed value of some location. */
  case <span class="keyword">class</span> <a title="class Boxed extends CopyPropagation.this.Value with ScalaObject with Product" id="155690">Boxed</a><span title="ScalaObject">(</span><a title="CopyPropagation.this.Location" id="341998">l</a>: <a href="#154941" title="CopyPropagation.this.Location">Location</a>) <span class="keyword">extends</span> <a href="#154950" title="CopyPropagation.this.Value">Value</a>
  
  /** The constant value c. */
  case <span class="keyword">class</span> <a title="class Const extends CopyPropagation.this.Value with ScalaObject with Product" id="155914">Const</a><span title="ScalaObject">(</span><a title="CopyPropagation.this.global.Constant" id="341335">c</a>: <a href="../../../symtab/Constants.scala.html#26513" title="CopyPropagation.this.global.Constant">Constant</a>) <span class="keyword">extends</span> <a href="#154950" title="CopyPropagation.this.Value">Value</a>
  
  /** Unknown. */
  case <span class="keyword">object</span> <a href="#340332" title="object CopyPropagation.this.Unknown" id="340343">Unknown</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#154950" title="CopyPropagation.this.Value">Value</a>
  
  /** The bottom record. */
  <span class="keyword">object</span> <a title="object CopyPropagation.this.AllRecords" id="154965">AllRecords</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#155418" title="CopyPropagation.this.Record">Record</a>(<a href="../../../symtab/Symbols.scala.html#26134" title="object CopyPropagation.this.global.NoSymbol">NoSymbol</a>, <span title="scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">HashMap</span>[Symbol, Value])

  /** The lattice for this analysis.   */
  <span class="keyword">object</span> <a title="object CopyPropagation.this.copyLattice" id="154967">copyLattice</a> <span title="ScalaObject" class="keyword">extends</span> <a href="CompleteLattice.scala.html#16031" title="scala.tools.nsc.backend.icode.analysis.CompleteLattice">CompleteLattice</a> {
    <span class="keyword">type</span> <a title="scala.collection.mutable.Map[CopyPropagation.this.Location,CopyPropagation.this.Value]" id="154976">Bindings</a> = <span title="scala.collection.mutable.Map[CopyPropagation.this.Location,CopyPropagation.this.Value]">Map</span>[Location, Value]

    <span class="keyword">def</span> <a title="=&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]" id="154977">emptyBinding</a> = <span title="scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]">HashMap</span>[Location, Value]()

    <span class="keyword">class</span> <a title="class State extends java.lang.Object with ScalaObject" id="154978">State</a><span title="ScalaObject">(</span><span class="keyword">val</span> <a title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings" id="340351">bindings</a>: <span title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings">Bindings</span>, <span class="keyword">var</span> <a title="List[CopyPropagation.this.Value]" id="340352">stack</a>: <a title="List[CopyPropagation.this.Value]" id="7345">List</a>[Value]) {
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(that: Any)Boolean" id="155140">equals</a>(<a title="Any" id="340378">that</a>: <a title="Any" id="49">Any</a>): <span title="Boolean">Boolean</span> = 
        <span title="(x$1: Boolean)Boolean">(</span><a href="#154978" title="(x$1: AnyRef)Boolean" class="keyword">this</a> eq <a href="#340378" title="Any">that</a>.<span title="[T0]T0">asInstanceOf</span><span title="AnyRef">[</span><a title="AnyRef" id="1758">AnyRef</a>]) ||
        <a href="#340378" title="Any">that</a>.<a title="[T0]Boolean" id="3620">isInstanceOf</a><span title="(x$1: Boolean)Boolean">[</span><a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">State</a>] &amp;&amp; {
          <span class="keyword">val</span> <a title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State" id="340382">other</a> = <a href="#340378" title="Any">that</a>.<span title="[T0]T0">asInstanceOf</span><span title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">[</span><a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">State</a>]

          /* comparison with bottom is reference equality! */
          <span title="Boolean" class="keyword">if</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#340382" title="(x$1: AnyRef)Boolean">other</a> eq <a href="#154982" title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">bottom</a>) || (<a href="#154978" title="(x$1: AnyRef)Boolean" class="keyword">this</a> eq <a href="#154982" title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">bottom</a>))
            (<a href="#154978" title="(x$1: AnyRef)Boolean" class="keyword">this</a> eq <a href="#340382" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">other</a>)
          <span class="keyword">else</span> {
            <a href="#154978" title="State.this.type" class="keyword">this</a>.<a href="#340351" title="(x$1: AnyRef)Boolean">bindings</a> <span title="(x$1: Boolean)Boolean">==</span> <a href="#340382" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">other</a>.<a href="#340351" title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings">bindings</a> &amp;&amp;
            <span title="object List">List</span>.<a title="(xs: List[CopyPropagation.this.Value],ys: List[CopyPropagation.this.Value])(f: (CopyPropagation.this.Value, CopyPropagation.this.Value) =&gt; Boolean)Boolean" id="24391">forall2</a>(<a href="#154978" title="State.this.type" class="keyword">this</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>, <a href="#340382" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">other</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>) { (<a title="CopyPropagation.this.Value" id="340410">a</a>, <a title="CopyPropagation.this.Value" id="340411">b</a>) =&gt; <a href="#340410" title="(x$1: AnyRef)Boolean">a</a> == <a href="#340411" title="CopyPropagation.this.Value">b</a> }
          }
        }

      /* Return an alias for the given local. It returns the last
       * local in the chain of aliased locals. Cycles are not allowed
       * to exist (by construction).
       */
      <span class="keyword">def</span> <a title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.global.icodes.Local" id="155141">getAlias</a>(<a title="CopyPropagation.this.global.icodes.Local" id="155368">l</a>: <a href="../Members.scala.html#46174" title="CopyPropagation.this.global.icodes.Local">Local</a>): <a href="../Members.scala.html#46174" title="CopyPropagation.this.global.icodes.Local">Local</a> = {
        <span class="keyword">var</span> <a title="CopyPropagation.this.global.icodes.Local" id="340426">target</a> = <a href="#155368" title="CopyPropagation.this.global.icodes.Local">l</a>
        <span class="keyword">var</span> <a title="Boolean" id="340427">stop</a> = <span title="Boolean(false)" class="keyword">false</span>
        
        <span title="Unit" class="keyword">while</span> (<a href="#340351" title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings">bindings</a>.<span title="(key: CopyPropagation.this.Location)Boolean">isDefinedAt</span><span title="(x$1: Boolean)Boolean">(</span><a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a>(<a href="#340426" title="CopyPropagation.this.global.icodes.Local">target</a>)) &amp;&amp; <span title="=&gt; Boolean">!</span><a href="#340427" title="Boolean">stop</a>) {
          <a href="#340351" title="(key: CopyPropagation.this.Location)CopyPropagation.this.Value">bindings</a>(<a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a>(<a href="#340426" title="CopyPropagation.this.global.icodes.Local">target</a>)) <a href="#340428" title="Unit" class="keyword">match</a> {
            <span title="Unit" class="keyword">case</span> Deref(LocalVar(<a title="CopyPropagation.this.global.icodes.Local" id="340462">t</a>)) =&gt; <a href="#340426" title="CopyPropagation.this.global.icodes.Local">target</a> = <a href="#340462" title="CopyPropagation.this.global.icodes.Local">t</a>
            <span title="Unit" class="keyword">case</span> _ =&gt; <a href="#340427" title="Boolean">stop</a> = <span title="Boolean(true)" class="keyword">true</span>
          }
        }
        <a href="#340426" title="CopyPropagation.this.global.icodes.Local">target</a>
      }

      /* Return the value bound to the given local. */
      <span class="keyword">def</span> <a title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.Value" id="155142">getBinding</a>(<a title="CopyPropagation.this.global.icodes.Local" id="155229">l</a>: <a href="../Members.scala.html#46174" title="CopyPropagation.this.global.icodes.Local">Local</a>): <a href="#154950" title="CopyPropagation.this.Value">Value</a> = {
        <span class="keyword">var</span> <a title="CopyPropagation.this.global.icodes.Local" id="340469">target</a> = <a href="#155229" title="CopyPropagation.this.global.icodes.Local">l</a>
        <span class="keyword">var</span> <a title="Boolean" id="340470">stop</a> = <span title="Boolean(false)" class="keyword">false</span>
        <span class="keyword">var</span> <a title="CopyPropagation.this.Value" id="340471">value</a>: <a href="#154950" title="CopyPropagation.this.Value">Value</a> = <a href="#155238" title="(l: CopyPropagation.this.Location)CopyPropagation.this.Deref">Deref</a>(<a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a>(<a href="#340469" title="CopyPropagation.this.global.icodes.Local">target</a>))
        
        <span title="Unit" class="keyword">while</span> (<a href="#340351" title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings">bindings</a>.<span title="(key: CopyPropagation.this.Location)Boolean">isDefinedAt</span><span title="(x$1: Boolean)Boolean">(</span><a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a>(<a href="#340469" title="CopyPropagation.this.global.icodes.Local">target</a>)) &amp;&amp; <span title="=&gt; Boolean">!</span><a href="#340470" title="Boolean">stop</a>) <a href="#340472" title="()Unit">{</a>
//          Console.println(&quot;finding binding for &quot; + target)
          <a href="#340471" title="CopyPropagation.this.Value">value</a> = <a href="#340351" title="(key: CopyPropagation.this.Location)CopyPropagation.this.Value">bindings</a>(<a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a>(<a href="#340469" title="CopyPropagation.this.global.icodes.Local">target</a>))
          <a href="#340471" title="CopyPropagation.this.Value">value</a> <span title="Unit" class="keyword">match</span> {
            <span title="Unit" class="keyword">case</span> Deref(LocalVar(<a title="CopyPropagation.this.global.icodes.Local" id="340521">t</a>)) =&gt; <a href="#340469" title="CopyPropagation.this.global.icodes.Local">target</a> = <a href="#340521" title="CopyPropagation.this.global.icodes.Local">t</a>
            <span title="Unit" class="keyword">case</span> _ =&gt; <a href="#340470" title="Boolean">stop</a> = <span title="Boolean(true)" class="keyword">true</span>
          }
        }
        <a href="#340471" title="CopyPropagation.this.Value">value</a>
      }

      /* Return the binding for the given field of the given record */
      <span class="keyword">def</span> <a title="(r: CopyPropagation.this.Record,f: CopyPropagation.this.global.Symbol)CopyPropagation.this.Value" id="155143">getBinding</a>(<a title="CopyPropagation.this.Record" id="155224">r</a>: <a href="#155418" title="CopyPropagation.this.Record">Record</a>, <a title="CopyPropagation.this.global.Symbol" id="155225">f</a>: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>): <a href="#154950" title="CopyPropagation.this.Value">Value</a> = {
        <span title="(assertion: Boolean,message: =&gt; Any)Unit">assert</span>(<a href="#155224" title="CopyPropagation.this.Record">r</a>.<a href="#342083" title="=&gt; scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">bindings</a>.<span title="(key: CopyPropagation.this.global.Symbol)Boolean">isDefinedAt</span>(<a href="#155225" title="CopyPropagation.this.global.Symbol">f</a>),
               <span title="(x$1: Any)java.lang.String" class="string">&quot;Record &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#155224" title="CopyPropagation.this.Record">r</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; does not contain a field &quot;)" class="string">&quot; does not contain a field &quot;</span> + <a href="#155225" title="CopyPropagation.this.global.Symbol">f</a>);

        <span class="keyword">var</span> <a title="CopyPropagation.this.Value" id="340528">target</a>: <a href="#154950" title="CopyPropagation.this.Value">Value</a> = <a href="#155224" title="CopyPropagation.this.Record">r</a>.<a href="#342083" title="(key: CopyPropagation.this.global.Symbol)CopyPropagation.this.Value">bindings</a>(<a href="#155225" title="CopyPropagation.this.global.Symbol">f</a>);
        <a href="#340528" title="CopyPropagation.this.Value">target</a> <span title="CopyPropagation.this.Value" class="keyword">match</span> {
          <span title="CopyPropagation.this.Value" class="keyword">case</span> Deref(LocalVar(<a title="CopyPropagation.this.global.icodes.Local" id="340565">l</a>)) =&gt; <a href="#155142" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.Value">getBinding</a>(<a href="#340565" title="CopyPropagation.this.global.icodes.Local">l</a>)
          <span title="CopyPropagation.this.Value" class="keyword">case</span> _ =&gt; <a href="#340528" title="CopyPropagation.this.Value">target</a>
        }
      }
      
      /** Return a local which contains the same value as this field, if any.
       * If the field holds a reference to a local, the returned value is the
       * binding of that local.
       */
      <span class="keyword">def</span> <a title="(r: CopyPropagation.this.Record,f: CopyPropagation.this.global.Symbol)Option[CopyPropagation.this.Value]" id="155144">getFieldValue</a>(<a title="CopyPropagation.this.Record" id="155624">r</a>: <a href="#155418" title="CopyPropagation.this.Record">Record</a>, <a title="CopyPropagation.this.global.Symbol" id="155625">f</a>: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>): <span title="Option[CopyPropagation.this.Value]">Option</span>[Value] = {
        <span title="Option[CopyPropagation.this.Value]" class="keyword">if</span>(<span title="=&gt; Boolean">!</span><a href="#155624" title="CopyPropagation.this.Record">r</a>.<a href="#342083" title="=&gt; scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">bindings</a>.<span title="(key: CopyPropagation.this.global.Symbol)Boolean">isDefinedAt</span>(<a href="#155625" title="CopyPropagation.this.global.Symbol">f</a>)) <span title="object None">None</span> <span class="keyword">else</span> {
        	<span class="keyword">var</span> <a title="CopyPropagation.this.Value" id="340580">target</a>: <a href="#154950" title="CopyPropagation.this.Value">Value</a> = <a href="#155624" title="CopyPropagation.this.Record">r</a>.<a href="#342083" title="(key: CopyPropagation.this.global.Symbol)CopyPropagation.this.Value">bindings</a>(<a href="#155625" title="CopyPropagation.this.global.Symbol">f</a>)
        	<a href="#340580" title="CopyPropagation.this.Value">target</a> <span title="Option[CopyPropagation.this.Value]" class="keyword">match</span> {
          	<span title="Some[CopyPropagation.this.Value]" class="keyword">case</span> Deref(LocalVar(<a title="CopyPropagation.this.global.icodes.Local" id="340595">l</a>)) =&gt; <span title="(x: CopyPropagation.this.Value)Some[CopyPropagation.this.Value]">Some</span>(<a href="#155142" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.Value">getBinding</a>(<a href="#340595" title="CopyPropagation.this.global.icodes.Local">l</a>))
          	<span title="Option[CopyPropagation.this.Value]" class="keyword">case</span> Deref(Field(<a title="CopyPropagation.this.Record" id="340610">r1</a>, <a title="CopyPropagation.this.global.Symbol" id="340611">f1</a>)) =&gt; <a href="#155144" title="(r: CopyPropagation.this.Record,f: CopyPropagation.this.global.Symbol)Option[CopyPropagation.this.Value]">getFieldValue</a><span title="(alternative: =&gt; Option[CopyPropagation.this.Value])Option[CopyPropagation.this.Value]">(</span><a href="#340610" title="CopyPropagation.this.Record">r1</a>, <a href="#340611" title="CopyPropagation.this.global.Symbol">f1</a>) orElse <span title="(x: CopyPropagation.this.Value)Some[CopyPropagation.this.Value]">Some</span>(<a href="#340580" title="CopyPropagation.this.Value">target</a>)
//          case Deref(This)    =&gt; Some(target)
//          case Const(k) =&gt; Some(target)
	          <span title="Some[CopyPropagation.this.Value]" class="keyword">case</span> _  =&gt; <span title="(x: CopyPropagation.this.Value)Some[CopyPropagation.this.Value]">Some</span>(<a href="#340580" title="CopyPropagation.this.Value">target</a>)
          }
        }
      }
      
      /** The same as getFieldValue, but never returns Record/Field values. Use
       *  this when you want to find a replacement for a field value (either a local,
       *  or a constant/this value). 
       */
      <span class="keyword">def</span> <a title="(r: CopyPropagation.this.Record,f: CopyPropagation.this.global.Symbol)Option[CopyPropagation.this.Value]" id="155145">getFieldNonRecordValue</a>(<a title="CopyPropagation.this.Record" id="155452">r</a>: <a href="#155418" title="CopyPropagation.this.Record">Record</a>, <a title="CopyPropagation.this.global.Symbol" id="155453">f</a>: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>): <span title="Option[CopyPropagation.this.Value]">Option</span>[Value] = {
        <span title="(assertion: Boolean,message: =&gt; Any)Unit">assert</span>(<a href="#155452" title="CopyPropagation.this.Record">r</a>.<a href="#342083" title="=&gt; scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">bindings</a>.<span title="(key: CopyPropagation.this.global.Symbol)Boolean">isDefinedAt</span>(<a href="#155453" title="CopyPropagation.this.global.Symbol">f</a>),
            <span title="(x$1: Any)java.lang.String" class="string">&quot;Record &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#155452" title="CopyPropagation.this.Record">r</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; does not contain a field &quot;)" class="string">&quot; does not contain a field &quot;</span> + <a href="#155453" title="CopyPropagation.this.global.Symbol">f</a>);

        <span class="keyword">var</span> <a title="CopyPropagation.this.Value" id="340635">target</a>: <a href="#154950" title="CopyPropagation.this.Value">Value</a> = <a href="#155452" title="CopyPropagation.this.Record">r</a>.<a href="#342083" title="(key: CopyPropagation.this.global.Symbol)CopyPropagation.this.Value">bindings</a>(<a href="#155453" title="CopyPropagation.this.global.Symbol">f</a>)
        <a href="#340635" title="CopyPropagation.this.Value">target</a> <span title="Option[CopyPropagation.this.Value]" class="keyword">match</span> {
          <span title="Option[CopyPropagation.this.Value]" class="keyword">case</span> Deref(LocalVar(<a title="CopyPropagation.this.global.icodes.Local" id="340669">l</a>)) =&gt; 
            <span class="keyword">val</span> <a title="CopyPropagation.this.global.icodes.Local" id="340674">alias</a> = <a href="#155141" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.global.icodes.Local">getAlias</a>(<a href="#340669" title="CopyPropagation.this.global.icodes.Local">l</a>)
            <a href="#155142" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.Value">getBinding</a>(<a href="#340674" title="CopyPropagation.this.global.icodes.Local">alias</a>) <span title="Option[CopyPropagation.this.Value]" class="keyword">match</span> {
              <span title="Some[CopyPropagation.this.Deref]" class="keyword">case</span> Record(_, _) =&gt; <span title="(x: CopyPropagation.this.Deref)Some[CopyPropagation.this.Deref]">Some</span>(<a href="#155238" title="(l: CopyPropagation.this.Location)CopyPropagation.this.Deref">Deref</a>(<a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a>(<a href="#340674" title="CopyPropagation.this.global.icodes.Local">alias</a>)))
              <span title="Option[CopyPropagation.this.Value]" class="keyword">case</span> Deref(Field(<a title="CopyPropagation.this.Record" id="340701">r1</a>, <a title="CopyPropagation.this.global.Symbol" id="340702">f1</a>)) =&gt; 
                <a href="#155145" title="(r: CopyPropagation.this.Record,f: CopyPropagation.this.global.Symbol)Option[CopyPropagation.this.Value]">getFieldNonRecordValue</a><span title="(alternative: =&gt; Option[CopyPropagation.this.Value])Option[CopyPropagation.this.Value]">(</span><a href="#340701" title="CopyPropagation.this.Record">r1</a>, <a href="#340702" title="CopyPropagation.this.global.Symbol">f1</a>) orElse <span title="(x: CopyPropagation.this.Deref)Some[CopyPropagation.this.Deref]">Some</span>(<a href="#155238" title="(l: CopyPropagation.this.Location)CopyPropagation.this.Deref">Deref</a>(<a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a>(<a href="#340674" title="CopyPropagation.this.global.icodes.Local">alias</a>))) 
              <span title="Some[CopyPropagation.this.Value]" class="keyword">case</span> <a title="CopyPropagation.this.Value" id="340733">v</a> =&gt; <span title="(x: CopyPropagation.this.Value)Some[CopyPropagation.this.Value]">Some</span>(<a href="#340733" title="CopyPropagation.this.Value">v</a>) 
            }
          <span title="Option[CopyPropagation.this.Value]" class="keyword">case</span> Deref(Field(<a title="CopyPropagation.this.Record" id="340739">r1</a>, <a title="CopyPropagation.this.global.Symbol" id="340740">f1</a>)) =&gt; 
            <a href="#155145" title="(r: CopyPropagation.this.Record,f: CopyPropagation.this.global.Symbol)Option[CopyPropagation.this.Value]">getFieldNonRecordValue</a><span title="(alternative: =&gt; Option[CopyPropagation.this.Value])Option[CopyPropagation.this.Value]">(</span><a href="#340739" title="CopyPropagation.this.Record">r1</a>, <a href="#340740" title="CopyPropagation.this.global.Symbol">f1</a>) orElse <span title="object None">None</span>
          <span title="Some[CopyPropagation.this.Value]" class="keyword">case</span> Deref(<a href="#340103" title="object CopyPropagation.this.This">This</a>) =&gt; <span title="(x: CopyPropagation.this.Value)Some[CopyPropagation.this.Value]">Some</span>(<a href="#340635" title="CopyPropagation.this.Value">target</a>)
          <span title="Some[CopyPropagation.this.Value]" class="keyword">case</span> Const(<a title="CopyPropagation.this.global.Constant" id="340761">k</a>)    =&gt; <span title="(x: CopyPropagation.this.Value)Some[CopyPropagation.this.Value]">Some</span>(<a href="#340635" title="CopyPropagation.this.Value">target</a>)
          <span title="None.type" class="keyword">case</span> _           =&gt; <span title="object None">None</span>
        }
      }

      <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="155146">toString</a>(): <span title="String">String</span> =
        <span title="(x$1: Any)java.lang.String" class="string">&quot;\nBindings: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#340351" title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings">bindings</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012Stack: &quot;)" class="string">&quot;\nStack: &quot;</span> + <a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>;

      <span class="keyword">def</span> <a title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State" id="155147">dup</a>: <a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">State</a> = {
        <span class="keyword">val</span> <a title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings" id="340778">b</a>: <span title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings">Bindings</span> = <span title="scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]">HashMap</span>()
        <a href="#340778" title="(iter: Traversable[(CopyPropagation.this.Location, CopyPropagation.this.Value)])b.type">b</a> ++= <a href="#340351" title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings">bindings</a>
        <span title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State" class="keyword">new</span> <a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">State</a>(<a href="#340778" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings">b</a>, <a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>)
      }
    }

    <span class="keyword">type</span> <a title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State" id="154979">Elem</a> = <a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">State</a>

    <span class="keyword">val</span> <a title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State" id="154980">top</a>    = <span title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State" class="keyword">new</span> <a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">State</a>(<a href="#154977" title="=&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]">emptyBinding</a>, <span title="object Nil">Nil</span>)
    <span class="keyword">val</span> <a title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State" id="154982">bottom</a> = <span title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State" class="keyword">new</span> <a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">State</a>(<a href="#154977" title="=&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]">emptyBinding</a>, <span title="object Nil">Nil</span>)

    <span class="keyword">val</span> <a title="List[object CopyPropagation.this.Unknown]" id="154984">exceptionHandlerStack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#340362" title="CopyPropagation.this.Unknown.type">::</a> <span title="(x: object CopyPropagation.this.Unknown)List[object CopyPropagation.this.Unknown]">Nil</span>

    <span class="keyword">def</span> <a title="(a: scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem,b: scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem)scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem" id="154986">lub2</a>(<a title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem" id="340796">a</a>: <a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">Elem</a>, <a title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem" id="340797">b</a>: <a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">Elem</a>): <a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">Elem</a> = {
      <span title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem" class="keyword">if</span> (<a href="#340796" title="(x$1: AnyRef)Boolean">a</a> eq <a href="#154982" title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">bottom</a>)      <a href="#340797" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">b</a>
      <span class="keyword">else</span> <span title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem" class="keyword">if</span> (<a href="#340797" title="(x$1: AnyRef)Boolean">b</a> eq <a href="#154982" title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">bottom</a>) <a href="#340796" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">a</a>
      <span class="keyword">else</span> <span title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem" class="keyword">if</span> (<a href="#340796" title="(x$1: AnyRef)Boolean">a</a> == <a href="#340797" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">b</a>) <a href="#340796" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">a</a>
      <span class="keyword">else</span> {
        <span class="keyword">val</span> <a title="List[CopyPropagation.this.Value]" id="340811">resStack</a> = 
          <span title="List[CopyPropagation.this.Value]" class="keyword">if</span> (<a href="#340796" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">a</a>.<a href="#340352" title="(x$1: AnyRef)Boolean">stack</a> eq <a href="#154984" title="=&gt; List[object CopyPropagation.this.Unknown]">exceptionHandlerStack</a>) <a href="#340796" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">a</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>
          <span class="keyword">else</span> <span title="List[CopyPropagation.this.Value]" class="keyword">if</span> (<a href="#340797" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">b</a>.<a href="#340352" title="(x$1: AnyRef)Boolean">stack</a> eq <a href="#154984" title="=&gt; List[object CopyPropagation.this.Unknown]">exceptionHandlerStack</a>) <a href="#340797" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">b</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>
          <span class="keyword">else</span> {
//            if (a.stack.length != b.stack.length)
//              throw new LubError(a, b, &quot;Invalid stacks in states: &quot;);
            <span title="object List">List</span>.<a title="(xs: List[CopyPropagation.this.Value],ys: List[CopyPropagation.this.Value])(f: (CopyPropagation.this.Value, CopyPropagation.this.Value) =&gt; CopyPropagation.this.Value)List[CopyPropagation.this.Value]" id="24375">map2</a>(<a href="#340796" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">a</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>, <a href="#340797" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">b</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>) { (<a title="CopyPropagation.this.Value" id="340831">v1</a>, <a title="CopyPropagation.this.Value" id="340832">v2</a>) =&gt; 
              <span title="CopyPropagation.this.Value" class="keyword">if</span> (<a href="#340831" title="(x$1: AnyRef)Boolean">v1</a> == <a href="#340832" title="CopyPropagation.this.Value">v2</a>) <a href="#340831" title="CopyPropagation.this.Value">v1</a> <span class="keyword">else</span> <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> 
            }
          }
      
/*        if (a.stack.length != b.stack.length)
          throw new LubError(a, b, &quot;Invalid stacks in states: &quot;);
        val resStack = List.map2(a.stack, b.stack) { (v1, v2) =&gt; 
          if (v1 == v2) v1 else Unknown 
        }
        */
        <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]" id="340812">resBindings</a> = <span title="scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]">HashMap</span>[Location, Value]
        
        <span class="keyword">for</span> ((<a title="CopyPropagation.this.Location" id="340914">k</a>, <a title="CopyPropagation.this.Value" id="340915">v</a>) &lt;- <a href="#340796" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">a</a>.<a href="#340351" title="(f: ((CopyPropagation.this.Location, CopyPropagation.this.Value)) =&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value])Unit" id="25431">bindings</a> <span class="keyword">if</span> <a href="#340797" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">b</a>.<a href="#340351" title="=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings">bindings</a>.<span title="(key: CopyPropagation.this.Location)Boolean">isDefinedAt</span><span title="(x$1: Boolean)Boolean">(</span><a href="#340914" title="CopyPropagation.this.Location">k</a>) &amp;&amp; <a href="#340915" title="(x$1: AnyRef)Boolean">v</a> == <a href="#340797" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem">b</a>.<a href="#340351" title="(key: CopyPropagation.this.Location)CopyPropagation.this.Value">bindings</a>(<a href="#340914" title="CopyPropagation.this.Location">k</a>))
          <a href="#340812" title="(kv: (CopyPropagation.this.Location, CopyPropagation.this.Value))resBindings.type">resBindings</a> += (<a href="#340914" title="(y: CopyPropagation.this.Value)(CopyPropagation.this.Location, CopyPropagation.this.Value)">k</a> -&gt; <a href="#340915" title="CopyPropagation.this.Value">v</a>);
        <span title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State" class="keyword">new</span> <a href="#154978" title="scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State">State</a>(<a href="#340812" title="scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]">resBindings</a>, <a href="#340811" title="List[CopyPropagation.this.Value]">resStack</a>)
      }
    }
  }

  <span class="keyword">final</span> <span class="keyword">class</span> <a title="class CopyAnalysis extends java.lang.Object with scala.tools.nsc.backend.icode.analysis.DataFlowAnalysis[CopyPropagation.this.copyLattice.type] with ScalaObject" id="154969">CopyAnalysis</a> <span title="ScalaObject" class="keyword">extends</span> <a href="DataFlowAnalysis.scala.html#15920" title="scala.tools.nsc.backend.icode.analysis.DataFlowAnalysis[CopyPropagation.this.copyLattice.type]">DataFlowAnalysis</a>[copyLattice.<span class="keyword">type</span>] {
    <span class="keyword">type</span> <a title="CopyPropagation.this.global.icodes.BasicBlock" id="154988">P</a> = <a href="../BasicBlocks.scala.html#46178" title="CopyPropagation.this.global.icodes.BasicBlock">BasicBlock</a>
    <span class="keyword">val</span> <a title="CopyPropagation.this.copyLattice.type" id="154989">lattice</a> = <a href="#154967" title="object CopyPropagation.this.copyLattice">copyLattice</a>

    <span class="keyword">var</span> <a title="CopyPropagation.this.global.icodes.IMethod" id="154992">method</a>: <a href="../Members.scala.html#46173" title="CopyPropagation.this.global.icodes.IMethod">IMethod</a> = _

    <span class="keyword">def</span> <a title="(m: CopyPropagation.this.global.icodes.IMethod)Unit" id="154994">init</a>(<a title="CopyPropagation.this.global.icodes.IMethod" id="155096">m</a>: <a href="../Members.scala.html#46173" title="CopyPropagation.this.global.icodes.IMethod">IMethod</a>) {
      <a href="#154969" title="CopyAnalysis.this.type" class="keyword">this</a>.<a href="#154992" title="(x$1: CopyPropagation.this.global.icodes.IMethod)Unit">method</a> = <a href="#155096" title="CopyPropagation.this.global.icodes.IMethod">m</a>

      <a href="DataFlowAnalysis.scala.html#61163" title="(f: =&gt; Unit)Unit">init</a> {
        <a href="DataFlowAnalysis.scala.html#61149" title="(elem: CopyAnalysis.this.P)CopyAnalysis.this.worklist.type" id="39463">worklist</a> += <a href="#155096" title="CopyPropagation.this.global.icodes.IMethod">m</a>.<a href="../Members.scala.html#61228" title="=&gt; CopyPropagation.this.global.icodes.Code">code</a>.<a href="../Members.scala.html#61392" title="=&gt; CopyPropagation.this.global.icodes.BasicBlock">startBlock</a>
        <a href="DataFlowAnalysis.scala.html#61149" title="(iter: Traversable[CopyAnalysis.this.P])CopyAnalysis.this.worklist.type">worklist</a> ++= (<a href="#155096" title="CopyPropagation.this.global.icodes.IMethod">m</a>.<a href="../Members.scala.html#61234" title="(f: (CopyPropagation.this.global.icodes.ExceptionHandler) =&gt; CopyPropagation.this.global.icodes.BasicBlock)(implicit bf: scala.collection.generic.BuilderFactory[CopyPropagation.this.global.icodes.BasicBlock,List[CopyPropagation.this.global.icodes.BasicBlock],List[CopyPropagation.this.global.icodes.ExceptionHandler]])List[CopyPropagation.this.global.icodes.BasicBlock]">exh</a> <span title="scala.collection.generic.BuilderFactory[CopyPropagation.this.global.icodes.BasicBlock,List[CopyPropagation.this.global.icodes.BasicBlock],List#Coll]">map</span> (<a href="#341022" title="CopyPropagation.this.global.icodes.ExceptionHandler">_</a>.<a href="../ExceptionHandlers.scala.html#61445" title="=&gt; CopyPropagation.this.global.icodes.BasicBlock">startBlock</a>))
        <a href="#155096" title="CopyPropagation.this.global.icodes.IMethod">m</a>.<a href="../Members.scala.html#61228" title="=&gt; CopyPropagation.this.global.icodes.Code">code</a>.<a href="../Members.scala.html#61390" title="=&gt; scala.collection.mutable.ListBuffer[CopyPropagation.this.global.icodes.BasicBlock]">blocks</a>.<a title="(f: (CopyPropagation.this.global.icodes.BasicBlock) =&gt; Unit)Unit" id="61746">foreach</a> { <a title="CopyPropagation.this.global.icodes.BasicBlock" id="341128">b</a> =&gt;
          <a href="DataFlowAnalysis.scala.html#61151" title="(key: CopyAnalysis.this.P,value: CopyAnalysis.this.lattice.Elem)Unit">in</a>(<a href="#341128" title="CopyPropagation.this.global.icodes.BasicBlock">b</a>)  = <a href="#154989" title="=&gt; CopyPropagation.this.copyLattice.type">lattice</a>.<a href="#154982" title="=&gt; CopyAnalysis.this.lattice.State">bottom</a>
          <a href="DataFlowAnalysis.scala.html#61153" title="(key: CopyAnalysis.this.P,value: CopyAnalysis.this.lattice.Elem)Unit">out</a>(<a href="#341128" title="CopyPropagation.this.global.icodes.BasicBlock">b</a>) = <a href="#154989" title="=&gt; CopyPropagation.this.copyLattice.type">lattice</a>.<a href="#154982" title="=&gt; CopyAnalysis.this.lattice.State">bottom</a>
          <a title="(assertion: Boolean)Unit" id="7874">assert</a>(<a href="DataFlowAnalysis.scala.html#61153" title="=&gt; scala.collection.mutable.Map[CopyAnalysis.this.P,CopyAnalysis.this.lattice.Elem]">out</a>.<a title="(key: CopyAnalysis.this.P)Boolean" id="44446">contains</a>(<a href="#341128" title="CopyPropagation.this.global.icodes.BasicBlock">b</a>))
          <a href="../../../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;Added point: &quot;</span> + <a href="#341128" title="CopyPropagation.this.global.icodes.BasicBlock">b</a>)
        } 
        <a href="#155096" title="CopyPropagation.this.global.icodes.IMethod">m</a>.<a href="../Members.scala.html#61234" title="(f: (CopyPropagation.this.global.icodes.ExceptionHandler) =&gt; Unit)Unit">exh</a> foreach { <a title="CopyPropagation.this.global.icodes.ExceptionHandler" id="341168">e</a> =&gt;
          <a href="DataFlowAnalysis.scala.html#61151" title="(key: CopyAnalysis.this.P,value: CopyAnalysis.this.lattice.Elem)Unit">in</a>(<a href="#341168" title="CopyPropagation.this.global.icodes.ExceptionHandler">e</a>.<a href="../ExceptionHandlers.scala.html#61445" title="=&gt; CopyPropagation.this.global.icodes.BasicBlock">startBlock</a>) = <span title="CopyPropagation.this.copyLattice.State" class="keyword">new</span> <a href="#154967" title="object CopyPropagation.this.copyLattice">copyLattice</a>.<a href="#154978" title="CopyPropagation.this.copyLattice.State">State</a>(<a href="#154967" title="object CopyPropagation.this.copyLattice">copyLattice</a>.<a href="#154977" title="=&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]">emptyBinding</a>, <a href="#154967" title="object CopyPropagation.this.copyLattice">copyLattice</a>.<a href="#154984" title="=&gt; List[object CopyPropagation.this.Unknown]">exceptionHandlerStack</a>);
        }

        // first block is special: it's not bottom, but a precisely defined state with no bindings
        <a href="DataFlowAnalysis.scala.html#61151" title="(key: CopyAnalysis.this.P,value: CopyAnalysis.this.lattice.Elem)Unit">in</a>(<a href="#155096" title="CopyPropagation.this.global.icodes.IMethod">m</a>.<a href="../Members.scala.html#61228" title="=&gt; CopyPropagation.this.global.icodes.Code">code</a>.<a href="../Members.scala.html#61392" title="=&gt; CopyPropagation.this.global.icodes.BasicBlock">startBlock</a>) = <span title="CopyAnalysis.this.lattice.State" class="keyword">new</span> <a href="#154989" title="=&gt; CopyPropagation.this.copyLattice.type">lattice</a>.<a href="#154978" title="CopyAnalysis.this.lattice.State">State</a>(<a href="#154989" title="=&gt; CopyPropagation.this.copyLattice.type">lattice</a>.<a href="#154977" title="=&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]">emptyBinding</a>, <span title="object Nil">Nil</span>);
      }
    }

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Unit" id="154995">run</a> {
      <a href="DataFlowAnalysis.scala.html#61166" title="(f: (CopyAnalysis.this.P, CopyAnalysis.this.lattice.Elem) =&gt; CopyAnalysis.this.lattice.Elem)Unit">forwardAnalysis</a>(<a href="#154996" title="(b: CopyPropagation.this.global.icodes.BasicBlock,in: CopyAnalysis.this.lattice.Elem)CopyAnalysis.this.lattice.Elem">blockTransfer</a>)
      <span title="Unit" class="keyword">if</span> (<a href="../../../Global.scala.html#39018" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../../Settings.scala.html#37150" title="=&gt; scala.tools.nsc.Settings.BooleanSetting">debug</a>.<a href="../../../Settings.scala.html#37759" title="=&gt; Boolean">value</a>) {
        <a href="../ICodes.scala.html#46149" title="=&gt; CopyPropagation.this.global.icodes.Linearizer">linearizer</a>.<a href="../Linearizers.scala.html#62209" title="(c: CopyPropagation.this.global.icodes.IMethod)List[CopyPropagation.this.global.icodes.BasicBlock]">linearize</a>(<a href="#154992" title="=&gt; CopyPropagation.this.global.icodes.IMethod">method</a>).<span title="(f: (CopyPropagation.this.global.icodes.BasicBlock) =&gt; Unit)Unit">foreach</span>(<a title="CopyPropagation.this.global.icodes.BasicBlock" id="341223">b</a> =&gt; <span title="Unit" class="keyword">if</span> (<a href="#341223" title="(x$1: AnyRef)Boolean">b</a> != <a href="#154992" title="=&gt; CopyPropagation.this.global.icodes.IMethod">method</a>.<a href="../Members.scala.html#61228" title="=&gt; CopyPropagation.this.global.icodes.Code">code</a>.<a href="../Members.scala.html#61392" title="=&gt; CopyPropagation.this.global.icodes.BasicBlock">startBlock</a>)
          <span title="(assertion: Boolean,message: =&gt; Any)Unit">assert</span>(<a href="DataFlowAnalysis.scala.html#61151" title="(key: CopyAnalysis.this.P)CopyAnalysis.this.lattice.Elem">in</a><span title="(x$1: AnyRef)Boolean">(</span><a href="#341223" title="CopyPropagation.this.global.icodes.BasicBlock">b</a>) != <a href="#154989" title="=&gt; CopyPropagation.this.copyLattice.type">lattice</a>.<a href="#154982" title="=&gt; CopyAnalysis.this.lattice.State">bottom</a>, 
            <span title="(x$1: Any)java.lang.String" class="string">&quot;Block &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#341223" title="CopyPropagation.this.global.icodes.BasicBlock">b</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; in &quot;)" class="string">&quot; in &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#154969" title="CopyAnalysis.this.type" class="keyword">this</a>.<a href="#154992" title="=&gt; CopyPropagation.this.global.icodes.IMethod">method</a> + <span title="java.lang.String(&quot; has input equal to bottom -- not visited?&quot;)" class="string">&quot; has input equal to bottom -- not visited?&quot;</span>));
      }
    }

    <span class="keyword">def</span> <a title="(b: CopyPropagation.this.global.icodes.BasicBlock,in: CopyAnalysis.this.lattice.Elem)CopyAnalysis.this.lattice.Elem" id="154996">blockTransfer</a>(<a title="CopyPropagation.this.global.icodes.BasicBlock" id="341191">b</a>: <a href="../BasicBlocks.scala.html#46178" title="CopyPropagation.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="CopyAnalysis.this.lattice.Elem" id="341192">in</a>: lattice.<a href="#154978" title="CopyAnalysis.this.lattice.Elem">Elem</a>): lattice.<a href="#154978" title="CopyAnalysis.this.lattice.Elem">Elem</a> =
      <a href="#341191" title="CopyPropagation.this.global.icodes.BasicBlock">b</a>.<a href="../BasicBlocks.scala.html#61313" title="=&gt; List[CopyPropagation.this.global.icodes.Instruction]">toList</a>.<a title="(z: CopyAnalysis.this.lattice.Elem)(f: (CopyAnalysis.this.lattice.Elem, CopyPropagation.this.global.icodes.Instruction) =&gt; CopyAnalysis.this.lattice.Elem)CopyAnalysis.this.lattice.Elem" id="28943">foldLeft</a>(<a href="#341192" title="CopyAnalysis.this.lattice.Elem">in</a>)(<a href="#154998" title="(in: CopyPropagation.this.copyLattice.Elem,i: CopyPropagation.this.global.icodes.Instruction)CopyPropagation.this.copyLattice.Elem">interpret</a>)
    
    <span class="keyword">import</span> opcodes._

    /** Abstract interpretation for one instruction. */
    <span class="keyword">def</span> <a title="(in: CopyPropagation.this.copyLattice.Elem,i: CopyPropagation.this.global.icodes.Instruction)CopyPropagation.this.copyLattice.Elem" id="154998">interpret</a>(<a title="CopyPropagation.this.copyLattice.Elem" id="155865">in</a>: copyLattice.<a href="#154978" title="CopyPropagation.this.copyLattice.Elem">Elem</a>, <a title="CopyPropagation.this.global.icodes.Instruction" id="155866">i</a>: <a href="../Opcodes.scala.html#46182" title="CopyPropagation.this.global.icodes.Instruction">Instruction</a>): copyLattice.<a href="#154978" title="CopyPropagation.this.copyLattice.Elem">Elem</a> = {
      <span class="keyword">var</span> <a title="CopyPropagation.this.copyLattice.State" id="341292">out</a> = <a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>.<a href="#155147" title="=&gt; CopyPropagation.this.copyLattice.State">dup</a>

      <span title="Unit" class="keyword">if</span> (<a href="../../../Global.scala.html#39018" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../../Settings.scala.html#37150" title="=&gt; scala.tools.nsc.Settings.BooleanSetting">debug</a>.<a href="../../../Settings.scala.html#37759" title="=&gt; Boolean">value</a>) {
        <a href="../../../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;- &quot;</span> + <a href="#155866" title="CopyPropagation.this.global.icodes.Instruction">i</a>)
        <a href="../../../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;in: &quot;</span> + <a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>)
        <a href="../../../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>)
      }

      <a href="#155866" title="CopyPropagation.this.global.icodes.Instruction">i</a> <span title="Any" class="keyword">match</span> {
        <span title="Unit" class="keyword">case</span> THIS(_) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#155238" title="(l: CopyPropagation.this.Location)CopyPropagation.this.Deref">Deref</a>(<a href="#340103" title="object CopyPropagation.this.This">This</a>) <a href="#341308" title="CopyPropagation.this.Deref">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">stack</a>

        <span title="Unit" class="keyword">case</span> CONSTANT(<a title="CopyPropagation.this.global.icodes.global.Constant" id="341325">k</a>) =&gt;
          <span title="Unit" class="keyword">if</span> (<a href="#341325" title="CopyPropagation.this.global.icodes.global.Constant">k</a>.<a href="../../../symtab/Constants.scala.html#42809" title="(x$1: Int)Boolean" id="2954">tag</a> != <span title="Int(1)">UnitTag</span>)
            <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#155914" title="(c: CopyPropagation.this.global.Constant)CopyPropagation.this.Const">Const</a>(<a href="#341325" title="CopyPropagation.this.global.icodes.global.Constant">k</a>) <a href="#341334" title="CopyPropagation.this.Const">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">stack</a>;
          
        <span title="Unit" class="keyword">case</span> LOAD_ARRAY_ITEM(_) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = (<a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#341356" title="CopyPropagation.this.Unknown.type">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span><span title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">(</span><span title="Int(2)" class="int">2</span>))

        <span title="Unit" class="keyword">case</span> LOAD_LOCAL(<a title="CopyPropagation.this.global.icodes.Local" id="341370">local</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#155238" title="(l: CopyPropagation.this.Location)CopyPropagation.this.Deref">Deref</a>(<a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a>(<a href="#341370" title="CopyPropagation.this.global.icodes.Local">local</a>)) <a href="#341373" title="CopyPropagation.this.Deref">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">stack</a>

        <span title="Unit" class="keyword">case</span> LOAD_FIELD(<a title="CopyPropagation.this.global.icodes.global.Symbol" id="341397">field</a>, <a title="Boolean" id="341398">isStatic</a>) =&gt;
          <span title="Unit" class="keyword">if</span> (<a href="#341398" title="Boolean">isStatic</a>)
            <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#341401" title="CopyPropagation.this.Unknown.type">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">stack</a>; /* ignore static fields */
          <span class="keyword">else</span> {
            <span class="keyword">val</span> <a title="CopyPropagation.this.Value" id="341411">v1</a> = <a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a> <span title="CopyPropagation.this.Value" class="keyword">match</span> {
              <span title="CopyPropagation.this.Deref" class="keyword">case</span> (<a title="CopyPropagation.this.Record" id="341416">r</a> @ Record(<a title="CopyPropagation.this.global.Symbol" id="341417">cls</a>, <a title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" id="341418">bindings</a>)) :: <a title="List[CopyPropagation.this.Value]" id="341421">xs</a> =&gt;
                <a href="#155238" title="(l: CopyPropagation.this.Location)CopyPropagation.this.Deref">Deref</a>(<a href="#155588" title="(r: CopyPropagation.this.Record,sym: CopyPropagation.this.global.Symbol)CopyPropagation.this.Field">Field</a>(<a href="#341416" title="CopyPropagation.this.Record">r</a>, <a href="#341397" title="CopyPropagation.this.global.icodes.global.Symbol">field</a>))
              
              <span title="&lt;refinement&gt; extends Product with CopyPropagation.this.Value" class="keyword">case</span> Deref(LocalVar(<a title="CopyPropagation.this.global.icodes.Local" id="341449">l</a>)) :: _ =&gt;
                <a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>.<a href="#155142" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.Value">getBinding</a>(<a href="#341449" title="CopyPropagation.this.global.icodes.Local">l</a>) <span title="&lt;refinement&gt; extends Product with CopyPropagation.this.Value" class="keyword">match</span> {
                  <span title="CopyPropagation.this.Deref" class="keyword">case</span> <a title="CopyPropagation.this.Record" id="341460">r</a> @ Record(<a title="CopyPropagation.this.global.Symbol" id="341461">cls</a>, <a title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" id="341462">bindings</a>) =&gt; <a href="#155238" title="(l: CopyPropagation.this.Location)CopyPropagation.this.Deref">Deref</a>(<a href="#155588" title="(r: CopyPropagation.this.Record,sym: CopyPropagation.this.global.Symbol)CopyPropagation.this.Field">Field</a>(<a href="#341460" title="CopyPropagation.this.Record">r</a>, <a href="#341397" title="CopyPropagation.this.global.icodes.global.Symbol">field</a>))
                  <span title="CopyPropagation.this.Unknown.type" class="keyword">case</span> _ =&gt; <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a>
                }
                
              <span title="CopyPropagation.this.Value" class="keyword">case</span> Deref(Field(<a title="CopyPropagation.this.Record" id="341496">r</a>, <a title="CopyPropagation.this.global.Symbol" id="341497">f</a>)) :: _ =&gt;
                <span class="keyword">val</span> <a title="Option[CopyPropagation.this.Value]" id="341504">fld</a> = <a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>.<a href="#155144" title="(r: CopyPropagation.this.Record,f: CopyPropagation.this.global.Symbol)Option[CopyPropagation.this.Value]">getFieldValue</a>(<a href="#341496" title="CopyPropagation.this.Record">r</a>, <a href="#341497" title="CopyPropagation.this.global.Symbol">f</a>)
                <a href="#341504" title="Option[CopyPropagation.this.Value]">fld</a> <span title="CopyPropagation.this.Value" class="keyword">match</span> {
                  <span title="CopyPropagation.this.Value" class="keyword">case</span> Some(<a title="CopyPropagation.this.Record" id="341508">r</a> @ Record(<a title="CopyPropagation.this.global.Symbol" id="341509">cls</a>, <a title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" id="341510">bindings</a>)) <span class="keyword">if</span> <a href="#341510" title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">bindings</a>.<span title="(key: CopyPropagation.this.global.Symbol)Boolean">isDefinedAt</span>(<a href="#341497" title="CopyPropagation.this.global.Symbol">f</a>) =&gt;
                  	<a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>.<a href="#155144" title="(r: CopyPropagation.this.Record,f: CopyPropagation.this.global.Symbol)Option[CopyPropagation.this.Value]">getFieldValue</a>(<a href="#341508" title="CopyPropagation.this.Record">r</a>, <a href="#341497" title="CopyPropagation.this.global.Symbol">f</a>).<a title="(default: =&gt; CopyPropagation.this.Value)CopyPropagation.this.Value" id="35047">getOrElse</a>(<a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a>)
                  <span title="CopyPropagation.this.Unknown.type" class="keyword">case</span> _ =&gt; <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a>
                }
                
              <span title="CopyPropagation.this.Unknown.type" class="keyword">case</span> _ =&gt; <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a>
            }
            <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341411" title="CopyPropagation.this.Value">v1</a> <a href="#341529" title="CopyPropagation.this.Value">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span><span title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">(</span><span title="Int(1)" class="int">1</span>)
          }
            
        <span title="Unit" class="keyword">case</span> LOAD_MODULE(<a title="CopyPropagation.this.global.icodes.global.Symbol" id="341543">module</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#341546" title="CopyPropagation.this.Unknown.type">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">stack</a>
          
        <span title="Unit" class="keyword">case</span> STORE_ARRAY_ITEM(<a title="CopyPropagation.this.global.icodes.TypeKind" id="341557">kind</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(3)" class="int">3</span>)

        <span title="Unit" class="keyword">case</span> STORE_LOCAL(<a title="CopyPropagation.this.global.icodes.Local" id="341566">local</a>) =&gt;
          <a href="#154999" title="(s: CopyPropagation.this.copyLattice.State,target: CopyPropagation.this.Location)Unit">cleanReferencesTo</a>(<a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>, <a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a>(<a href="#341566" title="CopyPropagation.this.global.icodes.Local">local</a>))
          <a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a> <span title="Any" class="keyword">match</span> {
            <span title="Unit" class="keyword">case</span> <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> :: <a title="List[CopyPropagation.this.Value]" id="341584">xs</a> =&gt; <span title="Unit">(</span>)
            <span title="Any" class="keyword">case</span> <a title="CopyPropagation.this.Value" id="341591">v</a> :: <a title="List[CopyPropagation.this.Value]" id="341592">vs</a> =&gt; 
              <a href="#341591" title="CopyPropagation.this.Value">v</a> <span title="Any" class="keyword">match</span> {
                <span title="Any" class="keyword">case</span> Deref(LocalVar(<a title="CopyPropagation.this.global.icodes.Local" id="341595">other</a>)) =&gt;
                  <span title="Any" class="keyword">if</span> (<a href="#341595" title="(x$1: AnyRef)Boolean">other</a> != <a href="#341566" title="CopyPropagation.this.global.icodes.Local">local</a>) 
                    <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340351" title="(kv: (CopyPropagation.this.Location, CopyPropagation.this.Value))scala.collection.mutable.Map[CopyPropagation.this.Location,CopyPropagation.this.Value]">bindings</a> += (<a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a><span title="(y: CopyPropagation.this.Value)(CopyPropagation.this.LocalVar, CopyPropagation.this.Value)">(</span><a href="#341566" title="CopyPropagation.this.global.icodes.Local">local</a>) -&gt; <a href="#341591" title="CopyPropagation.this.Value">v</a>);
                <span title="scala.collection.mutable.Map[CopyPropagation.this.Location,CopyPropagation.this.Value]" class="keyword">case</span> _ =&gt;
                  <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340351" title="(kv: (CopyPropagation.this.Location, CopyPropagation.this.Value))scala.collection.mutable.Map[CopyPropagation.this.Location,CopyPropagation.this.Value]">bindings</a> += (<a href="#155197" title="(l: CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar">LocalVar</a><span title="(y: CopyPropagation.this.Value)(CopyPropagation.this.LocalVar, CopyPropagation.this.Value)">(</span><a href="#341566" title="CopyPropagation.this.global.icodes.Local">local</a>) -&gt; <a href="#341591" title="CopyPropagation.this.Value">v</a>)
              }
            <span title="Nothing" class="keyword">case</span> <span title="object Nil">Nil</span> =&gt;
              <span title="object Predef">Predef</span>.<a title="(message: String)Nothing" id="7869">error</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;Incorrect icode in &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#154992" title="=&gt; CopyPropagation.this.global.icodes.IMethod">method</a> + <span title="java.lang.String(&quot;. Expecting something on the stack.&quot;)" class="string">&quot;. Expecting something on the stack.&quot;</span>)
          }
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(n: Int)List[CopyPropagation.this.Value]">stack</a> drop <span title="Int(1)" class="int">1</span>;
          
        <span title="Unit" class="keyword">case</span> STORE_THIS(_) =&gt;
          <a href="#154999" title="(s: CopyPropagation.this.copyLattice.State,target: CopyPropagation.this.Location)Unit">cleanReferencesTo</a>(<a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>, <a href="#340103" title="object CopyPropagation.this.This">This</a>)
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(n: Int)List[CopyPropagation.this.Value]">stack</a> drop <span title="Int(1)" class="int">1</span>
          
        <span title="Any" class="keyword">case</span> STORE_FIELD(<a title="CopyPropagation.this.global.icodes.global.Symbol" id="341748">field</a>, <a title="Boolean" id="341749">isStatic</a>) =&gt;
          <span title="Any" class="keyword">if</span> (<a href="#341749" title="Boolean">isStatic</a>) 
            <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(1)" class="int">1</span>);
          <span class="keyword">else</span> {
            <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(2)" class="int">2</span>);
            <a href="#154999" title="(s: CopyPropagation.this.copyLattice.State,target: CopyPropagation.this.Location)Unit">cleanReferencesTo</a>(<a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>, <a href="#155588" title="(r: CopyPropagation.this.Record,sym: CopyPropagation.this.global.Symbol)CopyPropagation.this.Field">Field</a>(<a href="#154965" title="object CopyPropagation.this.AllRecords">AllRecords</a>, <a href="#341748" title="CopyPropagation.this.global.icodes.global.Symbol">field</a>));
            <a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a> <span title="Any" class="keyword">match</span> {
              <span title="bindings.type" class="keyword">case</span> <a title="CopyPropagation.this.Value" id="341778">v</a> :: Record(_, <a title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" id="341783">bindings</a>) :: <a title="List[CopyPropagation.this.Value]" id="341786">vs</a> =&gt;
                <a href="#341783" title="(kv: (CopyPropagation.this.global.Symbol, CopyPropagation.this.Value))bindings.type">bindings</a> += (<a href="#341748" title="(y: CopyPropagation.this.Value)(CopyPropagation.this.global.icodes.global.Symbol, CopyPropagation.this.Value)">field</a> -&gt; <a href="#341778" title="CopyPropagation.this.Value">v</a>)
              <span title="Unit" class="keyword">case</span> _ =&gt; <span title="Unit">(</span>);
            }
          }
          
        <span title="Unit" class="keyword">case</span> CALL_PRIMITIVE(<a title="CopyPropagation.this.global.icodes.Primitive" id="341841">primitive</a>) =&gt;
          // TODO: model primitives
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#341844" title="CopyPropagation.this.Unknown.type">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span><span title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">(</span><a href="#155866" title="CopyPropagation.this.global.icodes.Instruction">i</a>.<a href="../Opcodes.scala.html#61468" title="=&gt; Int">consumed</a>)

        <span title="Unit" class="keyword">case</span> CALL_METHOD(<a title="CopyPropagation.this.global.icodes.global.Symbol" id="341859">method</a>, <a title="CopyPropagation.this.global.icodes.opcodes.InvokeStyle" id="341860">style</a>) =&gt; <a href="#341860" title="CopyPropagation.this.global.icodes.opcodes.InvokeStyle">style</a> <span title="Unit" class="keyword">match</span> {
          <span title="Unit" class="keyword">case</span> <a href="../Opcodes.scala.html#46441" title="object CopyPropagation.this.global.icodes.opcodes.Dynamic">Dynamic</a> | <a href="../Opcodes.scala.html#46443" title="object CopyPropagation.this.global.icodes.opcodes.InvokeDynamic">InvokeDynamic</a> =&gt;
            <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a> = <a href="#155000" title="(state: CopyPropagation.this.copyLattice.State,method: CopyPropagation.this.global.Symbol,static: Boolean)CopyPropagation.this.copyLattice.State">simulateCall</a>(<a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>, <a href="#341859" title="CopyPropagation.this.global.icodes.global.Symbol">method</a>, <span title="Boolean(false)" class="keyword">false</span>)

          <span title="Unit" class="keyword">case</span> Static(<a title="Boolean" id="341869">onInstance</a>) =&gt;
            <span title="Unit" class="keyword">if</span> (<a href="#341869" title="Boolean">onInstance</a>) {
              <span class="keyword">val</span> <a title="CopyPropagation.this.Value" id="341872">obj</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<a href="#341859" title="CopyPropagation.this.global.icodes.global.Symbol">method</a>.<a href="../../../symtab/Symbols.scala.html#27004" title="=&gt; CopyPropagation.this.global.icodes.global.Type">info</a>.<a href="../../../symtab/Types.scala.html#30200" title="=&gt; List[CopyPropagation.this.global.icodes.global.Type]">paramTypes</a>.<span title="=&gt; Int">length</span>).<span title="=&gt; CopyPropagation.this.Value">head</span>
//              if (method.isPrimaryConstructor) {
              <span title="Unit" class="keyword">if</span> (<a href="#341859" title="CopyPropagation.this.global.icodes.global.Symbol">method</a>.<a href="../../../symtab/Symbols.scala.html#26959" title="=&gt; Boolean">isPrimaryConstructor</a>/* &amp;&amp; isClosureClass(method.owner)*/) {
                <a href="#341872" title="CopyPropagation.this.Value">obj</a> <span title="Unit" class="keyword">match</span> {
                  <span title="Unit" class="keyword">case</span> Record(_, <a title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" id="341878">bindings</a>) =&gt;
                    <span class="keyword">for</span> (<a title="CopyPropagation.this.Value" id="341931">v</a> &lt;- <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">take</span><span title="(f: (CopyPropagation.this.Value) =&gt; scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value])Unit">(</span><a href="#341859" title="CopyPropagation.this.global.icodes.global.Symbol">method</a>.<a href="../../../symtab/Symbols.scala.html#27004" title="=&gt; CopyPropagation.this.global.icodes.global.Type">info</a>.<a href="../../../symtab/Types.scala.html#30200" title="=&gt; List[CopyPropagation.this.global.icodes.global.Type]">paramTypes</a>.<span title="(x$1: Int)Int">length</span> + <span title="Int(1)" class="int">1</span>)
                         <span class="keyword">if</span> <a href="#341931" title="(x$1: AnyRef)Boolean" id="6544">v</a> ne <a href="#341872" title="CopyPropagation.this.Value">obj</a>) {
                       <a href="#341878" title="(iter: Traversable[(CopyPropagation.this.global.Symbol, CopyPropagation.this.Value)])bindings.type">bindings</a> ++= <a href="#155002" title="(in: CopyPropagation.this.copyLattice.State,ctor: CopyPropagation.this.global.Symbol)scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">getBindingsForPrimaryCtor</a>(<a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>, <a href="#341859" title="CopyPropagation.this.global.icodes.global.Symbol">method</a>);
                    }
                  <span title="Unit" class="keyword">case</span> _ =&gt; <span title="Unit">(</span>)
                }
                // put the Record back on the stack and remove the 'returned' value
                <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="(x$1: Int)Int" class="int">1</span> + <a href="#341859" title="CopyPropagation.this.global.icodes.global.Symbol">method</a>.<a href="../../../symtab/Symbols.scala.html#27004" title="=&gt; CopyPropagation.this.global.icodes.global.Type">info</a>.<a href="../../../symtab/Types.scala.html#30200" title="=&gt; List[CopyPropagation.this.global.icodes.global.Type]">paramTypes</a>.<span title="=&gt; Int">length</span>)
              } <span class="keyword">else</span>
                <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a> = <a href="#155000" title="(state: CopyPropagation.this.copyLattice.State,method: CopyPropagation.this.global.Symbol,static: Boolean)CopyPropagation.this.copyLattice.State">simulateCall</a>(<a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>, <a href="#341859" title="CopyPropagation.this.global.icodes.global.Symbol">method</a>, <span title="Boolean(false)" class="keyword">false</span>)
            } <span class="keyword">else</span> 
              <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a> = <a href="#155000" title="(state: CopyPropagation.this.copyLattice.State,method: CopyPropagation.this.global.Symbol,static: Boolean)CopyPropagation.this.copyLattice.State">simulateCall</a>(<a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>, <a href="#341859" title="CopyPropagation.this.global.icodes.global.Symbol">method</a>, <span title="Boolean(true)" class="keyword">true</span>)

          <span title="Unit" class="keyword">case</span> SuperCall(_) =&gt;
            <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a> = <a href="#155000" title="(state: CopyPropagation.this.copyLattice.State,method: CopyPropagation.this.global.Symbol,static: Boolean)CopyPropagation.this.copyLattice.State">simulateCall</a>(<a href="#155865" title="CopyPropagation.this.copyLattice.Elem">in</a>, <a href="#341859" title="CopyPropagation.this.global.icodes.global.Symbol">method</a>, <span title="Boolean(false)" class="keyword">false</span>)
        }
        
        <span title="Unit" class="keyword">case</span> BOX(<a title="CopyPropagation.this.global.icodes.TypeKind" id="341989">tpe</a>) =&gt;
          <span class="keyword">val</span> <a title="CopyPropagation.this.Value" id="341992">top</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="=&gt; CopyPropagation.this.Value">head</span>
          <a href="#341992" title="CopyPropagation.this.Value">top</a> <span title="Unit" class="keyword">match</span> {
            <span title="Unit" class="keyword">case</span> Deref(<a title="CopyPropagation.this.Location" id="341994">loc</a>) =&gt; 
              <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#155690" title="(l: CopyPropagation.this.Location)CopyPropagation.this.Boxed">Boxed</a>(<a href="#341994" title="CopyPropagation.this.Location">loc</a>) <a href="#341997" title="CopyPropagation.this.Boxed">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">tail</span>
            <span title="Unit" class="keyword">case</span> _ =&gt;
              <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#342017" title="CopyPropagation.this.Unknown.type">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span><span title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">(</span><span title="Int(1)" class="int">1</span>)
          }

        <span title="Any" class="keyword">case</span> UNBOX(<a title="CopyPropagation.this.global.icodes.TypeKind" id="342031">tpe</a>) =&gt;
          <span class="keyword">val</span> <a title="CopyPropagation.this.Value" id="342034">top</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="=&gt; CopyPropagation.this.Value">head</span>
          <a href="#342034" title="CopyPropagation.this.Value">top</a> <span title="Any" class="keyword">match</span> {
            <span title="List[CopyPropagation.this.Value]" class="keyword">case</span> Boxed(<a title="CopyPropagation.this.Location" id="342036">loc</a>) =&gt; <a href="#155238" title="(l: CopyPropagation.this.Location)CopyPropagation.this.Deref">Deref</a>(<a href="#342036" title="CopyPropagation.this.Location">loc</a>) <a href="#342039" title="CopyPropagation.this.Deref">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">tail</span>
            <span title="Unit" class="keyword">case</span> _          =&gt; <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#342054" title="CopyPropagation.this.Unknown.type">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span><span title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">(</span><span title="Int(1)" class="int">1</span>)
          }
          
        <span title="Unit" class="keyword">case</span> NEW(<a title="CopyPropagation.this.global.icodes.REFERENCE" id="342074">kind</a>) =&gt;
          <span class="keyword">val</span> <a title="&lt;refinement&gt; extends Product with CopyPropagation.this.Value" id="342077">v1</a> = 
            <a href="#342074" title="CopyPropagation.this.global.icodes.REFERENCE">kind</a> <span title="&lt;refinement&gt; extends Product with CopyPropagation.this.Value" class="keyword">match</span> {
              <span title="CopyPropagation.this.Record" class="keyword">case</span> REFERENCE(<a title="CopyPropagation.this.global.icodes.global.Symbol" id="342079">cls</a>) =&gt;
                <a href="#155418" title="(cls: CopyPropagation.this.global.Symbol,bindings: scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value])CopyPropagation.this.Record">Record</a>(<a href="#342079" title="CopyPropagation.this.global.icodes.global.Symbol">cls</a>, <span title="scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">HashMap</span>[Symbol, Value])
              // bq: changed from _ to null, otherwise would be unreachable
              <span title="CopyPropagation.this.Unknown.type" class="keyword">case</span> <span title="Null(null)" class="keyword">null</span> =&gt;
                <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a>
            }
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#342077" title="&lt;refinement&gt; extends Product with CopyPropagation.this.Value">v1</a> <a href="#342110" title="&lt;refinement&gt; extends Product with CopyPropagation.this.Value">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">stack</a>

        <span title="Unit" class="keyword">case</span> CREATE_ARRAY(<a title="CopyPropagation.this.global.icodes.TypeKind" id="342122">elem</a>, <a title="Int" id="342123">dims</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#342126" title="CopyPropagation.this.Unknown.type">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span><span title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">(</span><a href="#342123" title="Int">dims</a>)
          
        <span title="Unit" class="keyword">case</span> IS_INSTANCE(<a title="CopyPropagation.this.global.icodes.TypeKind" id="342140">tpe</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#342143" title="CopyPropagation.this.Unknown.type">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span><span title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">(</span><span title="Int(1)" class="int">1</span>)
          
        <span title="Unit" class="keyword">case</span> CHECK_CAST(<a title="CopyPropagation.this.global.icodes.TypeKind" id="342157">tpe</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#342160" title="CopyPropagation.this.Unknown.type">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span><span title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">(</span><span title="Int(1)" class="int">1</span>)
          
        <span title="Unit" class="keyword">case</span> SWITCH(<a title="List[List[Int]]" id="342175">tags</a>, <a title="List[CopyPropagation.this.global.icodes.BasicBlock]" id="342176">labels</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(1)" class="int">1</span>)
          
        <span title="Unit" class="keyword">case</span> JUMP(<a title="CopyPropagation.this.global.icodes.BasicBlock" id="342185">whereto</a>) =&gt;
          <span title="Unit">(</span>)
          
        <span title="Unit" class="keyword">case</span> CJUMP(<a title="CopyPropagation.this.global.icodes.BasicBlock" id="342192">success</a>, <a title="CopyPropagation.this.global.icodes.BasicBlock" id="342193">failure</a>, <a title="CopyPropagation.this.global.icodes.TestOp" id="342194">cond</a>, <a title="CopyPropagation.this.global.icodes.TypeKind" id="342195">kind</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(2)" class="int">2</span>)
          
        <span title="Unit" class="keyword">case</span> CZJUMP(<a title="CopyPropagation.this.global.icodes.BasicBlock" id="342207">success</a>, <a title="CopyPropagation.this.global.icodes.BasicBlock" id="342208">failure</a>, <a title="CopyPropagation.this.global.icodes.TestOp" id="342209">cond</a>, <a title="CopyPropagation.this.global.icodes.TypeKind" id="342210">kind</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(1)" class="int">1</span>)
          
        <span title="Unit" class="keyword">case</span> RETURN(<a title="CopyPropagation.this.global.icodes.TypeKind" id="342219">kind</a>) =&gt;
          <span title="Unit" class="keyword">if</span> (<a href="#342219" title="(x$1: AnyRef)Boolean">kind</a> != <a href="../TypeKinds.scala.html#46201" title="object CopyPropagation.this.global.icodes.UNIT">UNIT</a>)
            <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(1)" class="int">1</span>)
          
        <span title="Unit" class="keyword">case</span> THROW() =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(1)" class="int">1</span>)
          
        <span title="Unit" class="keyword">case</span> DROP(<a title="CopyPropagation.this.global.icodes.TypeKind" id="342241">kind</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(1)" class="int">1</span>)
          
        <span title="Unit" class="keyword">case</span> DUP(<a title="CopyPropagation.this.global.icodes.TypeKind" id="342250">kind</a>) =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="=&gt; CopyPropagation.this.Value">head</span> <a href="#342253" title="CopyPropagation.this.Value">::</a> <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">stack</a>
          
        <span title="Unit" class="keyword">case</span> MONITOR_ENTER() =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(1)" class="int">1</span>);         

        <span title="Unit" class="keyword">case</span> MONITOR_EXIT() =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(1)" class="int">1</span>)

        <span title="Unit" class="keyword">case</span> SCOPE_ENTER(_) | SCOPE_EXIT(_) =&gt;
          <span title="Unit">(</span>)
        
        <span title="Unit" class="keyword">case</span> LOAD_EXCEPTION() =&gt;
          <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#342286" title="CopyPropagation.this.Unknown.type">::</a> <span title="(x: object CopyPropagation.this.Unknown)List[object CopyPropagation.this.Unknown]">Nil</span>

        <span title="Nothing" class="keyword">case</span> _ =&gt;
          <a href="../ICodes.scala.html#46151" title="=&gt; Unit">dump</a>
          <a href="../../../Global.scala.html#39077" title="(msg: String)Nothing">abort</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;Unknown instruction: &quot;</span> + <a href="#155866" title="CopyPropagation.this.global.icodes.Instruction">i</a>)
      }
      <a href="#341292" title="CopyPropagation.this.copyLattice.State">out</a>
    } /* def interpret */

    /** Remove all references to this local variable from both stack
     *  and bindings. It is called when a new assignment destroys 
     *  previous copy-relations.
     */
    <span class="keyword">final</span> <span class="keyword">def</span> <a title="(s: CopyPropagation.this.copyLattice.State,target: CopyPropagation.this.Location)Unit" id="154999">cleanReferencesTo</a>(<a title="CopyPropagation.this.copyLattice.State" id="341569">s</a>: copyLattice.<a href="#154978" title="CopyPropagation.this.copyLattice.State">State</a>, <a title="CopyPropagation.this.Location" id="341570">target</a>: <a href="#154941" title="CopyPropagation.this.Location">Location</a>) {
      <span class="keyword">def</span> <a title="(r: CopyPropagation.this.Record)CopyPropagation.this.Record" id="342300">cleanRecord</a>(<a title="CopyPropagation.this.Record" id="342301">r</a>: <a href="#155418" title="CopyPropagation.this.Record">Record</a>): <a href="#155418" title="CopyPropagation.this.Record">Record</a> = {
        <a href="#342301" title="CopyPropagation.this.Record">r</a>.<a href="#342083" title="(p: (CopyPropagation.this.global.Symbol, CopyPropagation.this.Value) =&gt; Boolean)r.bindings.type">bindings</a> retain { (<a title="CopyPropagation.this.global.Symbol" id="342304">loc</a>, <a title="CopyPropagation.this.Value" id="342305">value</a>) =&gt;
          <span title="(x$1: Boolean)Boolean">(</span><a href="#342305" title="CopyPropagation.this.Value">value</a> <span title="Boolean" class="keyword">match</span> {
            <span title="Boolean(false)" class="keyword">case</span> Deref(<a title="CopyPropagation.this.Location" id="342306">loc1</a>) <span class="keyword">if</span> (<a href="#342306" title="(x$1: AnyRef)Boolean">loc1</a> == <a href="#341570" title="CopyPropagation.this.Location">target</a>) =&gt; <span title="Boolean(false)" class="keyword">false</span>
            <span title="Boolean(false)" class="keyword">case</span> Boxed(<a title="CopyPropagation.this.Location" id="342315">loc1</a>) <span class="keyword">if</span> (<a href="#342315" title="(x$1: AnyRef)Boolean">loc1</a> == <a href="#341570" title="CopyPropagation.this.Location">target</a>)  =&gt; <span title="Boolean(false)" class="keyword">false</span>
            <span title="Boolean(true)" class="keyword">case</span> _ =&gt; <span title="Boolean(true)" class="keyword">true</span>
          }) &amp;&amp; (<a href="#341570" title="CopyPropagation.this.Location">target</a> <span title="Boolean" class="keyword">match</span> {
            <span title="Boolean" class="keyword">case</span> Field(<a href="#154965" title="object CopyPropagation.this.AllRecords">AllRecords</a>, <a title="CopyPropagation.this.global.Symbol" id="342324">sym1</a>) =&gt; <span title="=&gt; Boolean">!</span>(<a href="#342304" title="(x$1: AnyRef)Boolean">loc</a> == <a href="#342324" title="CopyPropagation.this.global.Symbol">sym1</a>)
            <span title="Boolean(true)" class="keyword">case</span> _ =&gt; <span title="Boolean(true)" class="keyword">true</span>
          })
        }
        <a href="#342301" title="CopyPropagation.this.Record">r</a>
      }

      <a href="#341569" title="CopyPropagation.this.copyLattice.State">s</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#341569" title="CopyPropagation.this.copyLattice.State">s</a>.<a href="#340352" title="(f: (CopyPropagation.this.Value) =&gt; CopyPropagation.this.Value)(implicit bf: scala.collection.generic.BuilderFactory[CopyPropagation.this.Value,List[CopyPropagation.this.Value],List[CopyPropagation.this.Value]])List[CopyPropagation.this.Value]">stack</a> <span title="scala.collection.generic.BuilderFactory[CopyPropagation.this.Value,List[CopyPropagation.this.Value],List#Coll]">map</span> { <a title="CopyPropagation.this.Value" id="342345">v</a> =&gt; <a href="#342345" title="CopyPropagation.this.Value">v</a> <span title="CopyPropagation.this.Value" class="keyword">match</span> {
        <span title="CopyPropagation.this.Record" class="keyword">case</span> Record(_, <a title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" id="342346">bindings</a>) =&gt;
          <a href="#342300" title="(r: CopyPropagation.this.Record)CopyPropagation.this.Record">cleanRecord</a>(<a href="#342345" title="CopyPropagation.this.Value">v</a>.<span title="[T0]T0">asInstanceOf</span><span title="CopyPropagation.this.Record">[</span><a href="#155418" title="CopyPropagation.this.Record">Record</a>])
        <span title="CopyPropagation.this.Unknown.type" class="keyword">case</span> Boxed(<a title="CopyPropagation.this.Location" id="342351">loc1</a>) <span class="keyword">if</span> (<a href="#342351" title="(x$1: AnyRef)Boolean">loc1</a> == <a href="#341570" title="CopyPropagation.this.Location">target</a>) =&gt; <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a>
        <span title="CopyPropagation.this.Value" class="keyword">case</span> _ =&gt; <a href="#342345" title="CopyPropagation.this.Value">v</a>
      }}

      <a href="#341569" title="CopyPropagation.this.copyLattice.State">s</a>.<a href="#340351" title="(p: (CopyPropagation.this.Location, CopyPropagation.this.Value) =&gt; Boolean)s.bindings.type">bindings</a> <span title="Unit">retain</span> { (<a title="CopyPropagation.this.Location" id="342388">loc</a>, <a title="CopyPropagation.this.Value" id="342389">value</a>) =&gt;
        <span title="(x$1: Boolean)Boolean">(</span><a href="#342389" title="CopyPropagation.this.Value">value</a> <span title="Boolean" class="keyword">match</span> {
          <span title="Boolean(false)" class="keyword">case</span> Deref(<a title="CopyPropagation.this.Location" id="342390">loc1</a>) <span class="keyword">if</span> (<a href="#342390" title="(x$1: AnyRef)Boolean">loc1</a> == <a href="#341570" title="CopyPropagation.this.Location">target</a>) =&gt; <span title="Boolean(false)" class="keyword">false</span>
          <span title="Boolean(false)" class="keyword">case</span> Boxed(<a title="CopyPropagation.this.Location" id="342399">loc1</a>) <span class="keyword">if</span> (<a href="#342399" title="(x$1: AnyRef)Boolean">loc1</a> == <a href="#341570" title="CopyPropagation.this.Location">target</a>) =&gt; <span title="Boolean(false)" class="keyword">false</span>
          <span title="Boolean" class="keyword">case</span> <a title="CopyPropagation.this.Record" id="342408">rec</a> @ Record(_, _) =&gt;
            <a href="#342300" title="(r: CopyPropagation.this.Record)CopyPropagation.this.Record">cleanRecord</a>(<a href="#342408" title="CopyPropagation.this.Record">rec</a>);
            <span title="Boolean(true)" class="keyword">true</span>
          <span title="Boolean(true)" class="keyword">case</span> _ =&gt; <span title="Boolean(true)" class="keyword">true</span>
        }) &amp;&amp; 
        (<a href="#342388" title="CopyPropagation.this.Location">loc</a> <span title="Boolean" class="keyword">match</span> {
          <span title="Boolean(false)" class="keyword">case</span> <a title="CopyPropagation.this.Location" id="342413">l</a>: <a href="#154941" title="CopyPropagation.this.Location">Location</a> <span class="keyword">if</span> (<a href="#342413" title="(x$1: AnyRef)Boolean">l</a> == <a href="#341570" title="CopyPropagation.this.Location">target</a>) =&gt; <span title="Boolean(false)" class="keyword">false</span>
          <span title="Boolean(true)" class="keyword">case</span> _ =&gt; <span title="Boolean(true)" class="keyword">true</span>
        })
      }
    }

    /** Update the state &lt;code&gt;s&lt;/code&gt; after the call to &lt;code&gt;method&lt;/code&gt;.
     *  The stack elements are dropped and replaced by the result of the call.
     *  If the method is impure, all bindings to record fields are cleared.
     *
     *  @param state  ...
     *  @param method ...
     *  @param static ...
     *  @return       ...
     */
    <span class="keyword">final</span> <span class="keyword">def</span> <a title="(state: CopyPropagation.this.copyLattice.State,method: CopyPropagation.this.global.Symbol,static: Boolean)CopyPropagation.this.copyLattice.State" id="155000">simulateCall</a>(<a title="CopyPropagation.this.copyLattice.State" id="341863">state</a>: copyLattice.<a href="#154978" title="CopyPropagation.this.copyLattice.State">State</a>, <a title="CopyPropagation.this.global.Symbol" id="341864">method</a>: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>, <a title="Boolean" id="341865">static</a>: <span title="Boolean">Boolean</span>): copyLattice.<a href="#154978" title="CopyPropagation.this.copyLattice.State">State</a> = {
      <span class="keyword">val</span> <a title="CopyPropagation.this.copyLattice.State" id="342424">out</a> = <span title="CopyPropagation.this.copyLattice.State" class="keyword">new</span> <a href="#154967" title="object CopyPropagation.this.copyLattice">copyLattice</a>.<a href="#154978" title="CopyPropagation.this.copyLattice.State">State</a>(<a href="#341863" title="CopyPropagation.this.copyLattice.State">state</a>.<a href="#340351" title="=&gt; CopyPropagation.this.copyLattice.Bindings">bindings</a>, <a href="#341863" title="CopyPropagation.this.copyLattice.State">state</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>);
      <a href="#342424" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#342424" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<a href="#341864" title="CopyPropagation.this.global.Symbol">method</a>.<a href="../../../symtab/Symbols.scala.html#27004" title="=&gt; CopyPropagation.this.global.Type">info</a>.<a href="../../../symtab/Types.scala.html#30200" title="=&gt; List[CopyPropagation.this.global.Type]">paramTypes</a>.<span title="(x$1: Int)Int">length</span> + (<span title="Int" class="keyword">if</span> (<a href="#341865" title="Boolean">static</a>) <span title="Int(0)" class="int">0</span> <span class="keyword">else</span> <span title="Int(1)" class="int">1</span>));
      <span title="Unit" class="keyword">if</span> (<a href="#341864" title="CopyPropagation.this.global.Symbol">method</a>.<a href="../../../symtab/Symbols.scala.html#27004" title="=&gt; CopyPropagation.this.global.Type">info</a>.<a href="../../../symtab/Types.scala.html#30193" title="(x$1: AnyRef)Boolean">resultType</a> <span title="(x$1: Boolean)Boolean">!=</span> <a href="../../../symtab/Definitions.scala.html#26479" title="object CopyPropagation.this.global.definitions">definitions</a>.<a href="../../../symtab/Definitions.scala.html#28277" title="=&gt; CopyPropagation.this.global.Symbol">UnitClass</a>.<a href="../../../symtab/Symbols.scala.html#27003" title="=&gt; CopyPropagation.this.global.Type">tpe</a> &amp;&amp; <span title="=&gt; Boolean">!</span><a href="#341864" title="CopyPropagation.this.global.Symbol">method</a>.<a href="../../../symtab/Symbols.scala.html#26916" title="=&gt; Boolean">isConstructor</a>)
        <a href="#342424" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#340343" title="object CopyPropagation.this.Unknown">Unknown</a> <a href="#342471" title="CopyPropagation.this.Unknown.type">::</a> <a href="#342424" title="CopyPropagation.this.copyLattice.State">out</a>.<a href="#340352" title="(x: CopyPropagation.this.Value)List[CopyPropagation.this.Value]">stack</a>;
      <span title="Unit" class="keyword">if</span> (<span title="=&gt; Boolean">!</span><a href="#155004" title="(m: CopyPropagation.this.global.Symbol)Boolean">isPureMethod</a>(<a href="#341864" title="CopyPropagation.this.global.Symbol">method</a>))
        <a href="#155001" title="(state: CopyPropagation.this.copyLattice.State)Unit">invalidateRecords</a>(<a href="#342424" title="CopyPropagation.this.copyLattice.State">out</a>);
      <a href="#342424" title="CopyPropagation.this.copyLattice.State">out</a>
    }

    /** Drop everything known about mutable record fields.
     *  
     *  A simple escape analysis would help here. Some of the records we 
     *  track never leak to other methods, therefore they can not be changed.
     *  We should not drop their bindings in this case. A closure object 
     *  would be such an example. Some complications: 
     * 
     *   - outer pointers. An closure escapes as an outer pointer to another
     *     nested closure.
     */
    <span class="keyword">final</span> <span class="keyword">def</span> <a title="(state: CopyPropagation.this.copyLattice.State)Unit" id="155001">invalidateRecords</a>(<a title="CopyPropagation.this.copyLattice.State" id="342485">state</a>: copyLattice.<a href="#154978" title="CopyPropagation.this.copyLattice.State">State</a>) {
      <span class="keyword">def</span> <a title="(sym: CopyPropagation.this.global.Symbol)Boolean" id="342489">shouldRetain</a>(<a title="CopyPropagation.this.global.Symbol" id="342490">sym</a>: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>): <span title="Boolean">Boolean</span> = {
        <span title="Unit" class="keyword">if</span> (<a href="#342490" title="CopyPropagation.this.global.Symbol">sym</a>.<a href="../../../symtab/Symbols.scala.html#26996" title="(mask: Long)Boolean">hasFlag</a>(symtab.Flags.<span title="Long(4096L)">MUTABLE</span>))
          <a href="../../../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;dropping binding for &quot;</span> + <a href="#342490" title="CopyPropagation.this.global.Symbol">sym</a>.<a href="../../../symtab/Symbols.scala.html#27089" title="=&gt; String">fullNameString</a>)
        <span title="=&gt; Boolean">!</span><a href="#342490" title="CopyPropagation.this.global.Symbol">sym</a>.<a href="../../../symtab/Symbols.scala.html#26996" title="(mask: Long)Boolean">hasFlag</a>(symtab.Flags.<span title="Long(4096L)">MUTABLE</span>)
      }
      <a href="#342485" title="CopyPropagation.this.copyLattice.State">state</a>.<a href="#340352" title="(x$1: List[CopyPropagation.this.Value])Unit">stack</a> = <a href="#342485" title="CopyPropagation.this.copyLattice.State">state</a>.<a href="#340352" title="(f: (CopyPropagation.this.Value) =&gt; CopyPropagation.this.Value)(implicit bf: scala.collection.generic.BuilderFactory[CopyPropagation.this.Value,List[CopyPropagation.this.Value],List[CopyPropagation.this.Value]])List[CopyPropagation.this.Value]">stack</a> <span title="scala.collection.generic.BuilderFactory[CopyPropagation.this.Value,List[CopyPropagation.this.Value],List#Coll]">map</span> { <a title="CopyPropagation.this.Value" id="342509">v</a> =&gt; <a href="#342509" title="CopyPropagation.this.Value">v</a> <span title="CopyPropagation.this.Value" class="keyword">match</span> {
        <span title="CopyPropagation.this.Record" class="keyword">case</span> Record(<a title="CopyPropagation.this.global.Symbol" id="342510">cls</a>, <a title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" id="342511">bindings</a>) =&gt;
          <a href="#342511" title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">bindings</a>.<span title="(p: (CopyPropagation.this.global.Symbol, CopyPropagation.this.Value) =&gt; Boolean)bindings.type">retain</span> { (sym: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>, v: <a href="#154950" title="CopyPropagation.this.Value">Value</a>) =&gt; <a href="#342489" title="(sym: CopyPropagation.this.global.Symbol)Boolean">shouldRetain</a>(<a href="#342516" title="CopyPropagation.this.global.Symbol">sym</a>) }
          <a href="#155418" title="(cls: CopyPropagation.this.global.Symbol,bindings: scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value])CopyPropagation.this.Record">Record</a>(<a href="#342510" title="CopyPropagation.this.global.Symbol">cls</a>, <a href="#342511" title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">bindings</a>)
        <span title="CopyPropagation.this.Value" class="keyword">case</span> _ =&gt; <a href="#342509" title="CopyPropagation.this.Value">v</a>
      }}

      <a href="#342485" title="CopyPropagation.this.copyLattice.State">state</a>.<a href="#340351" title="(p: (CopyPropagation.this.Location, CopyPropagation.this.Value) =&gt; Boolean)state.bindings.type">bindings</a> <span title="Unit">retain</span> {(<a title="CopyPropagation.this.Location" id="342546">loc</a>, <a title="CopyPropagation.this.Value" id="342547">value</a>) =&gt;
        <a href="#342547" title="CopyPropagation.this.Value">value</a> <span title="Boolean" class="keyword">match</span> {
          <span title="Boolean" class="keyword">case</span> Deref(Field(<a title="CopyPropagation.this.Record" id="342548">rec</a>, <a title="CopyPropagation.this.global.Symbol" id="342549">sym</a>)) =&gt; <a href="#342489" title="(sym: CopyPropagation.this.global.Symbol)Boolean">shouldRetain</a>(<a href="#342549" title="CopyPropagation.this.global.Symbol">sym</a>)
          <span title="Boolean" class="keyword">case</span> Boxed(Field(<a title="CopyPropagation.this.Record" id="342556">rec</a>, <a title="CopyPropagation.this.global.Symbol" id="342557">sym</a>)) =&gt; <a href="#342489" title="(sym: CopyPropagation.this.global.Symbol)Boolean">shouldRetain</a>(<a href="#342557" title="CopyPropagation.this.global.Symbol">sym</a>)
          <span title="Boolean(true)" class="keyword">case</span> _ =&gt; <span title="Boolean(true)" class="keyword">true</span>
        }
      }
    }

    /** Return bindings from an object fields to the values on the stack. This
     *  method has to find the correct mapping from fields to the order in which
     *  they are passed on the stack. It works for primary constructors.
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(in: CopyPropagation.this.copyLattice.State,ctor: CopyPropagation.this.global.Symbol)scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" id="155002">getBindingsForPrimaryCtor</a>(<a title="CopyPropagation.this.copyLattice.State" id="341938">in</a>: copyLattice.<a href="#154978" title="CopyPropagation.this.copyLattice.State">State</a>, <a title="CopyPropagation.this.global.Symbol" id="341939">ctor</a>: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>): <span title="scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">Map</span>[Symbol, Value] = {
      <span class="keyword">val</span> <a title="List[CopyPropagation.this.global.Symbol]" id="342566">paramAccessors</a> = <a href="#341939" title="CopyPropagation.this.global.Symbol">ctor</a>.<a href="../../../symtab/Symbols.scala.html#26983" title="=&gt; CopyPropagation.this.global.Symbol">owner</a>.<a href="../../../symtab/Symbols.scala.html#27039" title="=&gt; List[CopyPropagation.this.global.Symbol]">constrParamAccessors</a>;
      <span class="keyword">var</span> <a title="List[CopyPropagation.this.Value]" id="342567">values</a> = <a href="#341938" title="CopyPropagation.this.copyLattice.State">in</a>.<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">take</span>(<span title="(x$1: Int)Int" class="int">1</span> + <a href="#341939" title="CopyPropagation.this.global.Symbol">ctor</a>.<a href="../../../symtab/Symbols.scala.html#27004" title="=&gt; CopyPropagation.this.global.Type">info</a>.<a href="../../../symtab/Types.scala.html#30200" title="=&gt; List[CopyPropagation.this.global.Type]">paramTypes</a>.<span title="=&gt; Int">length</span>).<a title="=&gt; List[CopyPropagation.this.Value]" id="24301">reverse</a>.<span title="(n: Int)List[CopyPropagation.this.Value]">drop</span>(<span title="Int(1)" class="int">1</span>);
      <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" id="342568">bindings</a> = <span title="scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">HashMap</span>[Symbol, Value];

      <span title="Unit" class="keyword">if</span> (<a href="../../../Global.scala.html#39018" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../../Settings.scala.html#37150" title="=&gt; scala.tools.nsc.Settings.BooleanSetting">debug</a>.<a href="../../../Settings.scala.html#37759" title="=&gt; Boolean">value</a>) <a href="../../../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;getBindings for: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#341939" title="CopyPropagation.this.global.Symbol">ctor</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; acc: &quot;)" class="string">&quot; acc: &quot;</span> + <a href="#342566" title="List[CopyPropagation.this.global.Symbol]">paramAccessors</a>)
      
      <span class="keyword">var</span> <a title="List[CopyPropagation.this.global.Type]" id="342569">paramTypes</a> = <a href="#341939" title="CopyPropagation.this.global.Symbol">ctor</a>.<a href="../../../symtab/Symbols.scala.html#27003" title="=&gt; CopyPropagation.this.global.Type">tpe</a>.<a href="../../../symtab/Types.scala.html#30200" title="=&gt; List[CopyPropagation.this.global.Type]">paramTypes</a> 
      <span class="keyword">val</span> <a title="Int" id="342570">diff</a> = <a href="#342569" title="List[CopyPropagation.this.global.Type]">paramTypes</a>.<a title="(x$1: Int)Int" id="2966">length</a> - <a href="#342566" title="List[CopyPropagation.this.global.Symbol]">paramAccessors</a>.<span title="=&gt; Int">length</span>
      <a href="#342570" title="Int">diff</a> <span title="Unit" class="keyword">match</span> {
        <span title="Unit" class="keyword">case</span> <span title="Int(0)" class="int">0</span> =&gt; <span title="Unit">(</span>)
        <span title="Unit" class="keyword">case</span> <span title="Int(1)" class="int">1</span> <span class="keyword">if</span> <a href="#341939" title="CopyPropagation.this.global.Symbol">ctor</a>.<a href="../../../symtab/Symbols.scala.html#27003" title="=&gt; CopyPropagation.this.global.Type">tpe</a>.<a href="../../../symtab/Types.scala.html#30200" title="=&gt; List[CopyPropagation.this.global.Type]">paramTypes</a>.<span title="(x$1: AnyRef)Boolean">head</span> == <a href="#341939" title="CopyPropagation.this.global.Symbol">ctor</a>.<a href="../../../symtab/Symbols.scala.html#26983" title="=&gt; CopyPropagation.this.global.Symbol">owner</a>.<a href="../../../symtab/Symbols.scala.html#26830" title="=&gt; CopyPropagation.this.global.Symbol">rawowner</a>.<a href="../../../symtab/Symbols.scala.html#27003" title="=&gt; CopyPropagation.this.global.Type">tpe</a> =&gt;
          // it's an unused outer
          <a href="../../../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;considering unused outer at position 0 in &quot;</span> + <a href="#341939" title="CopyPropagation.this.global.Symbol">ctor</a>.<a href="../../../symtab/Symbols.scala.html#27003" title="=&gt; CopyPropagation.this.global.Type">tpe</a>.<a href="../../../symtab/Types.scala.html#30200" title="=&gt; List[CopyPropagation.this.global.Type]">paramTypes</a>)
          <a href="#342569" title="List[CopyPropagation.this.global.Type]">paramTypes</a> = <a href="#342569" title="List[CopyPropagation.this.global.Type]">paramTypes</a>.<span title="=&gt; List[CopyPropagation.this.global.Type]">tail</span>
          <a href="#342567" title="List[CopyPropagation.this.Value]">values</a> = <a href="#342567" title="List[CopyPropagation.this.Value]">values</a>.<span title="=&gt; List[CopyPropagation.this.Value]">tail</span>
        <span title="Nothing" class="keyword">case</span> _ =&gt;
          <a href="../../../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;giving up on &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#341939" title="CopyPropagation.this.global.Symbol">ctor</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;(diff: &quot;)" class="string">&quot;(diff: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#342570" title="Int">diff</a> + <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>)
          <span title="Nothing" class="keyword">return</span> <a href="#342568" title="scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">bindings</a>
      }
      
      // this relies on having the same order in paramAccessors and
      // the arguments on the stack. It should be the same!
      <span class="keyword">for</span> ((<a title="CopyPropagation.this.global.Symbol" id="342760">p</a>, <a title="Int" id="342761">i</a>) &lt;- <a href="#342566" title="List[CopyPropagation.this.global.Symbol]">paramAccessors</a>.<a href="#342727" title="(f: ((CopyPropagation.this.global.Symbol, Int)) =&gt; Unit)Unit" id="25462">zipWithIndex</a>) {
//        assert(p.tpe == paramTypes(i), &quot;In: &quot; + ctor.fullNameString
//               + &quot; having acc: &quot; + (paramAccessors map (_.tpe))+ &quot; vs. params&quot; + paramTypes
//               + &quot;\n\t failed at pos &quot; + i + &quot; with &quot; + p.tpe + &quot; == &quot; + paramTypes(i))
        <span title="Any" class="keyword">if</span> (<a href="#342760" title="CopyPropagation.this.global.Symbol">p</a>.<a href="../../../symtab/Symbols.scala.html#27003" title="(x$1: AnyRef)Boolean">tpe</a> == <a href="#342569" title="(n: Int)CopyPropagation.this.global.Type" id="28929">paramTypes</a>(<a href="#342761" title="Int">i</a>))
          <a href="#342568" title="(kv: (CopyPropagation.this.global.Symbol, CopyPropagation.this.Value))bindings.type">bindings</a> += (<a href="#342760" title="(y: CopyPropagation.this.Value)(CopyPropagation.this.global.Symbol, CopyPropagation.this.Value)">p</a> -&gt; <a href="#342567" title="List[CopyPropagation.this.Value]">values</a>.<span title="=&gt; CopyPropagation.this.Value">head</span>);
        <a href="#342567" title="List[CopyPropagation.this.Value]">values</a> = <a href="#342567" title="List[CopyPropagation.this.Value]">values</a>.<span title="=&gt; List[CopyPropagation.this.Value]">tail</span>;
      }

      <span title="Unit" class="keyword">if</span> (<a href="../../../Global.scala.html#39018" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../../Settings.scala.html#37150" title="=&gt; scala.tools.nsc.Settings.BooleanSetting">debug</a>.<a href="../../../Settings.scala.html#37759" title="=&gt; Boolean">value</a>) <a href="../../../Global.scala.html#39068" title="(msg: AnyRef)Unit">log</a>(<span title="(x$1: Any)java.lang.String" class="string">&quot;\t&quot;</span> + <a href="#342568" title="scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">bindings</a>)
      <a href="#342568" title="scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]">bindings</a>
    }

    /** Is &lt;code&gt;cls&lt;/code&gt; a closure class?
     *
     *  @param cls ...
     *  @return    ...
     */
    <span class="keyword">final</span> <span class="keyword">def</span> <a title="(cls: CopyPropagation.this.global.Symbol)Boolean" id="155003">isClosureClass</a>(<a title="CopyPropagation.this.global.Symbol" id="342851">cls</a>: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>): <span title="Boolean">Boolean</span> = 
        <a href="#342851" title="CopyPropagation.this.global.Symbol">cls</a>.<a href="../../../symtab/Symbols.scala.html#26969" title="(x$1: Boolean)Boolean">isFinal</a> &amp;&amp;
        <a href="#342851" title="CopyPropagation.this.global.Symbol">cls</a>.<a href="../../../symtab/Symbols.scala.html#27003" title="=&gt; CopyPropagation.this.global.Type">tpe</a>.<a href="../../../symtab/Types.scala.html#30189" title="=&gt; List[CopyPropagation.this.global.Type]">parents</a>.<a title="(p: (CopyPropagation.this.global.Type) =&gt; Boolean)Boolean" id="28937">exists</a> { <a title="CopyPropagation.this.global.Type" id="342858">t</a> =&gt; 
          <span class="keyword">val</span> TypeRef<a href="#342865" title="CopyPropagation.this.global.Symbol" id="342859">(</a>_, <a title="CopyPropagation.this.global.Symbol" id="342865">sym</a>, _) = <a href="#342858" title="CopyPropagation.this.global.Type">t</a>;
          <a href="../../../symtab/Definitions.scala.html#26479" title="object CopyPropagation.this.global.definitions">definitions</a>.<a href="../../../symtab/Definitions.scala.html#28455" title="(p: (CopyPropagation.this.global.Symbol) =&gt; Boolean)Boolean" id="25738">FunctionClass</a> exists <a href="#342859" title="CopyPropagation.this.global.Symbol">sym</a>.<a href="#342874" title="(x$1: AnyRef)Boolean">==</a>
        }

    /** Is symbol &lt;code&gt;m&lt;/code&gt; a pure method?
     *
     *  @param m ...
     *  @return  ...
     */
    <span class="keyword">final</span> <span class="keyword">def</span> <a title="(m: CopyPropagation.this.global.Symbol)Boolean" id="155004">isPureMethod</a>(<a title="CopyPropagation.this.global.Symbol" id="342481">m</a>: <a href="../../../symtab/Symbols.scala.html#26127" title="CopyPropagation.this.global.Symbol">Symbol</a>): <span title="Boolean">Boolean</span> = 
      <a href="#342481" title="CopyPropagation.this.global.Symbol">m</a>.<a href="../../../symtab/Symbols.scala.html#26905" title="=&gt; Boolean">isGetter</a> // abstract getters are still pure, as we 'know'

    <span class="keyword">final</span> <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="155005">toString</a>(): <span title="String">String</span> = {
      <span class="keyword">var</span> <a title="java.lang.String" id="342888">res</a> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <span class="keyword">for</span> (<a title="CopyPropagation.this.global.icodes.BasicBlock" id="342907">b</a> &lt;- <a href="#154969" title="CopyAnalysis.this.type" class="keyword">this</a>.<a href="#154992" title="=&gt; CopyPropagation.this.global.icodes.IMethod">method</a>.<a href="../Members.scala.html#61228" title="=&gt; CopyPropagation.this.global.icodes.Code">code</a>.<a href="../Members.scala.html#61390" title="=&gt; scala.collection.mutable.ListBuffer[CopyPropagation.this.global.icodes.BasicBlock]">blocks</a>.<a title="(f: (CopyPropagation.this.global.icodes.BasicBlock) =&gt; Unit)Unit" id="61592">toList</a>)
        <a href="#342888" title="java.lang.String">res</a> = <span title="(x$1: Any)java.lang.String">(</span><a href="#342888" title="(x$1: Any)java.lang.String">res</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012IN(&quot;)" class="string">&quot;\nIN(&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#342907" title="CopyPropagation.this.global.icodes.BasicBlock">b</a>.<a href="../BasicBlocks.scala.html#61275" title="=&gt; Int">label</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;):\011 Bindings: &quot;)" class="string">&quot;):\t Bindings: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="DataFlowAnalysis.scala.html#61151" title="(key: CopyAnalysis.this.P)CopyAnalysis.this.lattice.Elem">in</a>(<a href="#342907" title="CopyPropagation.this.global.icodes.BasicBlock">b</a>).<a href="#340351" title="=&gt; CopyAnalysis.this.lattice.Bindings">bindings</a> <span title="(x$1: Any)java.lang.String">+</span>
               <span title="java.lang.String(&quot;\012IN(&quot;)" class="string">&quot;\nIN(&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#342907" title="CopyPropagation.this.global.icodes.BasicBlock">b</a>.<a href="../BasicBlocks.scala.html#61275" title="=&gt; Int">label</a> <span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;):\011 Stack: &quot;)" class="string">&quot;):\t Stack: &quot;</span> + <a href="DataFlowAnalysis.scala.html#61151" title="(key: CopyAnalysis.this.P)CopyAnalysis.this.lattice.Elem">in</a>(<a href="#342907" title="CopyPropagation.this.global.icodes.BasicBlock">b</a>).<a href="#340352" title="=&gt; List[CopyPropagation.this.Value]">stack</a>) + <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>;
      <a href="#342888" title="java.lang.String">res</a>
    }

  } /* class CopyAnalysis */
}

        </pre>
    </body>
</html>