<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/backend/icode/analysis/CopyPropagation.scala</title>
        <script type="text/javascript" src="../../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */</span>

<span class="comment">// $Id: CopyPropagation.scala 16884 2009-01-09 16:52:09Z cunei $</span>

<span class="keyword">package</span> scala.tools.nsc.backend.icode.analysis

<span class="keyword">import</span> scala.collection.mutable.{Map, HashMap}
<span class="keyword">import</span> scala.tools.nsc.symtab.Flags.DEFERRED

<span class="comment">/** A modified copy-propagation like analysis. It 
 *  is augmented with a record-like value which is used
 *  to represent closures.
 *
 *  @author Iulian Dragos
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class CopyPropagation extends java.lang.Object with ScalaObject</span><a id="16777">CopyPropagation</a></span> {
  <span class="keyword">val</span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.Global</span><a id="80634">global</a></span>: <span class="typed"><span class="type">scala.tools.nsc.Global</span><a href="../../../Global.scala.html#6489">Global</a></span>
  <span class="keyword">import</span> global._
  <span class="keyword">import</span> icodes._

  <span class="comment">/** Locations can be local variables, this, and fields. */</span>
  <span class="keyword">abstract</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Location extends java.lang.Object with ScalaObject</span><a id="80637">Location</a></span>;
  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class LocalVar extends CopyPropagation.this.Location with ScalaObject with Product</span><span id="2751"><span id="29737"><span id="29814"><span id="80638"><span id="3500"><span id="80766"><span id="107194"><span id="29815"><span id="80639"><span id="107196"><span id="107202"><span id="2750"><span id="107203"><span id="29856"><span id="308"><span id="107195"><span id="107198"><span id="3501"><span id="80792"><span id="107197"><span id="80772"><span id="107201"><span id="107200"><span id="5794"><a id="3509">LocalVar</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><span id="80770"><span id="80769"><span id="80795"><a id="80773">l</a></span></span></span></span>: <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="../Members.scala.html#32333">Local</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#80637">Location</a></span>
  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Field extends CopyPropagation.this.Location with ScalaObject with Product</span><span id="2751"><span id="107236"><span id="107217"><span id="107220"><span id="107234"><span id="107223"><span id="107222"><span id="80642"><span id="3509"><span id="107224"><span id="29737"><span id="29814"><span id="107233"><span id="3500"><span id="107219"><span id="29815"><span id="23625"><span id="107218"><span id="2750"><span id="29856"><span id="1379"><span id="308"><span id="107235"><span id="80641"><span id="3501"><span id="107229"><span id="5794"><a id="107230">Field</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">CopyPropagation.this.Record</span><span id="107208"><span id="107207"><span id="107215"><a id="107503">r</a></span></span></span></span>: <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80647">Record</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><span id="107210"><span id="107209"><span id="107216"><a id="107504">sym</a></span></span></span></span>: <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#21866">Symbol</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#80637">Location</a></span>
  <span class="keyword">case</span> <span class="keyword">object</span> <span class="typed"><span class="type">object CopyPropagation.this.This</span><span id="80644"><span id="107242"><span id="107239"><span id="107243"><span id="3500"><span id="107241"><span id="29856"><span id="107245"><a id="107240">This</a></span></span></span></span></span></span></span></span></span> <span class="keyword">extends</span> <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#80637">Location</a></span>

  <span class="comment">/** Values that can be on the stack. */</span>
  <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Value extends java.lang.Object with ScalaObject</span><a id="80646">Value</a></span> {
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="80780">isRecord</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
  }
  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Record extends CopyPropagation.this.Value with ScalaObject with Product</span><span id="2751"><span id="107263"><span id="107264"><span id="80830"><span id="80648"><span id="107257"><span id="107254"><span id="80647"><span id="107259"><span id="80820"><span id="3509"><span id="107256"><span id="29737"><span id="29814"><span id="3500"><span id="107255"><span id="29815"><span id="23625"><span id="107265"><span id="2750"><span id="107262"><span id="80829"><span id="29856"><span id="1379"><span id="308"><span id="3501"><span id="5794"><a id="107258">Record</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><span id="80824"><span id="80823"><span id="80835"><a id="107675">cls</a></span></span></span></span>: <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#21866">Symbol</a></span>, <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><span id="80826"><span id="80825"><span id="80836"><a id="107676">bindings</a></span></span></span></span>: <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="19880">Map</a></span>[Symbol, Value]) <span class="keyword">extends</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span> {
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="80828">isRecord</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
  }
  <span class="comment">/** The value of some location in memory. */</span>
  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Deref extends CopyPropagation.this.Value with ScalaObject with Product</span><span id="2751"><span id="107275"><span id="80788"><span id="29737"><span id="29814"><span id="107276"><span id="3500"><span id="29815"><span id="107273"><span id="107270"><span id="2750"><span id="107278"><span id="29856"><span id="308"><span id="80787"><span id="3501"><span id="107272"><span id="80782"><span id="107271"><span id="80650"><span id="107277"><span id="5794"><span id="80651"><span id="3509"><a id="107269">Deref</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><span id="80785"><span id="80784"><span id="80791"><a id="107349">l</a></span></span></span></span>: <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#80637">Location</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span>
  
  <span class="comment">/** The boxed value of some location. */</span>
  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Boxed extends CopyPropagation.this.Value with ScalaObject with Product</span><span id="80883"><span id="2751"><span id="29737"><span id="29814"><span id="80884"><span id="107289"><span id="80653"><span id="107288"><span id="3500"><span id="29815"><span id="80654"><span id="107290"><span id="107282"><span id="2750"><span id="29856"><span id="308"><span id="107285"><span id="3501"><span id="80878"><span id="107284"><span id="107283"><span id="5794"><span id="107286"><span id="3509"><a id="107291">Boxed</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><span id="80881"><span id="80880"><span id="80887"><a id="107649">l</a></span></span></span></span>: <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#80637">Location</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span>
  
  <span class="comment">/** The constant value c. */</span>
  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Const extends CopyPropagation.this.Value with ScalaObject with Product</span><span id="107296"><span id="2751"><span id="80656"><span id="29737"><span id="29814"><span id="107303"><span id="3500"><span id="29815"><span id="107298"><span id="80924"><span id="107297"><span id="107295"><span id="2750"><span id="29856"><span id="308"><span id="3501"><span id="80930"><span id="107299"><span id="5794"><span id="107302"><span id="107304"><span id="80657"><span id="107301"><span id="3509"><a id="80929">Const</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Constant</span><span id="80927"><span id="80926"><span id="80933"><a id="107482">c</a></span></span></span></span>: <span class="typed"><span class="type">CopyPropagation.this.global.Constant</span><a href="../../../symtab/Constants.scala.html#22297">Constant</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span>
  
  <span class="comment">/** Unknown. */</span>
  <span class="keyword">case</span> <span class="keyword">object</span> <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><span id="107311"><span id="80659"><span id="107308"><span id="3500"><span id="107312"><span id="107309"><span id="107314"><span id="29856"><a id="107310">Unknown</a></span></span></span></span></span></span></span></span></span> <span class="keyword">extends</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span>
  
  <span class="comment">/** The bottom record. */</span>
  <span class="keyword">object</span> <span class="typed"><span class="type">object CopyPropagation.this.AllRecords</span><a id="80661">AllRecords</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80647">Record</a></span>(<span class="typed"><span class="type">object CopyPropagation.this.global.NoSymbol</span><a href="../../../symtab/Symbols.scala.html#21873">NoSymbol</a></span>, <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="20081">HashMap</a></span>[Symbol, Value])

  <span class="comment">/** The lattice for this analysis.   */</span>
  <span class="keyword">object</span> <span class="typed"><span class="type">object CopyPropagation.this.copyLattice</span><a id="80663">copyLattice</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CompleteLattice</span><a href="CompleteLattice.scala.html#16768">CompleteLattice</a></span> {
    <span class="keyword">type</span> <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a id="80672">Bindings</a></span> = <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a id="19880">Map</a></span>[Location, Value]

    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a id="80673">emptyBinding</a></span> = <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a id="20081">HashMap</a></span>[Location, Value]()

    <span class="keyword">class</span> <span class="typed"><span class="type">class State extends java.lang.Object with ScalaObject</span><a id="80674">State</a></span>(<span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><span id="80745"><span id="80744"><a id="107318">bindings</a></span></span></span>: <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a id="19880">Bindings</a></span>, <span class="keyword">var</span> <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><span id="107319"><span id="80748"><span id="80746"><span id="107328"><a id="80747">stack</a></span></span></span></span></span>: <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a id="526">List</a></span>[Value]) {
      <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Any)Boolean</span><a id="80750">equals</a></span>(<span class="typed"><span class="type">Any</span><a id="107329">that</a></span>: <span class="typed"><span class="type">Any</span><a id="51">Any</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = 
        (<span class="typed"><span class="type">State.this.type</span><a href="#80674" class="keyword">this</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">Any</span><a href="#107329">that</a></span>.<span class="typed"><span class="type">AnyRef</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">AnyRef</span><a id="2017">AnyRef</a></span>]) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span>
        <span class="typed"><span class="type">Any</span><a href="#107329">that</a></span>.<span class="typed"><span class="type">Boolean</span><a id="3501">isInstanceOf</a></span>[<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80674">State</a></span>] <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> {
          <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a id="107330">other</a></span> = <span class="typed"><span class="type">Any</span><a href="#107329">that</a></span>.<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80674">State</a></span>]

          <span class="comment">/* comparison with bottom is reference equality! */</span>
          <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span> ((<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#107330">other</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80678">bottom</a></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> (<span class="typed"><span class="type">State.this.type</span><a href="#80674" class="keyword">this</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80678">bottom</a></span>))
            (<span class="typed"><span class="type">State.this.type</span><a href="#80674" class="keyword">this</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#107330">other</a></span>)
          <span class="keyword">else</span> {
            <span class="typed"><span class="type">State.this.type</span><a href="#80674" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a href="#80744">bindings</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#107330">other</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a href="#80744">bindings</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span>
            <span class="typed"><span class="type">object List</span><a id="527">List</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value],List[CopyPropagation.this.Value])((CopyPropagation.this.Value, CopyPropagation.this.Value) =&gt; Boolean)Boolean</span><a id="21458">forall2</a></span>(<span class="typed"><span class="type">State.this.type</span><a href="#80674" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>, <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#107330">other</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>) { (<span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107335">a</a></span>, <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107336">b</a></span>) =&gt; <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107335">a</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107336">b</a></span> }
          }
        }

      <span class="comment">/* Return an alias for the given local. It returns the last
       * local in the chain of aliased locals. Cycles are not allowed
       * to exist (by construction).
       */</span>
      <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.global.icodes.Local</span><a id="80751">getAlias</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="80810">l</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="../Members.scala.html#32333">Local</a></span>): <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="../Members.scala.html#32333">Local</a></span> = {
        <span class="keyword">var</span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="107338">target</a></span> = <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#80810">l</a></span>
        <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><a id="107339">stop</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
        
        <span class="typed"><span class="type">Unit</span><a href="#107340" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a href="#80744">bindings</a></span>.<span class="typed"><span class="type">(CopyPropagation.this.Location)Boolean</span><a id="24241">isDefinedAt</a></span>(<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar</span><a href="#80766">LocalVar</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107338">target</a></span>)) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">Boolean</span><a href="#107339">stop</a></span>) {
          <span class="typed"><span class="type">(CopyPropagation.this.Location)CopyPropagation.this.Value</span><a href="#80744" id="24239">bindings</a></span>(<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar</span><a href="#80766">LocalVar</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107338">target</a></span>)) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="107344">t</a></span>)) =&gt; <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107338">target</a></span> = <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107344">t</a></span>
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Boolean</span><a href="#107339">stop</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
          }
        }
        <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107338">target</a></span>
      }

      <span class="comment">/* Return the value bound to the given local. */</span>
      <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.Value</span><a id="80752">getBinding</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="80778">l</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="../Members.scala.html#32333">Local</a></span>): <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span> = {
        <span class="keyword">var</span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="107345">target</a></span> = <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#80778">l</a></span>
        <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><a id="107346">stop</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
        <span class="keyword">var</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107347">value</a></span>: <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span> = <span class="typed"><span class="type">(CopyPropagation.this.Location)CopyPropagation.this.Deref</span><a href="#80782">Deref</a></span>(<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar</span><a href="#80766">LocalVar</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107345">target</a></span>))
        
        <span class="typed"><span class="type">Unit</span><a href="#107348" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a href="#80744">bindings</a></span>.<span class="typed"><span class="type">(CopyPropagation.this.Location)Boolean</span><a id="24241">isDefinedAt</a></span>(<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar</span><a href="#80766">LocalVar</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107345">target</a></span>)) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">Boolean</span><a href="#107346">stop</a></span>) {
<span class="comment">//          Console.println(&quot;finding binding for &quot; + target)</span>
          <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107347">value</a></span> = <span class="typed"><span class="type">(CopyPropagation.this.Location)CopyPropagation.this.Value</span><a href="#80744" id="24239">bindings</a></span>(<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar</span><a href="#80766">LocalVar</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107345">target</a></span>))
          <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107347">value</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="107353">t</a></span>)) =&gt; <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107345">target</a></span> = <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107353">t</a></span>
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Boolean</span><a href="#107346">stop</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
          }
        }
        <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107347">value</a></span>
      }

      <span class="comment">/* Return the binding for the given field of the given record */</span>
      <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.Record,CopyPropagation.this.global.Symbol)CopyPropagation.this.Value</span><a id="80753">getBinding</a></span>(<span class="typed"><span class="type">CopyPropagation.this.Record</span><a id="80776">r</a></span>: <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80647">Record</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a id="80777">f</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#21866">Symbol</a></span>): <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span> = {
        <span class="typed"><span class="type">(Boolean,=&gt; Any)Unit</span><span id="6004"><a id="821">assert</a></span></span>(<span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80776">r</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#80825">bindings</a></span>.<span class="typed"><span class="type">(CopyPropagation.this.global.Symbol)Boolean</span><a id="24241">isDefinedAt</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#80777">f</a></span>),
               <span class="typed"><span class="type">java.lang.String(&quot;Record &quot;)</span><span class="string">&quot;Record &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80776">r</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; does not contain a field &quot;)</span><span class="string">&quot; does not contain a field &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#80777">f</a></span>);

        <span class="keyword">var</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107354">target</a></span>: <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span> = <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80776">r</a></span>.<span class="typed"><span class="type">(CopyPropagation.this.global.Symbol)CopyPropagation.this.Value</span><a href="#80825" id="24239">bindings</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#80777">f</a></span>);
        <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107354">target</a></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">CopyPropagation.this.Value</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="107366">l</a></span>)) =&gt; <span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.Value</span><a href="#80752">getBinding</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107366">l</a></span>)
          <span class="typed"><span class="type">CopyPropagation.this.Value</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107354">target</a></span>
        }
      }
      
      <span class="comment">/** Return a local which contains the same value as this field, if any.
       * If the field holds a reference to a local, the returned value is the
       * binding of that local.
       */</span>
      <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.Record,CopyPropagation.this.global.Symbol)Option[CopyPropagation.this.Value]</span><a id="80754">getFieldValue</a></span>(<span class="typed"><span class="type">CopyPropagation.this.Record</span><a id="80839">r</a></span>: <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80647">Record</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a id="80840">f</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#21866">Symbol</a></span>): <span class="typed"><span class="type">Option[CopyPropagation.this.Value]</span><a id="934">Option</a></span>[Value] = {
        <span class="typed"><span class="type">(Boolean,=&gt; Any)Unit</span><span id="6004"><a id="821">assert</a></span></span>(<span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80839">r</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#80825">bindings</a></span>.<span class="typed"><span class="type">(CopyPropagation.this.global.Symbol)Boolean</span><a id="24241">isDefinedAt</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#80840">f</a></span>),
            <span class="typed"><span class="type">java.lang.String(&quot;Record &quot;)</span><span class="string">&quot;Record &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80839">r</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; does not contain a field &quot;)</span><span class="string">&quot; does not contain a field &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#80840">f</a></span>);

        <span class="keyword">var</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107368">target</a></span>: <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span> = <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80839">r</a></span>.<span class="typed"><span class="type">(CopyPropagation.this.global.Symbol)CopyPropagation.this.Value</span><a href="#80825" id="24239">bindings</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#80840">f</a></span>)
        <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107368">target</a></span> <span class="typed"><span class="type">Option[CopyPropagation.this.Value]</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">Some[CopyPropagation.this.Deref]</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="107379">l</a></span>)) =&gt; <span class="typed"><span class="type">(CopyPropagation.this.Deref)Some[CopyPropagation.this.Deref]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">(CopyPropagation.this.Location)CopyPropagation.this.Deref</span><a href="#80782">Deref</a></span>(<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar</span><a href="#80766">LocalVar</a></span>(<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.global.icodes.Local</span><a href="#80751">getAlias</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107379">l</a></span>))))
          <span class="typed"><span class="type">Some[CopyPropagation.this.Value]</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<span class="typed"><span class="type">object CopyPropagation.this.This</span><a href="#80644">This</a></span>)    =&gt; <span class="typed"><span class="type">(CopyPropagation.this.Value)Some[CopyPropagation.this.Value]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107368">target</a></span>)
          <span class="typed"><span class="type">Some[CopyPropagation.this.Value]</span><span class="keyword">case</span></span> <a id="1">Const</a>(<span class="typed"><span class="type">CopyPropagation.this.global.Constant</span><a id="107382">k</a></span>) =&gt; <span class="typed"><span class="type">(CopyPropagation.this.Value)Some[CopyPropagation.this.Value]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107368">target</a></span>)
          <span class="typed"><span class="type">None.type</span><span class="keyword">case</span></span> _  =&gt; <span class="typed"><span class="type">object None</span><a id="536">None</a></span>
        }
      }

      <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="80755">toString</a></span>(): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> =
        <span class="typed"><span class="type">java.lang.String(&quot;\012Bindings: &quot;)</span><span class="string">&quot;\nBindings: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a href="#80744">bindings</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;\012Stack: &quot;)</span><span class="string">&quot;\nStack: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>;

      <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a id="80756">dup</a></span>: <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80674">State</a></span> = {
        <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a id="107385">b</a></span>: <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a id="19880">Bindings</a></span> = <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a id="20081">HashMap</a></span>()
        <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a href="#107385">b</a></span> <span class="typed"><span class="type">(Iterable[(CopyPropagation.this.Location, CopyPropagation.this.Value)])Unit</span><a id="24191">++=</a></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a href="#80744">bindings</a></span>
        <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80674">State</a></span>(<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a href="#107385">b</a></span>, <span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>)
      }
    }

    <span class="keyword">type</span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a id="80675">Elem</a></span> = <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80674">State</a></span>

    <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><span id="80677"><a id="80676">top</a></span></span>    = <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80674">State</a></span>(<span class="typed"><span class="type">=&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a href="#80673">emptyBinding</a></span>, <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>)
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><span id="80679"><a id="80678">bottom</a></span></span> = <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80674">State</a></span>(<span class="typed"><span class="type">=&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a href="#80673">emptyBinding</a></span>, <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>)

    <span class="keyword">val</span> <span class="typed"><span class="type">List[object CopyPropagation.this.Unknown]</span><span id="80681"><a id="80680">exceptionHandlerStack</a></span></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(object CopyPropagation.this.Unknown)List[object CopyPropagation.this.Unknown]</span><a href="#107322" id="21335">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem,scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem)scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a id="80682">lub2</a></span>(<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a id="107389">a</a></span>: <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#80674">Elem</a></span>, <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a id="107390">b</a></span>: <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#80674">Elem</a></span>): <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#80674">Elem</a></span> = {
      <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107389">a</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80678">bottom</a></span>)      <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107390">b</a></span>
      <span class="keyword">else</span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107390">b</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80678">bottom</a></span>) <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107389">a</a></span>
      <span class="keyword">else</span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107389">a</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107390">b</a></span>) <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107389">a</a></span>
      <span class="keyword">else</span> {
        <span class="keyword">val</span> <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a id="107392">resStack</a></span> = 
          <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107389">a</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">=&gt; List[object CopyPropagation.this.Unknown]</span><a href="#80680">exceptionHandlerStack</a></span>) <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107389">a</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>
          <span class="keyword">else</span> <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107390">b</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">=&gt; List[object CopyPropagation.this.Unknown]</span><a href="#80680">exceptionHandlerStack</a></span>) <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107390">b</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>
          <span class="keyword">else</span> {
            <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107389">a</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21345">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3142">!=</a></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107390">b</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21345">length</a></span>)
              <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.LubError</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.LubError</span><a href="LubError.scala.html#16960">LubError</a></span>(<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107389">a</a></span>, <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107390">b</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;Invalid stacks in states: &quot;)</span><span class="string">&quot;Invalid stacks in states: &quot;</span></span>);
            <span class="typed"><span class="type">object List</span><a id="527">List</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value],List[CopyPropagation.this.Value])((CopyPropagation.this.Value, CopyPropagation.this.Value) =&gt; CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a id="21449">map2</a></span>(<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107389">a</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>, <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107390">b</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>) { (<span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107406">v1</a></span>, <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107407">v2</a></span>) =&gt; 
              <span class="typed"><span class="type">CopyPropagation.this.Value</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107406">v1</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107407">v2</a></span>) <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107406">v1</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> 
            }
          }
      
<span class="comment">/*        if (a.stack.length != b.stack.length)
          throw new LubError(a, b, &quot;Invalid stacks in states: &quot;);
        val resStack = List.map2(a.stack, b.stack) { (v1, v2) =&gt; 
          if (v1 == v2) v1 else Unknown 
        }
        */</span>
        <span class="keyword">val</span> <span class="typed"><span class="type">List[(CopyPropagation.this.Location, CopyPropagation.this.Value)]</span><a id="107393">commonPairs</a></span> = <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107389">a</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a href="#80744">bindings</a></span>.<span class="typed"><span class="type">=&gt; List[(CopyPropagation.this.Location, CopyPropagation.this.Value)]</span><a id="21815">toList</a></span> <span class="typed"><span class="type">(List[(CopyPropagation.this.Location, CopyPropagation.this.Value)])List[(CopyPropagation.this.Location, CopyPropagation.this.Value)]</span><a id="21395">intersect</a></span> (<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Elem</span><a href="#107390">b</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.Bindings</span><a href="#80744">bindings</a></span>.<span class="typed"><span class="type">=&gt; List[(CopyPropagation.this.Location, CopyPropagation.this.Value)]</span><a id="21815">toList</a></span>)
        <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a id="107394">resBindings</a></span> = <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a id="20081">HashMap</a></span>[Location, Value]
        <span class="keyword">for</span> (<span class="typed"><span class="type">(((CopyPropagation.this.Location, CopyPropagation.this.Value)) =&gt; Unit)Unit</span><span id="21366"><a href="#107412" id="21367">(</a></span></span><span class="typed"><span class="type">CopyPropagation.this.Location</span><span id="107413"><a id="107418">k</a></span></span>, <span class="typed"><span class="type">CopyPropagation.this.Value</span><span id="107414"><a id="107419">v</a></span></span>) &lt;- <span class="typed"><span class="type">List[(CopyPropagation.this.Location, CopyPropagation.this.Value)]</span><a href="#107393">commonPairs</a></span>)
          <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a href="#107394">resBindings</a></span> <span class="typed"><span class="type">((CopyPropagation.this.Location, CopyPropagation.this.Value))Unit</span><a id="24189">+=</a></span> (<span class="typed"><span class="type">(CopyPropagation.this.Location)ArrowAssoc[CopyPropagation.this.Location]</span><span id="6054"><a href="#107418" id="821">k</a></span></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)(CopyPropagation.this.Location, CopyPropagation.this.Value)</span><a id="6050">-&gt;</a></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107419">v</a></span>);
        <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.CopyPropagation.copyLattice.State</span><a href="#80674">State</a></span>(<span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a href="#107394">resBindings</a></span>, <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a href="#107392">resStack</a></span>)
      }
    }
  }

  <span class="keyword">final</span> <span class="keyword">class</span> <span class="typed"><span class="type">class CopyAnalysis extends java.lang.Object with scala.tools.nsc.backend.icode.analysis.DataFlowAnalysis[CopyPropagation.this.copyLattice.type] with ScalaObject</span><a id="80665">CopyAnalysis</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.DataFlowAnalysis[CopyPropagation.this.copyLattice.type]</span><a href="DataFlowAnalysis.scala.html#16657">DataFlowAnalysis</a></span>[copyLattice.<span class="keyword">type</span>] {
    <span class="keyword">type</span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a id="80684">P</a></span> = <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="../BasicBlocks.scala.html#32337">BasicBlock</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.type</span><span id="80686"><a id="80685">lattice</a></span></span> = <span class="typed"><span class="type">object CopyPropagation.this.copyLattice</span><a href="#80663">copyLattice</a></span>

    <span class="keyword">var</span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.IMethod</span><span id="80689"><span id="80687"><span id="80688"><a id="107431">method</a></span></span></span></span>: <span class="typed"><span class="type">CopyPropagation.this.global.icodes.IMethod</span><a href="../Members.scala.html#32332">IMethod</a></span> = _

    <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.global.icodes.IMethod)Unit</span><a id="80690">init</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.IMethod</span><a id="80735">m</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.icodes.IMethod</span><a href="../Members.scala.html#32332">IMethod</a></span>) {
      <span class="typed"><span class="type">CopyAnalysis.this.type</span><a href="#80665" class="keyword">this</a></span>.<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.IMethod)Unit</span><a href="#80688">method</a></span> = <span class="typed"><span class="type">CopyPropagation.this.global.icodes.IMethod</span><a href="#80735">m</a></span>

      <span class="typed"><span class="type">(=&gt; Unit)Unit</span><a href="DataFlowAnalysis.scala.html#32756">init</a></span> {
        <span class="typed"><span class="type">=&gt; scala.collection.jcl.Set[CopyAnalysis.this.P]</span><a href="DataFlowAnalysis.scala.html#32742">worklist</a></span> <span class="typed"><span class="type">(CopyAnalysis.this.P)Unit</span><a id="32999">+=</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.IMethod</span><a href="#80735">m</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.Code</span><a href="../Members.scala.html#32867">code</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.BasicBlock</span><a href="../Members.scala.html#33276">startBlock</a></span>
        <span class="typed"><span class="type">=&gt; scala.collection.jcl.Set[CopyAnalysis.this.P]</span><a href="DataFlowAnalysis.scala.html#32742">worklist</a></span> <span class="typed"><span class="type">(Iterable[CopyAnalysis.this.P])Unit</span><a id="25513">++=</a></span> (<span class="typed"><span class="type">CopyPropagation.this.global.icodes.IMethod</span><a href="#80735">m</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.icodes.ExceptionHandler]</span><a href="../Members.scala.html#32873">exh</a></span> <span class="typed"><span class="type">((CopyPropagation.this.global.icodes.ExceptionHandler) =&gt; CopyPropagation.this.global.icodes.BasicBlock)List[CopyPropagation.this.global.icodes.BasicBlock]</span><a id="21362">map</a></span> (<span class="typed"><span class="type">CopyPropagation.this.global.icodes.ExceptionHandler</span><a href="#107438">_</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.BasicBlock</span><a href="../ExceptionHandlers.scala.html#51919">startBlock</a></span>))
        <span class="typed"><span class="type">CopyPropagation.this.global.icodes.IMethod</span><a href="#80735">m</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.Code</span><a href="../Members.scala.html#32867">code</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.ListBuffer[CopyPropagation.this.global.icodes.BasicBlock]</span><a href="../Members.scala.html#33274">blocks</a></span>.<span class="typed"><span class="type">((CopyPropagation.this.global.icodes.BasicBlock) =&gt; Unit)Unit</span><a id="21792">foreach</a></span> { <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a id="107440">b</a></span> =&gt;
          <span class="typed"><span class="type">=&gt; scala.collection.mutable.Map[CopyAnalysis.this.P,CopyAnalysis.this.lattice.Elem]</span><a href="DataFlowAnalysis.scala.html#32744">in</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107440">b</a></span>)  = <span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.type</span><a href="#80685">lattice</a></span>.<span class="typed"><span class="type">=&gt; CopyAnalysis.this.lattice.State</span><a href="#80678">bottom</a></span>
          <span class="typed"><span class="type">=&gt; scala.collection.mutable.Map[CopyAnalysis.this.P,CopyAnalysis.this.lattice.Elem]</span><a href="DataFlowAnalysis.scala.html#32746">out</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107440">b</a></span>) = <span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.type</span><a href="#80685">lattice</a></span>.<span class="typed"><span class="type">=&gt; CopyAnalysis.this.lattice.State</span><a href="#80678">bottom</a></span>
          <span class="typed"><span class="type">(Boolean)Unit</span><span id="6003"><a id="821">assert</a></span></span>(<span class="typed"><span class="type">=&gt; scala.collection.mutable.Map[CopyAnalysis.this.P,CopyAnalysis.this.lattice.Elem]</span><a href="DataFlowAnalysis.scala.html#32746">out</a></span>.<span class="typed"><span class="type">(CopyAnalysis.this.P)Boolean</span><a id="24240">contains</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107440">b</a></span>))
          <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Added point: &quot;)</span><span class="string">&quot;Added point: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107440">b</a></span>)
        } 
        <span class="typed"><span class="type">CopyPropagation.this.global.icodes.IMethod</span><a href="#80735">m</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.icodes.ExceptionHandler]</span><a href="../Members.scala.html#32873">exh</a></span> <span class="typed"><span class="type">((CopyPropagation.this.global.icodes.ExceptionHandler) =&gt; Unit)Unit</span><a id="21366">foreach</a></span> { <span class="typed"><span class="type">CopyPropagation.this.global.icodes.ExceptionHandler</span><a id="107444">e</a></span> =&gt;
          <span class="typed"><span class="type">=&gt; scala.collection.mutable.Map[CopyAnalysis.this.P,CopyAnalysis.this.lattice.Elem]</span><a href="DataFlowAnalysis.scala.html#32744">in</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.ExceptionHandler</span><a href="#107444">e</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.BasicBlock</span><a href="../ExceptionHandlers.scala.html#51919">startBlock</a></span>) = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><span class="keyword">new</span></span> <span class="typed"><span class="type">object CopyPropagation.this.copyLattice</span><a href="#80663">copyLattice</a></span>.<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#80674">State</a></span>(<span class="typed"><span class="type">object CopyPropagation.this.copyLattice</span><a href="#80663">copyLattice</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a href="#80673">emptyBinding</a></span>, <span class="typed"><span class="type">object CopyPropagation.this.copyLattice</span><a href="#80663">copyLattice</a></span>.<span class="typed"><span class="type">=&gt; List[object CopyPropagation.this.Unknown]</span><a href="#80680">exceptionHandlerStack</a></span>);
        }

        <span class="comment">// first block is special: it's not bottom, but a precisely defined state with no bindings</span>
        <span class="typed"><span class="type">=&gt; scala.collection.mutable.Map[CopyAnalysis.this.P,CopyAnalysis.this.lattice.Elem]</span><a href="DataFlowAnalysis.scala.html#32744">in</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.IMethod</span><a href="#80735">m</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.Code</span><a href="../Members.scala.html#32867">code</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.BasicBlock</span><a href="../Members.scala.html#33276">startBlock</a></span>) = <span class="typed"><span class="type">CopyAnalysis.this.lattice.State</span><span class="keyword">new</span></span> <span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.type</span><a href="#80685">lattice</a></span>.<span class="typed"><span class="type">CopyAnalysis.this.lattice.State</span><a href="#80674">State</a></span>(<span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.type</span><a href="#80685">lattice</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.HashMap[CopyPropagation.this.Location,CopyPropagation.this.Value]</span><a href="#80673">emptyBinding</a></span>, <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>);
      }
    }

    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="80691">run</a></span> {
      <span class="typed"><span class="type">((CopyAnalysis.this.P, CopyAnalysis.this.lattice.Elem) =&gt; CopyAnalysis.this.lattice.Elem)Unit</span><a href="DataFlowAnalysis.scala.html#32759">forwardAnalysis</a></span>(<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.BasicBlock,CopyAnalysis.this.lattice.Elem)CopyAnalysis.this.lattice.Elem</span><a href="#80692">blockTransfer</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../../../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="../../../Settings.scala.html#30066">debug</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="../../../Settings.scala.html#30301">value</a></span>) {
        <span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.Linearizer</span><a href="../ICodes.scala.html#32308">linearizer</a></span>.<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.IMethod)List[CopyPropagation.this.global.icodes.BasicBlock]</span><a href="../Linearizers.scala.html#33332">linearize</a></span>(<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.IMethod</span><a href="#80687">method</a></span>).<span class="typed"><span class="type">((CopyPropagation.this.global.icodes.BasicBlock) =&gt; Unit)Unit</span><a id="21366">foreach</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a id="107454">b</a></span> =&gt; <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107454">b</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.IMethod</span><a href="#80687">method</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.Code</span><a href="../Members.scala.html#32867">code</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.BasicBlock</span><a href="../Members.scala.html#33276">startBlock</a></span>)
          <span class="typed"><span class="type">(Boolean,=&gt; Any)Unit</span><span id="6004"><a id="821">assert</a></span></span>(<span class="typed"><span class="type">(CopyAnalysis.this.P)CopyAnalysis.this.lattice.Elem</span><a href="DataFlowAnalysis.scala.html#32744" id="24239">in</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107454">b</a></span>) <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.type</span><a href="#80685">lattice</a></span>.<span class="typed"><span class="type">=&gt; CopyAnalysis.this.lattice.State</span><a href="#80678">bottom</a></span>, 
            <span class="typed"><span class="type">java.lang.String(&quot;Block &quot;)</span><span class="string">&quot;Block &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107454">b</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; in &quot;)</span><span class="string">&quot; in &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyAnalysis.this.type</span><a href="#80665" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.IMethod</span><a href="#80687">method</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; has input equal to bottom -- not visited?&quot;)</span><span class="string">&quot; has input equal to bottom -- not visited?&quot;</span></span>));
      }
    }

    <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.global.icodes.BasicBlock,CopyAnalysis.this.lattice.Elem)CopyAnalysis.this.lattice.Elem</span><a id="80692">blockTransfer</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a id="107445">b</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="../BasicBlocks.scala.html#32337">BasicBlock</a></span>, <span class="typed"><span class="type">CopyAnalysis.this.lattice.Elem</span><a id="107446">in</a></span>: lattice.<span class="typed"><span class="type">CopyAnalysis.this.lattice.Elem</span><a href="#80674">Elem</a></span>): lattice.<span class="typed"><span class="type">CopyAnalysis.this.lattice.Elem</span><a href="#80674">Elem</a></span> =
      <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107445">b</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.icodes.Instruction]</span><a href="../BasicBlocks.scala.html#33188">toList</a></span>.<span class="typed"><span class="type">(CopyAnalysis.this.lattice.Elem)((CopyAnalysis.this.lattice.Elem, CopyPropagation.this.global.icodes.Instruction) =&gt; CopyAnalysis.this.lattice.Elem)CopyAnalysis.this.lattice.Elem</span><a id="21375">foldLeft</a></span>(<span class="typed"><span class="type">CopyAnalysis.this.lattice.Elem</span><a href="#107446">in</a></span>)(<span class="typed"><span class="type">(CopyPropagation.this.copyLattice.Elem,CopyPropagation.this.global.icodes.Instruction)CopyPropagation.this.copyLattice.Elem</span><a href="#80694">interpret</a></span>)
    
    <span class="keyword">import</span> opcodes._

    <span class="comment">/** Abstract interpretation for one instruction. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.Elem,CopyPropagation.this.global.icodes.Instruction)CopyPropagation.this.copyLattice.Elem</span><a id="80694">interpret</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a id="80908">in</a></span>: copyLattice.<span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80674">Elem</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Instruction</span><a id="80909">i</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Instruction</span><a href="../Opcodes.scala.html#32341">Instruction</a></span>): copyLattice.<span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80674">Elem</a></span> = {
      <span class="keyword">var</span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a id="107473">out</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80908">in</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.State</span><a href="#80756">dup</a></span>

      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../../../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="../../../Settings.scala.html#30066">debug</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="../../../Settings.scala.html#30301">value</a></span>) {
        <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;- &quot;)</span><span class="string">&quot;- &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Instruction</span><a href="#80909">i</a></span>)
        <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;in: &quot;)</span><span class="string">&quot;in: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80908">in</a></span>)
        <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>)
      }

      <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Instruction</span><a href="#80909">i</a></span> <span class="typed"><span class="type">Any</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">THIS</a>(_) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">(CopyPropagation.this.Location)CopyPropagation.this.Deref</span><a href="#80782">Deref</a></span>(<span class="typed"><span class="type">object CopyPropagation.this.This</span><a href="#80644">This</a></span>) <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107476" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">CONSTANT</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Constant</span><a id="107479">k</a></span>) =&gt;
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Constant</span><a href="#107479">k</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../symtab/Constants.scala.html#37590">tag</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3142">!=</a></span> <span class="typed"><span class="type">Int(1)</span><span >UnitTag</span></span>)
            <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">(CopyPropagation.this.global.Constant)CopyPropagation.this.Const</span><a href="#80924">Const</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Constant</span><a href="#107479">k</a></span>) <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107481" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>;
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">LOAD_ARRAY_ITEM</a>(_) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = (<span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107485" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>))

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">LOAD_LOCAL</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="107489">local</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">(CopyPropagation.this.Location)CopyPropagation.this.Deref</span><a href="#80782">Deref</a></span>(<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar</span><a href="#80766">LocalVar</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107489">local</a></span>)) <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107490" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">LOAD_FIELD</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a id="107493">field</a></span>, <span class="typed"><span class="type">Boolean</span><a id="107494">isStatic</a></span>) =&gt;
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#107494">isStatic</a></span>)
            <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107495" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>; <span class="comment">/* ignore static fields */</span>
          <span class="keyword">else</span> {
            <span class="keyword">val</span> <span class="typed"><span class="type">&lt;refinement&gt; extends Product with CopyPropagation.this.Value</span><a id="107498">v1</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80908">in</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span> <span class="typed"><span class="type">&lt;refinement&gt; extends Product with CopyPropagation.this.Value</span><span class="keyword">match</span></span> {
              <span class="typed"><span class="type">CopyPropagation.this.Deref</span><span class="keyword">case</span></span> (<span class="typed"><span class="type">CopyPropagation.this.Record</span><a id="107499">r</a></span> @ <a id="1">Record</a>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a id="107500">cls</a></span>, <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="107501">bindings</a></span>)) <a id="1">::</a> <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a id="107502">xs</a></span> =&gt;
                <span class="typed"><span class="type">(CopyPropagation.this.Location)CopyPropagation.this.Deref</span><a href="#80782">Deref</a></span>(<span class="typed"><span class="type">(CopyPropagation.this.Record,CopyPropagation.this.global.Symbol)CopyPropagation.this.Field</span><a href="#107222">Field</a></span>(<span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#107499">r</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107493">field</a></span>))

              <span class="typed"><span class="type">CopyPropagation.this.Unknown.type</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span>
            }
            <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">&lt;refinement&gt; extends Product with CopyPropagation.this.Value</span><a href="#107498">v1</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107516" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
          }
            
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">LOAD_MODULE</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a id="107520">module</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107521" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">STORE_ARRAY_ITEM</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107524">kind</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(3)</span><span class="int">3</span></span>)

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">STORE_LOCAL</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="107526">local</a></span>) =&gt;
          <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.Location)Unit</span><a href="#80695">cleanReferencesTo</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>, <span class="typed"><span class="type">(CopyPropagation.this.global.icodes.Local)CopyPropagation.this.LocalVar</span><a href="#80766">LocalVar</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107526">local</a></span>))
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80908">in</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <a id="1">::</a> <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a id="107529">xs</a></span> =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>)
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107530">v</a></span> <a id="1">::</a> <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a id="107531">vs</a></span> =&gt; 
              <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107530">v</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a id="107532">other</a></span>)) =&gt;
                  <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107532">other</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107526">local</a></span>) 
                    <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.Bindings</span><a href="#80744">bindings</a></span> <span class="typed"><span class="type">((CopyPropagation.this.Location, CopyPropagation.this.Value))Unit</span><a id="24189">+=</a></span> (<span class="typed"><span class="type">(CopyPropagation.this.LocalVar)ArrowAssoc[CopyPropagation.this.LocalVar]</span><span id="6054"><a href="#80766" id="821">LocalVar</a></span></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107526">local</a></span>) <span class="typed"><span class="type">(CopyPropagation.this.Value)(CopyPropagation.this.LocalVar, CopyPropagation.this.Value)</span><a id="6050">-&gt;</a></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107530">v</a></span>);
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt;
                  <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.Bindings</span><a href="#80744">bindings</a></span> <span class="typed"><span class="type">((CopyPropagation.this.Location, CopyPropagation.this.Value))Unit</span><a id="24189">+=</a></span> (<span class="typed"><span class="type">(CopyPropagation.this.LocalVar)ArrowAssoc[CopyPropagation.this.LocalVar]</span><span id="6054"><a href="#80766" id="821">LocalVar</a></span></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Local</span><a href="#107526">local</a></span>) <span class="typed"><span class="type">(CopyPropagation.this.Value)(CopyPropagation.this.LocalVar, CopyPropagation.this.Value)</span><a id="6050">-&gt;</a></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107530">v</a></span>)
              }
            <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span> =&gt;
              <span class="typed"><span class="type">object Predef</span><a id="821">Predef</a></span>.<span class="typed"><span class="type">(String)Nothing</span><a id="6000">error</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Incorrect icode in &quot;)</span><span class="string">&quot;Incorrect icode in &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.IMethod</span><a href="#80687">method</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;. Expecting something on the stack.&quot;)</span><span class="string">&quot;. Expecting something on the stack.&quot;</span></span>)
          }
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span> <span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>;
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">STORE_THIS</a>(_) =&gt;
          <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.Location)Unit</span><a href="#80695">cleanReferencesTo</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>, <span class="typed"><span class="type">object CopyPropagation.this.This</span><a href="#80644">This</a></span>)
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span> <span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">STORE_FIELD</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a id="107564">field</a></span>, <span class="typed"><span class="type">Boolean</span><a id="107565">isStatic</a></span>) =&gt;
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#107565">isStatic</a></span>) 
            <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>);
          <span class="keyword">else</span> {
            <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>);
            <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.Location)Unit</span><a href="#80695">cleanReferencesTo</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>, <span class="typed"><span class="type">(CopyPropagation.this.Record,CopyPropagation.this.global.Symbol)CopyPropagation.this.Field</span><a href="#107222">Field</a></span>(<span class="typed"><span class="type">object CopyPropagation.this.AllRecords</span><a href="#80661">AllRecords</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107564">field</a></span>));
            <span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80908">in</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
              <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107568">v</a></span> <a id="1">::</a> <a id="1">Record</a>(_, <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="107569">bindings</a></span>) <a id="1">::</a> <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a id="107570">vs</a></span> =&gt;
                <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#107569">bindings</a></span> <span class="typed"><span class="type">((CopyPropagation.this.global.Symbol, CopyPropagation.this.Value))Unit</span><a id="24189">+=</a></span> (<span class="typed"><span class="type">(CopyPropagation.this.global.icodes.global.Symbol)ArrowAssoc[CopyPropagation.this.global.icodes.global.Symbol]</span><span id="6054"><a href="#107564" id="821">field</a></span></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)(CopyPropagation.this.global.icodes.global.Symbol, CopyPropagation.this.Value)</span><a id="6050">-&gt;</a></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107568">v</a></span>)
              <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>);
            }
          }
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">CALL_PRIMITIVE</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Primitive</span><a id="107581">primitive</a></span>) =&gt;
          <span class="comment">// TODO: model primitives</span>
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107582" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.Instruction</span><a href="#80909">i</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../Opcodes.scala.html#33388">consumed</a></span>)

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">CALL_METHOD</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a id="107586">method</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.opcodes.InvokeStyle</span><a id="107587">style</a></span>) =&gt; <span class="typed"><span class="type">CopyPropagation.this.global.icodes.opcodes.InvokeStyle</span><a href="#107587">style</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object CopyPropagation.this.global.icodes.opcodes.Dynamic</span><a href="../Opcodes.scala.html#32599">Dynamic</a></span> | <span class="typed"><span class="type">object CopyPropagation.this.global.icodes.opcodes.InvokeDynamic</span><a href="../Opcodes.scala.html#32601">InvokeDynamic</a></span> =&gt;
            <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span> = <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.global.Symbol,Boolean)CopyPropagation.this.copyLattice.State</span><a href="#80696">simulateCall</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80908">in</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107586">method</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)

          <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Static</a>(<span class="typed"><span class="type">Boolean</span><a id="107591">onInstance</a></span>) =&gt;
            <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#107591">onInstance</a></span>) {
              <span class="keyword">val</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107592">obj</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107586">method</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.global.Type</span><a href="../../../symtab/Symbols.scala.html#25231">info</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.icodes.global.Type]</span><a href="../../../symtab/Types.scala.html#25668">paramTypes</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21345">length</a></span>).<span class="typed"><span class="type">=&gt; CopyPropagation.this.Value</span><a id="21332">head</a></span>
<span class="comment">//              if (method.isPrimaryConstructor) {</span>
              <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107586">method</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../../symtab/Symbols.scala.html#25187">isPrimaryConstructor</a></span><span class="comment">/* &amp;&amp; isClosureClass(method.owner)*/</span>) {
                <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107592">obj</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                  <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Record</a>(_, <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="107595">bindings</a></span>) =&gt;
                    <span class="keyword">for</span> (<span class="typed"><span class="type">((CopyPropagation.this.Value) =&gt; Unit)Unit</span><span id="21366"><span id="21367"><span id="107618"><a id="107621">v</a></span></span></span></span> &lt;- <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21351">take</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107586">method</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.global.Type</span><a href="../../../symtab/Symbols.scala.html#25231">info</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.icodes.global.Type]</span><a href="../../../symtab/Types.scala.html#25668">paramTypes</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21345">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
                         <span class="keyword">if</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107618">v</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5795">ne</a></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107592">obj</a></span>) {
                       <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#107595">bindings</a></span> <span class="typed"><span class="type">(Iterable[(CopyPropagation.this.global.Symbol, CopyPropagation.this.Value)])Unit</span><a id="24191">++=</a></span> <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.global.Symbol)scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#80698">getBindingsForPrimaryCtor</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80908">in</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107586">method</a></span>);
                    }
                  <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>)
                }
                <span class="comment">// put the Record back on the stack and remove the 'returned' value</span>
                <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107586">method</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.global.Type</span><a href="../../../symtab/Symbols.scala.html#25231">info</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.icodes.global.Type]</span><a href="../../../symtab/Types.scala.html#25668">paramTypes</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21345">length</a></span>)
              } <span class="keyword">else</span>
                <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span> = <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.global.Symbol,Boolean)CopyPropagation.this.copyLattice.State</span><a href="#80696">simulateCall</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80908">in</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107586">method</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
            } <span class="keyword">else</span> 
              <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span> = <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.global.Symbol,Boolean)CopyPropagation.this.copyLattice.State</span><a href="#80696">simulateCall</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80908">in</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107586">method</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)

          <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">SuperCall</a>(_) =&gt;
            <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span> = <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.global.Symbol,Boolean)CopyPropagation.this.copyLattice.State</span><a href="#80696">simulateCall</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.Elem</span><a href="#80908">in</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107586">method</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
        }
        
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">BOX</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107645">tpe</a></span>) =&gt;
          <span class="keyword">val</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107646">top</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.Value</span><a id="21332">head</a></span>
          <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107646">top</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107647">loc</a></span>) =&gt; 
              <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">(CopyPropagation.this.Location)CopyPropagation.this.Boxed</span><a href="#80878">Boxed</a></span>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107647">loc</a></span>) <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107648" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a id="21334">tail</a></span>
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt;
              <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107652" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
          }

        <span class="typed"><span class="type">Any</span><span class="keyword">case</span></span> <a id="1">UNBOX</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107656">tpe</a></span>) =&gt;
          <span class="keyword">val</span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107657">top</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.Value</span><a id="21332">head</a></span>
          <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107657">top</a></span> <span class="typed"><span class="type">Any</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><span class="keyword">case</span></span> <a id="1">Boxed</a>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107658">loc</a></span>) =&gt; <span class="typed"><span class="type">(CopyPropagation.this.Location)CopyPropagation.this.Deref</span><a href="#80782">Deref</a></span>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107658">loc</a></span>) <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107659" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a id="21334">tail</a></span>
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _          =&gt; <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107662" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
          }
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">NEW</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.REFERENCE</span><a id="107672">kind</a></span>) =&gt;
          <span class="keyword">val</span> <span class="typed"><span class="type">&lt;refinement&gt; extends Product with CopyPropagation.this.Value</span><a id="107673">v1</a></span> = 
            <span class="typed"><span class="type">CopyPropagation.this.global.icodes.REFERENCE</span><a href="#107672">kind</a></span> <span class="typed"><span class="type">&lt;refinement&gt; extends Product with CopyPropagation.this.Value</span><span class="keyword">match</span></span> {
              <span class="typed"><span class="type">CopyPropagation.this.Record</span><span class="keyword">case</span></span> <a id="1">REFERENCE</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a id="107674">cls</a></span>) =&gt;
                <span class="typed"><span class="type">(CopyPropagation.this.global.Symbol,scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value])CopyPropagation.this.Record</span><a href="#80820">Record</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.global.Symbol</span><a href="#107674">cls</a></span>, <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="20081">HashMap</a></span>[Symbol, Value])
              <span class="comment">// bq: changed from _ to null, otherwise would be unreachable</span>
              <span class="typed"><span class="type">CopyPropagation.this.Unknown.type</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> =&gt;
                <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span>
            }
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">&lt;refinement&gt; extends Product with CopyPropagation.this.Value</span><a href="#107673">v1</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107688" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">CREATE_ARRAY</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107691">elem</a></span>, <span class="typed"><span class="type">Int</span><a id="107692">dims</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107693" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int</span><a href="#107692">dims</a></span>)
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">IS_INSTANCE</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107697">tpe</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107698" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">CHECK_CAST</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107702">tpe</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107703" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">SWITCH</a>(<span class="typed"><span class="type">List[List[Int]]</span><a id="107707">tags</a></span>, <span class="typed"><span class="type">List[CopyPropagation.this.global.icodes.BasicBlock]</span><a id="107708">labels</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">JUMP</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a id="107710">whereto</a></span>) =&gt;
          <span class="typed"><span class="type">Unit</span><span >(</span></span>)
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">CJUMP</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a id="107711">success</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a id="107712">failure</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.TestOp</span><a id="107713">cond</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107714">kind</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>)
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">CZJUMP</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a id="107716">success</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a id="107717">failure</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.TestOp</span><a id="107718">cond</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107719">kind</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">RETURN</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107721">kind</a></span>) =&gt;
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a href="#107721">kind</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">object CopyPropagation.this.global.icodes.UNIT</span><a href="../TypeKinds.scala.html#32355">UNIT</a></span>)
            <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">THROW</a>() =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">DROP</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107725">kind</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">DUP</a>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.TypeKind</span><a id="107727">kind</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.Value</span><a id="21332">head</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107728" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>
          
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">MONITOR_ENTER</a>() =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>);         

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">MONITOR_EXIT</a>() =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">SCOPE_ENTER</a>(_) | <a id="1">SCOPE_EXIT</a>(_) =&gt;
          <span class="typed"><span class="type">Unit</span><span >(</span></span>)
        
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">LOAD_EXCEPTION</a>() =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(object CopyPropagation.this.Unknown)List[object CopyPropagation.this.Unknown]</span><a href="#107733" id="21335">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>

        <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> _ =&gt;
          <span class="typed"><span class="type">=&gt; Unit</span><a href="../ICodes.scala.html#32310">dump</a></span>
          <span class="typed"><span class="type">(String)Nothing</span><a href="../../../Global.scala.html#21214">abort</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Unknown instruction: &quot;)</span><span class="string">&quot;Unknown instruction: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.Instruction</span><a href="#80909">i</a></span>)
      }
      <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107473">out</a></span>
    } <span class="comment">/* def interpret */</span>

    <span class="comment">/** Remove all references to this local variable from both stack
     *  and bindings. It is called when a new assignment destroys 
     *  previous copy-relations.
     */</span>
    <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.Location)Unit</span><a id="80695">cleanReferencesTo</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a id="107527">s</a></span>: copyLattice.<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#80674">State</a></span>, <span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107528">target</a></span>: <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#80637">Location</a></span>) {
      <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.Record)CopyPropagation.this.Record</span><a id="107736">cleanRecord</a></span>(<span class="typed"><span class="type">CopyPropagation.this.Record</span><a id="107737">r</a></span>: <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80647">Record</a></span>): <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80647">Record</a></span> = {
        <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#107737">r</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#80825">bindings</a></span> <span class="typed"><span class="type">((CopyPropagation.this.global.Symbol, CopyPropagation.this.Value) =&gt; Boolean)Unit</span><a id="24210">retain</a></span> { (<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a id="107739">loc</a></span>, <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107740">value</a></span>) =&gt;
          <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107740">value</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107741">loc1</a></span>) <span class="keyword">if</span> (<span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107741">loc1</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107528">target</a></span>) =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
            <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> <a id="1">Boxed</a>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107743">loc1</a></span>) <span class="keyword">if</span> (<span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107743">loc1</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107528">target</a></span>)  =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
            <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
          }
        }
        <span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#107737">r</a></span>
      }

      <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107527">s</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107527">s</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span> <span class="typed"><span class="type">((CopyPropagation.this.Value) =&gt; CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a id="21362">map</a></span> { <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107748">v</a></span> =&gt; <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107748">v</a></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">CopyPropagation.this.Record</span><span class="keyword">case</span></span> <a id="1">Record</a>(_, <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="107749">bindings</a></span>) =&gt;
          <span class="typed"><span class="type">(CopyPropagation.this.Record)CopyPropagation.this.Record</span><a href="#107736">cleanRecord</a></span>(<span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107748">v</a></span>.<span class="typed"><span class="type">CopyPropagation.this.Record</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80647">Record</a></span>])
        <span class="typed"><span class="type">CopyPropagation.this.Unknown.type</span><span class="keyword">case</span></span> <a id="1">Boxed</a>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107750">loc1</a></span>) <span class="keyword">if</span> (<span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107750">loc1</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107528">target</a></span>) =&gt; <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span>
        <span class="typed"><span class="type">CopyPropagation.this.Value</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107748">v</a></span>
      }}

      <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107527">s</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.Bindings</span><a href="#80744">bindings</a></span> <span class="typed"><span class="type">((CopyPropagation.this.Location, CopyPropagation.this.Value) =&gt; Boolean)Unit</span><a id="24210">retain</a></span> { (<span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107753">loc</a></span>, <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107754">value</a></span>) =&gt;
        (<span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107754">value</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107755">loc1</a></span>) <span class="keyword">if</span> (<span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107755">loc1</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107528">target</a></span>) =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
          <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> <a id="1">Boxed</a>(<span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107757">loc1</a></span>) <span class="keyword">if</span> (<span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107757">loc1</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107528">target</a></span>) =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
          <span class="typed"><span class="type">Boolean</span><span class="keyword">case</span></span> <a id="1">Record</a>(_, _) =&gt; 
            <span class="typed"><span class="type">(CopyPropagation.this.Record)CopyPropagation.this.Record</span><a href="#107736">cleanRecord</a></span>(<span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107754">value</a></span>.<span class="typed"><span class="type">CopyPropagation.this.Record</span><a id="3503">asInstanceOf</a></span>[<span class="typed"><span class="type">CopyPropagation.this.Record</span><a href="#80647">Record</a></span>]);
            <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
          <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
        }) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> 
        (<span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107753">loc</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107759">l</a></span>: <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#80637">Location</a></span> <span class="keyword">if</span> (<span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107759">l</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">CopyPropagation.this.Location</span><a href="#107528">target</a></span>) =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
          <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
        })
      }
    }

    <span class="comment">/** Update the state &lt;code&gt;s&lt;/code&gt; after the call to &lt;code&gt;method&lt;/code&gt;.
     *  The stack elements are dropped and replaced by the result of the call.
     *  If the method is impure, all bindings to record fields are cleared.
     *
     *  @param state  ...
     *  @param method ...
     *  @param static ...
     *  @return       ...
     */</span>
    <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.global.Symbol,Boolean)CopyPropagation.this.copyLattice.State</span><a id="80696">simulateCall</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a id="107588">state</a></span>: copyLattice.<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#80674">State</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a id="107589">method</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#21866">Symbol</a></span>, <span class="typed"><span class="type">Boolean</span><a id="107590">static</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span>): copyLattice.<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#80674">State</a></span> = {
      <span class="keyword">val</span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a id="107761">out</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><span class="keyword">new</span></span> <span class="typed"><span class="type">object CopyPropagation.this.copyLattice</span><a href="#80663">copyLattice</a></span>.<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#80674">State</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107588">state</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.Bindings</span><a href="#80744">bindings</a></span>, <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107588">state</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>);
      <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107761">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107761">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107589">method</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Symbols.scala.html#25231">info</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.Type]</span><a href="../../../symtab/Types.scala.html#25668">paramTypes</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21345">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> (<span class="typed"><span class="type">Int</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#107590">static</a></span>) <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span> <span class="keyword">else</span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>));
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107589">method</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Symbols.scala.html#25231">info</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Types.scala.html#25663">resultType</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">object CopyPropagation.this.global.definitions</span><a href="../../../symtab/Definitions.scala.html#22259">definitions</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Definitions.scala.html#25821">UnitClass</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Symbols.scala.html#25230">tpe</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107589">method</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../../symtab/Symbols.scala.html#25148">isConstructor</a></span>)
        <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107761">out</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">object CopyPropagation.this.Unknown</span><a href="#80659">Unknown</a></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a href="#107785" id="21335">::</a></span> <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107761">out</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>;
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">(CopyPropagation.this.global.Symbol)Boolean</span><a href="#80700">isPureMethod</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107589">method</a></span>))
        <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State)Unit</span><a href="#80697">invalidateRecords</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107761">out</a></span>);
      <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107761">out</a></span>
    }

    <span class="comment">/** Drop everything known about mutable record fields.
     *
     *  @param state ...
     */</span>
    <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State)Unit</span><a id="80697">invalidateRecords</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a id="107789">state</a></span>: copyLattice.<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#80674">State</a></span>) {
      <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107789">state</a></span>.<span class="typed"><span class="type">(List[CopyPropagation.this.Value])Unit</span><a href="#80747">stack</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107789">state</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span> <span class="typed"><span class="type">((CopyPropagation.this.Value) =&gt; CopyPropagation.this.Value)List[CopyPropagation.this.Value]</span><a id="21362">map</a></span> { <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107793">v</a></span> =&gt; <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107793">v</a></span> <span class="typed"><span class="type">CopyPropagation.this.Value</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">CopyPropagation.this.Record</span><span class="keyword">case</span></span> <a id="1">Record</a>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a id="107794">cls</a></span>, <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="107795">bindings</a></span>) =&gt;
          <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#107795">bindings</a></span>.<span class="typed"><span class="type">((CopyPropagation.this.global.Symbol, CopyPropagation.this.Value) =&gt; Boolean)Unit</span><a id="24210">retain</a></span> { (<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a id="107797">sym</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#21866">Symbol</a></span>, <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107798">v</a></span>: <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#80646">Value</a></span>) =&gt; <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107797">sym</a></span>.<span class="typed"><span class="type">(Long)Boolean</span><a href="../../../symtab/Symbols.scala.html#25223">hasFlag</a></span>(symtab.Flags.<span class="typed"><span class="type">Long(4096L)</span><span >MUTABLE</span></span>) }
          <span class="typed"><span class="type">(CopyPropagation.this.global.Symbol,scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value])CopyPropagation.this.Record</span><a href="#80820">Record</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107794">cls</a></span>, <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#107795">bindings</a></span>)
        <span class="typed"><span class="type">CopyPropagation.this.Value</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107793">v</a></span>
      }}

      <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107789">state</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.copyLattice.Bindings</span><a href="#80744">bindings</a></span> <span class="typed"><span class="type">((CopyPropagation.this.Location, CopyPropagation.this.Value) =&gt; Boolean)Unit</span><a id="24210">retain</a></span> {(<span class="typed"><span class="type">CopyPropagation.this.Location</span><a id="107800">loc</a></span>, <span class="typed"><span class="type">CopyPropagation.this.Value</span><a id="107801">value</a></span>) =&gt;
        <span class="typed"><span class="type">CopyPropagation.this.Value</span><a href="#107801">value</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<a id="1">Field</a>(_, _)) =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
          <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> <a id="1">Boxed</a>(<a id="1">Field</a>(_, _)) =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
          <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
        }
      }
    }

    <span class="comment">/** Return bindings from an object fields to the values on the stack. This
     *  method has to find the correct mapping from fields to the order in which
     *  they are passed on the stack. It works for primary constructors.
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.copyLattice.State,CopyPropagation.this.global.Symbol)scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="80698">getBindingsForPrimaryCtor</a></span>(<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a id="107623">in</a></span>: copyLattice.<span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#80674">State</a></span>, <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a id="107624">ctor</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#21866">Symbol</a></span>): <span class="typed"><span class="type">scala.collection.mutable.Map[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="19880">Map</a></span>[Symbol, Value] = {
      <span class="keyword">val</span> <span class="typed"><span class="type">List[CopyPropagation.this.global.Symbol]</span><a id="107802">paramAccessors</a></span> = <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107624">ctor</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#25211">owner</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.Symbol]</span><a href="../../../symtab/Symbols.scala.html#25265">constrParamAccessors</a></span>;
      <span class="keyword">var</span> <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a id="107803">values</a></span> = <span class="typed"><span class="type">CopyPropagation.this.copyLattice.State</span><a href="#107623">in</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21351">take</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107624">ctor</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Symbols.scala.html#25231">info</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.Type]</span><a href="../../../symtab/Types.scala.html#25668">paramTypes</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21345">length</a></span>).<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a id="21385">reverse</a></span>.<span class="typed"><span class="type">(Int)List[CopyPropagation.this.Value]</span><a id="21353">drop</a></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>);
      <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="107804">bindings</a></span> = <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a id="20081">HashMap</a></span>[Symbol, Value];

      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../../../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="../../../Settings.scala.html#30066">debug</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="../../../Settings.scala.html#30301">value</a></span>) <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;getBindings for: &quot;)</span><span class="string">&quot;getBindings for: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107624">ctor</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; acc: &quot;)</span><span class="string">&quot; acc: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">List[CopyPropagation.this.global.Symbol]</span><a href="#107802">paramAccessors</a></span>)
      
      <span class="keyword">var</span> <span class="typed"><span class="type">List[CopyPropagation.this.global.Type]</span><a id="107805">paramTypes</a></span> = <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107624">ctor</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Symbols.scala.html#25230">tpe</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.Type]</span><a href="../../../symtab/Types.scala.html#25668">paramTypes</a></span> 
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="107806">diff</a></span> = <span class="typed"><span class="type">List[CopyPropagation.this.global.Type]</span><a href="#107805">paramTypes</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21345">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">-</a></span> <span class="typed"><span class="type">List[CopyPropagation.this.global.Symbol]</span><a href="#107802">paramAccessors</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21345">length</a></span>
      <span class="typed"><span class="type">Int</span><a href="#107806">diff</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span> =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>)
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> <span class="keyword">if</span> <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107624">ctor</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Symbols.scala.html#25230">tpe</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.Type]</span><a href="../../../symtab/Types.scala.html#25668">paramTypes</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a id="21332">head</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107624">ctor</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#25211">owner</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#25070">rawowner</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Symbols.scala.html#25230">tpe</a></span> =&gt;
          <span class="comment">// it's an unused outer</span>
          <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;considering unused outer at position 0 in &quot;)</span><span class="string">&quot;considering unused outer at position 0 in &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107624">ctor</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Symbols.scala.html#25230">tpe</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.Type]</span><a href="../../../symtab/Types.scala.html#25668">paramTypes</a></span>)
          <span class="typed"><span class="type">List[CopyPropagation.this.global.Type]</span><a href="#107805">paramTypes</a></span> = <span class="typed"><span class="type">List[CopyPropagation.this.global.Type]</span><a href="#107805">paramTypes</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.Type]</span><a id="21334">tail</a></span>
          <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a href="#107803">values</a></span> = <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a href="#107803">values</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a id="21334">tail</a></span>
        <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> _ =&gt;
          <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;giving up on &quot;)</span><span class="string">&quot;giving up on &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107624">ctor</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;(diff: &quot;)</span><span class="string">&quot;(diff: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">Int</span><a href="#107806">diff</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;)&quot;)</span><span class="string">&quot;)&quot;</span></span>)
          <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#107804">bindings</a></span>
      }
      
      <span class="comment">// this relies on having the same order in paramAccessors and</span>
      <span class="comment">// the arguments on the stack. It should be the same!</span>
      <span class="keyword">for</span> (<span class="typed"><span class="type">(((CopyPropagation.this.global.Symbol, Int)) =&gt; Unit)Unit</span><span id="21366"><a href="#107837" id="21367">(</a></span></span><span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><span id="107838"><a id="107843">p</a></span></span>, <span class="typed"><span class="type">Int</span><span id="107839"><a id="107844">i</a></span></span>) &lt;- <span class="typed"><span class="type">List[CopyPropagation.this.global.Symbol]</span><a href="#107802">paramAccessors</a></span>.<span class="typed"><span class="type">=&gt; List[(CopyPropagation.this.global.Symbol, Int)]</span><a id="21388">zipWithIndex</a></span>) {
<span class="comment">//        assert(p.tpe == paramTypes(i), &quot;In: &quot; + ctor.fullNameString</span>
<span class="comment">//               + &quot; having acc: &quot; + (paramAccessors map (_.tpe))+ &quot; vs. params&quot; + paramTypes</span>
<span class="comment">//               + &quot;\n\t failed at pos &quot; + i + &quot; with &quot; + p.tpe + &quot; == &quot; + paramTypes(i))</span>
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107843">p</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Symbols.scala.html#25230">tpe</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">(Int)CopyPropagation.this.global.Type</span><a href="#107805" id="21361">paramTypes</a></span>(<span class="typed"><span class="type">Int</span><a href="#107844">i</a></span>))
          <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#107804">bindings</a></span> <span class="typed"><span class="type">((CopyPropagation.this.global.Symbol, CopyPropagation.this.Value))Unit</span><a id="24189">+=</a></span> (<span class="typed"><span class="type">(CopyPropagation.this.global.Symbol)ArrowAssoc[CopyPropagation.this.global.Symbol]</span><span id="6054"><a href="#107843" id="821">p</a></span></span> <span class="typed"><span class="type">(CopyPropagation.this.Value)(CopyPropagation.this.global.Symbol, CopyPropagation.this.Value)</span><a id="6050">-&gt;</a></span> <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a href="#107803">values</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.Value</span><a id="21332">head</a></span>);
        <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a href="#107803">values</a></span> = <span class="typed"><span class="type">List[CopyPropagation.this.Value]</span><a href="#107803">values</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a id="21334">tail</a></span>;
      }

      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../../../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="../../../Settings.scala.html#30066">debug</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="../../../Settings.scala.html#30301">value</a></span>) <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;\011&quot;)</span><span class="string">&quot;\t&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#107804">bindings</a></span>)
      <span class="typed"><span class="type">scala.collection.mutable.HashMap[CopyPropagation.this.global.Symbol,CopyPropagation.this.Value]</span><a href="#107804">bindings</a></span>
    }

    <span class="comment">/** Is &lt;code&gt;cls&lt;/code&gt; a closure class?
     *
     *  @param cls ...
     *  @return    ...
     */</span>
    <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.global.Symbol)Boolean</span><a id="80699">isClosureClass</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a id="107863">cls</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#21866">Symbol</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = 
        <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107863">cls</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../../symtab/Symbols.scala.html#25197">isFinal</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span>
        <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107863">cls</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.Type</span><a href="../../../symtab/Symbols.scala.html#25230">tpe</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.Type]</span><a href="../../../symtab/Types.scala.html#25659">parents</a></span>.<span class="typed"><span class="type">((CopyPropagation.this.global.Type) =&gt; Boolean)Boolean</span><a id="21373">exists</a></span> { <span class="typed"><span class="type">CopyPropagation.this.global.Type</span><a id="107866">t</a></span> =&gt; 
          <span class="keyword">val</span> <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107868">TypeRef</a></span>(_, <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><span id="107867"><a id="107868">sym</a></span></span>, _) = <span class="typed"><span class="type">CopyPropagation.this.global.Type</span><a href="#107866">t</a></span>;
          <span class="typed"><span class="type">object CopyPropagation.this.global.definitions</span><a href="../../../symtab/Definitions.scala.html#22259">definitions</a></span>.<span class="typed"><span class="type">=&gt; Array[CopyPropagation.this.global.Symbol]</span><a href="../../../symtab/Definitions.scala.html#25997">FunctionClass</a></span> <span class="typed"><span class="type">((CopyPropagation.this.global.Symbol) =&gt; Boolean)Boolean</span><a id="21794">exists</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107867">sym</a></span>.<span class="typed"><span class="type">(AnyRef)Boolean</span><a href="#107871" id="3509">==</a></span>
        }

    <span class="comment">/** Is symbol &lt;code&gt;m&lt;/code&gt; a pure method?
     *
     *  @param m ...
     *  @return  ...
     */</span>
    <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(CopyPropagation.this.global.Symbol)Boolean</span><a id="80700">isPureMethod</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a id="107788">m</a></span>: <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="../../../symtab/Symbols.scala.html#21866">Symbol</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = 
      <span class="typed"><span class="type">CopyPropagation.this.global.Symbol</span><a href="#107788">m</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../../symtab/Symbols.scala.html#25137">isGetter</a></span> <span class="comment">// abstract getters are still pure, as we 'know'</span>

    <span class="keyword">final</span> <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="80701">toString</a></span>(): <span class="typed"><span class="type">String</span><a id="1861">String</a></span> = {
      <span class="keyword">var</span> <span class="typed"><span class="type">java.lang.String</span><a id="107873">res</a></span> = <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>
      <span class="keyword">for</span> (<span class="typed"><span class="type">((CopyPropagation.this.global.icodes.BasicBlock) =&gt; Unit)Unit</span><span id="21366"><a id="107877">b</a></span></span> &lt;- <span class="typed"><span class="type">CopyAnalysis.this.type</span><a href="#80665" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.IMethod</span><a href="#80687">method</a></span>.<span class="typed"><span class="type">=&gt; CopyPropagation.this.global.icodes.Code</span><a href="../Members.scala.html#32867">code</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.ListBuffer[CopyPropagation.this.global.icodes.BasicBlock]</span><a href="../Members.scala.html#33274">blocks</a></span>.<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.global.icodes.BasicBlock]</span><a id="33309">toList</a></span>)
        <span class="typed"><span class="type">java.lang.String</span><a href="#107873">res</a></span> = (<span class="typed"><span class="type">java.lang.String</span><a href="#107873">res</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;\012IN(&quot;)</span><span class="string">&quot;\nIN(&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107877">b</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../BasicBlocks.scala.html#33150">label</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;):\011 Bindings: &quot;)</span><span class="string">&quot;):\t Bindings: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">(CopyAnalysis.this.P)CopyAnalysis.this.lattice.Elem</span><a href="DataFlowAnalysis.scala.html#32744" id="24239">in</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107877">b</a></span>).<span class="typed"><span class="type">=&gt; CopyAnalysis.this.lattice.Bindings</span><a href="#80744">bindings</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span>
               <span class="typed"><span class="type">java.lang.String(&quot;\012IN(&quot;)</span><span class="string">&quot;\nIN(&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107877">b</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../BasicBlocks.scala.html#33150">label</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span><span class="typed"><span class="type">java.lang.String(&quot;):\011 Stack: &quot;)</span><span class="string">&quot;):\t Stack: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">(CopyAnalysis.this.P)CopyAnalysis.this.lattice.Elem</span><a href="DataFlowAnalysis.scala.html#32744" id="24239">in</a></span>(<span class="typed"><span class="type">CopyPropagation.this.global.icodes.BasicBlock</span><a href="#107877">b</a></span>).<span class="typed"><span class="type">=&gt; List[CopyPropagation.this.Value]</span><a href="#80746">stack</a></span>) <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;\012&quot;)</span><span class="string">&quot;\n&quot;</span></span>;
      <span class="typed"><span class="type">java.lang.String</span><a href="#107873">res</a></span>
    }

  } <span class="comment">/* class CopyAnalysis */</span>
}

        </pre>
    </body>
</html>