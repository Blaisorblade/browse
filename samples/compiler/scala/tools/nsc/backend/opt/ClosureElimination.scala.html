<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/backend/opt/ClosureElimination.scala</title>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
 <span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Iulian Dragos
 */</span>

<span class="comment">// $Id: ClosureElimination.scala 17396 2009-03-30 12:26:51Z dragos $</span>

<span class="keyword">package</span> scala.tools.nsc.backend.opt;

<span class="keyword">import</span> scala.collection.mutable.{Map, HashMap};
<span class="keyword">import</span> scala.tools.nsc.backend.icode.analysis.LubError;
<span class="keyword">import</span> scala.tools.nsc.symtab._;

<span class="comment">/**
 *  @author Iulian Dragos
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class ClosureElimination extends scala.tools.nsc.SubComponent with ScalaObject</span><a id="8564">ClosureElimination</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">scala.tools.nsc.SubComponent</span><a href="../../SubComponent.scala.html#6300">SubComponent</a></span> {
  <span class="keyword">import</span> global._
  <span class="keyword">import</span> icodes._
  <span class="keyword">import</span> icodes.opcodes._

  <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="80560"><a id="80559">phaseName</a></span></span> = <span class="typed"><span class="type">java.lang.String(&quot;closelim&quot;)</span><span class="string">&quot;closelim&quot;</span></span>

  <span class="comment">/** Create a new phase */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.Phase)ClosureElimination.this.ClosureEliminationPhase</span><a id="80561">newPhase</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Phase</span><a id="80566">p</a></span>: <span class="typed"><span class="type">scala.tools.nsc.Phase</span><a href="../../Phase.scala.html#6873">Phase</a></span>) = <span class="typed"><span class="type">ClosureElimination.this.ClosureEliminationPhase</span><span class="keyword">new</span></span> <span class="typed"><span class="type">ClosureElimination.this.ClosureEliminationPhase</span><a href="#80562">ClosureEliminationPhase</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Phase</span><a href="#80566">p</a></span>)

  <span class="comment">/** The Inlining phase.
   */</span>
  <span class="keyword">class</span> <span class="typed"><span class="type">class ClosureEliminationPhase extends ClosureElimination.this.global.icodes.ICodePhase with ScalaObject</span><a id="80562">ClosureEliminationPhase</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Phase</span><span id="80569"><a id="80575">prev</a></span></span>: <span class="typed"><span class="type">scala.tools.nsc.Phase</span><a href="../../Phase.scala.html#6873">Phase</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.ICodePhase</span><a href="../icode/ICodes.scala.html#32320">ICodePhase</a></span>(<span class="typed"><span class="type">scala.tools.nsc.Phase</span><a href="#80575">prev</a></span>) {

    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; java.lang.String</span><a id="80571">name</a></span> = <span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#80559">phaseName</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">ClosureElimination.this.ClosureElim</span><span id="80573"><a id="80572">closser</a></span></span> = <span class="typed"><span class="type">ClosureElimination.this.ClosureElim</span><span class="keyword">new</span></span> <span class="typed"><span class="type">ClosureElimination.this.ClosureElim</span><a href="#80563">ClosureElim</a></span>

    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.IClass)Unit</span><a id="80574">apply</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IClass</span><a id="80595">c</a></span>: <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IClass</span><a href="../icode/Members.scala.html#32330">IClass</a></span>): <span class="typed"><span class="type">Unit</span><a id="2169">Unit</a></span> =
      <span class="typed"><span class="type">=&gt; ClosureElimination.this.ClosureElim</span><a href="#80572">closser</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.IClass)Unit</span><a href="#80585">analyzeClass</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IClass</span><a href="#80595">c</a></span>)
  }

  <span class="comment">/** 
   * Remove references to the environemnt through fields of a closure object. 
   * This has to be run after an 'apply' method has been inlined, but it still 
   * references the closure object.
   *
   */</span>
  <span class="keyword">class</span> <span class="typed"><span class="type">class ClosureElim extends java.lang.Object with ScalaObject</span><a id="80563">ClosureElim</a></span> {

    <span class="comment">/* fresh name counter */</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="80581"><span id="80579"><span id="80580"><a id="80598">count</a></span></span></span></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    
    <span class="keyword">def</span> <span class="typed"><span class="type">(String)java.lang.String</span><a id="80582">freshName</a></span>(<span class="typed"><span class="type">String</span><a id="80702">s</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = {
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="80704">ret</a></span> = <span class="typed"><span class="type">String</span><a href="#80702">s</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElim.this.type</span><a href="#80563" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="#80579">count</a></span>
      <span class="typed"><span class="type">ClosureElim.this.type</span><a href="#80563" class="keyword">this</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="#80580">count</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      <span class="typed"><span class="type">java.lang.String</span><a href="#80704">ret</a></span>
    }

    <span class="comment">/** A simple peephole optimizer. */</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">ClosureElimination.this.PeepholeOpt</span><span id="80584"><a id="80583">peephole</a></span></span> = <span class="typed"><span class="type">ClosureElimination.this.PeepholeOpt</span><span class="keyword">new</span></span> <span class="typed"><span class="type">ClosureElimination.this.PeepholeOpt</span><a href="#80564">PeepholeOpt</a></span>( (<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a id="80609">i1</a></span>, <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a id="80610">i2</a></span>) =&gt;
    	<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction,ClosureElimination.this.global.icodes.Instruction)(ClosureElimination.this.global.icodes.Instruction, ClosureElimination.this.global.icodes.Instruction)</span><span id="23625"><a id="1379">(</a></span></span><span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80609">i1</a></span>, <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80610">i2</a></span>) <span class="typed"><span class="type">Option[List[ClosureElimination.this.global.icodes.Instruction]]</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">Option[List[ClosureElimination.this.global.icodes.Instruction]]</span><span class="keyword">case</span></span> <a id="1">(</a><a id="1">CONSTANT</a>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Constant</span><a id="80613">c</a></span>), <a id="1">DROP</a>(_)) =&gt; 
          <span class="typed"><span class="type">Option[List[ClosureElimination.this.global.icodes.Instruction]]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Constant</span><a href="#80613">c</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../symtab/Constants.scala.html#37590">tag</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">==</a></span> <span class="typed"><span class="type">Int(1)</span><span >UnitTag</span></span>)
            <span class="typed"><span class="type">(List[ClosureElimination.this.global.icodes.Instruction])Some[List[ClosureElimination.this.global.icodes.Instruction]]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction*)List[ClosureElimination.this.global.icodes.Instruction]</span><span id="21328"><a id="527">List</a></span></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80610">i2</a></span>))
          <span class="keyword">else</span>
            <span class="typed"><span class="type">(object Nil)Some[object Nil]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>);
          
        <span class="typed"><span class="type">Option[List[ClosureElimination.this.global.icodes.Instruction]]</span><span class="keyword">case</span></span> <a id="1">(</a><a id="1">LOAD_LOCAL</a>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Local</span><a id="80618">x</a></span>), <a id="1">STORE_LOCAL</a>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Local</span><a id="80619">y</a></span>)) =&gt;
        	<span class="typed"><span class="type">Option[List[ClosureElimination.this.global.icodes.Instruction]]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Local</span><a href="#80618">x</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Local</span><a href="#80619">y</a></span>) <span class="typed"><span class="type">(object Nil)Some[object Nil]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>) <span class="keyword">else</span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span>

<span class="comment">//        case (STORE_LOCAL(x), LOAD_LOCAL(y)) if (x == y) =&gt;</span>
<span class="comment">//          Some(List(DUP(x.kind), STORE_LOCAL(x)))</span>
          
        <span class="typed"><span class="type">Some[object Nil]</span><span class="keyword">case</span></span> <a id="1">(</a><a id="1">LOAD_LOCAL</a>(_), <a id="1">DROP</a>(_)) | <a id="1">(</a><a id="1">DUP</a>(_), <a id="1">DROP</a>(_)) =&gt;
          <span class="typed"><span class="type">(object Nil)Some[object Nil]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>)

        <span class="typed"><span class="type">Some[object Nil]</span><span class="keyword">case</span></span> <a id="1">(</a><a id="1">BOX</a>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.TypeKind</span><a id="80622">t1</a></span>), <a id="1">UNBOX</a>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.TypeKind</span><a id="80623">t2</a></span>)) <span class="keyword">if</span> (<span class="typed"><span class="type">ClosureElimination.this.global.icodes.TypeKind</span><a href="#80622">t1</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.TypeKind</span><a href="#80623">t2</a></span>) =&gt;
          <span class="typed"><span class="type">(object Nil)Some[object Nil]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>)
          
        <span class="typed"><span class="type">Option[List[ClosureElimination.this.global.icodes.Instruction]]</span><span class="keyword">case</span></span> <a id="1">(</a><a id="1">LOAD_FIELD</a>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Symbol</span><a id="80626">sym</a></span>, <span class="typed"><span class="type">Boolean</span><a id="80627">isStatic</a></span>), <a id="1">DROP</a>(_)) =&gt;
        	<span class="typed"><span class="type">Option[List[ClosureElimination.this.global.icodes.Instruction]]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#80627">isStatic</a></span>)
            <span class="typed"><span class="type">(object Nil)Some[object Nil]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>)
          <span class="keyword">else</span>
            <span class="typed"><span class="type">(List[ClosureElimination.this.global.icodes.opcodes.DROP])Some[List[ClosureElimination.this.global.icodes.opcodes.DROP]]</span><span id="29737"><a id="308">Some</a></span></span>(<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.TypeKind)ClosureElimination.this.global.icodes.opcodes.DROP</span><a href="../icode/Opcodes.scala.html#33759">DROP</a></span>(<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.global.Symbol)ClosureElimination.this.global.icodes.REFERENCE</span><a href="../icode/TypeKinds.scala.html#33948">REFERENCE</a></span>(<span class="typed"><span class="type">object ClosureElimination.this.global.definitions</span><a href="../../symtab/Definitions.scala.html#22259">definitions</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.Symbol</span><a href="../../symtab/Definitions.scala.html#25778">ObjectClass</a></span>)) <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.opcodes.DROP)List[ClosureElimination.this.global.icodes.opcodes.DROP]</span><a href="#80630" id="21335">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>);
          
        <span class="typed"><span class="type">None.type</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">object None</span><a id="536">None</a></span>
      });
    
    <span class="keyword">def</span> <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.IClass)Unit</span><a id="80585">analyzeClass</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IClass</span><a id="80596">cls</a></span>: <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IClass</span><a href="../icode/Members.scala.html#32330">IClass</a></span>): <span class="typed"><span class="type">Unit</span><a id="2169">Unit</a></span> = <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="../../Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="../../Settings.scala.html#30058">Xcloselim</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="../../Settings.scala.html#30301">value</a></span>) {
      <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IClass</span><a href="#80596">cls</a></span>.<span class="typed"><span class="type">=&gt; List[ClosureElimination.this.global.icodes.IMethod]</span><a href="../icode/Members.scala.html#32687">methods</a></span>.<span class="typed"><span class="type">((ClosureElimination.this.global.icodes.IMethod) =&gt; Unit)Unit</span><a id="21366">foreach</a></span> { <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a id="80732">m</a></span> =&gt; 
        <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.IMethod)Unit</span><a href="#80589">analyzeMethod</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80732">m</a></span>)
        <span class="typed"><span class="type">=&gt; ClosureElimination.this.PeepholeOpt</span><a href="#80583">peephole</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.IMethod)Unit</span><a href="#80605">transformMethod</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80732">m</a></span>);
     }}


    <span class="keyword">val</span> <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.CopyAnalysis</span><span id="80587"><a id="80586">cpp</a></span></span> = <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.CopyAnalysis</span><span class="keyword">new</span></span> <span class="typed"><span class="type">object ClosureElimination.this.global.copyPropagation</span><a href="../../Global.scala.html#21180">copyPropagation</a></span>.<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.CopyAnalysis</span><a href="../icode/analysis/CopyPropagation.scala.html#80665">CopyAnalysis</a></span>


    <span class="keyword">import</span> copyPropagation._

    <span class="comment">/* Some embryonic copy propagation. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.IMethod)Unit</span><a id="80589">analyzeMethod</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a id="80733">m</a></span>: <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="../icode/Members.scala.html#32332">IMethod</a></span>): <span class="typed"><span class="type">Unit</span><a id="2169">Unit</a></span> = <span class="keyword">try</span> {<span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80733">m</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.icodes.Code</span><a href="../icode/Members.scala.html#32867">code</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5795">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) {
      <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Analyzing &quot;)</span><span class="string">&quot;Analyzing &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80733">m</a></span>)
      <span class="typed"><span class="type">=&gt; ClosureElimination.this.global.copyPropagation.CopyAnalysis</span><a href="#80586">cpp</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.IMethod)Unit</span><a href="../icode/analysis/CopyPropagation.scala.html#80690">init</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80733">m</a></span>)
      <span class="typed"><span class="type">=&gt; ClosureElimination.this.global.copyPropagation.CopyAnalysis</span><a href="#80586">cpp</a></span>.<span class="typed"><span class="type">=&gt; Unit</span><a href="../icode/analysis/CopyPropagation.scala.html#80691">run</a></span>

      <span class="keyword">for</span> (<span class="typed"><span class="type">((ClosureElimination.this.global.icodes.BasicBlock) =&gt; Unit)Unit</span><span id="21366"><a id="80740">bb</a></span></span> &lt;- <span class="typed"><span class="type">=&gt; ClosureElimination.this.global.icodes.Linearizer</span><a href="../icode/ICodes.scala.html#32308">linearizer</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.IMethod)List[ClosureElimination.this.global.icodes.BasicBlock]</span><a href="../icode/Linearizers.scala.html#33332">linearize</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80733">m</a></span>)) {
        <span class="keyword">var</span> <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a id="80741">info</a></span> = <span class="typed"><span class="type">=&gt; ClosureElimination.this.global.copyPropagation.CopyAnalysis</span><a href="#80586">cpp</a></span>.<span class="typed"><span class="type">(ClosureElim.this.cpp.P)ClosureElim.this.cpp.lattice.Elem</span><a href="../icode/analysis/DataFlowAnalysis.scala.html#32744" id="24239">in</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80740">bb</a></span>)
        <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Cpp info at entry to block &quot;)</span><span class="string">&quot;Cpp info at entry to block &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80740">bb</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;: &quot;)</span><span class="string">&quot;: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>)

        <span class="keyword">for</span> (<span class="typed"><span class="type">((ClosureElimination.this.global.icodes.Instruction) =&gt; Unit)Unit</span><span id="21366"><a id="80762">i</a></span></span> &lt;- <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80740">bb</a></span>.<span class="typed"><span class="type">=&gt; List[ClosureElimination.this.global.icodes.Instruction]</span><a href="../icode/BasicBlocks.scala.html#33188">toList</a></span>) {
          <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">LOAD_LOCAL</a>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Local</span><a id="80763">l</a></span>) <span class="keyword">if</span> (<span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">=&gt; ClosureElim.this.cpp.lattice.Bindings</span><a href="../icode/analysis/CopyPropagation.scala.html#80744">bindings</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Location)Boolean</span><a id="24241">isDefinedAt</a></span>(<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.Local)ClosureElimination.this.global.copyPropagation.LocalVar</span><a href="../icode/analysis/CopyPropagation.scala.html#80766">LocalVar</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Local</span><a href="#80763">l</a></span>))) =&gt;
              <span class="keyword">val</span> <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a id="80774">t</a></span> = <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.Local)ClosureElimination.this.global.copyPropagation.Value</span><a href="../icode/analysis/CopyPropagation.scala.html#80752">getBinding</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Local</span><a href="#80763">l</a></span>)
              <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80774">t</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a id="80796">v</a></span>)) =&gt; 
                  <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80740">bb</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction,ClosureElimination.this.global.icodes.Instruction)Boolean</span><a href="../icode/BasicBlocks.scala.html#33198">replaceInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span>, <span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Value)ClosureElimination.this.global.icodes.Instruction</span><a href="#80590">valueToInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80774">t</a></span>));
                  <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;replaced &quot;)</span><span class="string">&quot;replaced &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; with &quot;)</span><span class="string">&quot; with &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80774">t</a></span>)

                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<span class="typed"><span class="type">object ClosureElimination.this.global.copyPropagation.This</span><a href="../icode/analysis/CopyPropagation.scala.html#80644">This</a></span>) =&gt;
                  <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80740">bb</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction,ClosureElimination.this.global.icodes.Instruction)Boolean</span><a href="../icode/BasicBlocks.scala.html#33198">replaceInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span>, <span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Value)ClosureElimination.this.global.icodes.Instruction</span><a href="#80590">valueToInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80774">t</a></span>));
                  <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;replaced &quot;)</span><span class="string">&quot;replaced &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; with &quot;)</span><span class="string">&quot; with &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80774">t</a></span>)

                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt; 
                  <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80740">bb</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction,ClosureElimination.this.global.icodes.Instruction)Boolean</span><a href="../icode/BasicBlocks.scala.html#33198">replaceInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span>, <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Local)ClosureElimination.this.global.icodes.opcodes.LOAD_LOCAL</span><a href="../icode/Opcodes.scala.html#33415">LOAD_LOCAL</a></span>(<span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.Local)ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a href="../icode/analysis/CopyPropagation.scala.html#80751">getAlias</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Local</span><a href="#80763">l</a></span>)));
                  <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;replaced &quot;)</span><span class="string">&quot;replaced &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; with &quot;)</span><span class="string">&quot; with &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.Local)ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a href="../icode/analysis/CopyPropagation.scala.html#80751">getAlias</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Local</span><a href="#80763">l</a></span>))

              }

            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">LOAD_FIELD</a>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Symbol</span><a id="80811">f</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>) <span class="keyword">if</span> <span class="typed"><span class="type">(ClosureElimination.this.global.Symbol,ClosureElimination.this.global.Symbol)Boolean</span><a href="#80591">accessible</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Symbol</span><a href="#80811">f</a></span>, <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80733">m</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.icodes.global.Symbol</span><a href="../icode/Members.scala.html#32864">symbol</a></span>) =&gt;
              <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(Int)ClosureElimination.this.global.copyPropagation.Value</span><a href="../icode/analysis/CopyPropagation.scala.html#80746" id="21361">stack</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Record</span><a id="80818">r</a></span> @ <a id="1">Record</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.Symbol</span><a id="80837">cls</a></span>, <span class="typed"><span class="type">scala.collection.mutable.Map[ClosureElimination.this.global.copyPropagation.global.Symbol,ClosureElimination.this.global.copyPropagation.Value]</span><a id="80838">bindings</a></span>) <span class="keyword">if</span> <span class="typed"><span class="type">scala.collection.mutable.Map[ClosureElimination.this.global.copyPropagation.global.Symbol,ClosureElimination.this.global.copyPropagation.Value]</span><a href="#80838">bindings</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.Symbol)Boolean</span><a id="24241">isDefinedAt</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Symbol</span><a href="#80811">f</a></span>) =&gt;
                  <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Record,ClosureElimination.this.global.copyPropagation.global.Symbol)Option[ClosureElimination.this.global.copyPropagation.Value]</span><a href="../icode/analysis/CopyPropagation.scala.html#80754">getFieldValue</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Record</span><a href="#80818">r</a></span>, <span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Symbol</span><a href="#80811">f</a></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                    <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a id="80841">v</a></span>) =&gt;
                      <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80740">bb</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction,List[ClosureElimination.this.global.icodes.Instruction])Boolean</span><a href="../icode/BasicBlocks.scala.html#33199">replaceInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span>, 
                          <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.TypeKind)ClosureElimination.this.global.icodes.opcodes.DROP</span><a href="../icode/Opcodes.scala.html#33759">DROP</a></span>(<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.global.Symbol)ClosureElimination.this.global.icodes.REFERENCE</span><a href="../icode/TypeKinds.scala.html#33948">REFERENCE</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.Symbol</span><a href="#80837">cls</a></span>)) <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction)List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80843" id="21335">::</a></span> <span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Value)ClosureElimination.this.global.icodes.Instruction</span><a href="#80590">valueToInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80841">v</a></span>) <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction)List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80844" id="21335">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>);
                      <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Replaced &quot;)</span><span class="string">&quot;Replaced &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; with &quot;)</span><span class="string">&quot; with &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Record,ClosureElimination.this.global.copyPropagation.global.Symbol)ClosureElimination.this.global.copyPropagation.Value</span><a href="../icode/analysis/CopyPropagation.scala.html#80753">getBinding</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Record</span><a href="#80818">r</a></span>, <span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Symbol</span><a href="#80811">f</a></span>));
                    <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span> =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>);
                  }

                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a id="80855">l</a></span>)) =&gt;
                  <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.Local)ClosureElimination.this.global.copyPropagation.Value</span><a href="../icode/analysis/CopyPropagation.scala.html#80752">getBinding</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a href="#80855">l</a></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                    <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Record</span><a id="80857">r</a></span> @ <a id="1">Record</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.Symbol</span><a id="80858">cls</a></span>, <span class="typed"><span class="type">scala.collection.mutable.Map[ClosureElimination.this.global.copyPropagation.global.Symbol,ClosureElimination.this.global.copyPropagation.Value]</span><a id="80859">bindings</a></span>) <span class="keyword">if</span> <span class="typed"><span class="type">scala.collection.mutable.Map[ClosureElimination.this.global.copyPropagation.global.Symbol,ClosureElimination.this.global.copyPropagation.Value]</span><a href="#80859">bindings</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.Symbol)Boolean</span><a id="24241">isDefinedAt</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Symbol</span><a href="#80811">f</a></span>) =&gt;
                      <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Record,ClosureElimination.this.global.copyPropagation.global.Symbol)Option[ClosureElimination.this.global.copyPropagation.Value]</span><a href="../icode/analysis/CopyPropagation.scala.html#80754">getFieldValue</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Record</span><a href="#80857">r</a></span>, <span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Symbol</span><a href="#80811">f</a></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a id="80860">v</a></span>) =&gt;
                          <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80740">bb</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction,List[ClosureElimination.this.global.icodes.Instruction])Boolean</span><a href="../icode/BasicBlocks.scala.html#33199">replaceInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span>, 
                              <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.TypeKind)ClosureElimination.this.global.icodes.opcodes.DROP</span><a href="../icode/Opcodes.scala.html#33759">DROP</a></span>(<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.global.Symbol)ClosureElimination.this.global.icodes.REFERENCE</span><a href="../icode/TypeKinds.scala.html#33948">REFERENCE</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.Symbol</span><a href="#80858">cls</a></span>)) <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction)List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80862" id="21335">::</a></span> <span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Value)ClosureElimination.this.global.icodes.Instruction</span><a href="#80590">valueToInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80860">v</a></span>) <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction)List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80863" id="21335">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>);
                          <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Replaced &quot;)</span><span class="string">&quot;Replaced &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; with &quot;)</span><span class="string">&quot; with &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Record,ClosureElimination.this.global.copyPropagation.global.Symbol)ClosureElimination.this.global.copyPropagation.Value</span><a href="../icode/analysis/CopyPropagation.scala.html#80753">getBinding</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Record</span><a href="#80857">r</a></span>, <span class="typed"><span class="type">ClosureElimination.this.global.icodes.global.Symbol</span><a href="#80811">f</a></span>));
                        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span> =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>);
                      }
                    <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>);
                  }

                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>);
              }
              
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">UNBOX</a>(_) =&gt;
              <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">=&gt; List[ClosureElimination.this.global.copyPropagation.Value]</span><a href="../icode/analysis/CopyPropagation.scala.html#80746">stack</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a id="80873">loc1</a></span>)) <a id="1">::</a> _ <span class="keyword">if</span> (<span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">=&gt; ClosureElim.this.cpp.lattice.Bindings</span><a href="../icode/analysis/CopyPropagation.scala.html#80744">bindings</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Location)Boolean</span><a id="24241">isDefinedAt</a></span>(<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.Local)ClosureElimination.this.global.copyPropagation.LocalVar</span><a href="../icode/analysis/CopyPropagation.scala.html#80766">LocalVar</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a href="#80873">loc1</a></span>))) =&gt;
                  <span class="keyword">val</span> <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a id="80875">value</a></span> = <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.Local)ClosureElimination.this.global.copyPropagation.Value</span><a href="../icode/analysis/CopyPropagation.scala.html#80752">getBinding</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a href="#80873">loc1</a></span>)
                  <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80875">value</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                    <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Boxed</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a id="80888">loc2</a></span>)) =&gt;
                      <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80740">bb</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction,List[ClosureElimination.this.global.icodes.Instruction])Boolean</span><a href="../icode/BasicBlocks.scala.html#33199">replaceInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span>, <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.TypeKind)ClosureElimination.this.global.icodes.opcodes.DROP</span><a href="../icode/Opcodes.scala.html#33759">DROP</a></span>(<span class="typed"><span class="type">object ClosureElimination.this.global.icodes</span><a href="../../Global.scala.html#21176">icodes</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.icodes.TypeKind</span><a href="../icode/ICodes.scala.html#32315">AnyRefReference</a></span>) <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction)List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80890" id="21335">::</a></span> <span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Value)ClosureElimination.this.global.icodes.Instruction</span><a href="#80590">valueToInstruction</a></span>(<span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.Local)ClosureElimination.this.global.copyPropagation.Value</span><a href="../icode/analysis/CopyPropagation.scala.html#80752">getBinding</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a href="#80888">loc2</a></span>)) <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction)List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80891" id="21335">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>)
                      <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;replaced &quot;)</span><span class="string">&quot;replaced &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; with &quot;)</span><span class="string">&quot; with &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.Local)ClosureElimination.this.global.copyPropagation.Value</span><a href="../icode/analysis/CopyPropagation.scala.html#80752">getBinding</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a href="#80888">loc2</a></span>))
                    <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt;
                      <span class="typed"><span class="type">Unit</span><span >(</span></span>)
                  }
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Boxed</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a id="80898">loc1</a></span>)) <a id="1">::</a> _ =&gt;
                  <span class="keyword">val</span> <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a id="80899">value</a></span> = <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.global.icodes.Local)ClosureElimination.this.global.copyPropagation.Value</span><a href="../icode/analysis/CopyPropagation.scala.html#80752">getBinding</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a href="#80898">loc1</a></span>)
                  <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80740">bb</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction,List[ClosureElimination.this.global.icodes.Instruction])Boolean</span><a href="../icode/BasicBlocks.scala.html#33199">replaceInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span>, <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.TypeKind)ClosureElimination.this.global.icodes.opcodes.DROP</span><a href="../icode/Opcodes.scala.html#33759">DROP</a></span>(<span class="typed"><span class="type">object ClosureElimination.this.global.icodes</span><a href="../../Global.scala.html#21176">icodes</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.icodes.TypeKind</span><a href="../icode/ICodes.scala.html#32315">AnyRefReference</a></span>) <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction)List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80902" id="21335">::</a></span> <span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Value)ClosureElimination.this.global.icodes.Instruction</span><a href="#80590">valueToInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80899">value</a></span>) <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction)List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80903" id="21335">::</a></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>)
                  <span class="typed"><span class="type">(AnyRef)Unit</span><a href="../../Global.scala.html#21205">log</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;replaced &quot;)</span><span class="string">&quot;replaced &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; with &quot;)</span><span class="string">&quot; with &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80899">value</a></span>)
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt;
                  <span class="typed"><span class="type">Unit</span><span >(</span></span>)
              }

            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>);
          }
          <span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span> = <span class="typed"><span class="type">=&gt; ClosureElimination.this.global.copyPropagation.CopyAnalysis</span><a href="#80586">cpp</a></span>.<span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.copyLattice.Elem,ClosureElimination.this.global.copyPropagation.global.icodes.Instruction)ClosureElimination.this.global.copyPropagation.copyLattice.Elem</span><a href="../icode/analysis/CopyPropagation.scala.html#80694">interpret</a></span>(<span class="typed"><span class="type">ClosureElim.this.cpp.lattice.Elem</span><a href="#80741">info</a></span>, <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80762">i</a></span>)
        }
      }
    }} <span class="keyword">catch</span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.LubError</span><a id="80910">e</a></span>: <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.LubError</span><a href="../icode/analysis/LubError.scala.html#16960">LubError</a></span> =&gt; 
        <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;In method: &quot;)</span><span class="string">&quot;In method: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80733">m</a></span>)
        <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.LubError</span><a href="#80910">e</a></span>)
        <span class="typed"><span class="type">scala.tools.nsc.backend.icode.analysis.LubError</span><a href="#80910">e</a></span>.<span class="typed"><span class="type">()Unit</span><a id="23651">printStackTrace</a></span>
    }

    <span class="comment">/* Partial mapping from values to instructions that load them. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(ClosureElimination.this.global.copyPropagation.Value)ClosureElimination.this.global.icodes.Instruction</span><a id="80590">valueToInstruction</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a id="80804">v</a></span>: <span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="../icode/analysis/CopyPropagation.scala.html#80646">Value</a></span>): <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="../icode/Opcodes.scala.html#32341">Instruction</a></span> = (<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value</span><a href="#80804">v</a></span>: @<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.Value @unchecked</span><a href="../icode/analysis/CopyPropagation.scala.html#80646">unchecked</a></span>) <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">ClosureElimination.this.global.icodes.opcodes.LOAD_LOCAL</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<a id="1">LocalVar</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a id="80922">v</a></span>)) =&gt; 
        <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Local)ClosureElimination.this.global.icodes.opcodes.LOAD_LOCAL</span><a href="../icode/Opcodes.scala.html#33415">LOAD_LOCAL</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.icodes.Local</span><a href="#80922">v</a></span>)
      <span class="typed"><span class="type">ClosureElimination.this.global.icodes.opcodes.CONSTANT</span><span class="keyword">case</span></span> <a id="1">Const</a>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.Constant</span><a id="80934">k</a></span>) =&gt;
        <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.global.Constant)ClosureElimination.this.global.icodes.opcodes.CONSTANT</span><a href="../icode/Opcodes.scala.html#37573">CONSTANT</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.copyPropagation.global.Constant</span><a href="#80934">k</a></span>)
      <span class="typed"><span class="type">ClosureElimination.this.global.icodes.opcodes.THIS</span><span class="keyword">case</span></span> <a id="1">Deref</a>(<span class="typed"><span class="type">object ClosureElimination.this.global.copyPropagation.This</span><a href="../icode/analysis/CopyPropagation.scala.html#80644">This</a></span>) =&gt;
        <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.global.Symbol)ClosureElimination.this.global.icodes.opcodes.THIS</span><a href="../icode/Opcodes.scala.html#37549">THIS</a></span>(<span class="typed"><span class="type">object ClosureElimination.this.global.definitions</span><a href="../../symtab/Definitions.scala.html#22259">definitions</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.Symbol</span><a href="../../symtab/Definitions.scala.html#25778">ObjectClass</a></span>)
    }
    
    <span class="comment">/** is field 'f' accessible from method 'm'? */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(ClosureElimination.this.global.Symbol,ClosureElimination.this.global.Symbol)Boolean</span><a id="80591">accessible</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a id="80812">f</a></span>: <span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="../../symtab/Symbols.scala.html#21866">Symbol</a></span>, <span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a id="80813">m</a></span>: <span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="../../symtab/Symbols.scala.html#21866">Symbol</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2170">Boolean</a></span> = 
      <span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="#80812">f</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../symtab/Symbols.scala.html#25184">isPublic</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> (<span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="#80812">f</a></span>.<span class="typed"><span class="type">(Long)Boolean</span><a href="../../symtab/Symbols.scala.html#25223">hasFlag</a></span>(Flags.<span class="typed"><span class="type">Long(1L)</span><span >PROTECTED</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2751">&amp;&amp;</a></span> (<span class="typed"><span class="type">(ClosureElimination.this.global.Symbol)ClosureElimination.this.global.Symbol</span><a href="#80592">enclPackage</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="#80812">f</a></span>) <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">(ClosureElimination.this.global.Symbol)ClosureElimination.this.global.Symbol</span><a href="#80592">enclPackage</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="#80813">m</a></span>)))

    <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(ClosureElimination.this.global.Symbol)ClosureElimination.this.global.Symbol</span><a id="80592">enclPackage</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a id="80938">sym</a></span>: <span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="../../symtab/Symbols.scala.html#21866">Symbol</a></span>): <span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="../../symtab/Symbols.scala.html#21866">Symbol</a></span> = 
      <span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><span class="keyword">if</span></span> ((<span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="#80938">sym</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">object ClosureElimination.this.global.NoSymbol</span><a href="../../symtab/Symbols.scala.html#21873">NoSymbol</a></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span> <span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="#80938">sym</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../symtab/Symbols.scala.html#25167">isPackageClass</a></span>) <span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="#80938">sym</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">(ClosureElimination.this.global.Symbol)ClosureElimination.this.global.Symbol</span><a href="#80592">enclPackage</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.Symbol</span><a href="#80938">sym</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.Symbol</span><a href="../../symtab/Symbols.scala.html#25211">owner</a></span>)

  } <span class="comment">/* class ClosureElim */</span>


  <span class="comment">/** Peephole optimization. */</span>
  <span class="keyword">class</span> <span class="typed"><span class="type">class PeepholeOpt extends java.lang.Object with ScalaObject</span><a id="80564">PeepholeOpt</a></span>(<span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction, ClosureElimination.this.global.icodes.Instruction) =&gt; Option[List[ClosureElimination.this.global.icodes.Instruction]]</span><span id="80600"><a id="80607">peep</a></span></span>: (Instruction, Instruction) =&gt; Option[List[Instruction]]) {

    <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><span id="80604"><span id="80602"><span id="80603"><a id="80944">method</a></span></span></span></span>: <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="../icode/Members.scala.html#32332">IMethod</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.IMethod)Unit</span><a id="80605">transformMethod</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a id="80734">m</a></span>: <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="../icode/Members.scala.html#32332">IMethod</a></span>): <span class="typed"><span class="type">Unit</span><a id="2169">Unit</a></span> = <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80734">m</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.icodes.Code</span><a href="../icode/Members.scala.html#32867">code</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5795">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) {
      <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.IMethod)Unit</span><a href="#80603">method</a></span> = <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80734">m</a></span>
      <span class="keyword">for</span> (<span class="typed"><span class="type">((ClosureElimination.this.global.icodes.BasicBlock) =&gt; Unit)Unit</span><span id="21792"><a id="80946">b</a></span></span> &lt;- <span class="typed"><span class="type">ClosureElimination.this.global.icodes.IMethod</span><a href="#80734">m</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.icodes.Code</span><a href="../icode/Members.scala.html#32867">code</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.ListBuffer[ClosureElimination.this.global.icodes.BasicBlock]</span><a href="../icode/Members.scala.html#33274">blocks</a></span>) 
        <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.BasicBlock)Unit</span><a href="#80606">transformBlock</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80946">b</a></span>)
    }

    <span class="keyword">def</span> <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.BasicBlock)Unit</span><a id="80606">transformBlock</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a id="80947">b</a></span>: <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="../icode/BasicBlocks.scala.html#32337">BasicBlock</a></span>): <span class="typed"><span class="type">Unit</span><a id="2169">Unit</a></span> = <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80947">b</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21644">size</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3146">&gt;=</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>) {
      <span class="keyword">var</span> <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a id="80949">newInstructions</a></span>: <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a id="526">List</a></span>[Instruction] = <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>;

      <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80949">newInstructions</a></span> = <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80947">b</a></span>.<span class="typed"><span class="type">=&gt; List[ClosureElimination.this.global.icodes.Instruction]</span><a href="../icode/BasicBlocks.scala.html#33188">toList</a></span>
      
      <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><a id="80950">redo</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
      <span class="typed"><span class="type">Unit</span><a href="#80951" class="keyword">do</a></span> {
        <span class="keyword">var</span> <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a id="80952">h</a></span> = <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80949">newInstructions</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.icodes.Instruction</span><a id="21332">head</a></span>;
        <span class="keyword">var</span> <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a id="80953">t</a></span> = <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80949">newInstructions</a></span>.<span class="typed"><span class="type">=&gt; List[ClosureElimination.this.global.icodes.Instruction]</span><a id="21334">tail</a></span>;
        <span class="keyword">var</span> <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a id="80954">seen</a></span>: <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a id="526">List</a></span>[Instruction] = <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>;
        <span class="typed"><span class="type">Boolean</span><a href="#80950">redo</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;

        <span class="typed"><span class="type">Unit</span><a href="#80955" class="keyword">while</a></span> (<span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80953">t</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">!=</a></span> <span class="typed"><span class="type">object Nil</span><a id="335">Nil</a></span>) {
          <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction,ClosureElimination.this.global.icodes.Instruction)Option[List[ClosureElimination.this.global.icodes.Instruction]]</span><a href="#80600" id="29833">peep</a></span>(<span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80952">h</a></span>, <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80953">t</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.icodes.Instruction</span><a id="21332">head</a></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a id="80958">newInstrs</a></span>) =&gt;
              <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80949">newInstructions</a></span> = <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80954">seen</a></span>.<span class="typed"><span class="type">=&gt; List[ClosureElimination.this.global.icodes.Instruction]</span><a id="21385">reverse</a></span> <span class="typed"><span class="type">(List[ClosureElimination.this.global.icodes.Instruction])List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80959" id="21339">:::</a></span> <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80958">newInstrs</a></span> <span class="typed"><span class="type">(List[ClosureElimination.this.global.icodes.Instruction])List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80961" id="21339">:::</a></span> <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80953">t</a></span>.<span class="typed"><span class="type">=&gt; List[ClosureElimination.this.global.icodes.Instruction]</span><a id="21334">tail</a></span>;
              <span class="typed"><span class="type">Boolean</span><a href="#80950">redo</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a id="536">None</a></span> =&gt;
            	<span class="typed"><span class="type">Unit</span><span >(</span></span>)
          }
          <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80954">seen</a></span> = <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80952">h</a></span> <span class="typed"><span class="type">(ClosureElimination.this.global.icodes.Instruction)List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80966" id="21335">::</a></span> <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80954">seen</a></span>;
          <span class="typed"><span class="type">ClosureElimination.this.global.icodes.Instruction</span><a href="#80952">h</a></span> = <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80953">t</a></span>.<span class="typed"><span class="type">=&gt; ClosureElimination.this.global.icodes.Instruction</span><a id="21332">head</a></span>;
          <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80953">t</a></span> = <span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80953">t</a></span>.<span class="typed"><span class="type">=&gt; List[ClosureElimination.this.global.icodes.Instruction]</span><a id="21334">tail</a></span>
        }
      } <span class="keyword">while</span> (<span class="typed"><span class="type">Boolean</span><a href="#80950">redo</a></span>);
      <span class="typed"><span class="type">ClosureElimination.this.global.icodes.BasicBlock</span><a href="#80947">b</a></span>.<span class="typed"><span class="type">(List[ClosureElimination.this.global.icodes.Instruction])Unit</span><a href="../icode/BasicBlocks.scala.html#33191">fromList</a></span>(<span class="typed"><span class="type">List[ClosureElimination.this.global.icodes.Instruction]</span><a href="#80949">newInstructions</a></span>)
    }
  }

} <span class="comment">/* class ClosureElimination */</span>

        </pre>
    </body>
</html>