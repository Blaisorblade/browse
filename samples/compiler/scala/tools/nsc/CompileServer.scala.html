<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/CompileServer.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */
// $Id: CompileServer.scala 18620 2009-08-31 20:19:46Z extempore $

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> java.io.{ BufferedOutputStream, FileOutputStream, PrintStream, File =&gt; JFile }
<span class="keyword">import</span> scala.io.File

<span class="keyword">import</span> scala.tools.nsc.reporters.{Reporter, ConsoleReporter}
<span class="keyword">import</span> scala.tools.nsc.util.FakePos //Position
<span class="keyword">import</span> scala.tools.util.SocketServer

/** 
 *  The server part of the fsc offline compiler.  It awaits compilation
 *  commands and executes them.  It caches a compiler instance so
 *  that it can respond more quickly.
 *
 *  @author Martin Odersky
 *  @version 1.0
 */
<span class="keyword">class</span> <a title="class StandardCompileServer extends scala.tools.util.SocketServer with ScalaObject" id="9348">StandardCompileServer</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../util/SocketServer.scala.html#21370" title="scala.tools.util.SocketServer">SocketServer</a>
{
  <span class="keyword">def</span> <a title="=&gt; scala.tools.nsc.CompileSocket" id="661839">compileSocket</a>: <a href="CompileSocket.scala.html#8838" title="scala.tools.nsc.CompileSocket">CompileSocket</a> = <a href="CompileSocket.scala.html#8839" title="object scala.tools.nsc.CompileSocket">CompileSocket</a> // todo: make this a lazy val

  <span class="keyword">val</span> <a title="java.lang.String" id="661840">versionMsg</a> = <span title="(x$1: Any)java.lang.String" class="string">&quot;Fast Scala compiler &quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
    <a href="Properties.scala.html#9424" title="object scala.tools.nsc.Properties">Properties</a>.<a title="=&gt; java.lang.String" id="38232">versionString</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; -- &quot;)" class="string">&quot; -- &quot;</span> +
    <a href="Properties.scala.html#9424" title="object scala.tools.nsc.Properties">Properties</a>.<a title="=&gt; String" id="38234">copyrightString</a>

  <span class="keyword">val</span> <a title="Double" id="661842">MaxCharge</a> = <span title="Double(0.8)" class="double">0.8</span>

  <span class="keyword">var</span> <a title="Boolean" id="661845">shutDown</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(false)" class="keyword">false</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="scala.tools.nsc.Global" id="661848">compiler</a>: <a href="Global.scala.html#8460" title="scala.tools.nsc.Global">Global</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s1: scala.tools.nsc.Settings,s2: scala.tools.nsc.Settings)Boolean" id="661850">settingsAreCompatible</a>(<a title="scala.tools.nsc.Settings" id="661916">s1</a>: <a href="Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>, <a title="scala.tools.nsc.Settings" id="661917">s2</a>: <a href="Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>) = <a href="#661916" title="(x$1: AnyRef)Boolean">s1</a> == <a href="#661917" title="scala.tools.nsc.Settings">s2</a>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(code: Int)Nothing" id="661851">exit</a>(<a title="Int" id="661926">code</a>: <a title="Int" id="2177">Int</a>): <a title="Nothing" id="3622">Nothing</a> = {
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="()Unit">close</span>()
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="()Unit">close</span>()
    <span title="object Predef">Predef</span>.<a title="(status: Int)Nothing" id="7872">exit</a>(<a href="#661926" title="Int">code</a>)
  }

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.Runtime" id="661852">runtime</a> = <a title="object java.lang.Runtime" id="1498">Runtime</a>.<a title="()java.lang.Runtime" id="130424">getRuntime</a>()
  <span class="keyword">import</span> runtime.{ totalMemory, freeMemory, maxMemory }

  <span class="keyword">var</span> <a title="scala.tools.nsc.reporters.ConsoleReporter" id="661856">reporter</a>: <a href="reporters/ConsoleReporter.scala.html#13099" title="scala.tools.nsc.reporters.ConsoleReporter">ConsoleReporter</a> = _

  /** Create a new compiler instance */
  <span class="keyword">def</span> <a title="(settings: scala.tools.nsc.Settings,reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global" id="661858">newGlobal</a>(<a title="scala.tools.nsc.Settings" id="661936">settings</a>: <a href="Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>, <a title="scala.tools.nsc.reporters.Reporter" id="661937">reporter</a>: <a href="reporters/Reporter.scala.html#13075" title="scala.tools.nsc.reporters.Reporter">Reporter</a>) =
    <a href="#661940" title="scala.tools.nsc.Global{ ... }" class="keyword">new</a> <a href="Global.scala.html#8460" title="anonymous class $anon extends scala.tools.nsc.Global" id="661940">Global</a>(<a href="#661936" title="scala.tools.nsc.Settings">settings</a>, <a href="#661937" title="scala.tools.nsc.reporters.Reporter">reporter</a>) {
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(msg: String)Unit" id="661942">inform</a>(<a title="String" id="661957">msg</a>: <span title="String">String</span>) = <a href="../util/SocketServer.scala.html#286597" title="=&gt; java.io.PrintWriter">out</a>.<span title="(x$1: java.lang.String)Unit">println</span>(<a href="#661957" title="String">msg</a>)
    }

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="661859">timeout</a>() {
    <span title="Unit" class="keyword">if</span> (<a title="=&gt; Boolean" id="2205">!</a><a href="#661839" title="=&gt; scala.tools.nsc.CompileSocket">compileSocket</a>.<a href="CompileSocket.scala.html#131915" title="(port: Int)scala.io.File">portFile</a>(<a href="../util/SocketServer.scala.html#286608" title="=&gt; Int">port</a>).<a title="=&gt; Boolean" id="111858">exists</a>)    
      <a href="../util/SocketServer.scala.html#286603" title="(msg: String)Nothing">fatal</a>(<span title="java.lang.String(&quot;port file no longer exists; skipping cleanup&quot;)" class="string">&quot;port file no longer exists; skipping cleanup&quot;</span>)
  }
  
  <span class="keyword">def</span> <a title="()Unit" id="661860">printMemoryStats</a>() {
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: java.lang.String)Unit">println</span>(<a title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" id="8101" class="string">&quot;New session, total memory = %s, max memory = %s, free memory = %s&quot;</a>.<a title="(args: Any*)String" id="30764">format</a>(
      <a href="#661852" title="()Long">totalMemory</a>, <a href="#661852" title="()Long">maxMemory</a>, <a href="#661852" title="()Long">freeMemory</a>))
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="()Unit">flush</span>()
  }
  
  <span class="keyword">def</span> <a title="()Boolean" id="661861">isMemoryFullEnough</a>() = {
    <a href="#661852" title="=&gt; java.lang.Runtime">runtime</a>.<a title="()Unit" id="130457">gc</a>()
    (<a href="#661852" title="(x$1: Long)Long" id="3202">totalMemory</a> - <a href="#661852" title="()Long">freeMemory</a>).<a title="(x$1: Double)Double" id="3586">toDouble</a> <a title="(x$1: Double)Boolean" id="3576">/</a> <a href="#661852" title="()Long">maxMemory</a>.<span title="=&gt; Double">toDouble</span> &gt; <a href="#661842" title="=&gt; Double">MaxCharge</a>
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(arguments: List[String],settings: scala.tools.nsc.Settings,error: (String) =&gt; Unit,interactive: Boolean)scala.tools.nsc.OfflineCompilerCommand" id="661862">newOfflineCompilerCommand</a>(
    <a title="List[String]" id="662049">arguments</a>: <a title="List[String]" id="7345">List</a>[String],
    <a title="scala.tools.nsc.Settings" id="662050">settings</a>: <a href="Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>,
    <a title="(String) =&gt; Unit" id="662051">error</a>: String =&gt; Unit, 
    <a title="Boolean" id="662052">interactive</a>: <span title="Boolean">Boolean</span>
  ) = <span title="scala.tools.nsc.OfflineCompilerCommand" class="keyword">new</span> <a href="OfflineCompilerCommand.scala.html#8595" title="scala.tools.nsc.OfflineCompilerCommand">OfflineCompilerCommand</a>(<a href="#662049" title="List[String]">arguments</a>, <a href="#662050" title="scala.tools.nsc.Settings">settings</a>, <a href="#662051" title="(String) =&gt; Unit">error</a>, <a href="#662052" title="Boolean">interactive</a>)

  <span class="keyword">def</span> <a title="()Unit" id="661863">session</a>() {
    <a href="#661860" title="()Unit">printMemoryStats</a>()
    <span class="keyword">val</span> <a title="String" id="662058">password</a> = <a href="CompileSocket.scala.html#131924" title="(port: Int)String">compileSocket</a> getPassword <a href="../util/SocketServer.scala.html#286608" title="=&gt; Int">port</a>
    <span class="keyword">val</span> <a title="java.lang.String" id="662059">guessedPassword</a> = <a href="../util/SocketServer.scala.html#286600" title="=&gt; java.io.BufferedReader">in</a>.<span title="()java.lang.String">readLine</span>()
    <span class="keyword">val</span> <a title="java.lang.String" id="662060">input</a> = <a href="../util/SocketServer.scala.html#286600" title="=&gt; java.io.BufferedReader">in</a>.<span title="()java.lang.String">readLine</span>()
    <span title="Unit" class="keyword">if</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#662060" title="(x$1: AnyRef)Boolean">input</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; <a href="#662058" title="(x$1: AnyRef)Boolean">password</a> == <a href="#662059" title="java.lang.String">guessedPassword</a>) {
      <span class="keyword">val</span> <a title="List[java.lang.String]" id="662081">args</a> = <a href="#662060" title="java.lang.String">input</a>.<a title="(x$1: java.lang.String,x$2: Int)Array[java.lang.String]" id="7040">split</a>(<span title="java.lang.String(&quot;\00&quot;)" class="string">&quot;\0&quot;</span>,<span title="Int(-1)">-</span><span class="int">1</span>).<a title="=&gt; List[java.lang.String]" id="25352">toList</a>
      <span title="Unit" class="keyword">if</span> (<a href="#662081" title="(elem: Any)Boolean">args</a> contains <span title="java.lang.String(&quot;-shutdown&quot;)" class="string">&quot;-shutdown&quot;</span>) {
        <a href="../util/SocketServer.scala.html#286597" title="=&gt; java.io.PrintWriter">out</a>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="java.lang.String(&quot;[Compile server exited]&quot;)" class="string">&quot;[Compile server exited]&quot;</span>)
        <a href="#661845" title="(x$1: Boolean)Unit">shutDown</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span title="Nothing" class="keyword">return</span>
      }
      <span title="Unit" class="keyword">if</span> (<a href="#662081" title="(elem: Any)Boolean">args</a> contains <span title="java.lang.String(&quot;-reset&quot;)" class="string">&quot;-reset&quot;</span>) {
        <a href="../util/SocketServer.scala.html#286597" title="=&gt; java.io.PrintWriter">out</a>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="java.lang.String(&quot;[Compile server was reset]&quot;)" class="string">&quot;[Compile server was reset]&quot;</span>)
        <a href="#661848" title="(x$1: scala.tools.nsc.Global)Unit">compiler</a> = <span title="Null(null)" class="keyword">null</span>
        <span title="Nothing" class="keyword">return</span>
      }
      <span class="keyword">def</span> <a title="(msg: String)Unit" id="662082">error</a>(<a title="String" id="662112">msg</a>: <span title="String">String</span>) {
        <a href="../util/SocketServer.scala.html#286597" title="=&gt; java.io.PrintWriter">out</a>.<a title="(x$1: Any)Unit" id="38934">println</a><a title="(_1: scala.tools.nsc.util.FakePos,_2: java.lang.String)(scala.tools.nsc.util.FakePos, java.lang.String)" id="1155">(</a>/*new Position*/ <a href="util/Position.scala.html#172091" title="(msg: String)scala.tools.nsc.util.FakePos">FakePos</a>(<span title="java.lang.String(&quot;fsc&quot;)" class="string">&quot;fsc&quot;</span>),
                    <a href="#662112" title="(x$1: Any)java.lang.String">msg</a> + <span title="java.lang.String(&quot;\012  fsc -help  gives more information&quot;)" class="string">&quot;\n  fsc -help  gives more information&quot;</span>)
      }
      <span class="keyword">val</span> <a title="scala.tools.nsc.OfflineCompilerCommand" id="662083">command</a> = <a href="#661862" title="(arguments: List[String],settings: scala.tools.nsc.Settings,error: (String) =&gt; Unit,interactive: Boolean)scala.tools.nsc.OfflineCompilerCommand">newOfflineCompilerCommand</a>(<a href="#662081" title="List[java.lang.String]">args</a>, <span title="scala.tools.nsc.Settings" class="keyword">new</span> <a href="Settings.scala.html#8706" title="scala.tools.nsc.Settings">Settings</a>(<a href="#662082" title="(msg: String)Unit">error</a>), <a href="#662082" title="(msg: String)Unit">error</a>, <span title="Boolean(false)" class="keyword">false</span>)
      
      <a href="#661856" title="(x$1: scala.tools.nsc.reporters.ConsoleReporter)Unit">reporter</a> = <a href="#662219" title="scala.tools.nsc.reporters.ConsoleReporter{ ... }" class="keyword">new</a> <a href="reporters/ConsoleReporter.scala.html#13099" title="anonymous class $anon extends scala.tools.nsc.reporters.ConsoleReporter" id="662219">ConsoleReporter</a>(<a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141974" title="=&gt; scala.tools.nsc.Settings">settings</a>, <a href="../util/SocketServer.scala.html#286600" title="=&gt; java.io.BufferedReader">in</a>, <a href="../util/SocketServer.scala.html#286597" title="=&gt; java.io.PrintWriter">out</a>) {
        // disable prompts, so that compile server cannot block
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Unit" id="662221">displayPrompt</a> = <span title="Unit">(</span>)
      }
      
      <span title="Unit" class="keyword">if</span> (<a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141998" title="=&gt; Boolean">shouldStopWithInfo</a>) {
        <a href="#661856" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/Reporter.scala.html#38782" title="(pos: scala.tools.nsc.util.Position,msg: String,force: Boolean)Unit">info</a>(<span title="Null(null)" class="keyword">null</span>,
                        <a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141999" title="(compiler: scala.tools.nsc.Global)String">getInfoMessage</a>(<a href="#661858" title="(settings: scala.tools.nsc.Settings,reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global">newGlobal</a>(<a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141974" title="=&gt; scala.tools.nsc.Settings">settings</a>, <a href="#661856" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>)), <span title="Boolean(true)" class="keyword">true</span>)
        } <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> (<a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141986" title="=&gt; List[String]">files</a>.<a title="=&gt; Boolean" id="25434">isEmpty</a>)
            <a href="#661856" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/Reporter.scala.html#38782" title="(pos: scala.tools.nsc.util.Position,msg: String,force: Boolean)Unit">info</a>(<span title="Null(null)" class="keyword">null</span>, <a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141993" title="=&gt; String">usageMsg</a>, <span title="Boolean(true)" class="keyword">true</span>)
          <span class="keyword">else</span> {
            <span class="keyword">try</span> {
              <span title="Unit" class="keyword">if</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#661848" title="(x$1: AnyRef)Boolean">compiler</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; <a href="#661850" title="(s1: scala.tools.nsc.Settings,s2: scala.tools.nsc.Settings)Boolean">settingsAreCompatible</a>(<a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141974" title="=&gt; scala.tools.nsc.Settings">settings</a>, <a href="#661848" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39018" title="=&gt; scala.tools.nsc.Settings">settings</a>)) {
                <a href="#661848" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39019" title="(x$1: scala.tools.nsc.Settings)Unit">settings</a> = <a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141974" title="=&gt; scala.tools.nsc.Settings">settings</a>
                <a href="#661848" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39022" title="(x$1: scala.tools.nsc.reporters.Reporter)Unit">reporter</a> = <a href="#661856" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>
              } <span class="keyword">else</span> {
                <span title="Unit" class="keyword">if</span> (<a href="#662081" title="(elem: Any)Boolean">args</a> contains <span title="java.lang.String(&quot;-verbose&quot;)" class="string">&quot;-verbose&quot;</span>)
                  <a href="../util/SocketServer.scala.html#286597" title="=&gt; java.io.PrintWriter">out</a>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="java.lang.String(&quot;[Starting new compile server instance]&quot;)" class="string">&quot;[Starting new compile server instance]&quot;</span>)
                <a href="#661848" title="(x$1: scala.tools.nsc.Global)Unit">compiler</a> = <a href="#661858" title="(settings: scala.tools.nsc.Settings,reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global">newGlobal</a>(<a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141974" title="=&gt; scala.tools.nsc.Settings">settings</a>, <a href="#661856" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>)
              }
              <span class="keyword">val</span> <a title="scala.tools.nsc.Global" id="662248">c</a> = <a href="#661848" title="=&gt; scala.tools.nsc.Global">compiler</a>
              <span class="keyword">val</span> <a title="c.Run" id="662249">run</a> = <span title="c.Run" class="keyword">new</span> <a href="#662248" title="scala.tools.nsc.Global">c</a>.<a href="Global.scala.html#39178" title="c.Run">Run</a>()
              <a href="Global.scala.html#40220" title="(filenames: List[String])Unit">run</a> compile <a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141986" title="=&gt; List[String]">files</a>
            } <span class="keyword">catch</span> {
              <span title="Unit" class="keyword">case</span> <a title="scala.tools.nsc.FatalError" id="662278">ex</a> @ <a id="1">FatalError</a>(<a title="String" id="662279">msg</a>) =&gt;
                <span title="Unit" class="keyword">if</span> (<a href="#662083" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#141974" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="Settings.scala.html#37150" title="=&gt; scala.tools.nsc.Settings.BooleanSetting">debug</a>.<a href="Settings.scala.html#37759" title="=&gt; command.settings.debug.T">value</a>)
                  <a href="#662278" title="scala.tools.nsc.FatalError">ex</a>.<span title="(x$1: java.io.PrintWriter)Unit">printStackTrace</span>(<a href="../util/SocketServer.scala.html#286597" title="=&gt; java.io.PrintWriter">out</a>);
              <a href="#661856" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/Reporter.scala.html#38784" title="(pos: scala.tools.nsc.util.Position,msg: String)Unit">error</a>(<span title="Null(null)" class="keyword">null</span>, <span title="(x$1: Any)java.lang.String" class="string">&quot;fatal error: &quot;</span> + <a href="#662279" title="String">msg</a>)
              <a href="#661848" title="(x$1: scala.tools.nsc.Global)Unit">compiler</a> = <span title="Null(null)" class="keyword">null</span>
              <span title="Unit" class="keyword">case</span> <a title="java.lang.Throwable" id="662294">ex</a>: <a title="Throwable" id="1887">Throwable</a> =&gt;
                <a href="#662294" title="java.lang.Throwable">ex</a>.<span title="(x$1: java.io.PrintWriter)Unit">printStackTrace</span>(<a href="../util/SocketServer.scala.html#286597" title="=&gt; java.io.PrintWriter">out</a>);
              <a href="#661856" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/Reporter.scala.html#38784" title="(pos: scala.tools.nsc.util.Position,msg: String)Unit">error</a>(<span title="Null(null)" class="keyword">null</span>, <span title="(x$1: Any)java.lang.String" class="string">&quot;fatal error (server aborted): &quot;</span> + <a href="#662294" title="java.lang.Throwable">ex</a>.<a title="()java.lang.String" id="25926">getMessage</a>())
              <a href="#661845" title="(x$1: Boolean)Unit">shutDown</a> = <span title="Boolean(true)" class="keyword">true</span>
            }
            <a href="#661856" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/ConsoleReporter.scala.html#38827" title="()Unit">printSummary</a>()
            <span title="Unit" class="keyword">if</span> (<a href="#661861" title="()Boolean">isMemoryFullEnough</a>)
              <a href="#661848" title="(x$1: scala.tools.nsc.Global)Unit">compiler</a> = <span title="Null(null)" class="keyword">null</span>
          }
    }
  }
  
  /** A directory holding redirected output */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.io.Directory" id="661864">redirectDir</a> = (<a href="#661839" title="=&gt; scala.tools.nsc.CompileSocket">compileSocket</a>.<a href="CompileSocket.scala.html#131905" title="(child: scala.io.Path)scala.io.Path">tmpDir</a> <a title="scala.io.Path" id="661909">/</a> <span title="implicit scala.io.Path.string2path : (s: String)scala.io.Path" class="string">&quot;output-redirects&quot;</span>).<a href="#661909" title="Boolean" id="111879">ensureDirectory</a>()

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(setter: (java.io.PrintStream) =&gt; Unit,filename: String)Unit" id="661866">redirect</a>(<a title="(java.io.PrintStream) =&gt; Unit" id="662315">setter</a>: PrintStream =&gt; Unit, <a title="String" id="662316">filename</a>: <span title="String">String</span>): <a title="Unit" id="1950">Unit</a> =
    <a href="#662315" title="(v1: java.io.PrintStream)Unit" id="25529">setter</a>(<span title="java.io.PrintStream" class="keyword">new</span> <a title="java.io.PrintStream" id="4002">PrintStream</a>((<a href="#661864" title="(child: scala.io.Path)scala.io.Path">redirectDir</a> / <a href="#662316" title="implicit scala.io.Path.string2path : (s: String)scala.io.Path">filename</a>).<a title="scala.io.File" id="111882">ensureFile</a>.<a href="#111882" title="Boolean" id="130732">bufferedOutput</a>()))

  <span class="keyword">def</span> <a title="(args: Array[String])Unit" id="661867">main</a>(<a title="Array[String]" id="662354">args</a>: <a title="Array[String]" id="887">Array</a>[String]) {
    <a href="#661866" title="(setter: (java.io.PrintStream) =&gt; Unit,filename: String)Unit">redirect</a>(<span title="object java.lang.System">System</span>.<a href="#662357" title="(x$1: java.io.PrintStream)Unit" id="64908">setOut</a>, <span title="java.lang.String(&quot;scala-compile-server-out.log&quot;)" class="string">&quot;scala-compile-server-out.log&quot;</span>)
    <a href="#661866" title="(setter: (java.io.PrintStream) =&gt; Unit,filename: String)Unit">redirect</a>(<span title="object java.lang.System">System</span>.<a href="#662363" title="(x$1: java.io.PrintStream)Unit" id="64910">setErr</a>, <span title="java.lang.String(&quot;scala-compile-server-err.log&quot;)" class="string">&quot;scala-compile-server-err.log&quot;</span>)
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="(x$1: Any)java.lang.String" class="string">&quot;...starting server on socket &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="../util/SocketServer.scala.html#286608" title="=&gt; Int">port</a>+<span title="java.lang.String(&quot;...&quot;)" class="string">&quot;...&quot;</span>)
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="()Unit">flush</span>()
    <a href="#661839" title="=&gt; scala.tools.nsc.CompileSocket">compileSocket</a>.<a href="CompileSocket.scala.html#131918" title="(port: Int)Unit">setPort</a>(<a href="../util/SocketServer.scala.html#286608" title="=&gt; Int">port</a>)
    <a href="../util/SocketServer.scala.html#286611" title="()Unit">run</a>()
    <a href="#661839" title="=&gt; scala.tools.nsc.CompileSocket">compileSocket</a>.<a href="CompileSocket.scala.html#131919" title="(port: Int)Boolean">deletePort</a>(<a href="../util/SocketServer.scala.html#286608" title="=&gt; Int">port</a>)
    <a href="#661851" title="(code: Int)Nothing">exit</a>(<span title="Int(0)" class="int">0</span>)
  }
}


<span class="keyword">object</span> <a title="object scala.tools.nsc.CompileServer" id="8320">CompileServer</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9348" title="scala.tools.nsc.StandardCompileServer">StandardCompileServer</a>

        </pre>
    </body>
</html>