<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/CompileServer.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */
// $Id: CompileServer.scala 18626 2009-09-01 16:05:38Z extempore $

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> java.io.{ BufferedOutputStream, FileOutputStream, PrintStream, File =&gt; JFile }
<span class="keyword">import</span> scala.io.File

<span class="keyword">import</span> scala.tools.nsc.reporters.{Reporter, ConsoleReporter}
<span class="keyword">import</span> scala.tools.nsc.util.FakePos //Position
<span class="keyword">import</span> scala.tools.util.SocketServer

/** 
 *  The server part of the fsc offline compiler.  It awaits compilation
 *  commands and executes them.  It caches a compiler instance so
 *  that it can respond more quickly.
 *
 *  @author Martin Odersky
 *  @version 1.0
 */
<span class="keyword">class</span> <a title="class StandardCompileServer extends scala.tools.util.SocketServer with ScalaObject" id="9417">StandardCompileServer</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../util/SocketServer.scala.html#21512" title="scala.tools.util.SocketServer">SocketServer</a>
{
  <span class="keyword">def</span> <a title="=&gt; scala.tools.nsc.CompileSocket" id="663410">compileSocket</a>: <a href="CompileSocket.scala.html#8907" title="scala.tools.nsc.CompileSocket">CompileSocket</a> = <a href="CompileSocket.scala.html#8908" title="object scala.tools.nsc.CompileSocket">CompileSocket</a> // todo: make this a lazy val

  <span class="keyword">val</span> <a title="java.lang.String" id="663411">versionMsg</a> = <span title="(x$1: Any)java.lang.String" class="string">&quot;Fast Scala compiler &quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
    <a href="Properties.scala.html#9493" title="object scala.tools.nsc.Properties">Properties</a>.<a title="=&gt; java.lang.String" id="38461">versionString</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; -- &quot;)" class="string">&quot; -- &quot;</span> +
    <a href="Properties.scala.html#9493" title="object scala.tools.nsc.Properties">Properties</a>.<a title="=&gt; String" id="38463">copyrightString</a>

  <span class="keyword">val</span> <a title="Double" id="663413">MaxCharge</a> = <span title="Double(0.8)" class="double">0.8</span>

  <span class="keyword">var</span> <a title="Boolean" id="663416">shutDown</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(false)" class="keyword">false</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="scala.tools.nsc.Global" id="663419">compiler</a>: <a href="Global.scala.html#8529" title="scala.tools.nsc.Global">Global</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s1: scala.tools.nsc.Settings,s2: scala.tools.nsc.Settings)Boolean" id="663421">settingsAreCompatible</a>(<a title="scala.tools.nsc.Settings" id="663488">s1</a>: <a href="Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>, <a title="scala.tools.nsc.Settings" id="663489">s2</a>: <a href="Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>) = <a href="#663488" title="(x$1: AnyRef)Boolean">s1</a> == <a href="#663489" title="scala.tools.nsc.Settings">s2</a>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(code: Int)Nothing" id="663422">exit</a>(<a title="Int" id="663498">code</a>: <a title="Int" id="2198">Int</a>): <a title="Nothing" id="3643">Nothing</a> = {
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="()Unit">close</span>()
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="()Unit">close</span>()
    <span title="object Predef">Predef</span>.<a title="(status: Int)Nothing" id="7941">exit</a>(<a href="#663498" title="Int">code</a>)
  }

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.Runtime" id="663423">runtime</a> = <a title="object java.lang.Runtime" id="1519">Runtime</a>.<a title="()java.lang.Runtime" id="130971">getRuntime</a>()
  <span class="keyword">import</span> runtime.{ totalMemory, freeMemory, maxMemory }

  <span class="keyword">var</span> <a title="scala.tools.nsc.reporters.ConsoleReporter" id="663427">reporter</a>: <a href="reporters/ConsoleReporter.scala.html#13171" title="scala.tools.nsc.reporters.ConsoleReporter">ConsoleReporter</a> = _

  /** Create a new compiler instance */
  <span class="keyword">def</span> <a title="(settings: scala.tools.nsc.Settings,reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global" id="663429">newGlobal</a>(<a title="scala.tools.nsc.Settings" id="663508">settings</a>: <a href="Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>, <a title="scala.tools.nsc.reporters.Reporter" id="663509">reporter</a>: <a href="reporters/Reporter.scala.html#13147" title="scala.tools.nsc.reporters.Reporter">Reporter</a>) =
    <a href="#663512" title="scala.tools.nsc.Global{ ... }" class="keyword">new</a> <a href="Global.scala.html#8529" title="anonymous class $anon extends scala.tools.nsc.Global" id="663512">Global</a>(<a href="#663508" title="scala.tools.nsc.Settings">settings</a>, <a href="#663509" title="scala.tools.nsc.reporters.Reporter">reporter</a>) {
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(msg: String)Unit" id="663514">inform</a>(<a title="String" id="663529">msg</a>: <span title="String">String</span>) = <a href="../util/SocketServer.scala.html#287477" title="=&gt; java.io.PrintWriter">out</a>.<span title="(x$1: java.lang.String)Unit">println</span>(<a href="#663529" title="String">msg</a>)
    }

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="663430">timeout</a>() {
    <span title="Unit" class="keyword">if</span> (<a title="=&gt; Boolean" id="2226">!</a><a href="#663410" title="=&gt; scala.tools.nsc.CompileSocket">compileSocket</a>.<a href="CompileSocket.scala.html#132490" title="(port: Int)scala.io.File">portFile</a>(<a href="../util/SocketServer.scala.html#287488" title="=&gt; Int">port</a>).<a title="=&gt; Boolean" id="112304">exists</a>)    
      <a href="../util/SocketServer.scala.html#287483" title="(msg: String)Nothing">fatal</a>(<span title="java.lang.String(&quot;port file no longer exists; skipping cleanup&quot;)" class="string">&quot;port file no longer exists; skipping cleanup&quot;</span>)
  }
  
  <span class="keyword">def</span> <a title="()Unit" id="663431">printMemoryStats</a>() {
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: java.lang.String)Unit">println</span>(<a title="implicit scala.Predef.stringWrapper : (x: String)scala.runtime.RichString" id="8170" class="string">&quot;New session, total memory = %s, max memory = %s, free memory = %s&quot;</a>.<a title="(args: Any*)String" id="30950">format</a>(
      <a href="#663423" title="()Long">totalMemory</a>, <a href="#663423" title="()Long">maxMemory</a>, <a href="#663423" title="()Long">freeMemory</a>))
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="()Unit">flush</span>()
  }
  
  <span class="keyword">def</span> <a title="()Boolean" id="663432">isMemoryFullEnough</a>() = {
    <a href="#663423" title="=&gt; java.lang.Runtime">runtime</a>.<a title="()Unit" id="131004">gc</a>()
    (<a href="#663423" title="(x$1: Long)Long" id="3223">totalMemory</a> - <a href="#663423" title="()Long">freeMemory</a>).<a title="(x$1: Double)Double" id="3607">toDouble</a> <a title="(x$1: Double)Boolean" id="3597">/</a> <a href="#663423" title="()Long">maxMemory</a>.<span title="=&gt; Double">toDouble</span> &gt; <a href="#663413" title="=&gt; Double">MaxCharge</a>
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(arguments: List[String],settings: scala.tools.nsc.Settings,error: (String) =&gt; Unit,interactive: Boolean)scala.tools.nsc.OfflineCompilerCommand" id="663433">newOfflineCompilerCommand</a>(
    <a title="List[String]" id="663621">arguments</a>: <a title="List[String]" id="7414">List</a>[String],
    <a title="scala.tools.nsc.Settings" id="663622">settings</a>: <a href="Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>,
    <a title="(String) =&gt; Unit" id="663623">error</a>: String =&gt; Unit, 
    <a title="Boolean" id="663624">interactive</a>: <span title="Boolean">Boolean</span>
  ) = <span title="scala.tools.nsc.OfflineCompilerCommand" class="keyword">new</span> <a href="OfflineCompilerCommand.scala.html#8664" title="scala.tools.nsc.OfflineCompilerCommand">OfflineCompilerCommand</a>(<a href="#663621" title="List[String]">arguments</a>, <a href="#663622" title="scala.tools.nsc.Settings">settings</a>, <a href="#663623" title="(String) =&gt; Unit">error</a>, <a href="#663624" title="Boolean">interactive</a>)

  <span class="keyword">def</span> <a title="()Unit" id="663434">session</a>() {
    <a href="#663431" title="()Unit">printMemoryStats</a>()
    <span class="keyword">val</span> <a title="String" id="663630">password</a> = <a href="CompileSocket.scala.html#132499" title="(port: Int)String">compileSocket</a> getPassword <a href="../util/SocketServer.scala.html#287488" title="=&gt; Int">port</a>
    <span class="keyword">val</span> <a title="java.lang.String" id="663631">guessedPassword</a> = <a href="../util/SocketServer.scala.html#287480" title="=&gt; java.io.BufferedReader">in</a>.<span title="()java.lang.String">readLine</span>()
    <span class="keyword">val</span> <a title="java.lang.String" id="663632">input</a> = <a href="../util/SocketServer.scala.html#287480" title="=&gt; java.io.BufferedReader">in</a>.<span title="()java.lang.String">readLine</span>()
    <span title="Unit" class="keyword">if</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#663632" title="(x$1: AnyRef)Boolean">input</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; <a href="#663630" title="(x$1: AnyRef)Boolean">password</a> == <a href="#663631" title="java.lang.String">guessedPassword</a>) {
      <span class="keyword">val</span> <a title="List[java.lang.String]" id="663653">args</a> = <a href="#663632" title="java.lang.String">input</a>.<a title="(x$1: java.lang.String,x$2: Int)Array[java.lang.String]" id="7109">split</a>(<span title="java.lang.String(&quot;\00&quot;)" class="string">&quot;\0&quot;</span>,<span title="Int(-1)">-</span><span class="int">1</span>).<a title="=&gt; List[java.lang.String]" id="25511">toList</a>
      <span title="Unit" class="keyword">if</span> (<a href="#663653" title="(elem: Any)Boolean">args</a> contains <span title="java.lang.String(&quot;-shutdown&quot;)" class="string">&quot;-shutdown&quot;</span>) {
        <a href="../util/SocketServer.scala.html#287477" title="=&gt; java.io.PrintWriter">out</a>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="java.lang.String(&quot;[Compile server exited]&quot;)" class="string">&quot;[Compile server exited]&quot;</span>)
        <a href="#663416" title="(x$1: Boolean)Unit">shutDown</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span title="Nothing" class="keyword">return</span>
      }
      <span title="Unit" class="keyword">if</span> (<a href="#663653" title="(elem: Any)Boolean">args</a> contains <span title="java.lang.String(&quot;-reset&quot;)" class="string">&quot;-reset&quot;</span>) {
        <a href="../util/SocketServer.scala.html#287477" title="=&gt; java.io.PrintWriter">out</a>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="java.lang.String(&quot;[Compile server was reset]&quot;)" class="string">&quot;[Compile server was reset]&quot;</span>)
        <a href="#663419" title="(x$1: scala.tools.nsc.Global)Unit">compiler</a> = <span title="Null(null)" class="keyword">null</span>
        <span title="Nothing" class="keyword">return</span>
      }
      <span class="keyword">def</span> <a title="(msg: String)Unit" id="663654">error</a>(<a title="String" id="663684">msg</a>: <span title="String">String</span>) {
        <a href="../util/SocketServer.scala.html#287477" title="=&gt; java.io.PrintWriter">out</a>.<a title="(x$1: Any)Unit" id="39166">println</a><a title="(_1: scala.tools.nsc.util.FakePos,_2: java.lang.String)(scala.tools.nsc.util.FakePos, java.lang.String)" id="1176">(</a>/*new Position*/ <a href="util/Position.scala.html#172839" title="(msg: String)scala.tools.nsc.util.FakePos">FakePos</a>(<span title="java.lang.String(&quot;fsc&quot;)" class="string">&quot;fsc&quot;</span>),
                    <a href="#663684" title="(x$1: Any)java.lang.String">msg</a> + <span title="java.lang.String(&quot;\012  fsc -help  gives more information&quot;)" class="string">&quot;\n  fsc -help  gives more information&quot;</span>)
      }
      <span class="keyword">val</span> <a title="scala.tools.nsc.OfflineCompilerCommand" id="663655">command</a> = <a href="#663433" title="(arguments: List[String],settings: scala.tools.nsc.Settings,error: (String) =&gt; Unit,interactive: Boolean)scala.tools.nsc.OfflineCompilerCommand">newOfflineCompilerCommand</a>(<a href="#663653" title="List[java.lang.String]">args</a>, <span title="scala.tools.nsc.Settings" class="keyword">new</span> <a href="Settings.scala.html#8775" title="scala.tools.nsc.Settings">Settings</a>(<a href="#663654" title="(msg: String)Unit">error</a>), <a href="#663654" title="(msg: String)Unit">error</a>, <span title="Boolean(false)" class="keyword">false</span>)
      
      <a href="#663427" title="(x$1: scala.tools.nsc.reporters.ConsoleReporter)Unit">reporter</a> = <a href="#663791" title="scala.tools.nsc.reporters.ConsoleReporter{ ... }" class="keyword">new</a> <a href="reporters/ConsoleReporter.scala.html#13171" title="anonymous class $anon extends scala.tools.nsc.reporters.ConsoleReporter" id="663791">ConsoleReporter</a>(<a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142569" title="=&gt; scala.tools.nsc.Settings">settings</a>, <a href="../util/SocketServer.scala.html#287480" title="=&gt; java.io.BufferedReader">in</a>, <a href="../util/SocketServer.scala.html#287477" title="=&gt; java.io.PrintWriter">out</a>) {
        // disable prompts, so that compile server cannot block
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Unit" id="663793">displayPrompt</a> = <span title="Unit">(</span>)
      }
      
      <span title="Unit" class="keyword">if</span> (<a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142593" title="=&gt; Boolean">shouldStopWithInfo</a>) {
        <a href="#663427" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/Reporter.scala.html#39014" title="(pos: scala.tools.nsc.util.Position,msg: String,force: Boolean)Unit">info</a>(<span title="Null(null)" class="keyword">null</span>,
                        <a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142594" title="(compiler: scala.tools.nsc.Global)String">getInfoMessage</a>(<a href="#663429" title="(settings: scala.tools.nsc.Settings,reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global">newGlobal</a>(<a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142569" title="=&gt; scala.tools.nsc.Settings">settings</a>, <a href="#663427" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>)), <span title="Boolean(true)" class="keyword">true</span>)
        } <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> (<a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142581" title="=&gt; List[String]">files</a>.<a title="=&gt; Boolean" id="25593">isEmpty</a>)
            <a href="#663427" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/Reporter.scala.html#39014" title="(pos: scala.tools.nsc.util.Position,msg: String,force: Boolean)Unit">info</a>(<span title="Null(null)" class="keyword">null</span>, <a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142588" title="=&gt; String">usageMsg</a>, <span title="Boolean(true)" class="keyword">true</span>)
          <span class="keyword">else</span> {
            <span class="keyword">try</span> {
              <span title="Unit" class="keyword">if</span> (<span title="(x$1: Boolean)Boolean">(</span><a href="#663419" title="(x$1: AnyRef)Boolean">compiler</a> ne <span title="Null(null)" class="keyword">null</span>) &amp;&amp; <a href="#663421" title="(s1: scala.tools.nsc.Settings,s2: scala.tools.nsc.Settings)Boolean">settingsAreCompatible</a>(<a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142569" title="=&gt; scala.tools.nsc.Settings">settings</a>, <a href="#663419" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39250" title="=&gt; scala.tools.nsc.Settings">settings</a>)) {
                <a href="#663419" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39251" title="(x$1: scala.tools.nsc.Settings)Unit">settings</a> = <a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142569" title="=&gt; scala.tools.nsc.Settings">settings</a>
                <a href="#663419" title="=&gt; scala.tools.nsc.Global">compiler</a>.<a href="Global.scala.html#39254" title="(x$1: scala.tools.nsc.reporters.Reporter)Unit">reporter</a> = <a href="#663427" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>
              } <span class="keyword">else</span> {
                <span title="Unit" class="keyword">if</span> (<a href="#663653" title="(elem: Any)Boolean">args</a> contains <span title="java.lang.String(&quot;-verbose&quot;)" class="string">&quot;-verbose&quot;</span>)
                  <a href="../util/SocketServer.scala.html#287477" title="=&gt; java.io.PrintWriter">out</a>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="java.lang.String(&quot;[Starting new compile server instance]&quot;)" class="string">&quot;[Starting new compile server instance]&quot;</span>)
                <a href="#663419" title="(x$1: scala.tools.nsc.Global)Unit">compiler</a> = <a href="#663429" title="(settings: scala.tools.nsc.Settings,reporter: scala.tools.nsc.reporters.Reporter)scala.tools.nsc.Global">newGlobal</a>(<a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142569" title="=&gt; scala.tools.nsc.Settings">settings</a>, <a href="#663427" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>)
              }
              <span class="keyword">val</span> <a title="scala.tools.nsc.Global" id="663820">c</a> = <a href="#663419" title="=&gt; scala.tools.nsc.Global">compiler</a>
              <span class="keyword">val</span> <a title="c.Run" id="663821">run</a> = <span title="c.Run" class="keyword">new</span> <a href="#663820" title="scala.tools.nsc.Global">c</a>.<a href="Global.scala.html#39410" title="c.Run">Run</a>()
              <a href="Global.scala.html#40452" title="(filenames: List[String])Unit">run</a> compile <a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142581" title="=&gt; List[String]">files</a>
            } <span class="keyword">catch</span> {
              <span title="Unit" class="keyword">case</span> <a title="scala.tools.nsc.FatalError" id="663850">ex</a> @ <a id="1">FatalError</a>(<a title="String" id="663851">msg</a>) =&gt;
                <span title="Unit" class="keyword">if</span> (<a href="#663655" title="scala.tools.nsc.OfflineCompilerCommand">command</a>.<a href="CompilerCommand.scala.html#142569" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="Settings.scala.html#37345" title="=&gt; scala.tools.nsc.Settings.BooleanSetting">debug</a>.<a href="Settings.scala.html#37988" title="=&gt; command.settings.debug.T">value</a>)
                  <a href="#663850" title="scala.tools.nsc.FatalError">ex</a>.<span title="(x$1: java.io.PrintWriter)Unit">printStackTrace</span>(<a href="../util/SocketServer.scala.html#287477" title="=&gt; java.io.PrintWriter">out</a>);
              <a href="#663427" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/Reporter.scala.html#39016" title="(pos: scala.tools.nsc.util.Position,msg: String)Unit">error</a>(<span title="Null(null)" class="keyword">null</span>, <span title="(x$1: Any)java.lang.String" class="string">&quot;fatal error: &quot;</span> + <a href="#663851" title="String">msg</a>)
              <a href="#663419" title="(x$1: scala.tools.nsc.Global)Unit">compiler</a> = <span title="Null(null)" class="keyword">null</span>
              <span title="Unit" class="keyword">case</span> <a title="java.lang.Throwable" id="663866">ex</a>: <a title="Throwable" id="1908">Throwable</a> =&gt;
                <a href="#663866" title="java.lang.Throwable">ex</a>.<span title="(x$1: java.io.PrintWriter)Unit">printStackTrace</span>(<a href="../util/SocketServer.scala.html#287477" title="=&gt; java.io.PrintWriter">out</a>);
              <a href="#663427" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/Reporter.scala.html#39016" title="(pos: scala.tools.nsc.util.Position,msg: String)Unit">error</a>(<span title="Null(null)" class="keyword">null</span>, <span title="(x$1: Any)java.lang.String" class="string">&quot;fatal error (server aborted): &quot;</span> + <a href="#663866" title="java.lang.Throwable">ex</a>.<a title="()java.lang.String" id="26085">getMessage</a>())
              <a href="#663416" title="(x$1: Boolean)Unit">shutDown</a> = <span title="Boolean(true)" class="keyword">true</span>
            }
            <a href="#663427" title="=&gt; scala.tools.nsc.reporters.ConsoleReporter">reporter</a>.<a href="reporters/ConsoleReporter.scala.html#39059" title="()Unit">printSummary</a>()
            <span title="Unit" class="keyword">if</span> (<a href="#663432" title="()Boolean">isMemoryFullEnough</a>)
              <a href="#663419" title="(x$1: scala.tools.nsc.Global)Unit">compiler</a> = <span title="Null(null)" class="keyword">null</span>
          }
    }
  }
  
  /** A directory holding redirected output */
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.io.Directory" id="663435">redirectDir</a> = (<a href="#663410" title="=&gt; scala.tools.nsc.CompileSocket">compileSocket</a>.<a href="CompileSocket.scala.html#132480" title="(child: scala.io.Path)scala.io.Path">tmpDir</a> <a title="scala.io.Path" id="663480">/</a> <span title="implicit scala.io.Path.string2path : (s: String)scala.io.Path" class="string">&quot;output-redirects&quot;</span>).<a href="#663480" title="Boolean" id="112323">createDirectory</a>()

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(setter: (java.io.PrintStream) =&gt; Unit,filename: String)Unit" id="663437">redirect</a>(<a title="(java.io.PrintStream) =&gt; Unit" id="663887">setter</a>: PrintStream =&gt; Unit, <a title="String" id="663888">filename</a>: <span title="String">String</span>): <a title="Unit" id="1971">Unit</a> =
    <a href="#663887" title="(v1: java.io.PrintStream)Unit" id="25688">setter</a>(<span title="java.io.PrintStream" class="keyword">new</span> <a title="java.io.PrintStream" id="4023">PrintStream</a>((<a href="#663435" title="(child: scala.io.Path)scala.io.Path">redirectDir</a> <a title="scala.io.Path" id="663915">/</a> <a href="#663888" title="implicit scala.io.Path.string2path : (s: String)scala.io.Path">filename</a>).<a href="#663915" title="Boolean" id="112328">createFile</a><a title="scala.io.File" id="663920">(</a>).<a href="#663920" title="Boolean" id="131266">bufferedOutput</a>()))

  <span class="keyword">def</span> <a title="(args: Array[String])Unit" id="663438">main</a>(<a title="Array[String]" id="663929">args</a>: <a title="Array[String]" id="905">Array</a>[String]) {
    <a href="#663437" title="(setter: (java.io.PrintStream) =&gt; Unit,filename: String)Unit">redirect</a>(<span title="object java.lang.System">System</span>.<a href="#663932" title="(x$1: java.io.PrintStream)Unit" id="65180">setOut</a>, <span title="java.lang.String(&quot;scala-compile-server-out.log&quot;)" class="string">&quot;scala-compile-server-out.log&quot;</span>)
    <a href="#663437" title="(setter: (java.io.PrintStream) =&gt; Unit,filename: String)Unit">redirect</a>(<span title="object java.lang.System">System</span>.<a href="#663938" title="(x$1: java.io.PrintStream)Unit" id="65182">setErr</a>, <span title="java.lang.String(&quot;scala-compile-server-err.log&quot;)" class="string">&quot;scala-compile-server-err.log&quot;</span>)
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="(x$1: Any)java.lang.String" class="string">&quot;...starting server on socket &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="../util/SocketServer.scala.html#287488" title="=&gt; Int">port</a>+<span title="java.lang.String(&quot;...&quot;)" class="string">&quot;...&quot;</span>)
    <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="()Unit">flush</span>()
    <a href="#663410" title="=&gt; scala.tools.nsc.CompileSocket">compileSocket</a>.<a href="CompileSocket.scala.html#132493" title="(port: Int)Unit">setPort</a>(<a href="../util/SocketServer.scala.html#287488" title="=&gt; Int">port</a>)
    <a href="../util/SocketServer.scala.html#287491" title="()Unit">run</a>()
    <a href="#663410" title="=&gt; scala.tools.nsc.CompileSocket">compileSocket</a>.<a href="CompileSocket.scala.html#132494" title="(port: Int)Boolean">deletePort</a>(<a href="../util/SocketServer.scala.html#287488" title="=&gt; Int">port</a>)
    <a href="#663422" title="(code: Int)Nothing">exit</a>(<span title="Int(0)" class="int">0</span>)
  }
}


<span class="keyword">object</span> <a title="object scala.tools.nsc.CompileServer" id="8389">CompileServer</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9417" title="scala.tools.nsc.StandardCompileServer">StandardCompileServer</a>

        </pre>
    </body>
</html>