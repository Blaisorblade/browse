<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/CompilationUnits.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */</span>
<span class="comment">// $Id: CompilationUnits.scala 17274 2009-03-10 11:39:04Z michelou $</span>

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> scala.tools.nsc.util.{FreshNameCreator,OffsetPosition,Position,SourceFile}
<span class="keyword">import</span> scala.tools.nsc.io.AbstractFile
<span class="keyword">import</span> scala.collection.mutable.{HashSet, HashMap, ListBuffer}

<span class="keyword">trait</span> <span class="typed"><span class="type">trait CompilationUnits extends java.lang.Object with ScalaObject</span><a id="7404">CompilationUnits</a></span> { self: Global =&gt;

  <span class="comment">/** One unit of compilation that has been submitted to the compiler.
    * It typically corresponds to a single file of source code.  It includes
    * error-reporting hooks.  */</span>
  <span class="keyword">class</span> <span class="typed"><span class="type">class CompilationUnit extends java.lang.Object with CompilationUnits.this.CompilationUnitTrait with ScalaObject</span><a id="22571">CompilationUnit</a></span>(<span class="keyword">val</span> <span class="typed"><span class="type">scala.tools.nsc.util.SourceFile</span><span id="24128"><span id="24127"><a id="83937">source</a></span></span></span>: <span class="typed"><span class="type">scala.tools.nsc.util.SourceFile</span><a href="util/SourceFile.scala.html#8483">SourceFile</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">CompilationUnits.this.CompilationUnitTrait</span><a href="ast/Trees.scala.html#22354">CompilationUnitTrait</a></span> {
    <span class="comment">/** the fresh name creator */</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.tools.nsc.util.FreshNameCreator</span><span id="24132"><span id="24130"><span id="24131"><a id="95584">fresh</a></span></span></span></span> : <span class="typed"><span class="type">scala.tools.nsc.util.FreshNameCreator</span><a href="util/FreshNameCreator.scala.html#8468">FreshNameCreator</a></span> = <span class="typed"><span class="type">scala.tools.nsc.util.FreshNameCreator.Default</span><span class="keyword">new</span></span> <span class="typed"><span class="type">object scala.tools.nsc.util.FreshNameCreator</span><a href="util/FreshNameCreator.scala.html#8469">FreshNameCreator</a></span>.<span class="typed"><span class="type">scala.tools.nsc.util.FreshNameCreator.Default</span><a href="util/FreshNameCreator.scala.html#77539">Default</a></span>

    <span class="comment">/** the content of the compilation unit in tree form */</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">CompilationUnits.this.Tree</span><span id="24135"><span id="24133"><span id="24134"><a id="95585">body</a></span></span></span></span>: <span class="typed"><span class="type">CompilationUnits.this.Tree</span><a href="ast/Trees.scala.html#22371">Tree</a></span> = <span class="typed"><span class="type">object CompilationUnits.this.EmptyTree</span><a href="ast/Trees.scala.html#22380">EmptyTree</a></span>

    <span class="comment">/** Note: depends now contains toplevel classes.
     *  To get their sourcefiles, you need to dereference with .sourcefile
     */</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]</span><span id="24137"><a id="24136">depends</a></span></span> = <span class="typed"><span class="type">scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]</span><a id="19895">HashSet</a></span>[Symbol]
    <span class="comment">/** so we can relink 
     */</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]</span><span id="24139"><a id="24138">defined</a></span></span> = <span class="typed"><span class="type">scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]</span><a id="19895">HashSet</a></span>[Symbol]

    <span class="comment">/** Synthetic definitions generated by namer, eliminated by typer.
     */</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CompilationUnits.this.Symbol,CompilationUnits.this.Tree]</span><span id="24141"><a id="24140">synthetics</a></span></span> = <span class="typed"><span class="type">scala.collection.mutable.HashMap[CompilationUnits.this.Symbol,CompilationUnits.this.Tree]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashMap[CompilationUnits.this.Symbol,CompilationUnits.this.Tree]</span><a id="20081">HashMap</a></span>[Symbol, Tree]

    <span class="comment">/** things to check at end of compilation unit */</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[() =&gt; Unit]</span><span id="24143"><a id="24142">toCheck</a></span></span> = <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[() =&gt; Unit]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.ListBuffer[() =&gt; Unit]</span><a id="19925">ListBuffer</a></span>[() =&gt; Unit]

    <span class="comment">/** used to track changes in a signature */</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Long</span><span id="24146"><span id="24144"><span id="24145"><a id="95586">pickleHash</a></span></span></span></span> : <span class="typed"><span class="type">Long</span><a id="2399">Long</a></span> = <span class="typed"><span class="type">Long(0L)</span><span class="int">0</span></span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(Int)scala.tools.nsc.util.Position</span><a id="24147">position</a></span>(<span class="typed"><span class="type">Int</span><a id="95587">pos</a></span>: <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span>) = <span class="typed"><span class="type">=&gt; scala.tools.nsc.util.SourceFile</span><a href="#24127">source</a></span>.<span class="typed"><span class="type">(Int)scala.tools.nsc.util.Position</span><a href="util/SourceFile.scala.html#22653">position</a></span>(<span class="typed"><span class="type">Int</span><a href="#95587">pos</a></span>)

    <span class="comment">/** The icode representation of classes in this compilation unit.
     *  It is empty up to phase 'icode'.
     */</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.HashSet[CompilationUnits.this.icodes.IClass]</span><span id="24149"><a id="24148">icode</a></span></span>: <span class="typed"><span class="type">scala.collection.mutable.HashSet[CompilationUnits.this.icodes.IClass]</span><a id="19895">HashSet</a></span>[icodes.IClass] = <span class="typed"><span class="type">scala.collection.mutable.HashSet[CompilationUnits.this.icodes.IClass]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.HashSet[CompilationUnits.this.icodes.IClass]</span><a id="19895">HashSet</a></span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a id="24150">error</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a id="40588">pos</a></span>: <span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a href="util/Position.scala.html#8480">Position</a></span>, <span class="typed"><span class="type">String</span><a id="40589">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) =
      <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.Reporter</span><a href="Global.scala.html#21160">reporter</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a href="reporters/Reporter.scala.html#34470">error</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a href="#40588">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#40589">msg</a></span>)

    <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a id="24151">warning</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a id="59462">pos</a></span>: <span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a href="util/Position.scala.html#8480">Position</a></span>, <span class="typed"><span class="type">String</span><a id="59463">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = 
      <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.Reporter</span><a href="Global.scala.html#21160">reporter</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a href="reporters/Reporter.scala.html#34469">warning</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a href="#59462">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#59463">msg</a></span>)

    <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a id="24152">deprecationWarning</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a id="74670">pos</a></span>: <span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a href="util/Position.scala.html#8480">Position</a></span>, <span class="typed"><span class="type">String</span><a id="74671">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = 
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#29958">deprecation</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="Settings.scala.html#30301">value</a></span>) <span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a href="#24151">warning</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a href="#74670">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#74671">msg</a></span>)
      <span class="keyword">else</span> <span class="typed"><span class="type">=&gt; CompilationUnits.this.Run</span><a href="Global.scala.html#21305">currentRun</a></span>.<span class="typed"><span class="type">(Boolean)Unit</span><a href="Global.scala.html#36535">deprecationWarnings</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a id="24153">uncheckedWarning</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a id="95594">pos</a></span>: <span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a href="util/Position.scala.html#8480">Position</a></span>, <span class="typed"><span class="type">String</span><a id="95595">msg</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = 
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings</span><a href="Global.scala.html#21157">settings</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting</span><a href="Settings.scala.html#29982">unchecked</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.Settings.BooleanSetting#T</span><a href="Settings.scala.html#30301">value</a></span>) <span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a href="#24151">warning</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a href="#95594">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#95595">msg</a></span>)
      <span class="keyword">else</span> <span class="typed"><span class="type">=&gt; CompilationUnits.this.Run</span><a href="Global.scala.html#21305">currentRun</a></span>.<span class="typed"><span class="type">(Boolean)Unit</span><a href="Global.scala.html#36538">uncheckedWarnings</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a id="24154">incompleteInputError</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a id="40564">pos</a></span>: <span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a href="util/Position.scala.html#8480">Position</a></span>, <span class="typed"><span class="type">String</span><a id="40565">msg</a></span>:<span class="typed"><span class="type">String</span><a id="1861">String</a></span>) =
      <span class="typed"><span class="type">=&gt; scala.tools.nsc.reporters.Reporter</span><a href="Global.scala.html#21160">reporter</a></span>.<span class="typed"><span class="type">(scala.tools.nsc.util.Position,String)Unit</span><a href="reporters/Reporter.scala.html#34471" id="29833">incompleteInputError</a></span>(<span class="typed"><span class="type">scala.tools.nsc.util.Position</span><a href="#40564">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#40565">msg</a></span>) 

    <span class="comment">/** Is this about a .java source file? */</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><a id="24156">isJava</a></span> = <span class="typed"><span class="type">=&gt; scala.tools.nsc.util.SourceFile</span><a href="#24127">source</a></span>.<span class="typed"><span class="type">=&gt; scala.tools.nsc.io.AbstractFile</span><a href="util/SourceFile.scala.html#22650">file</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="io/AbstractFile.scala.html#25439">name</a></span>.<span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5842">endsWith</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;.java&quot;)</span><span class="string">&quot;.java&quot;</span></span>)
    
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="24157">toString</a></span>() = <span class="typed"><span class="type">=&gt; scala.tools.nsc.util.SourceFile</span><a href="#24127">source</a></span>.<span class="typed"><span class="type">()String</span><a href="util/SourceFile.scala.html#22658">toString</a></span>()

    <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="24158">clear</a></span>() {
      <span class="typed"><span class="type">(scala.tools.nsc.util.FreshNameCreator)Unit</span><a href="#24131">fresh</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
      <span class="typed"><span class="type">(CompilationUnits.this.Tree)Unit</span><a href="#24134">body</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
      <span class="typed"><span class="type">=&gt; scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]</span><a href="#24136">depends</a></span>.<span class="typed"><span class="type">()Unit</span><a id="25501">clear</a></span>
      <span class="typed"><span class="type">=&gt; scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]</span><a href="#24138">defined</a></span>.<span class="typed"><span class="type">()Unit</span><a id="25501">clear</a></span>
    }
  }
}



        </pre>
    </body>
</html>