<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/nsc/CompileClient.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2009 LAMP/EPFL
 * @author  Martin Odersky
 */</span>
<span class="comment">// $Id: CompileClient.scala 17313 2009-03-16 13:03:02Z extempore $</span>

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> java.io.{BufferedReader, File, InputStreamReader, PrintWriter}
<span class="keyword">import</span> Properties.fileEndings

<span class="comment">/** The client part of the fsc offline compiler.  Instead of compiling
 *  things itself, it send requests to a CompileServer.
 */</span>
<span class="keyword">class</span> <span class="typed"><span class="type">class StandardCompileClient extends java.lang.Object with ScalaObject</span><a id="6474">StandardCompileClient</a></span> {
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.CompileSocket</span><a id="67843">compileSocket</a></span>: <span class="typed"><span class="type">scala.tools.nsc.CompileSocket</span><a href="CompileSocket.scala.html#6852">CompileSocket</a></span> = <span class="typed"><span class="type">object scala.tools.nsc.CompileSocket</span><a href="CompileSocket.scala.html#6853">CompileSocket</a></span>  <span class="comment">// todo: should be lazy val</span>

  <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><span id="67845"><a id="67844">versionMsg</a></span></span>  = <span class="typed"><span class="type">java.lang.String(&quot;Fast &quot;)</span><span class="string">&quot;Fast &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">object scala.tools.nsc.Properties</span><a href="Properties.scala.html#7366">Properties</a></span>.<span class="typed"><span class="type">=&gt; String</span><a id="46655">versionMsg</a></span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="67848"><span id="67846"><span id="67847"><a id="94766">verbose</a></span></span></span></span>     = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="67851"><span id="67849"><span id="67850"><a id="94767">version</a></span></span></span></span>     = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="67854"><span id="67852"><span id="67853"><a id="94768">shutdown</a></span></span></span></span>    = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>

  <span class="comment">/** Convert a filename to an absolute path */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)java.lang.String</span><a id="67855">absFileName</a></span>(<span class="typed"><span class="type">String</span><a id="94770">path</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = <span class="typed"><span class="type">java.io.File</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.File</span><a id="3669">File</a></span>(<span class="typed"><span class="type">String</span><a href="#94770">path</a></span>).<span class="typed"><span class="type">()java.lang.String</span><a id="40689">getAbsolutePath</a></span>()

  <span class="comment">/** Convert a sequence of filenames, separated by &lt;code&gt;File.pathSeparator&lt;/code&gt;,
    * into absolute filenames.
    */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)String</span><a id="67856">absFileNames</a></span>(<span class="typed"><span class="type">String</span><a id="94774">paths</a></span>: <span class="typed"><span class="type">String</span><a id="1861">String</a></span>) = {
    <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="94776">sep</a></span> = <span class="typed"><span class="type">object java.io.File</span><a id="3670">File</a></span>.<span class="typed"><span class="type">java.lang.String</span><a id="40677">pathSeparator</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">List[java.lang.String]</span><a id="94777">pathsList</a></span> = <span class="typed"><span class="type">String</span><a href="#94774">paths</a></span>.<span class="typed"><span class="type">(java.lang.String)Array[java.lang.String]</span><a id="5865">split</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#94776">sep</a></span>).<span class="typed"><span class="type">=&gt; List[java.lang.String]</span><a id="21815">toList</a></span>
    <span class="typed"><span class="type">List[java.lang.String]</span><a href="#94777">pathsList</a></span>.<span class="typed"><span class="type">((java.lang.String) =&gt; java.lang.String)List[java.lang.String]</span><a id="21362">map</a></span>(<span class="typed"><span class="type">(String)java.lang.String</span><a href="#67855">absFileName</a></span>).<span class="typed"><span class="type">(String,String,String)String</span><a id="21818">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#94776">sep</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>)
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Array[String])(String, String)</span><a id="67857">normalize</a></span>(<span class="typed"><span class="type">Array[String]</span><a id="94788">args</a></span>: <span class="typed"><span class="type">Array[String]</span><a id="1072">Array</a></span>[String]): <span class="typed"><span class="type">(String, String)</span><a id="1378">(</a></span>String, String) = {
     <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="94789">i</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="94790">vmArgs</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a id="23671" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a id="1435">StringBuilder</a></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">java.lang.String</span><a id="94791">serverAdr</a></span> = <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>
    <span class="typed"><span class="type">Unit</span><a href="#94792" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#94789">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">Array[String]</span><a href="#94788">args</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21508">length</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="94798">arg</a></span> = <span class="typed"><span class="type">(Int)String</span><a href="#94788" id="21509">args</a></span>(<span class="typed"><span class="type">Int</span><a href="#94789">i</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; List[java.lang.String]</span><a href="Properties.scala.html#46668">fileEndings</a></span> <span class="typed"><span class="type">((java.lang.String) =&gt; Boolean)Boolean</span><a id="21373">exists</a></span>(<span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5842">endsWith</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#94809">_</a></span>)) {
        <span class="typed"><span class="type">Array[String]</span><a href="#94788">args</a></span>(<span class="typed"><span class="type">Int</span><a href="#94789">i</a></span>) = <span class="typed"><span class="type">(String)java.lang.String</span><a href="#67855">absFileName</a></span>(<span class="typed"><span class="type">String</span><a href="#94798">arg</a></span>)
      } <span class="keyword">else</span> <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(java.lang.String)Boolean</span><a id="5841">startsWith</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-J&quot;)</span><span class="string">&quot;-J&quot;</span></span>) {
        <span class="comment">//see http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/javac.html#J</span>
        <span class="typed"><span class="type">StringBuilder</span><a href="#94790">vmArgs</a></span> <span class="typed"><span class="type">(String)StringBuilder</span><a id="23690">append</a></span> <span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span><span class="typed"><span class="type">String</span><a href="#94798">arg</a></span>.<span class="typed"><span class="type">(Int)java.lang.String</span><a id="5854">substring</a></span>(<span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>)
        <span class="typed"><span class="type">Array[String]</span><a href="#94788">args</a></span>(<span class="typed"><span class="type">Int</span><a href="#94789">i</a></span>) = <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>
      } <span class="keyword">else</span> <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-verbose&quot;)</span><span class="string">&quot;-verbose&quot;</span></span>) {
        <span class="typed"><span class="type">(Boolean)Unit</span><a href="#67847">verbose</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
      } <span class="keyword">else</span> <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-version&quot;)</span><span class="string">&quot;-version&quot;</span></span>) {
        <span class="typed"><span class="type">(Boolean)Unit</span><a href="#67850">version</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
      } <span class="keyword">else</span> <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-shutdown&quot;)</span><span class="string">&quot;-shutdown&quot;</span></span>) {
        <span class="typed"><span class="type">(Boolean)Unit</span><a href="#67853">shutdown</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
      }
      <span class="typed"><span class="type">Int</span><a href="#94789">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#94789">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&lt;</a></span> <span class="typed"><span class="type">Array[String]</span><a href="#94788">args</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a id="21508">length</a></span>) {
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-classpath&quot;)</span><span class="string">&quot;-classpath&quot;</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span>
            <span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-sourcepath&quot;)</span><span class="string">&quot;-sourcepath&quot;</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span>
            <span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-bootclasspath&quot;)</span><span class="string">&quot;-bootclasspath&quot;</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span>
            <span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-extdirs&quot;)</span><span class="string">&quot;-extdirs&quot;</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2750">||</a></span>
            <span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-d&quot;)</span><span class="string">&quot;-d&quot;</span></span>) {
          <span class="typed"><span class="type">Array[String]</span><a href="#94788">args</a></span>(<span class="typed"><span class="type">Int</span><a href="#94789">i</a></span>) = <span class="typed"><span class="type">(String)String</span><a href="#67856">absFileNames</a></span>(<span class="typed"><span class="type">(Int)String</span><a href="#94788" id="21509">args</a></span>(<span class="typed"><span class="type">Int</span><a href="#94789">i</a></span>))
          <span class="typed"><span class="type">Int</span><a href="#94789">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        } <span class="keyword">else</span> <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#94798">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-server&quot;)</span><span class="string">&quot;-server&quot;</span></span>) {
          <span class="typed"><span class="type">java.lang.String</span><a href="#94791">serverAdr</a></span> = <span class="typed"><span class="type">(Int)String</span><a href="#94788" id="21509">args</a></span>(<span class="typed"><span class="type">Int</span><a href="#94789">i</a></span>)
          <span class="typed"><span class="type">Array[String]</span><a href="#94788">args</a></span>(<span class="typed"><span class="type">Int</span><a href="#94789">i</a></span><span class="typed"><span class="type">(Int)Int</span><a id="3148">-</a></span><span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) = <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>
          <span class="typed"><span class="type">Array[String]</span><a href="#94788">args</a></span>(<span class="typed"><span class="type">Int</span><a href="#94789">i</a></span>) = <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>
        }
      }
    }
    <span class="typed"><span class="type">(String,java.lang.String)(String, java.lang.String)</span><span id="23625"><a id="1379">(</a></span></span><span class="typed"><span class="type">StringBuilder</span><a href="#94790">vmArgs</a></span>.<span class="typed"><span class="type">()String</span><a id="23723">toString</a></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#94791">serverAdr</a></span>)
  }

  <span class="comment">// used by class ant.FastScalac to skip exit statement in Ant.</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Array[String])Int</span><a id="67858">main0</a></span>(<span class="typed"><span class="type">Array[String]</span><a id="94890">args0</a></span>: <span class="typed"><span class="type">Array[String]</span><a id="1072">Array</a></span>[String]): <span class="typed"><span class="type">Int</span><a id="2394">Int</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Array[String]</span><a id="94891">args</a></span> =
      <span class="typed"><span class="type">Array[String]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Array[String]</span><a href="#94890">args0</a></span>.<span class="typed"><span class="type">((String) =&gt; Boolean)Boolean</span><a id="21794">exists</a></span>(<span class="typed"><span class="type">String</span><a id="94898">arg</a></span> =&gt; <span class="typed"><span class="type">String</span><a href="#94898">arg</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;-d&quot;)</span><span class="string">&quot;-d&quot;</span></span>))
        <span class="typed"><span class="type">Array[String]</span><a href="#94890">args0</a></span>
      <span class="keyword">else</span>
        (<span class="typed"><span class="type">java.lang.String(&quot;-d&quot;)</span><span class="string">&quot;-d&quot;</span></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#94900" id="21335">::</a></span> <span class="typed"><span class="type">java.lang.String(&quot;.&quot;)</span><span class="string">&quot;.&quot;</span></span> <span class="typed"><span class="type">(String)List[String]</span><a href="#94901" id="21335">::</a></span> <span class="typed"><span class="type">Array[String]</span><a href="#94890">args0</a></span>.<span class="typed"><span class="type">=&gt; List[String]</span><a id="21815">toList</a></span>).<span class="typed"><span class="type">Array[String]</span><a id="21675">toArray</a></span>

    <span class="keyword">val</span> <span class="typed"><span class="type">(String, String)</span><span id="23625"><a href="#94911" id="1379">(</a></span></span><span class="typed"><span class="type">String</span><span id="94911"><span id="94893"><a href="#94892" id="23614">vmArgs</a></span></span></span>, <span class="typed"><span class="type">String</span><span id="94912"><span id="94894"><a href="#94892" id="23616">serverAdr</a></span></span></span>) = <span class="typed"><span class="type">(Array[String])(String, String)</span><a href="#67857">normalize</a></span>(<span class="typed"><span class="type">Array[String]</span><a href="#94891">args</a></span>)
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#67849">version</a></span>) {
      <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">=&gt; java.lang.String</span><a href="#67844">versionMsg</a></span>)
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    }
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#67846">verbose</a></span>) {
      <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;[Server arguments: &quot;)</span><span class="string">&quot;[Server arguments: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">Array[String]</span><a href="#94891">args</a></span>.<span class="typed"><span class="type">(String,String,String)String</span><a id="21818">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;]&quot;)</span><span class="string">&quot;]&quot;</span></span>))
      <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;[VM arguments: &quot;)</span><span class="string">&quot;[VM arguments: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">String</span><a href="#94893">vmArgs</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5802">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;]&quot;)</span><span class="string">&quot;]&quot;</span></span>)
    }
    <span class="keyword">val</span> <span class="typed"><span class="type">java.net.Socket</span><a id="94895">socket</a></span> = <span class="typed"><span class="type">java.net.Socket</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#94894">serverAdr</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3509">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>) <span class="typed"><span class="type">=&gt; scala.tools.nsc.CompileSocket</span><a href="#67843">compileSocket</a></span>.<span class="typed"><span class="type">(String,Boolean)java.net.Socket</span><a href="CompileSocket.scala.html#67472">getOrCreateSocket</a></span>(<span class="typed"><span class="type">String</span><a href="#94893">vmArgs</a></span>, <span class="typed"><span class="type">=&gt; Boolean</span><a id="2747">!</a></span><span class="typed"><span class="type">=&gt; Boolean</span><a href="#67852">shutdown</a></span>)
                 <span class="keyword">else</span> <span class="typed"><span class="type">=&gt; scala.tools.nsc.CompileSocket</span><a href="#67843">compileSocket</a></span>.<span class="typed"><span class="type">(String)java.net.Socket</span><a href="CompileSocket.scala.html#67474">getSocket</a></span>(<span class="typed"><span class="type">String</span><a href="#94894">serverAdr</a></span>)
    <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><a id="94896">sawerror</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">java.net.Socket</span><a href="#94895">socket</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5794">eq</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#67852">shutdown</a></span>) {
        <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;[No compilation server running.]&quot;)</span><span class="string">&quot;[No compilation server running.]&quot;</span></span>)
      } <span class="keyword">else</span> {
        <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Compilation failed.&quot;)</span><span class="string">&quot;Compilation failed.&quot;</span></span>) 
        <span class="typed"><span class="type">Boolean</span><a href="#94896">sawerror</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
      }
    } <span class="keyword">else</span> {
      <span class="keyword">val</span> <span class="typed"><span class="type">java.io.PrintWriter</span><a id="94932">out</a></span> = <span class="typed"><span class="type">(java.io.OutputStream,Boolean)java.io.PrintWriter</span><a id="28680" class="keyword">new</a></span> <span class="typed"><span class="type">java.io.PrintWriter</span><a id="3759">PrintWriter</a></span>(<span class="typed"><span class="type">java.net.Socket</span><a href="#94895">socket</a></span>.<span class="typed"><span class="type">()java.io.OutputStream</span><a id="47508">getOutputStream</a></span>(), <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>)
      <span class="keyword">val</span> <span class="typed"><span class="type">java.io.BufferedReader</span><a id="94933">in</a></span> = <span class="typed"><span class="type">(java.io.Reader)java.io.BufferedReader</span><a id="46775" class="keyword">new</a></span> <span class="typed"><span class="type">java.io.BufferedReader</span><a id="3549">BufferedReader</a></span>(<span class="typed"><span class="type">java.io.InputStreamReader</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.InputStreamReader</span><a id="3741">InputStreamReader</a></span>(<span class="typed"><span class="type">java.net.Socket</span><a href="#94895">socket</a></span>.<span class="typed"><span class="type">()java.io.InputStream</span><a id="47507">getInputStream</a></span>()))
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#94932">out</a></span>.<span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span>(<span class="typed"><span class="type">=&gt; scala.tools.nsc.CompileSocket</span><a href="#67843">compileSocket</a></span>.<span class="typed"><span class="type">(Int)String</span><a href="CompileSocket.scala.html#67476">getPassword</a></span>(<span class="typed"><span class="type">java.net.Socket</span><a href="#94895">socket</a></span>.<span class="typed"><span class="type">()Int</span><a id="47502">getPort</a></span>()))
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#94932">out</a></span>.<span class="typed"><span class="type">(java.lang.String)Unit</span><a id="28711">println</a></span>(<span class="typed"><span class="type">Array[String]</span><a href="#94891">args</a></span>.<span class="typed"><span class="type">(String,String,String)String</span><a id="21818">mkString</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;\00&quot;)</span><span class="string">&quot;\0&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>))
      <span class="keyword">var</span> <span class="typed"><span class="type">java.lang.String</span><a id="94934">fromServer</a></span> = <span class="typed"><span class="type">java.io.BufferedReader</span><a href="#94933">in</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="46779">readLine</a></span>()
      <span class="typed"><span class="type">Unit</span><a href="#94935" class="keyword">while</a></span> (<span class="typed"><span class="type">java.lang.String</span><a href="#94934">fromServer</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5795">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) {
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.tools.nsc.CompileSocket</span><a href="#67843">compileSocket</a></span>.<span class="typed"><span class="type">=&gt; java.util.regex.Pattern</span><a href="CompileSocket.scala.html#67452">errorPattern</a></span>.<span class="typed"><span class="type">(java.lang.CharSequence)java.util.regex.Matcher</span><a id="67780">matcher</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#94934">fromServer</a></span>).<span class="typed"><span class="type">()Boolean</span><a id="79743">matches</a></span>)
          <span class="typed"><span class="type">Boolean</span><a href="#94896">sawerror</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
        <span class="typed"><span class="type">object Console</span><a id="440">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a id="27062">println</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#94934">fromServer</a></span>)
        <span class="typed"><span class="type">java.lang.String</span><a href="#94934">fromServer</a></span> = <span class="typed"><span class="type">java.io.BufferedReader</span><a href="#94933">in</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="46779">readLine</a></span>()
      }
      <span class="typed"><span class="type">java.io.BufferedReader</span><a href="#94933">in</a></span>.<span class="typed"><span class="type">()Unit</span><a id="46785">close</a></span>()
      <span class="typed"><span class="type">java.io.PrintWriter</span><a href="#94932">out</a></span>.<span class="typed"><span class="type">()Unit</span><a id="28686">close</a></span>()
      <span class="typed"><span class="type">java.net.Socket</span><a href="#94895">socket</a></span>.<span class="typed"><span class="type">()Unit</span><a id="47528">close</a></span>()
    }
    <span class="typed"><span class="type">Int</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#94896">sawerror</a></span>) <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> <span class="keyword">else</span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(Array[String])Unit</span><a id="67859">main</a></span>(<span class="typed"><span class="type">Array[String]</span><a id="94972">args</a></span>: <span class="typed"><span class="type">Array[String]</span><a id="1072">Array</a></span>[String]) {
    <span class="keyword">try</span> {
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="94973">status</a></span> = <span class="typed"><span class="type">(Array[String])Int</span><a href="#67858">main0</a></span>(<span class="typed"><span class="type">Array[String]</span><a href="#94972">args</a></span>)
      <span class="typed"><span class="type">(Int)Nothing</span><span id="6002"><a id="821">exit</a></span></span>(<span class="typed"><span class="type">Int</span><a href="#94973">status</a></span>)
    } <span class="keyword">catch</span> {
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Exception</span><a id="94975">e</a></span>: <span class="typed"><span class="type">Exception</span><a id="2131">Exception</a></span> =&gt; <span class="typed"><span class="type">(Int)Nothing</span><span id="6002"><a id="821">exit</a></span></span>(<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
    }
  }
}


<span class="keyword">object</span> <span class="typed"><span class="type">object scala.tools.nsc.CompileClient</span><a id="6361">CompileClient</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">scala.tools.nsc.StandardCompileClient</span><a href="#6474">StandardCompileClient</a></span>

        </pre>
    </body>
</html>