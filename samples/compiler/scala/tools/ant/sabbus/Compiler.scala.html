<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/ant/sabbus/Compiler.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala Ant Tasks                      **
**    / __/ __// _ | / /  / _ |    (c) 2005-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

// $Id: Compiler.scala 17828 2009-05-26 18:12:53Z extempore $

<span class="keyword">package</span> scala.tools.ant.sabbus

<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> java.net.URL
<span class="keyword">import</span> java.lang.reflect.InvocationTargetException
<span class="keyword">import</span> scala.util.ScalaClassLoader

<span class="keyword">class</span> <a title="class Compiler extends java.lang.Object with ScalaObject" id="19846">Compiler</a><a title="ScalaObject" id="959">(</a><a title="Array[java.net.URL]" id="172546">classpath</a>: <span title="Array[java.net.URL]">Array</span>[URL], <span class="keyword">val</span> <a title="scala.tools.ant.sabbus.Settings" id="172547">settings</a>: <a href="Settings.scala.html#19858" title="scala.tools.ant.sabbus.Settings">Settings</a>)
{  
  <span class="keyword">val</span> <a title="String" id="172494">foreignCompilerName</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;scala.tools.ant.sabbus.ForeignCompiler&quot;)" class="string">&quot;scala.tools.ant.sabbus.ForeignCompiler&quot;</span>
  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.util.URLClassLoader" id="172497">classLoader</a> = <a title="(urls: Seq[java.net.URL])scala.util.URLClassLoader" id="27737">ScalaClassLoader</a> fromURLs <a href="#172546" title="Array[java.net.URL]">classpath</a>
  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="AnyRef" id="172499">foreignCompiler</a>: <a title="AnyRef" id="1758">AnyRef</a> = <a href="#172496" title="(path: String)AnyRef" id="117433">classLoader</a> create <a href="#172494" title="=&gt; String">foreignCompilerName</a>
    
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Array[String]" id="172500">settingsArray</a>: <span title="Array[String]">Array</span>[String] = <a href="#172547" title="=&gt; scala.tools.ant.sabbus.Settings">settings</a>.<a href="Settings.scala.html#172486" title="=&gt; List[String]">toArgs</a>.<a title="(implicit evidence$1: scala.reflect.ClassManifest[String])Array[String]" id="25349">toArray</a>
  <a href="#172501" title="(method: String,types: Array[Class[_]],args: Array[AnyRef])java.lang.Object">foreignInvoke</a>(<span title="java.lang.String(&quot;args_$eq&quot;)" class="string">&quot;args_$eq&quot;</span>, <span title="(xs: Class[_]*)(implicit evidence$2: scala.reflect.ClassManifest[Class[_]])Array[Class[_]]">Array</span><span title="(clazz: Class[_],arg1: scala.reflect.OptManifest[_],args: scala.reflect.OptManifest[_]*)scala.reflect.ClassManifest[Class[_]]">(</span>classOf<span title="java.lang.Class[Array[String]]">[</span>Array[String]]), <span title="(xs: AnyRef*)(implicit evidence$2: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]">Array</span><span title="(clazz: Class[_])scala.reflect.ClassManifest[AnyRef]">(</span><a href="#172500" title="=&gt; Array[String]">settingsArray</a>))
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(method: String,types: Array[Class[_]],args: Array[AnyRef])java.lang.Object" id="172501">foreignInvoke</a>(<a title="String" id="180825">method</a>: <span title="String">String</span>, <a title="Array[Class[_]]" id="180826">types</a>: <span title="Array[Class[_]]">Array</span>[Class[_]], <a title="Array[AnyRef]" id="180827">args</a>: <span title="Array[AnyRef]">Array</span>[AnyRef]) =
    <span class="keyword">try</span> <a href="#172498" title="=&gt; AnyRef">foreignCompiler</a>.<a title="()java.lang.Class[_]" id="3628">getClass</a>.<a title="(x$1: java.lang.String,x$2: java.lang.Class[_]*)java.lang.reflect.Method" id="4845">getMethod</a>(<a href="#180825" title="String">method</a>, <a href="#180826" title="Array[Class[_]]">types</a>: _*).<a title="(x$1: Any,x$2: java.lang.Object*)java.lang.Object" id="118915">invoke</a>(<a href="#172498" title="=&gt; AnyRef">foreignCompiler</a>, <a href="#180827" title="Array[AnyRef]">args</a>: _*)
    <span class="keyword">catch</span> {
      <span title="Nothing" class="keyword">case</span> <a title="java.lang.reflect.InvocationTargetException" id="180840">e</a>: <a title="java.lang.reflect.InvocationTargetException" id="4056">InvocationTargetException</a> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="#180840" title="java.lang.reflect.InvocationTargetException">e</a>.<a title="()java.lang.Throwable" id="125075">getCause</a>
    }
  
  <span class="keyword">def</span> <a title="(files: Array[java.io.File])(Int, Int)" id="172502">compile</a>(<a title="Array[java.io.File]" id="181853">files</a>: <span title="Array[java.io.File]">Array</span>[File]): <a title="(Int, Int)" id="1154">(</a>Int, Int) = //(errors, warnings)
    <span class="keyword">try</span> {
      <a href="#172501" title="(method: String,types: Array[Class[_]],args: Array[AnyRef])java.lang.Object">foreignInvoke</a>(<span title="java.lang.String(&quot;args_$eq&quot;)" class="string">&quot;args_$eq&quot;</span>, <span title="(xs: Class[_]*)(implicit evidence$2: scala.reflect.ClassManifest[Class[_]])Array[Class[_]]">Array</span><span title="(clazz: Class[_],arg1: scala.reflect.OptManifest[_],args: scala.reflect.OptManifest[_]*)scala.reflect.ClassManifest[Class[_]]">(</span>classOf<span title="java.lang.Class[Array[String]]">[</span>Array[String]]), <span title="(xs: AnyRef*)(implicit evidence$2: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]">Array</span><span title="(clazz: Class[_])scala.reflect.ClassManifest[AnyRef]">(</span><a href="#172500" title="=&gt; Array[String]">settingsArray</a>))
      <span class="keyword">val</span> <a title="Int" id="181855">result</a> =
        <a href="#172501" title="(method: String,types: Array[Class[_]],args: Array[AnyRef])java.lang.Object">foreignInvoke</a>(<span title="java.lang.String(&quot;compile&quot;)" class="string">&quot;compile&quot;</span>, <span title="(xs: Class[_]*)(implicit evidence$2: scala.reflect.ClassManifest[Class[_]])Array[Class[_]]">Array</span><span title="(clazz: Class[_],arg1: scala.reflect.OptManifest[_],args: scala.reflect.OptManifest[_]*)scala.reflect.ClassManifest[Class[_]]">(</span>classOf<span title="java.lang.Class[Array[java.io.File]]">[</span>Array[File]]), <span title="(xs: AnyRef*)(implicit evidence$2: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]">Array</span><span title="(clazz: Class[_])scala.reflect.ClassManifest[AnyRef]">(</span><a href="#181853" title="Array[java.io.File]">files</a>)).<a title="[T0]T0" id="3623">asInstanceOf</a><span title="Int">[</span><a title="Int" id="2177">Int</a>]
      <a title="(_1: Int,_2: Int)(Int, Int)" id="1155">(</a><a href="#181855" title="(x$1: Int)Int" id="2861">result</a> &gt;&gt; <span title="Int(16)" class="int">16</span>, <a href="#181855" title="(x$1: Int)Int" id="2976">result</a> &amp; <span title="Int(255)" class="int">0x00FF</span>)
    }
    <span class="keyword">catch</span> {
      <span title="Nothing" class="keyword">case</span> <a title="Exception" id="182174">ex</a>: <a title="Exception" id="1875">Exception</a> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="CompilationFailure.scala.html#96349" title="(message: String,cause: Exception)scala.tools.ant.sabbus.CompilationFailure">CompilationFailure</a>(<a href="#182174" title="Exception">ex</a>.<a title="()java.lang.String" id="25926">getMessage</a>, <a href="#182174" title="Exception">ex</a>)
    }
}

        </pre>
    </body>
</html>