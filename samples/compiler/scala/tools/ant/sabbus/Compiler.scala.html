<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/tools/ant/sabbus/Compiler.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala Ant Tasks                      **
**    / __/ __// _ | / /  / _ |    (c) 2005-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

// $Id: Compiler.scala 17828 2009-05-26 18:12:53Z extempore $

<span class="keyword">package</span> scala.tools.ant.sabbus

<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> java.net.URL
<span class="keyword">import</span> java.lang.reflect.InvocationTargetException
<span class="keyword">import</span> scala.util.ScalaClassLoader

<span class="keyword">class</span> <a title="class Compiler extends java.lang.Object with ScalaObject" id="19981">Compiler</a><a title="ScalaObject" id="977">(</a><a title="Array[java.net.URL]" id="173294">classpath</a>: <span title="Array[java.net.URL]">Array</span>[URL], <span class="keyword">val</span> <a title="scala.tools.ant.sabbus.Settings" id="173295">settings</a>: <a href="Settings.scala.html#19993" title="scala.tools.ant.sabbus.Settings">Settings</a>)
{  
  <span class="keyword">val</span> <a title="String" id="173242">foreignCompilerName</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;scala.tools.ant.sabbus.ForeignCompiler&quot;)" class="string">&quot;scala.tools.ant.sabbus.ForeignCompiler&quot;</span>
  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.util.URLClassLoader" id="173245">classLoader</a> = <a title="(urls: Seq[java.net.URL])scala.util.URLClassLoader" id="27896">ScalaClassLoader</a> fromURLs <a href="#173294" title="Array[java.net.URL]">classpath</a>
  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="AnyRef" id="173247">foreignCompiler</a>: <a title="AnyRef" id="1779">AnyRef</a> = <a href="#173244" title="(path: String)AnyRef" id="117920">classLoader</a> create <a href="#173242" title="=&gt; String">foreignCompilerName</a>
    
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Array[String]" id="173248">settingsArray</a>: <span title="Array[String]">Array</span>[String] = <a href="#173295" title="=&gt; scala.tools.ant.sabbus.Settings">settings</a>.<a href="Settings.scala.html#173234" title="=&gt; List[String]">toArgs</a>.<a title="(implicit evidence$1: scala.reflect.ClassManifest[String])Array[String]" id="25508">toArray</a>
  <a href="#173249" title="(method: String,types: Array[Class[_]],args: Array[AnyRef])java.lang.Object">foreignInvoke</a>(<span title="java.lang.String(&quot;args_$eq&quot;)" class="string">&quot;args_$eq&quot;</span>, <span title="(xs: Class[_]*)(implicit evidence$2: scala.reflect.ClassManifest[Class[_]])Array[Class[_]]">Array</span><span title="(clazz: Class[_],arg1: scala.reflect.OptManifest[_],args: scala.reflect.OptManifest[_]*)scala.reflect.ClassManifest[Class[_]]">(</span>classOf<span title="java.lang.Class[Array[String]]">[</span>Array[String]]), <span title="(xs: AnyRef*)(implicit evidence$2: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]">Array</span><span title="(clazz: Class[_])scala.reflect.ClassManifest[AnyRef]">(</span><a href="#173248" title="=&gt; Array[String]">settingsArray</a>))
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(method: String,types: Array[Class[_]],args: Array[AnyRef])java.lang.Object" id="173249">foreignInvoke</a>(<a title="String" id="181599">method</a>: <span title="String">String</span>, <a title="Array[Class[_]]" id="181600">types</a>: <span title="Array[Class[_]]">Array</span>[Class[_]], <a title="Array[AnyRef]" id="181601">args</a>: <span title="Array[AnyRef]">Array</span>[AnyRef]) =
    <span class="keyword">try</span> <a href="#173246" title="=&gt; AnyRef">foreignCompiler</a>.<a title="()java.lang.Class[_]" id="3649">getClass</a>.<a title="(x$1: java.lang.String,x$2: java.lang.Class[_]*)java.lang.reflect.Method" id="4914">getMethod</a>(<a href="#181599" title="String">method</a>, <a href="#181600" title="Array[Class[_]]">types</a>: _*).<a title="(x$1: Any,x$2: java.lang.Object*)java.lang.Object" id="119408">invoke</a>(<a href="#173246" title="=&gt; AnyRef">foreignCompiler</a>, <a href="#181601" title="Array[AnyRef]">args</a>: _*)
    <span class="keyword">catch</span> {
      <span title="Nothing" class="keyword">case</span> <a title="java.lang.reflect.InvocationTargetException" id="181614">e</a>: <a title="java.lang.reflect.InvocationTargetException" id="4077">InvocationTargetException</a> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="#181614" title="java.lang.reflect.InvocationTargetException">e</a>.<a title="()java.lang.Throwable" id="125598">getCause</a>
    }
  
  <span class="keyword">def</span> <a title="(files: Array[java.io.File])(Int, Int)" id="173250">compile</a>(<a title="Array[java.io.File]" id="182627">files</a>: <span title="Array[java.io.File]">Array</span>[File]): <a title="(Int, Int)" id="1175">(</a>Int, Int) = //(errors, warnings)
    <span class="keyword">try</span> {
      <a href="#173249" title="(method: String,types: Array[Class[_]],args: Array[AnyRef])java.lang.Object">foreignInvoke</a>(<span title="java.lang.String(&quot;args_$eq&quot;)" class="string">&quot;args_$eq&quot;</span>, <span title="(xs: Class[_]*)(implicit evidence$2: scala.reflect.ClassManifest[Class[_]])Array[Class[_]]">Array</span><span title="(clazz: Class[_],arg1: scala.reflect.OptManifest[_],args: scala.reflect.OptManifest[_]*)scala.reflect.ClassManifest[Class[_]]">(</span>classOf<span title="java.lang.Class[Array[String]]">[</span>Array[String]]), <span title="(xs: AnyRef*)(implicit evidence$2: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]">Array</span><span title="(clazz: Class[_])scala.reflect.ClassManifest[AnyRef]">(</span><a href="#173248" title="=&gt; Array[String]">settingsArray</a>))
      <span class="keyword">val</span> <a title="Int" id="182629">result</a> =
        <a href="#173249" title="(method: String,types: Array[Class[_]],args: Array[AnyRef])java.lang.Object">foreignInvoke</a>(<span title="java.lang.String(&quot;compile&quot;)" class="string">&quot;compile&quot;</span>, <span title="(xs: Class[_]*)(implicit evidence$2: scala.reflect.ClassManifest[Class[_]])Array[Class[_]]">Array</span><span title="(clazz: Class[_],arg1: scala.reflect.OptManifest[_],args: scala.reflect.OptManifest[_]*)scala.reflect.ClassManifest[Class[_]]">(</span>classOf<span title="java.lang.Class[Array[java.io.File]]">[</span>Array[File]]), <span title="(xs: AnyRef*)(implicit evidence$2: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]">Array</span><span title="(clazz: Class[_])scala.reflect.ClassManifest[AnyRef]">(</span><a href="#182627" title="Array[java.io.File]">files</a>)).<a title="[T0]T0" id="3644">asInstanceOf</a><span title="Int">[</span><a title="Int" id="2198">Int</a>]
      <a title="(_1: Int,_2: Int)(Int, Int)" id="1176">(</a><a href="#182629" title="(x$1: Int)Int" id="2882">result</a> &gt;&gt; <span title="Int(16)" class="int">16</span>, <a href="#182629" title="(x$1: Int)Int" id="2997">result</a> &amp; <span title="Int(255)" class="int">0x00FF</span>)
    }
    <span class="keyword">catch</span> {
      <span title="Nothing" class="keyword">case</span> <a title="Exception" id="182948">ex</a>: <a title="Exception" id="1896">Exception</a> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="CompilationFailure.scala.html#96727" title="(message: String,cause: Exception)scala.tools.ant.sabbus.CompilationFailure">CompilationFailure</a>(<a href="#182948" title="Exception">ex</a>.<a title="()java.lang.String" id="26085">getMessage</a>, <a href="#182948" title="Exception">ex</a>)
    }
}

        </pre>
    </body>
</html>