<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scalax/collection/mutable/FlatHashTable.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: FlatHashTable.scala 16893 2009-01-13 13:09:22Z cunei $</span>

<span class="keyword">package</span> scalax.collection.mutable

<span class="keyword">trait</span> <span class="typed"><span class="type">trait FlatHashTable[A] extends java.lang.Object with ScalaObject</span><a id="6557">FlatHashTable</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="15954">A</a></span>] {

  <span class="comment">/** The load factor for the hash table; must be &lt; 500 (0.5)
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="23875">loadFactor</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">Int(450)</span><span class="int">450</span></span>
  <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="23876">loadFactorDenum</a></span> = <span class="typed"><span class="type">Int(1000)</span><span class="int">1000</span></span>

  <span class="comment">/** The initial size of the hash table.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="23877">initialSize</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">Int(16)</span><span class="int">16</span></span>

  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">val</span> <span class="typed"><span class="type">Boolean(false)</span><span id="23879"><a id="23878">tableDebug</a></span></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>

  <span class="comment">/** The actual hash table.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">Array[AnyRef]</span><span id="23882"><span id="23880"><span id="23881"><a id="101801">table</a></span></span></span></span>: scala.<span class="typed"><span class="type">Array[AnyRef]</span><a href="../../../scala/Array.scala.html#1070">Array</a></span>[AnyRef] = 
    <span class="typed"><span class="type">Array[AnyRef]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#23877">initialSize</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="keyword">else</span> <span class="typed"><span class="type">Array[AnyRef]</span><span class="keyword">new</span></span> scala.<span class="typed"><span class="type">Array[AnyRef]</span><a href="../../../scala/Array.scala.html#1070">Array</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#23877">initialSize</a></span>)

  <span class="comment">/** The number of mappings contained in this hash table.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="23885"><span id="23883"><span id="23884"><a id="101802">tableSize</a></span></span></span></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>

  <span class="comment">/** The next size value at which to resize (capacity * load factor).
   */</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="23888"><span id="23886"><span id="23887"><a id="101803">threshold</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#23900">newThreshold</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#23877">initialSize</a></span>)

  <span class="comment">/** Returns the number of entires in this hash table.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="23889">size</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#23883">tableSize</a></span>
  
  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Option[A]</span><a id="23890">findEntry</a></span>(<span class="typed"><span class="type">A</span><a id="101829">elem</a></span>: <span class="typed"><span class="type">A</span><a href="#15954">A</a></span>): <span class="typed"><span class="type">Option[A]</span><a href="../../../scala/Option.scala.html#932">Option</a></span>[A] = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="101830">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#23899">index</a></span>(<span class="typed"><span class="type">(A)Int</span><a href="#23897">elemHashCode</a></span>(<span class="typed"><span class="type">A</span><a href="#101829">elem</a></span>))
    <span class="keyword">var</span> <span class="typed"><span class="type">AnyRef</span><a id="101831">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#101830">h</a></span>)
    <span class="typed"><span class="type">Unit</span><a href="#101832" class="keyword">while</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#101831">entry</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#101831">entry</a></span> <span class="typed"><span class="type">(Any)Boolean</span><a id="3495">!=</a></span> <span class="typed"><span class="type">A</span><a href="#101829">elem</a></span>) {
      <span class="typed"><span class="type">Int</span><a href="#101830">h</a></span> = (<span class="typed"><span class="type">Int</span><a href="#101830">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span>
      <span class="typed"><span class="type">AnyRef</span><a href="#101831">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#101830">h</a></span>)
    }
    <span class="typed"><span class="type">Option[A]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#101831">entry</a></span>) <span class="typed"><span class="type">object None</span><a href="../../../scala/Option.scala.html#534">None</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">(A)Some[A]</span><a href="../../../scala/Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">AnyRef</span><a href="#101831">entry</a></span>.<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15954">A</a></span>])
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Boolean</span><a id="23891">containsEntry</a></span>(<span class="typed"><span class="type">A</span><a id="101922">elem</a></span>: <span class="typed"><span class="type">A</span><a href="#15954">A</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="101923">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#23899">index</a></span>(<span class="typed"><span class="type">(A)Int</span><a href="#23897">elemHashCode</a></span>(<span class="typed"><span class="type">A</span><a href="#101922">elem</a></span>))
    <span class="keyword">var</span> <span class="typed"><span class="type">AnyRef</span><a id="101924">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#101923">h</a></span>)
    <span class="typed"><span class="type">Unit</span><a href="#101925" class="keyword">while</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#101924">entry</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#101924">entry</a></span> <span class="typed"><span class="type">(Any)Boolean</span><a id="3495">!=</a></span> <span class="typed"><span class="type">A</span><a href="#101922">elem</a></span>) {
      <span class="typed"><span class="type">Int</span><a href="#101923">h</a></span> = (<span class="typed"><span class="type">Int</span><a href="#101923">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span>
      <span class="typed"><span class="type">AnyRef</span><a href="#101924">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#101923">h</a></span>)
    }
    <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#101924">entry</a></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Boolean</span><a id="23892">addEntry</a></span>(<span class="typed"><span class="type">A</span><a id="101956">elem</a></span>: <span class="typed"><span class="type">A</span><a href="#15954">A</a></span>) : <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="101957">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#23899">index</a></span>(<span class="typed"><span class="type">(A)Int</span><a href="#23897">elemHashCode</a></span>(<span class="typed"><span class="type">A</span><a href="#101956">elem</a></span>))
    <span class="keyword">var</span> <span class="typed"><span class="type">AnyRef</span><a id="101958">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#101957">h</a></span>)
    <span class="typed"><span class="type">Unit</span><a href="#101959" class="keyword">while</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#101958">entry</a></span>) {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">AnyRef</span><a href="#101958">entry</a></span> <span class="typed"><span class="type">(Any)Boolean</span><a id="3494">==</a></span> <span class="typed"><span class="type">A</span><a href="#101956">elem</a></span>) <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
      <span class="typed"><span class="type">Int</span><a href="#101957">h</a></span> = (<span class="typed"><span class="type">Int</span><a href="#101957">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span>
      <span class="typed"><span class="type">AnyRef</span><a href="#101958">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#101957">h</a></span>)
    }
    <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#101957">h</a></span>) = <span class="typed"><span class="type">A</span><a href="#101956">elem</a></span>.<span class="typed"><span class="type">AnyRef</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">AnyRef</span><a id="2015">AnyRef</a></span>]
    <span class="typed"><span class="type">(Int)Unit</span><a href="#23884">tableSize</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#23883">tableSize</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#23883">tableSize</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3144">&gt;=</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#23886">threshold</a></span>) <span class="typed"><span class="type">()Unit</span><a href="#23895">growTable</a></span>()
    <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Option[A]</span><a id="23893">removeEntry</a></span>(<span class="typed"><span class="type">A</span><a id="102008">elem</a></span>: <span class="typed"><span class="type">A</span><a href="#15954">A</a></span>) : <span class="typed"><span class="type">Option[A]</span><a href="../../../scala/Option.scala.html#932">Option</a></span>[A] = {
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean(false)</span><span >tableDebug</span></span>) <span class="typed"><span class="type">()Unit</span><a href="#23896">checkConsistent</a></span>()
    <span class="keyword">def</span> <span class="typed"><span class="type">(Int,Int)Boolean</span><a id="102009">precedes</a></span>(<span class="typed"><span class="type">Int</span><a id="102013">i</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">Int</span><a id="102014">j</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>) = {
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="102015">d</a></span> = <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3092">&gt;&gt;</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#102013">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3142">&lt;=</a></span> <span class="typed"><span class="type">Int</span><a href="#102014">j</a></span>) <span class="typed"><span class="type">Int</span><a href="#102014">j</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int</span><a href="#102013">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#102015">d</a></span>
      <span class="keyword">else</span> <span class="typed"><span class="type">Int</span><a href="#102013">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int</span><a href="#102014">j</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int</span><a href="#102015">d</a></span>
    }
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="102010">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#23899">index</a></span>(<span class="typed"><span class="type">(A)Int</span><a href="#23897">elemHashCode</a></span>(<span class="typed"><span class="type">A</span><a href="#102008">elem</a></span>))
    <span class="keyword">var</span> <span class="typed"><span class="type">AnyRef</span><a id="102011">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102010">h</a></span>)
    <span class="typed"><span class="type">Unit</span><a href="#102012" class="keyword">while</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#102011">entry</a></span>) {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">AnyRef</span><a href="#102011">entry</a></span> <span class="typed"><span class="type">(Any)Boolean</span><a id="3494">==</a></span> <span class="typed"><span class="type">A</span><a href="#102008">elem</a></span>) {
        <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="102031">h0</a></span> = <span class="typed"><span class="type">Int</span><a href="#102010">h</a></span>
        <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="102032">h1</a></span> = (<span class="typed"><span class="type">Int</span><a href="#102031">h0</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span>
        <span class="typed"><span class="type">Unit</span><a href="#102033" class="keyword">while</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102032">h1</a></span>)) {
          <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="102043">h2</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#23899">index</a></span>(<span class="typed"><span class="type">(A)Int</span><a href="#23897">elemHashCode</a></span>(<span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102032">h1</a></span>).<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15954">A</a></span>]))
          <span class="comment">//Console.println(&quot;shift at &quot;+h1+&quot;:&quot;+table(h1)+&quot; with h2 = &quot;+h2+&quot;? &quot;+(h2 != h1)+precedes(h2, h0)+table.length)</span>
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#102043">h2</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3140">!=</a></span> <span class="typed"><span class="type">Int</span><a href="#102032">h1</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">(Int,Int)Boolean</span><a href="#102009">precedes</a></span>(<span class="typed"><span class="type">Int</span><a href="#102043">h2</a></span>, <span class="typed"><span class="type">Int</span><a href="#102031">h0</a></span>)) {
            <span class="comment">//Console.println(&quot;shift &quot;+h1+&quot; to &quot;+h0+&quot;!&quot;)</span>
            <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102031">h0</a></span>) = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102032">h1</a></span>)
            <span class="typed"><span class="type">Int</span><a href="#102031">h0</a></span> = <span class="typed"><span class="type">Int</span><a href="#102032">h1</a></span>
          } 
          <span class="typed"><span class="type">Int</span><a href="#102032">h1</a></span> = (<span class="typed"><span class="type">Int</span><a href="#102032">h1</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span>
        }
        <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102031">h0</a></span>) = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
        <span class="typed"><span class="type">(Int)Unit</span><a href="#23884">tableSize</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean(false)</span><span >tableDebug</span></span>) <span class="typed"><span class="type">()Unit</span><a href="#23896">checkConsistent</a></span>()
        <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">(A)Some[A]</span><a href="../../../scala/Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">AnyRef</span><a href="#102011">entry</a></span>.<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15954">A</a></span>])
      }
      <span class="typed"><span class="type">Int</span><a href="#102010">h</a></span> = (<span class="typed"><span class="type">Int</span><a href="#102010">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span>
      <span class="typed"><span class="type">AnyRef</span><a href="#102011">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102010">h</a></span>)
    }
    <span class="typed"><span class="type">object None</span><a href="../../../scala/Option.scala.html#534">None</a></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; &lt;refinement&gt; extends java.lang.Object with scalax.collection.Iterator[A]</span><a id="23894">elements</a></span> = <span class="typed"><span class="type">template $anon extends java.lang.Object with scalax.collection.Iterator[A]</span><a id="102112" class="keyword">new</a></span> <span class="typed"><span class="type">scalax.collection.Iterator[A]</span><a href="../Iterator.scala.html#6386">Iterator</a></span>[A] {
    <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="102116"><span id="102114"><span id="102115"><a id="102121">i</a></span></span></span></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="102117">hasNext</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
      <span class="typed"><span class="type">Unit</span><a href="#102123" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#102114">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#102114">i</a></span>))) <span class="typed"><span class="type">(Int)Unit</span><a href="#102115">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>;
      <span class="typed"><span class="type">=&gt; Int</span><a href="#102114">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span>
    }
    <span class="keyword">def</span> <span class="typed"><span class="type">()A</span><a id="102118">next</a></span>(): <span class="typed"><span class="type">A</span><a href="#15954">A</a></span> =
      <span class="typed"><span class="type">A</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#102117">hasNext</a></span>) { <span class="typed"><span class="type">(Int)Unit</span><a href="#102115">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>; <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#102114">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>).<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15954">A</a></span>] }
      <span class="keyword">else</span> <span class="typed"><span class="type">object scalax.collection.Iterator</span><a href="../Iterator.scala.html#6387">Iterator</a></span>.<span class="typed"><span class="type">=&gt; &lt;refinement&gt; extends java.lang.Object with scalax.collection.Iterator[Nothing]</span><a href="../Iterator.scala.html#24377">empty</a></span>.<span class="typed"><span class="type">()Nothing</span><a href="../Iterator.scala.html#20217">next</a></span>
  }

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="23895">growTable</a></span>() {
    <span class="keyword">val</span> <span class="typed"><span class="type">Array[AnyRef]</span><a id="102203">oldtable</a></span> = <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>
    <span class="typed"><span class="type">(Array[AnyRef])Unit</span><a href="#23881">table</a></span> = <span class="typed"><span class="type">Array[AnyRef]</span><span class="keyword">new</span></span> scala.<span class="typed"><span class="type">Array[AnyRef]</span><a href="../../../scala/Array.scala.html#1070">Array</a></span>[AnyRef](<span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">*</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>)
    <span class="typed"><span class="type">(Int)Unit</span><a href="#23884">tableSize</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#23887">threshold</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#23900">newThreshold</a></span>(<span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span>)
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="102204">i</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">Unit</span><a href="#102205" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#102204">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Array[AnyRef]</span><a href="#102203">oldtable</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">AnyRef</span><a id="102224">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">oldtable</a></span>(<span class="typed"><span class="type">Int</span><a href="#102204">i</a></span>)
      <span class="typed"><span class="type">AnyVal with NotNull</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#102224">entry</a></span>) <span class="typed"><span class="type">(A)Boolean</span><a href="#23892">addEntry</a></span>(<span class="typed"><span class="type">AnyRef</span><a href="#102224">entry</a></span>.<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15954">A</a></span>])
      <span class="typed"><span class="type">Int</span><a href="#102204">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    }
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean(false)</span><span >tableDebug</span></span>) <span class="typed"><span class="type">()Unit</span><a href="#23896">checkConsistent</a></span>()
  }

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="23896">checkConsistent</a></span>() {
    <span class="keyword">for</span> (<span class="typed"><span class="type">((Int) =&gt; Unit)Unit</span><a href="../../../scala/Range.scala.html#25001" id="102268">i</a></span> &lt;- <span class="typed"><span class="type">implicit scala.Predef.intWrapper : (Int)scala.runtime.RichInt</span><a href="../../../scala/Predef.scala.html#13511" class="int">0</a></span> <span class="typed"><span class="type">(Int)Range</span><a href="../../../scala/runtime/RichInt.scala.html#19402">until</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102268">i</a></span>) <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">(A)Boolean</span><a href="#23891">containsEntry</a></span>(<span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102268">i</a></span>).<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15954">A</a></span>]))
        <span class="typed"><span class="type">(Boolean,=&gt; Any)Unit</span><a href="../../../scala/Predef.scala.html#13362">assert</a></span>(<span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>, <span class="typed"><span class="type">Int</span><a href="#102268">i</a></span><span class="typed"><span class="type">(java.lang.String)java.lang.String</span><a id="3087">+</a></span><span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">(Int)AnyRef</span><a href="../../../scala/Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102268">i</a></span>)<span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">()String</span><a href="../../../scala/Collection.scala.html#17380">toString</a></span>)
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(A)Int</span><a id="23897">elemHashCode</a></span>(<span class="typed"><span class="type">A</span><a id="101888">elem</a></span>: <span class="typed"><span class="type">A</span><a href="#15954">A</a></span>) = <span class="typed"><span class="type">A</span><a href="#101888">elem</a></span>.<span class="typed"><span class="type">()Int</span><a id="3497">hashCode</a></span>()

  <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int)Int</span><a id="23898">improve</a></span>(<span class="typed"><span class="type">Int</span><a id="101835">hcode</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>) = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="101837">h</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">Int</span><a href="#101835">hcode</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">=&gt; Int</span><a id="3096">~</a></span>(<span class="typed"><span class="type">Int</span><a href="#101835">hcode</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3088">&lt;&lt;</a></span> <span class="typed"><span class="type">Int(9)</span><span class="int">9</span></span>)
    <span class="typed"><span class="type">Int</span><a href="#101837">h</a></span> = <span class="typed"><span class="type">Int</span><a href="#101837">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3152">^</a></span> (<span class="typed"><span class="type">Int</span><a href="#101837">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3090">&gt;&gt;&gt;</a></span> <span class="typed"><span class="type">Int(14)</span><span class="int">14</span></span>)
    <span class="typed"><span class="type">Int</span><a href="#101837">h</a></span> = <span class="typed"><span class="type">Int</span><a href="#101837">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> (<span class="typed"><span class="type">Int</span><a href="#101837">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3088">&lt;&lt;</a></span> <span class="typed"><span class="type">Int(4)</span><span class="int">4</span></span>)
    <span class="typed"><span class="type">Int</span><a href="#101837">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3152">^</a></span> (<span class="typed"><span class="type">Int</span><a href="#101837">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3090">&gt;&gt;&gt;</a></span> <span class="typed"><span class="type">Int(10)</span><span class="int">10</span></span>)
  }

  <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int)Int</span><a id="23899">index</a></span>(<span class="typed"><span class="type">Int</span><a id="101833">hcode</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>) = <span class="typed"><span class="type">(Int)Int</span><a href="#23898">improve</a></span>(<span class="typed"><span class="type">Int</span><a href="#101833">hcode</a></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3151">&amp;</a></span> (<span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int)Int</span><a id="23900">newThreshold</a></span>(<span class="typed"><span class="type">Int</span><a id="101813">size</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>) = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="101815">lf</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#23875">loadFactor</a></span>
    <span class="typed"><span class="type">(Boolean,=&gt; Any)Unit</span><a href="../../../scala/Predef.scala.html#13362">assert</a></span>(<span class="typed"><span class="type">Int</span><a href="#101815">lf</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#23876">loadFactorDenum</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">/</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>), <span class="typed"><span class="type">java.lang.String(&quot;loadFactor too large; must be &lt; 0.5&quot;)</span><span class="string">&quot;loadFactor too large; must be &lt; 0.5&quot;</span></span>)
    (<span class="typed"><span class="type">Int</span><a href="#101813">size</a></span>.<span class="typed"><span class="type">=&gt; Long</span><a id="3084">toLong</a></span> <span class="typed"><span class="type">(Int)Long</span><a id="3256">*</a></span> <span class="typed"><span class="type">Int</span><a href="#101815">lf</a></span> <span class="typed"><span class="type">(Int)Long</span><a id="3257">/</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#23876">loadFactorDenum</a></span> ).<span class="typed"><span class="type">=&gt; Int</span><a id="3192">toInt</a></span>
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="23901">clear</a></span>() {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="102292">i</a></span> = <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../scala/Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">Unit</span><a href="#102293" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#102292">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3144">&gt;=</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) { <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#23880">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#102292">i</a></span>) = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>; <span class="typed"><span class="type">Int</span><a href="#102292">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> }
    <span class="typed"><span class="type">(Int)Unit</span><a href="#23884">tableSize</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
  }
}

        </pre>
    </body>
</html>