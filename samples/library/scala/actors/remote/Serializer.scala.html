<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/actors/remote/Serializer.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2005-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: Serializer.scala 16893 2009-01-13 13:09:22Z cunei $</span>


<span class="keyword">package</span> scala.actors.remote


<span class="keyword">import</span> java.lang.ClassNotFoundException

<span class="keyword">import</span> java.io.{DataInputStream, DataOutputStream, EOFException, IOException}

<span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Serializer extends java.lang.Object with ScalaObject</span><a id="8260">Serializer</a></span>(<span class="keyword">val</span> <span class="typed"><span class="type">scala.actors.remote.Service</span><span id="23246"><span id="23245"><a id="23263">service</a></span></span></span>: <span class="typed"><span class="type">scala.actors.remote.Service</span><a href="Service.scala.html#8266">Service</a></span>) {
  <span class="keyword">def</span> <span class="typed"><span class="type">(AnyRef)Array[Byte]</span><a id="23248">serialize</a></span>(<span class="typed"><span class="type">AnyRef</span><a id="23264">o</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="2015">AnyRef</a></span>): <span class="typed"><span class="type">Array[Byte]</span><a href="../../Array.scala.html#1070">Array</a></span>[Byte]
  <span class="keyword">def</span> <span class="typed"><span class="type">(Array[Byte])AnyRef</span><a id="23249">deserialize</a></span>(<span class="typed"><span class="type">Array[Byte]</span><a id="23265">a</a></span>: <span class="typed"><span class="type">Array[Byte]</span><a href="../../Array.scala.html#1070">Array</a></span>[Byte]): <span class="typed"><span class="type">AnyRef</span><a id="2015">AnyRef</a></span>

  @<span class="typed"><span class="type">throws</span><a href="../../throws.scala.html#254">throws</a></span>(<span class="typed"><span class="type">java.lang.Class[java.io.IOException]</span><span >classOf</span></span>[IOException])
  <span class="keyword">def</span> <span class="typed"><span class="type">(java.io.DataInputStream)Array[Byte]</span><a id="23250">readBytes</a></span>(<span class="typed"><span class="type">java.io.DataInputStream</span><a id="23268">inputStream</a></span>: <span class="typed"><span class="type">java.io.DataInputStream</span><a id="3565">DataInputStream</a></span>): <span class="typed"><span class="type">Array[Byte]</span><a href="../../Array.scala.html#1070">Array</a></span>[Byte] = {
    <span class="keyword">try</span> {
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="23288">length</a></span> = <span class="typed"><span class="type">java.io.DataInputStream</span><a href="#23268">inputStream</a></span>.<span class="typed"><span class="type">()Int</span><a id="23281">readInt</a></span>()
      <span class="keyword">val</span> <span class="typed"><span class="type">Array[Byte]</span><a id="23289">bytes</a></span> = <span class="typed"><span class="type">Array[Byte]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Array[Byte]</span><a href="../../Array.scala.html#1070">Array</a></span>[Byte](<span class="typed"><span class="type">Int</span><a href="#23288">length</a></span>)
      <span class="typed"><span class="type">java.io.DataInputStream</span><a href="#23268">inputStream</a></span>.<span class="typed"><span class="type">(Array[Byte],Int,Int)Unit</span><a id="23273">readFully</a></span>(<span class="typed"><span class="type">Array[Byte]</span><a href="#23289">bytes</a></span>, <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="typed"><span class="type">Int</span><a href="#23288">length</a></span>)
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Array[Byte]</span><a href="#23289">bytes</a></span>
    }
    <span class="keyword">catch</span> {
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">NullPointerException</span><a id="23333">npe</a></span>: <span class="typed"><span class="type">NullPointerException</span><a id="1721">NullPointerException</a></span> =&gt;
        <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(java.lang.String)java.io.EOFException</span><a id="23337" class="keyword">new</a></span> <span class="typed"><span class="type">java.io.EOFException</span><a id="3763">EOFException</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Connection closed.&quot;)</span><span class="string">&quot;Connection closed.&quot;</span></span>)
    }
  }

  @<span class="typed"><span class="type">throws</span><a href="../../throws.scala.html#254">throws</a></span>(<span class="typed"><span class="type">java.lang.Class[java.io.IOException]</span><span >classOf</span></span>[IOException]) @<span class="typed"><span class="type">throws</span><a href="../../throws.scala.html#254">throws</a></span>(<span class="typed"><span class="type">java.lang.Class[java.lang.ClassNotFoundException]</span><span >classOf</span></span>[ClassNotFoundException])
  <span class="keyword">def</span> <span class="typed"><span class="type">(java.io.DataInputStream)AnyRef</span><a id="23251">readObject</a></span>(<span class="typed"><span class="type">java.io.DataInputStream</span><a id="23344">inputStream</a></span>: <span class="typed"><span class="type">java.io.DataInputStream</span><a id="3565">DataInputStream</a></span>): <span class="typed"><span class="type">AnyRef</span><a id="2015">AnyRef</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Array[Byte]</span><a id="23345">bytes</a></span> = <span class="typed"><span class="type">(java.io.DataInputStream)Array[Byte]</span><a href="#23250">readBytes</a></span>(<span class="typed"><span class="type">java.io.DataInputStream</span><a href="#23344">inputStream</a></span>)
    <span class="typed"><span class="type">(Array[Byte])AnyRef</span><a href="#23249">deserialize</a></span>(<span class="typed"><span class="type">Array[Byte]</span><a href="#23345">bytes</a></span>)
  }

  @<span class="typed"><span class="type">throws</span><a href="../../throws.scala.html#254">throws</a></span>(<span class="typed"><span class="type">java.lang.Class[java.io.IOException]</span><span >classOf</span></span>[IOException])
  <span class="keyword">def</span> <span class="typed"><span class="type">(java.io.DataOutputStream,Array[Byte])Unit</span><a id="23252">writeBytes</a></span>(<span class="typed"><span class="type">java.io.DataOutputStream</span><a id="23346">outputStream</a></span>: <span class="typed"><span class="type">java.io.DataOutputStream</span><a id="3526">DataOutputStream</a></span>, <span class="typed"><span class="type">Array[Byte]</span><a id="23347">bytes</a></span>: <span class="typed"><span class="type">Array[Byte]</span><a href="../../Array.scala.html#1070">Array</a></span>[Byte]) {
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="23366">length</a></span> = <span class="typed"><span class="type">Array[Byte]</span><a href="#23347">bytes</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>;
    <span class="comment">// original length</span>
    <span class="typed"><span class="type">java.io.DataOutputStream</span><a href="#23346">outputStream</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a id="23357">writeInt</a></span>(<span class="typed"><span class="type">Int</span><a href="#23366">length</a></span>)
    <span class="typed"><span class="type">java.io.DataOutputStream</span><a href="#23346">outputStream</a></span>.<span class="typed"><span class="type">(Array[Byte],Int,Int)Unit</span><a id="23351">write</a></span>(<span class="typed"><span class="type">Array[Byte]</span><a href="#23347">bytes</a></span>, <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="typed"><span class="type">Int</span><a href="#23366">length</a></span>)
    <span class="typed"><span class="type">java.io.DataOutputStream</span><a href="#23346">outputStream</a></span>.<span class="typed"><span class="type">()Unit</span><a id="23352">flush</a></span>()
  }

  @<span class="typed"><span class="type">throws</span><a href="../../throws.scala.html#254">throws</a></span>(<span class="typed"><span class="type">java.lang.Class[java.io.IOException]</span><span >classOf</span></span>[IOException])
  <span class="keyword">def</span> <span class="typed"><span class="type">(java.io.DataOutputStream,AnyRef)Unit</span><a id="23253">writeObject</a></span>(<span class="typed"><span class="type">java.io.DataOutputStream</span><a id="23409">outputStream</a></span>: <span class="typed"><span class="type">java.io.DataOutputStream</span><a id="3526">DataOutputStream</a></span>, <span class="typed"><span class="type">AnyRef</span><a id="23410">obj</a></span>: <span class="typed"><span class="type">AnyRef</span><a id="2015">AnyRef</a></span>) {
    <span class="keyword">val</span> <span class="typed"><span class="type">Array[Byte]</span><a id="23411">bytes</a></span> = <span class="typed"><span class="type">(AnyRef)Array[Byte]</span><a href="#23248">serialize</a></span>(<span class="typed"><span class="type">AnyRef</span><a href="#23410">obj</a></span>)
    <span class="typed"><span class="type">(java.io.DataOutputStream,Array[Byte])Unit</span><a href="#23252">writeBytes</a></span>(<span class="typed"><span class="type">java.io.DataOutputStream</span><a href="#23409">outputStream</a></span>, <span class="typed"><span class="type">Array[Byte]</span><a href="#23411">bytes</a></span>)
  }
}

        </pre>
    </body>
</html>