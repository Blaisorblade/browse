<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/io/Position.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style">
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

// $Id: Position.scala 17274 2009-03-10 11:39:04Z michelou $


<span class="keyword">package</span> scala.io

/** &lt;p&gt;
 *    The object &lt;code&gt;Position&lt;/code&gt; provides convenience methods to encode
 *    line and column number in one single integer. The encode line (column)
 *    numbers range from 0 to &lt;code&gt;LINE_MASK&lt;/code&gt;
 *    (&lt;code&gt;COLUMN_MASK&lt;/code&gt;), where 0 indicates that the line (column) is
 *    the undefined and 1 represents the first line (column). Line (Column)
 *    numbers greater than &lt;code&gt;LINE_MASK&lt;/code&gt;
 *    (&lt;code&gt;COLUMN_MASK&lt;/code&gt;) are replaced by &lt;code&gt;LINE_MASK&lt;/code&gt;
 *    (&lt;code&gt;COLUMN_MASK&lt;/code&gt;). Furthermore, if the encoded line number is
 *    &lt;code&gt;LINE_MASK&lt;/code&gt;, the column number is always set to 0.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    The following properties hold:
 *  &lt;/p&gt;
 *  &lt;ul&gt;
 *    &lt;li&gt;
 *      the undefined position is 0: &lt;code&gt;encode(0,0) == 0&lt;/code&gt;
 *    &lt;/li&gt;
 *    &lt;li&gt;
 *      encodings are non-negative : &lt;code&gt;encode(line,column) &gt;= 0&lt;/code&gt;
 *    &lt;/li&gt;
 *    &lt;li&gt;
 *      position order is preserved:
 *      &lt;code&gt;(line1 &amp;lt; line2) || (line1 == line2 &amp;amp;&amp;amp; column1 &amp;lt; column2)&lt;/code&gt;
 *      &lt;div&gt;implies&lt;/div&gt;
 *      &lt;code&gt;encode(line1,column1) &amp;lt;= encode(line2,column2)&lt;/code&gt;
 *    &lt;/li&gt;
 *  &lt;/ul&gt;
 *
 *  @author Burak Emir (translated from work by Matthias Zenger and others)
 */
<span class="keyword">object</span> <a title="object scala.io.Position" id="9922">Position</a> <a href="../ScalaObject.scala.html#969" title="ScalaObject">{</a>

  /** Number of bits used to encode the line number */
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(20)" id="159905">LINE_BITS</a>   = <span title="Int(20)" class="int">20</span>
  /** Number of bits used to encode the column number */
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(11)" id="159907">COLUMN_BITS</a> = <span class="int">31</span> <span title="Int(11)">-</span> LINE_BITS // no negatives =&gt; 31

  /** Mask to decode the line number */
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(1048575)" id="159909">LINE_MASK</a>   = (<span class="int">1</span> &lt;&lt; LINE_BITS) <span title="Int(1048575)">-</span> <span class="int">1</span>
  /** Mask to decode the column number */
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(2047)" id="159911">COLUMN_MASK</a> = (<span class="int">1</span> &lt;&lt; COLUMN_BITS) <span title="Int(2047)">-</span> <span class="int">1</span>

  /** The undefined position */
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(0)" id="159913">NOPOS</a>       = <span title="Int(0)" class="int">0</span>

  /** The first position in a source file */
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int" id="159915">FIRSTPOS</a>    = <a href="#159917" title="(line: Int,column: Int)Int">encode</a>(<span title="Int(1)" class="int">1</span>, <span title="Int(1)" class="int">1</span>)

  /** Encodes a position into a single integer. */
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(line: Int,column: Int)Int" id="159917">encode</a>(<a title="Int" id="159952">line</a>: <span title="Int">Int</span>, <a title="Int" id="159953">column</a>: <span title="Int">Int</span>): <span title="Int">Int</span> = {
    <span class="keyword">var</span> <a title="Int" id="159959">line1</a>, <a title="Int" id="159960">column1</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">if</span> (<a href="#159952" title="(x$1: Int)Boolean">line</a> &lt; <span title="Int(0)" class="int">0</span>)
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.IllegalArgumentException" class="keyword">new</span> <a href="../Predef.scala.html#16275" title="java.lang.IllegalArgumentException">IllegalArgumentException</a>(<a href="#159952" title="(x$1: java.lang.String)java.lang.String">line</a> + <span title="java.lang.String(&quot; &lt; 0&quot;)" class="string">&quot; &lt; 0&quot;</span>)
    <span title="Unit" class="keyword">if</span> (<a title="(x$1: Boolean)Boolean" id="2225">(</a><a href="#159952" title="(x$1: Int)Boolean" id="2965">line</a> == <span title="Int(0)" class="int">0</span>) &amp;&amp; (<a href="#159953" title="(x$1: Int)Boolean" id="2967">column</a> != <span title="Int(0)" class="int">0</span>))
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.IllegalArgumentException" class="keyword">new</span> <a href="../Predef.scala.html#16275" title="java.lang.IllegalArgumentException">IllegalArgumentException</a>(<a href="#159952" title="(x$1: java.lang.String)java.lang.String">line</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#159953" title="Int">column</a> + <span title="java.lang.String(&quot; not allowed&quot;)" class="string">&quot; not allowed&quot;</span>)
    <span title="Unit" class="keyword">if</span> (<a href="#159953" title="(x$1: Int)Boolean">column</a> &lt; <span title="Int(0)" class="int">0</span>)
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.IllegalArgumentException" class="keyword">new</span> <a href="../Predef.scala.html#16275" title="java.lang.IllegalArgumentException">IllegalArgumentException</a>(<a href="#159952" title="(x$1: java.lang.String)java.lang.String">line</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#159953" title="Int">column</a> + <span title="java.lang.String(&quot; not allowed&quot;)" class="string">&quot; not allowed&quot;</span>)

    <span title="Unit" class="keyword">if</span> (<a href="#159952" title="(x$1: Int)Boolean" id="2975">line</a> &gt;= <span title="Int(1048575)">LINE_MASK</span>) {
      <a href="#159959" title="Int">line1</a> = <span title="Int(1048575)">LINE_MASK</span>
      <a href="#159960" title="Int">column1</a> = <span title="Int(0)" class="int">0</span>
    }
    <span class="keyword">else</span> {
      <a href="#159959" title="Int">line1</a> = <a href="#159952" title="Int">line</a>
      <span title="Unit" class="keyword">if</span> (<a href="#159953" title="(x$1: Int)Boolean" id="2973">column</a> &gt; <span title="Int(2047)">COLUMN_MASK</span>)
        <a href="#159960" title="Int">column1</a> = <span title="Int(2047)">COLUMN_MASK</span>
      <span class="keyword">else</span> 
        <a href="#159960" title="Int">column1</a> = <a href="#159953" title="Int">column</a>
    }
    <a title="(x$1: Int)Int" id="2987">(</a><a href="#159959" title="(x$1: Int)Int" id="2866">line1</a> &lt;&lt; <span title="Int(11)">COLUMN_BITS</span>) | <a href="#159960" title="Int">column1</a>
  }

  /** Returns the line number of the encoded position. */
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(pos: Int)Int" id="159918">line</a>(<a title="Int" id="160062">pos</a>: <span title="Int">Int</span>): <span title="Int">Int</span> =
    <span title="(x$1: Int)Int">(</span><a href="#160062" title="(x$1: Int)Int" id="2874">pos</a> &gt;&gt; <span title="Int(11)">COLUMN_BITS</span>) &amp; <span title="Int(1048575)">LINE_MASK</span>

  /** Returns the column number of the encoded position. */
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(pos: Int)Int" id="159919">column</a>(<a title="Int" id="160080">pos</a>: <span title="Int">Int</span>): <span title="Int">Int</span> =
    <a href="#160080" title="(x$1: Int)Int">pos</a> &amp; <span title="Int(2047)">COLUMN_MASK</span>

  /** Returns a string representation of the encoded position. */
  <span class="keyword">def</span> <a title="(pos: Int)String" id="159920">toString</a>(<a title="Int" id="160092">pos</a>: <span title="Int">Int</span>): <a title="String" id="1618">String</a> = {
    <span class="keyword">val</span> <a title="StringBuilder" id="160094">sb</a> = <a href="../collection/mutable/StringBuilder.scala.html#23455" title="()StringBuilder" class="keyword">new</a> <a href="../package.scala.html#14896" title="StringBuilder">StringBuilder</a>
    <a href="../collection/mutable/StringBuilder.scala.html#23489" title="(x: Int)StringBuilder">sb</a> append <a href="#159918" title="(pos: Int)Int">line</a>(<a href="#160092" title="Int">pos</a>)
    <a href="../collection/mutable/StringBuilder.scala.html#23487" title="(x: Char)StringBuilder">sb</a> append <span title="Char(':')" class="char">':'</span>
    <a href="../collection/mutable/StringBuilder.scala.html#23489" title="(x: Int)StringBuilder">sb</a> append <a href="#159919" title="(pos: Int)Int">column</a>(<a href="#160092" title="Int">pos</a>)
    <a href="#160094" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#23516" title="()String">toString</a>()
  }
}

        </pre>
    </body>
</html>