<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/xml/include/sax/Main.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2002-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

// $Id: Main.scala 18387 2009-07-24 15:28:37Z odersky $

<span class="keyword">package</span> scala.xml
<span class="keyword">package</span> include.sax
<span class="keyword">import</span> scala.xml.include._

<span class="keyword">import</span> org.xml.sax.SAXException
<span class="keyword">import</span> org.xml.sax.SAXParseException
<span class="keyword">import</span> org.xml.sax.EntityResolver
<span class="keyword">import</span> org.xml.sax.helpers.XMLReaderFactory
<span class="keyword">import</span> org.xml.sax.XMLReader

<span class="keyword">object</span> <a title="object scala.xml.include.sax.Main" id="9984">Main</a> <a href="../../../ScalaObject.scala.html#969" title="ScalaObject">{</a>
  
    /**
      * The driver method for xinc
      * Output is written to System.out via Conolse
      * &lt;/p&gt;
      *
      * @param args  contains the URLs and/or filenames
      *              of the documents to be procesed.
      */
    <span class="keyword">def</span> <a title="(args: Array[String])Unit" id="24076">main</a>(<a title="Array[String]" id="24080">args</a>: <a href="../../../Array.scala.html#897" title="Array[String]">Array</a>[String]) {
      <span class="keyword">var</span> <a title="org.xml.sax.XMLReader" id="24082">parser</a>: <a title="org.xml.sax.XMLReader" id="24026">XMLReader</a> = <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">var</span> <a title="Boolean" id="24083">err</a> = <span title="Boolean(false)" class="keyword">false</span>
      <span class="keyword">try</span> {
        <a href="#24082" title="org.xml.sax.XMLReader">parser</a> = <span title="object org.xml.sax.helpers.XMLReaderFactory">XMLReaderFactory</span>.<a title="()org.xml.sax.XMLReader" id="24112">createXMLReader</a>()
      } 
      <span class="keyword">catch</span> { 
        <span title="Unit" class="keyword">case</span> <a title="org.xml.sax.SAXException" id="24128">e</a>:<span title="org.xml.sax.SAXException">SAXException</span> =&gt;
          <span class="keyword">try</span> {
            <a href="#24082" title="org.xml.sax.XMLReader">parser</a> = <span title="object org.xml.sax.helpers.XMLReaderFactory">XMLReaderFactory</span>.<a title="(x$1: java.lang.String)org.xml.sax.XMLReader" id="24113">createXMLReader</a>(
              <span title="java.lang.String(&quot;org.apache.xerces.parsers.SAXParser&quot;)" class="string">&quot;org.apache.xerces.parsers.SAXParser&quot;</span>)
          } <span class="keyword">catch</span> {
            <span title="Unit" class="keyword">case</span> <a title="org.xml.sax.SAXException" id="24146">e2</a>:<span title="org.xml.sax.SAXException">SAXException</span> =&gt;
              <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="java.lang.String(&quot;Could not find an XML parser&quot;)" class="string">&quot;Could not find an XML parser&quot;</span>)
              <a href="#24083" title="Boolean">err</a> = <span title="Boolean(true)" class="keyword">true</span>
          }
      }

      <span title="Unit" class="keyword">if</span>(<a href="#24083" title="Boolean">err</a>) <span title="Nothing" class="keyword">return</span>;
      // Need better namespace handling
      <span class="keyword">try</span> {
        <a href="#24082" title="org.xml.sax.XMLReader">parser</a>.<a title="(x$1: java.lang.String,x$2: Boolean)Unit" id="24088">setFeature</a>(<span title="java.lang.String(&quot;http://xml.org/sax/features/namespace-prefixes&quot;)" class="string">&quot;http://xml.org/sax/features/namespace-prefixes&quot;</span>, <span title="Boolean(true)" class="keyword">true</span>);
      }
      <span class="keyword">catch</span> { 
        <span title="Unit" class="keyword">case</span> <a title="org.xml.sax.SAXException" id="24476">e</a>:<span title="org.xml.sax.SAXException">SAXException</span> =&gt;
          <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: Any)Unit">println</span>(<a href="#24476" title="org.xml.sax.SAXException">e</a>)
          <a href="#24083" title="Boolean">err</a> = <span title="Boolean(true)" class="keyword">true</span>
      }   
      <span title="Unit" class="keyword">if</span> (<a href="#24083" title="Boolean">err</a>) <span title="Nothing" class="keyword">return</span>
      
      <span title="Unit" class="keyword">if</span> (<a href="#24080" title="Array[String]">args</a>.<a href="../../../Array.scala.html#17822" title="(x$1: Int)Boolean" id="2965">length</a> == <span title="Int(0)" class="int">0</span>) <span title="Nothing" class="keyword">return</span>
      <span class="keyword">var</span> <a title="org.xml.sax.EntityResolver" id="24084">resolver</a>: <span title="org.xml.sax.EntityResolver">EntityResolver</span> = <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">var</span> <a title="Int" id="24085">arg</a>: <a title="Int" id="2190">Int</a> = <span title="Int(0)" class="int">0</span>
      <span title="Unit" class="keyword">if</span> (<a href="../../../Array.scala.html#17823" title="(i: Int)String">args</a>(<span title="Int(0)" class="int">0</span>).<a title="(x$1: Any)Boolean" id="6999">equals</a>(<span title="java.lang.String(&quot;-r&quot;)" class="string">&quot;-r&quot;</span>)) {
        <span class="keyword">try</span> {
          <a href="#24084" title="org.xml.sax.EntityResolver">resolver</a> = <a title="object java.lang.Class" id="1430">Class</a>.<a title="(x$1: java.lang.String)java.lang.Class[_]" id="4095">forName</a>(<a href="../../../Array.scala.html#17823" title="(i: Int)String">args</a>(<span title="Int(1)" class="int">1</span>)).<a title="()?0" id="4109">newInstance</a>().<a title="[T0]T0" id="3636">asInstanceOf</a><span title="org.xml.sax.EntityResolver">[</span><span title="org.xml.sax.EntityResolver">EntityResolver</span>];
          <a href="#24082" title="org.xml.sax.XMLReader">parser</a>.<a title="(x$1: org.xml.sax.EntityResolver)Unit" id="24096">setEntityResolver</a>(<a href="#24084" title="org.xml.sax.EntityResolver">resolver</a>);
        }
        <span class="keyword">catch</span> { 
          <span title="Unit" class="keyword">case</span> <a title="Exception" id="25273">ex</a>:<span title="Exception">Exception</span> =&gt; 
            <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="java.lang.String(&quot;Could not load requested EntityResolver&quot;)" class="string">&quot;Could not load requested EntityResolver&quot;</span>)
            <a href="#24083" title="Boolean">err</a> = <span title="Boolean(true)" class="keyword">true</span>
        }
        <a href="#24085" title="Int">arg</a> = <span title="Int(2)" class="int">2</span>
      }
      <span title="Unit" class="keyword">if</span> (<a href="#24083" title="Boolean">err</a>) <span title="Nothing" class="keyword">return</span>
      
      <span title="Unit" class="keyword">while</span> (<a href="#24085" title="(x$1: Int)Boolean" id="2969">arg</a> &lt; <a href="#24080" title="Array[String]">args</a>.<a href="../../../Array.scala.html#17822" title="=&gt; Int">length</a>) <a href="#25280" title="()Unit">{</a>
        <span class="keyword">try</span> {
          <span class="keyword">val</span> <a title="scala.xml.include.sax.XIncludeFilter" id="25287">includer</a> = <span title="scala.xml.include.sax.XIncludeFilter" class="keyword">new</span> <a href="XIncludeFilter.scala.html#9986" title="scala.xml.include.sax.XIncludeFilter">XIncludeFilter</a>();
          <a href="#25287" title="scala.xml.include.sax.XIncludeFilter">includer</a>.<a title="(x$1: org.xml.sax.XMLReader)Unit" id="25292">setParent</a>(<a href="#24082" title="org.xml.sax.XMLReader">parser</a>)
          <span class="keyword">val</span> <a title="scala.xml.include.sax.XIncluder" id="25288">s</a> = <span title="scala.xml.include.sax.XIncluder" class="keyword">new</span> <a href="XIncluder.scala.html#9980" title="scala.xml.include.sax.XIncluder">XIncluder</a>(<span title="object java.lang.System">System</span>.<a title="java.io.PrintStream" id="24148">out</a>, <span title="java.lang.String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span>)
          <a href="#25287" title="scala.xml.include.sax.XIncludeFilter">includer</a>.<a title="(x$1: org.xml.sax.ContentHandler)Unit" id="25311">setContentHandler</a>(<a href="#25288" title="scala.xml.include.sax.XIncluder">s</a>)
          <span title="Unit" class="keyword">if</span> (<a href="#24084" title="(x$1: AnyRef)Boolean" id="6592">resolver</a> != <span title="Null(null)" class="keyword">null</span>) <a href="#25287" title="scala.xml.include.sax.XIncludeFilter">includer</a>.<a title="(x$1: org.xml.sax.EntityResolver)Unit" id="25305">setEntityResolver</a>(<a href="#24084" title="org.xml.sax.EntityResolver">resolver</a>)
          <span class="keyword">try</span> {
            <a href="#25287" title="scala.xml.include.sax.XIncludeFilter">includer</a>.<a title="(x$1: java.lang.String,x$2: Any)Unit" id="25300">setProperty</a>(
              <span title="java.lang.String(&quot;http://xml.org/sax/properties/lexical-handler&quot;)" class="string">&quot;http://xml.org/sax/properties/lexical-handler&quot;</span>,
              <a href="#25288" title="scala.xml.include.sax.XIncluder">s</a>)
            <a href="#25288" title="scala.xml.include.sax.XIncluder">s</a>.<a href="XIncluder.scala.html#25526" title="(filter: scala.xml.include.sax.XIncludeFilter)Unit">setFilter</a>(<a href="#25287" title="scala.xml.include.sax.XIncludeFilter">includer</a>)
          }
          <span class="keyword">catch</span> { 
            <span title="Unit" class="keyword">case</span> <a title="org.xml.sax.SAXException" id="25549">e</a>:<span title="org.xml.sax.SAXException">SAXException</span> =&gt; // Will not support comments
          }
          <a href="#25287" title="scala.xml.include.sax.XIncludeFilter">includer</a>.<a title="(x$1: java.lang.String)Unit" id="25319">parse</a>(<a href="../../../Array.scala.html#17823" title="(i: Int)String">args</a>(<a href="#24085" title="Int">arg</a>))
        }
        <span class="keyword">catch</span> { 
          <span title="Unit" class="keyword">case</span> <a title="org.xml.sax.SAXParseException" id="25587">e</a>:<a title="org.xml.sax.SAXParseException" id="23993">SAXParseException</a> =&gt;
            <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: Any)Unit">println</span>(<a href="#25587" title="org.xml.sax.SAXParseException">e</a>)
            <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: java.lang.String)Unit">println</span>(<span title="(x$1: Any)java.lang.String" class="string">&quot;Problem in &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#25587" title="org.xml.sax.SAXParseException">e</a>.<a title="()java.lang.String" id="25610">getSystemId</a>() 
                               <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; at line &quot;)" class="string">&quot; at line &quot;</span> + <a href="#25587" title="org.xml.sax.SAXParseException">e</a>.<a title="()Int" id="25611">getLineNumber</a>())
          <span title="Unit" class="keyword">case</span> <a title="Exception" id="25635">e</a>: <span title="Exception">Exception</span> =&gt; // be specific about exceptions????
            <span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: Any)Unit">println</span>(<a href="#25635" title="Exception">e</a>)
            <a href="#25635" title="Exception">e</a>.<a title="()Unit" id="19025">printStackTrace</a>()
        }
        <a href="#24085" title="Int" id="2977">arg</a> += <span title="Int(1)" class="int">1</span>
      }
    }
}

        </pre>
    </body>
</html>