<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/xml/parsing/FactoryAdapter.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: FactoryAdapter.scala 16893 2009-01-13 13:09:22Z cunei $</span>


<span class="keyword">package</span> scala.xml.parsing

<span class="keyword">import</span> java.io.{InputStream, Reader, File, FileDescriptor, FileInputStream}
<span class="keyword">import</span> scala.collection.mutable.{HashMap,Stack}

<span class="keyword">import</span> org.xml.sax.{Attributes, InputSource}

<span class="keyword">import</span> org.xml.sax.SAXException
<span class="keyword">import</span> org.xml.sax.SAXNotRecognizedException
<span class="keyword">import</span> org.xml.sax.SAXNotSupportedException
<span class="keyword">import</span> org.xml.sax.SAXParseException
<span class="keyword">import</span> org.xml.sax.helpers.DefaultHandler

<span class="keyword">import</span> javax.xml.parsers.SAXParserFactory
<span class="keyword">import</span> javax.xml.parsers.ParserConfigurationException
<span class="keyword">import</span> javax.xml.parsers.SAXParser


<span class="comment">/** SAX adapter class, for use with Java SAX parser. Keeps track of 
 *  namespace bindings, without relying on namespace handling of the 
 *  underlying SAX parser.
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class FactoryAdapter extends org.xml.sax.helpers.DefaultHandler with ScalaObject</span><a id="12591">FactoryAdapter</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">org.xml.sax.helpers.DefaultHandler</span><a id="26057">DefaultHandler</a></span>() {
      
  <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><span id="26202"><a id="26201">buffer</a></span></span>      = <span class="typed"><span class="type">()StringBuilder</span><a href="../../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../../StringBuilder.scala.html#1433">StringBuilder</a></span>()
  <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.Stack[scala.xml.MetaData]</span><span id="26204"><a id="26203">attribStack</a></span></span> = <span class="typed"><span class="type">scala.collection.mutable.Stack[scala.xml.MetaData]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.Stack[scala.xml.MetaData]</span><a href="../../collection/mutable/Stack.scala.html#11308">Stack</a></span>[MetaData]
  <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.Stack[scala.xml.Node]</span><span id="26206"><a id="26205">hStack</a></span></span>      = <span class="typed"><span class="type">scala.collection.mutable.Stack[scala.xml.Node]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.Stack[scala.xml.Node]</span><a href="../../collection/mutable/Stack.scala.html#11308">Stack</a></span>[Node]   <span class="comment">// [ element ] contains siblings</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.Stack[String]</span><span id="26208"><a id="26207">tagStack</a></span></span>    = <span class="typed"><span class="type">scala.collection.mutable.Stack[String]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.Stack[String]</span><a href="../../collection/mutable/Stack.scala.html#11308">Stack</a></span>[String]
  <span class="keyword">var</span> <span class="typed"><span class="type">scala.collection.mutable.Stack[scala.xml.NamespaceBinding]</span><span id="26211"><span id="26209"><span id="26210"><a id="66924">scopeStack</a></span></span></span></span>  = <span class="typed"><span class="type">scala.collection.mutable.Stack[scala.xml.NamespaceBinding]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.Stack[scala.xml.NamespaceBinding]</span><a href="../../collection/mutable/Stack.scala.html#11308">Stack</a></span>[NamespaceBinding]

  <span class="keyword">var</span> <span class="typed"><span class="type">String</span><span id="26214"><span id="26212"><span id="26213"><a id="66925">curTag</a></span></span></span></span> : <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="26217"><span id="26215"><span id="26216"><a id="66926">capture</a></span></span></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>

  <span class="comment">// abstract methods</span>

  <span class="comment">/** Tests if an XML element contains text.
   * @return true if element named &lt;code&gt;localName&lt;/code&gt; contains text.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="26218">nodeContainsText</a></span>(<span class="typed"><span class="type">String</span><a id="66928">localName</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> <span class="comment">// abstract</span>
  
  <span class="comment">/** creates an new non-text(tree) node.
   * @param elemName
   * @param attribs
   * @param chIter
   * @return a new XML element.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String,String,scala.xml.MetaData,scala.xml.NamespaceBinding,List[scala.xml.Node])scala.xml.Node</span><a id="26219">createNode</a></span>(<span class="typed"><span class="type">String</span><a id="66929">pre</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>, <span class="typed"><span class="type">String</span><a id="66930">elemName</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>, <span class="typed"><span class="type">scala.xml.MetaData</span><a id="66931">attribs</a></span>: <span class="typed"><span class="type">scala.xml.MetaData</span><a href="../MetaData.scala.html#7378">MetaData</a></span>,
                 <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="66932">scope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>, <span class="typed"><span class="type">List[scala.xml.Node]</span><a id="66933">chIter</a></span>: <span class="typed"><span class="type">List[scala.xml.Node]</span><a href="../../List.scala.html#524">List</a></span>[Node]): <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> <span class="comment">//abstract </span>
  
  <span class="comment">/** creates a Text node.
   * @param text
   * @return a new Text node.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)scala.xml.Text</span><a id="26220">createText</a></span>(<span class="typed"><span class="type">String</span><a id="42719">text</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">scala.xml.Text</span><a href="../Text.scala.html#7159">Text</a></span> <span class="comment">// abstract</span>

  <span class="comment">/** creates a new processing instruction node.
  */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String,String)Seq[scala.xml.ProcInstr]</span><a id="26221">createProcInstr</a></span>(<span class="typed"><span class="type">String</span><a id="42724">target</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>, <span class="typed"><span class="type">String</span><a id="42725">data</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">Seq[scala.xml.ProcInstr]</span><a href="../../Seq.scala.html#761">Seq</a></span>[ProcInstr] 
    
  <span class="comment">//</span>
  <span class="comment">// ContentHandler methods</span>
  <span class="comment">//</span>
  
  <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><span id="26223"><a id="26222">normalizeWhitespace</a></span></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>

  <span class="comment">/** Characters.
  * @param ch
  * @param offset
  * @param length
  */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Array[Char],Int,Int)Unit</span><a id="26224">characters</a></span>(<span class="typed"><span class="type">Array[Char]</span><a id="66934">ch</a></span>: <span class="typed"><span class="type">Array[Char]</span><a href="../../Array.scala.html#1070">Array</a></span>[Char], <span class="typed"><span class="type">Int</span><a id="66935">offset</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">Int</span><a id="66936">length</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = {
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#26215">capture</a></span>) {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#26222">normalizeWhitespace</a></span>) {
        <span class="comment">// normalizing whitespace is not compliant, but useful */</span>
	<span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="66937">i</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">Int</span><a href="#66935">offset</a></span>
        <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><a id="66938">ws</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
        <span class="typed"><span class="type">Unit</span><a href="#66939" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#66937">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#66935">offset</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int</span><a href="#66936">length</a></span>) {
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">implicit scala.Predef.charWrapper : (Char)scala.runtime.RichChar</span><a href="../../Predef.scala.html#13512">ch</a></span>(<span class="typed"><span class="type">Int</span><a href="#66937">i</a></span>).<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../runtime/RichChar.scala.html#19389">isWhitespace</a></span>) {
            <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Boolean</span><a href="#66938">ws</a></span>) {
              <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#26201">buffer</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char(' ')</span><span class="char">' '</span></span>)
              <span class="typed"><span class="type">Boolean</span><a href="#66938">ws</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
            }
          } <span class="keyword">else</span> {
            <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#26201">buffer</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">(Int)Char</span><a href="../../Array.scala.html#17253">ch</a></span>(<span class="typed"><span class="type">Int</span><a href="#66937">i</a></span>))
            <span class="typed"><span class="type">Boolean</span><a href="#66938">ws</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
          }
	  <span class="typed"><span class="type">Int</span><a href="#66937">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        }
      } <span class="keyword">else</span> { <span class="comment">// compliant:report every character</span>
        <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#26201">buffer</a></span>.<span class="typed"><span class="type">(Array[Char],Int,Int)StringBuilder</span><a href="../../StringBuilder.scala.html#19643">append</a></span>(<span class="typed"><span class="type">Array[Char]</span><a href="#66934">ch</a></span>, <span class="typed"><span class="type">Int</span><a href="#66935">offset</a></span>, <span class="typed"><span class="type">Int</span><a href="#66936">length</a></span>)
      }
    }          
  }

  <span class="comment">//var elemCount = 0; //STATISTICS</span>

  <span class="comment">/* ContentHandler methods */</span>

  <span class="comment">/* Start prefix mapping - use default impl. 
   def startPrefixMapping( prefix:String , uri:String ):Unit = {} 
   */</span>

  <span class="comment">/* Start element. */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String,String,String,org.xml.sax.Attributes)Unit</span><a id="26225">startElement</a></span>(<span class="typed"><span class="type">String</span><a id="67064">uri</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>, <span class="typed"><span class="type">String</span><a id="67065">_localName</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>,
                            <span class="typed"><span class="type">String</span><a id="67066">qname</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>, <span class="typed"><span class="type">org.xml.sax.Attributes</span><a id="67067">attributes</a></span>: <span class="typed"><span class="type">org.xml.sax.Attributes</span><a id="25922">Attributes</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = {
    <span class="comment">/*elemCount = elemCount + 1; STATISTICS */</span>
    <span class="typed"><span class="type">()Unit</span><a href="#26226">captureText</a></span>()
    <span class="comment">//Console.println(&quot;FactoryAdapter::startElement(&quot;+uri+&quot;,&quot;+_localName+&quot;,&quot;+qname+&quot;,&quot;+attributes+&quot;)&quot;);</span>
    <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[String]</span><a href="#26207">tagStack</a></span>.<span class="typed"><span class="type">(String*)Unit</span><a href="../../collection/mutable/Stack.scala.html#51041">push</a></span>(<span class="typed"><span class="type">=&gt; String</span><a href="#26212">curTag</a></span>)
    <span class="typed"><span class="type">(String)Unit</span><a href="#26213">curTag</a></span> = <span class="typed"><span class="type">String</span><a href="#67066">qname</a></span>; <span class="comment">//localName ;</span>

    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="67080">colon</a></span> = <span class="typed"><span class="type">String</span><a href="#67066">qname</a></span>.<span class="typed"><span class="type">(Int)Int</span><a id="5842">indexOf</a></span>(<span class="typed"><span class="type">Char(':')</span><span class="char">':'</span></span>.<span class="typed"><span class="type">Int</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>])
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="67081">localName</a></span> = <span class="typed"><span class="type">String</span><span class="keyword">if</span></span>(-<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">Int</span><a href="#67080">colon</a></span>) <span class="typed"><span class="type">String</span><a href="#67066">qname</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">String</span><a href="#67066">qname</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">Int</span><a href="#67080">colon</a></span><span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span><span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>,<span class="typed"><span class="type">String</span><a href="#67066">qname</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>())

    <span class="comment">//Console.println(&quot;FactoryAdapter::startElement - localName =&quot;+localName);</span>

    <span class="typed"><span class="type">(Boolean)Unit</span><a href="#26216">capture</a></span> = <span class="typed"><span class="type">(String)Boolean</span><a href="#26218">nodeContainsText</a></span>(<span class="typed"><span class="type">String</span><a href="#67081">localName</a></span>)

    <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.Node]</span><a href="#26205">hStack</a></span>.<span class="typed"><span class="type">(scala.xml.Node*)Unit</span><a href="../../collection/mutable/Stack.scala.html#51041">push</a></span>(<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.MetaData</span><a id="67082">m</a></span>: <span class="typed"><span class="type">scala.xml.MetaData</span><a href="../MetaData.scala.html#7378">MetaData</a></span> = <span class="typed"><span class="type">object scala.xml.Null</span><a href="../Null.scala.html#7298">Null</a></span>

    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="67083">scpe</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.NamespaceBinding]</span><a href="#26209">scopeStack</a></span>.<span class="typed"><span class="type">=&gt; scala.xml.NamespaceBinding</span><a href="../../collection/mutable/Stack.scala.html#51042">top</a></span>
    <span class="keyword">for</span> (<span class="typed"><span class="type">((Int) =&gt; Unit)Unit</span><a href="../../List.scala.html#20910" id="67124">i</a></span> &lt;- <span class="typed"><span class="type">object List</span><a href="../../List.scala.html#525">List</a></span>.<span class="typed"><span class="type">(Int,Int)List[Int]</span><a href="../../List.scala.html#16983">range</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="typed"><span class="type">org.xml.sax.Attributes</span><a href="#67067">attributes</a></span>.<span class="typed"><span class="type">()Int</span><a id="67068">getLength</a></span>())) {
      <span class="comment">//val attrType = attributes.getType(i); // unused for now</span>
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="67125">qname</a></span> = <span class="typed"><span class="type">org.xml.sax.Attributes</span><a href="#67067">attributes</a></span>.<span class="typed"><span class="type">(Int)java.lang.String</span><a id="67071">getQName</a></span>(<span class="typed"><span class="type">Int</span><a href="#67124">i</a></span>)
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="67126">value</a></span> = <span class="typed"><span class="type">org.xml.sax.Attributes</span><a href="#67067">attributes</a></span>.<span class="typed"><span class="type">(Int)java.lang.String</span><a id="67073">getValue</a></span>(<span class="typed"><span class="type">Int</span><a href="#67124">i</a></span>)
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="67127">colon</a></span> = <span class="typed"><span class="type">java.lang.String</span><a href="#67125">qname</a></span>.<span class="typed"><span class="type">(Int)Int</span><a id="5842">indexOf</a></span>(<span class="typed"><span class="type">Char(':')</span><span class="char">':'</span></span>.<span class="typed"><span class="type">Int</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>])
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (-<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3140">!=</a></span> <span class="typed"><span class="type">Int</span><a href="#67127">colon</a></span>) {                     <span class="comment">// prefixed attribute</span>
        <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="67134">pre</a></span> = <span class="typed"><span class="type">java.lang.String</span><a href="#67125">qname</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="typed"><span class="type">Int</span><a href="#67127">colon</a></span>)
        <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="67135">key</a></span> = <span class="typed"><span class="type">java.lang.String</span><a href="#67125">qname</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">Int</span><a href="#67127">colon</a></span><span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span><span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#67125">qname</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>())
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">java.lang.String(&quot;xmlns&quot;)</span><span class="string">&quot;xmlns&quot;</span></span> <span class="comment">/*XML.xmlns*/</span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#67134">pre</a></span>)
          <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#67083">scpe</a></span> = <span class="typed"><span class="type">java.lang.String</span><a href="#67126">value</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>() <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span> =&gt; <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#67135">key</a></span>, <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>,  <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#67083">scpe</a></span>)
            <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#67135">key</a></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#67126">value</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#67083">scpe</a></span>)
          }
        <span class="keyword">else</span>
          <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#67082">m</a></span> = <span class="typed"><span class="type">scala.xml.PrefixedAttribute</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.PrefixedAttribute</span><a href="../PrefixedAttribute.scala.html#7243">PrefixedAttribute</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#67134">pre</a></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#67135">key</a></span>, <span class="typed"><span class="type">(String)scala.xml.Text</span><a href="../Text.scala.html#22618">Text</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#67126">value</a></span>), <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#67082">m</a></span>)
      } <span class="keyword">else</span> <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">java.lang.String(&quot;xmlns&quot;)</span><span class="string">&quot;xmlns&quot;</span></span> <span class="comment">/*XML.xmlns*/</span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">java.lang.String</span><a href="#67125">qname</a></span>)
        <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#67083">scpe</a></span> = <span class="typed"><span class="type">java.lang.String</span><a href="#67126">value</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>() <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span> =&gt; <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>(<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>,  <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#67083">scpe</a></span>)
          <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>(<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#67126">value</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#67083">scpe</a></span>)
        }
      <span class="keyword">else</span>
        <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#67082">m</a></span> = <span class="typed"><span class="type">scala.xml.UnprefixedAttribute</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.UnprefixedAttribute</span><a href="../UnprefixedAttribute.scala.html#7216">UnprefixedAttribute</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#67125">qname</a></span>, <span class="typed"><span class="type">(String)scala.xml.Text</span><a href="../Text.scala.html#22618">Text</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#67126">value</a></span>), <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#67082">m</a></span>)
    }
    <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.NamespaceBinding]</span><a href="#26209">scopeStack</a></span>.<span class="typed"><span class="type">(scala.xml.NamespaceBinding*)Unit</span><a href="../../collection/mutable/Stack.scala.html#51041">push</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#67083">scpe</a></span>)
    <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.MetaData]</span><a href="#26203">attribStack</a></span>.<span class="typed"><span class="type">(scala.xml.MetaData*)Unit</span><a href="../../collection/mutable/Stack.scala.html#51041">push</a></span>(<span class="typed"><span class="type">scala.xml.MetaData</span><a href="#67082">m</a></span>)
    <span class="typed"><span class="type">Unit</span><span >(</span></span>)
  } <span class="comment">// startElement(String,String,String,Attributes)</span>
  

  <span class="comment">/** captures text, possibly normalizing whitespace
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="26226">captureText</a></span>(): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = {
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#26215">capture</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="67210">text</a></span> = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#26201">buffer</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>()
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#67210">text</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>() <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">String</span><a href="#67210">text</a></span>.<span class="typed"><span class="type">(Any)Boolean</span><a id="5830">equals</a></span>(<span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span>)) {
        <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.Node]</span><a href="#26205">hStack</a></span>.<span class="typed"><span class="type">(scala.xml.Node*)Unit</span><a href="../../collection/mutable/Stack.scala.html#51041">push</a></span>(<span class="typed"><span class="type">(String)scala.xml.Text</span><a href="#26220">createText</a></span>(<span class="typed"><span class="type">String</span><a href="#67210">text</a></span>))
      }
    }
    <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#26201">buffer</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19626">setLength</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
  }

  <span class="comment">/** End element.
   * @param uri
   * @param localName
   * @param qname
   * @throws org.xml.sax.SAXException if ..
   */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String,String,String)Unit</span><a id="26227">endElement</a></span>(<span class="typed"><span class="type">String</span><a id="67212">uri</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span> , <span class="typed"><span class="type">String</span><a id="67213">_localName</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span> , <span class="typed"><span class="type">String</span><a id="67214">qname</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = {
    <span class="typed"><span class="type">()Unit</span><a href="#26226">captureText</a></span>()

    <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.MetaData</span><a id="67215">metaData</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.MetaData]</span><a href="#26203">attribStack</a></span>.<span class="typed"><span class="type">()scala.xml.MetaData</span><a href="../../collection/mutable/Stack.scala.html#51043">pop</a></span>

    <span class="comment">// reverse order to get it right</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">List[scala.xml.Node]</span><a id="67216">v</a></span>: <span class="typed"><span class="type">List[scala.xml.Node]</span><a href="../../List.scala.html#524">List</a></span>[Node] = <span class="typed"><span class="type">object Nil</span><a href="../../List.scala.html#333">Nil</a></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.Node</span><a id="67217">child</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.Node]</span><a href="#26205">hStack</a></span>.<span class="typed"><span class="type">()scala.xml.Node</span><a href="../../collection/mutable/Stack.scala.html#51043">pop</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#67222" class="keyword">while</a></span> (<span class="typed"><span class="type">scala.xml.Node</span><a href="#67217">child</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) {
      <span class="typed"><span class="type">List[scala.xml.Node]</span><a href="#67216">v</a></span> = <span class="typed"><span class="type">scala.xml.Node</span><a href="#67217">child</a></span><span class="typed"><span class="type">(scala.xml.Node)List[scala.xml.Node]</span><a href="../../List.scala.html#20872">::</a></span><span class="typed"><span class="type">List[scala.xml.Node]</span><a href="#67216">v</a></span>
      <span class="typed"><span class="type">scala.xml.Node</span><a href="#67217">child</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.Node]</span><a href="#26205">hStack</a></span>.<span class="typed"><span class="type">()scala.xml.Node</span><a href="../../collection/mutable/Stack.scala.html#51043">pop</a></span>
    }

    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="67218">colon</a></span> = <span class="typed"><span class="type">String</span><a href="#67214">qname</a></span>.<span class="typed"><span class="type">(Int)Int</span><a id="5842">indexOf</a></span>(<span class="typed"><span class="type">Char(':')</span><span class="char">':'</span></span>.<span class="typed"><span class="type">Int</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>])
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="67219">localName</a></span> =
      <span class="typed"><span class="type">String</span><span class="keyword">if</span></span> (-<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">Int</span><a href="#67218">colon</a></span>) <span class="typed"><span class="type">String</span><a href="#67214">qname</a></span>
      <span class="keyword">else</span> <span class="typed"><span class="type">String</span><a href="#67214">qname</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">Int</span><a href="#67218">colon</a></span><span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span><span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>, <span class="typed"><span class="type">String</span><a href="#67214">qname</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>())  

    <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="67220">scp</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.NamespaceBinding]</span><a href="#26209">scopeStack</a></span>.<span class="typed"><span class="type">()scala.xml.NamespaceBinding</span><a href="../../collection/mutable/Stack.scala.html#51043">pop</a></span>
    <span class="comment">// create element</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="67221">pre</a></span> = <span class="typed"><span class="type">java.lang.String</span><span class="keyword">if</span></span> (-<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">Int</span><a href="#67218">colon</a></span>) <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="keyword">else</span> <span class="typed"><span class="type">String</span><a href="#67214">qname</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="typed"><span class="type">Int</span><a href="#67218">colon</a></span>)
    <span class="typed"><span class="type">(scala.xml.Node)Unit</span><a href="#26234">rootElem</a></span> = <span class="typed"><span class="type">(String,String,scala.xml.MetaData,scala.xml.NamespaceBinding,List[scala.xml.Node])scala.xml.Node</span><a href="#26219">createNode</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#67221">pre</a></span>, <span class="typed"><span class="type">String</span><a href="#67219">localName</a></span>, <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#67215">metaData</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#67220">scp</a></span>, <span class="typed"><span class="type">List[scala.xml.Node]</span><a href="#67216">v</a></span>)

    <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.Node]</span><a href="#26205">hStack</a></span>.<span class="typed"><span class="type">(scala.xml.Node*)Unit</span><a href="../../collection/mutable/Stack.scala.html#51041">push</a></span>(<span class="typed"><span class="type">=&gt; scala.xml.Node</span><a href="#26233">rootElem</a></span>)

    <span class="comment">// set</span>
    <span class="typed"><span class="type">(String)Unit</span><a href="#26213">curTag</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[String]</span><a href="#26207">tagStack</a></span>.<span class="typed"><span class="type">()String</span><a href="../../collection/mutable/Stack.scala.html#51043">pop</a></span>

    <span class="typed"><span class="type">(Boolean)Unit</span><a href="#26216">capture</a></span> =
      <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; String</span><a href="#26212">curTag</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) <span class="typed"><span class="type">(String)Boolean</span><a href="#26218">nodeContainsText</a></span>(<span class="typed"><span class="type">=&gt; String</span><a href="#26212">curTag</a></span>) <span class="comment">// root level</span>
      <span class="keyword">else</span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
  } <span class="comment">// endElement(String,String,String)</span>
  
  <span class="comment">/** Processing instruction.
  */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String,String)Unit</span><a id="26228">processingInstruction</a></span>(<span class="typed"><span class="type">String</span><a id="67264">target</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>, <span class="typed"><span class="type">String</span><a id="67265">data</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) {
    <span class="keyword">for</span> (<span class="typed"><span class="type">((scala.xml.ProcInstr) =&gt; Unit)Unit</span><a href="../../Iterable.scala.html#17328" id="67267">pi</a></span> &lt;- <span class="typed"><span class="type">(String,String)Seq[scala.xml.ProcInstr]</span><a href="#26221">createProcInstr</a></span>(<span class="typed"><span class="type">String</span><a href="#67264">target</a></span>, <span class="typed"><span class="type">String</span><a href="#67265">data</a></span>))
      <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.Node]</span><a href="#26205">hStack</a></span>.<span class="typed"><span class="type">(scala.xml.Node*)Unit</span><a href="../../collection/mutable/Stack.scala.html#51041">push</a></span>(<span class="typed"><span class="type">scala.xml.ProcInstr</span><a href="#67267">pi</a></span>)
  }
  
  <span class="comment">//</span>
  <span class="comment">// ErrorHandler methods</span>
  <span class="comment">//</span>

  <span class="comment">/** Warning.*/</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(org.xml.sax.SAXParseException)Unit</span><a id="26229">warning</a></span>(<span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a id="67268">ex</a></span>: <span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a id="25910">SAXParseException</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = <span class="typed"><span class="type">Unit</span><span >{</span></span>
    <span class="comment">// ignore warning, crimson warns even for entity resolution!</span>
    <span class="comment">//printError(&quot;Warning&quot;, ex);</span>
  }

  <span class="comment">/** Error.     */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(org.xml.sax.SAXParseException)Unit</span><a id="26230">error</a></span>(<span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a id="67278">ex</a></span>: <span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a id="25910">SAXParseException</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> =
    <span class="typed"><span class="type">(String,org.xml.sax.SAXParseException)Unit</span><a href="#26232">printError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Error&quot;)</span><span class="string">&quot;Error&quot;</span></span>, <span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a href="#67278">ex</a></span>) 

  <span class="comment">/** Fatal error.*/</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(org.xml.sax.SAXParseException)Unit</span><a id="26231">fatalError</a></span>(<span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a id="67281">ex</a></span>: <span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a id="25910">SAXParseException</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> =
    <span class="typed"><span class="type">(String,org.xml.sax.SAXParseException)Unit</span><a href="#26232">printError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Fatal Error&quot;)</span><span class="string">&quot;Fatal Error&quot;</span></span>, <span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a href="#67281">ex</a></span>)

  <span class="comment">//</span>
  <span class="comment">// Protected methods</span>
  <span class="comment">//</span>

  <span class="comment">/** Prints the error message */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String,org.xml.sax.SAXParseException)Unit</span><a id="26232">printError</a></span>(<span class="typed"><span class="type">String</span><a id="67279">errtype</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>, <span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a id="67280">ex</a></span>: <span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a id="25910">SAXParseException</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> =
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(java.io.PrintStream)(=&gt; Unit)Unit</span><a href="../../Console.scala.html#31282">withOut</a></span>(<span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">=&gt; java.io.PrintStream</span><a href="../../Console.scala.html#31279">err</a></span>) {
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../../Console.scala.html#31297">print</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;[&quot;)</span><span class="string">&quot;[&quot;</span></span>)
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../../Console.scala.html#31297">print</a></span>(<span class="typed"><span class="type">String</span><a href="#67279">errtype</a></span>)
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../../Console.scala.html#31297">print</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;] &quot;)</span><span class="string">&quot;] &quot;</span></span>)

    <span class="keyword">var</span> <span class="typed"><span class="type">java.lang.String</span><a id="67296">systemId</a></span> = <span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a href="#67280">ex</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="67275">getSystemId</a></span>()
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">java.lang.String</span><a href="#67296">systemId</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="67305">index</a></span> = <span class="typed"><span class="type">java.lang.String</span><a href="#67296">systemId</a></span>.<span class="typed"><span class="type">(Int)Int</span><a id="5844">lastIndexOf</a></span>(<span class="typed"><span class="type">Char('/')</span><span class="char">'/'</span></span>.<span class="typed"><span class="type">Int</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>])
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#67305">index</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3140">!=</a></span> -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>)
        <span class="typed"><span class="type">java.lang.String</span><a href="#67296">systemId</a></span> = <span class="typed"><span class="type">java.lang.String</span><a href="#67296">systemId</a></span>.<span class="typed"><span class="type">(Int)java.lang.String</span><a id="5852">substring</a></span>(<span class="typed"><span class="type">Int</span><a href="#67305">index</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
      <span class="comment">//Console.print(systemId)</span>
    }

    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../../Console.scala.html#31297">print</a></span>(<span class="typed"><span class="type">Char(':')</span><span class="char">':'</span></span>)
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../../Console.scala.html#31297">print</a></span>(<span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a href="#67280">ex</a></span>.<span class="typed"><span class="type">()Int</span><a id="67276">getLineNumber</a></span>())
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../../Console.scala.html#31297">print</a></span>(<span class="typed"><span class="type">Char(':')</span><span class="char">':'</span></span>)
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../../Console.scala.html#31297">print</a></span>(<span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a href="#67280">ex</a></span>.<span class="typed"><span class="type">()Int</span><a id="67277">getColumnNumber</a></span>())
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../../Console.scala.html#31297">print</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;: &quot;)</span><span class="string">&quot;: &quot;</span></span>)
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../../Console.scala.html#31297">print</a></span>(<span class="typed"><span class="type">org.xml.sax.SAXParseException</span><a href="#67280">ex</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="67302">getMessage</a></span>())
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">()Unit</span><a href="../../Console.scala.html#31299">println</a></span>
    <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">()Unit</span><a href="../../Console.scala.html#31298">flush</a></span>
  }

  <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.Node</span><span id="26235"><span id="26233"><span id="26234"><a id="66927">rootElem</a></span></span></span></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>:<span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span>

  <span class="comment">//FactoryAdapter</span>
  <span class="comment">// MAIN</span>
  <span class="comment">//</span>

  <span class="comment">/** load XML document
   * @param source
   * @return a new XML document object
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(org.xml.sax.InputSource)scala.xml.Node</span><a id="26236">loadXML</a></span>(<span class="typed"><span class="type">org.xml.sax.InputSource</span><a id="26298">source</a></span>: <span class="typed"><span class="type">org.xml.sax.InputSource</span><a id="25925">InputSource</a></span>): <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> = {
    <span class="comment">// create parser</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">javax.xml.parsers.SAXParser</span><a id="67329">parser</a></span>: <span class="typed"><span class="type">javax.xml.parsers.SAXParser</span><a id="26143">SAXParser</a></span> = <span class="keyword">try</span> {
      <span class="keyword">val</span> <span class="typed"><span class="type">javax.xml.parsers.SAXParserFactory</span><a id="67407">f</a></span> = <span class="typed"><span class="type">object javax.xml.parsers.SAXParserFactory</span><a id="26180">SAXParserFactory</a></span>.<span class="typed"><span class="type">()javax.xml.parsers.SAXParserFactory</span><a id="67409">newInstance</a></span>()
      <span class="typed"><span class="type">javax.xml.parsers.SAXParserFactory</span><a href="#67407">f</a></span>.<span class="typed"><span class="type">(Boolean)Unit</span><a id="67411">setNamespaceAware</a></span>(<span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
      <span class="typed"><span class="type">javax.xml.parsers.SAXParserFactory</span><a href="#67407">f</a></span>.<span class="typed"><span class="type">()javax.xml.parsers.SAXParser</span><a id="67410">newSAXParser</a></span>()
    } <span class="keyword">catch</span> {
      <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Exception</span><a id="67421">e</a></span>: <span class="typed"><span class="type">Exception</span><a id="2129">Exception</a></span> =&gt;
        <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">=&gt; java.io.PrintStream</span><a href="../../Console.scala.html#31279">err</a></span>.<span class="typed"><span class="type">(java.lang.String)Unit</span><a id="31216">println</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;error: Unable to instantiate parser&quot;)</span><span class="string">&quot;error: Unable to instantiate parser&quot;</span></span>)
        <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">Exception</span><a href="#67421">e</a></span>
    }
      
    <span class="comment">// parse file</span>
    <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.NamespaceBinding]</span><a href="#26209">scopeStack</a></span>.<span class="typed"><span class="type">(scala.xml.NamespaceBinding*)Unit</span><a href="../../collection/mutable/Stack.scala.html#51041">push</a></span>(<span class="typed"><span class="type">object scala.xml.TopScope</span><a href="../TopScope.scala.html#7361">TopScope</a></span>)
    <span class="typed"><span class="type">javax.xml.parsers.SAXParser</span><a href="#67329">parser</a></span>.<span class="typed"><span class="type">(org.xml.sax.InputSource,org.xml.sax.helpers.DefaultHandler)Unit</span><a id="67341">parse</a></span>(<span class="typed"><span class="type">org.xml.sax.InputSource</span><a href="#26298">source</a></span>, <span class="typed"><span class="type">scala.xml.parsing.FactoryAdapter</span><a href="#12591" class="keyword">this</a></span>)
    <span class="typed"><span class="type">=&gt; scala.collection.mutable.Stack[scala.xml.NamespaceBinding]</span><a href="#26209">scopeStack</a></span>.<span class="typed"><span class="type">()scala.xml.NamespaceBinding</span><a href="../../collection/mutable/Stack.scala.html#51043">pop</a></span>
    <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">=&gt; scala.xml.Node</span><a href="#26233">rootElem</a></span>
  } <span class="comment">// loadXML</span>

  <span class="comment">/** loads XML from given file */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(java.io.File)scala.xml.Node</span><a id="26237">loadFile</a></span>(<span class="typed"><span class="type">java.io.File</span><a id="67449">file</a></span>: <span class="typed"><span class="type">java.io.File</span><a id="3667">File</a></span>): <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> =
    <span class="typed"><span class="type">(org.xml.sax.InputSource)scala.xml.Node</span><a href="#26236">loadXML</a></span>(<span class="typed"><span class="type">(java.io.InputStream)org.xml.sax.InputSource</span><a id="26286" class="keyword">new</a></span> <span class="typed"><span class="type">org.xml.sax.InputSource</span><a id="25925">InputSource</a></span>(<span class="typed"><span class="type">(java.io.File)java.io.FileInputStream</span><a id="26315" class="keyword">new</a></span> <span class="typed"><span class="type">java.io.FileInputStream</span><a id="3808">FileInputStream</a></span>(<span class="typed"><span class="type">java.io.File</span><a href="#67449">file</a></span>)))
  
  <span class="comment">/** loads XML from given file descriptor */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(java.io.FileDescriptor)scala.xml.Node</span><a id="26238">loadFile</a></span>(<span class="typed"><span class="type">java.io.FileDescriptor</span><a id="67453">fileDesc</a></span>: <span class="typed"><span class="type">java.io.FileDescriptor</span><a id="3748">FileDescriptor</a></span>): <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> =
    <span class="typed"><span class="type">(org.xml.sax.InputSource)scala.xml.Node</span><a href="#26236">loadXML</a></span>(<span class="typed"><span class="type">(java.io.InputStream)org.xml.sax.InputSource</span><a id="26286" class="keyword">new</a></span> <span class="typed"><span class="type">org.xml.sax.InputSource</span><a id="25925">InputSource</a></span>(<span class="typed"><span class="type">(java.io.FileDescriptor)java.io.FileInputStream</span><a id="26316" class="keyword">new</a></span> <span class="typed"><span class="type">java.io.FileInputStream</span><a id="3808">FileInputStream</a></span>(<span class="typed"><span class="type">java.io.FileDescriptor</span><a href="#67453">fileDesc</a></span>)))
  
  <span class="comment">/** loads XML from given file */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)scala.xml.Node</span><a id="26239">loadFile</a></span>(<span class="typed"><span class="type">String</span><a id="67457">fileName</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> =
    <span class="typed"><span class="type">(org.xml.sax.InputSource)scala.xml.Node</span><a href="#26236">loadXML</a></span>(<span class="typed"><span class="type">(java.io.InputStream)org.xml.sax.InputSource</span><a id="26286" class="keyword">new</a></span> <span class="typed"><span class="type">org.xml.sax.InputSource</span><a id="25925">InputSource</a></span>(<span class="typed"><span class="type">java.io.FileInputStream</span><span class="keyword">new</span></span> <span class="typed"><span class="type">java.io.FileInputStream</span><a id="3808">FileInputStream</a></span>(<span class="typed"><span class="type">String</span><a href="#67457">fileName</a></span>)))
  
  <span class="comment">/** loads XML from given InputStream */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(java.io.InputStream)scala.xml.Node</span><a id="26240">load</a></span>(<span class="typed"><span class="type">java.io.InputStream</span><a id="67461">is</a></span>: <span class="typed"><span class="type">java.io.InputStream</span><a id="3742">InputStream</a></span>): <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> =
    <span class="typed"><span class="type">(org.xml.sax.InputSource)scala.xml.Node</span><a href="#26236">loadXML</a></span>(<span class="typed"><span class="type">(java.io.InputStream)org.xml.sax.InputSource</span><a id="26286" class="keyword">new</a></span> <span class="typed"><span class="type">org.xml.sax.InputSource</span><a id="25925">InputSource</a></span>(<span class="typed"><span class="type">java.io.InputStream</span><a href="#67461">is</a></span>))

  <span class="comment">/** loads XML from given Reader */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(java.io.Reader)scala.xml.Node</span><a id="26241">load</a></span>(<span class="typed"><span class="type">java.io.Reader</span><a id="67464">reader</a></span>: <span class="typed"><span class="type">java.io.Reader</span><a id="3553">Reader</a></span>): <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> =
    <span class="typed"><span class="type">(org.xml.sax.InputSource)scala.xml.Node</span><a href="#26236">loadXML</a></span>(<span class="typed"><span class="type">(java.io.Reader)org.xml.sax.InputSource</span><a id="26287" class="keyword">new</a></span> <span class="typed"><span class="type">org.xml.sax.InputSource</span><a id="25925">InputSource</a></span>(<span class="typed"><span class="type">java.io.Reader</span><a href="#67464">reader</a></span>))

  <span class="comment">/** loads XML from given sysID */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)scala.xml.Node</span><a id="26242">load</a></span>(<span class="typed"><span class="type">String</span><a id="67467">sysID</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> =
    <span class="typed"><span class="type">(org.xml.sax.InputSource)scala.xml.Node</span><a href="#26236">loadXML</a></span>(<span class="typed"><span class="type">(java.lang.String)org.xml.sax.InputSource</span><a id="26285" class="keyword">new</a></span> <span class="typed"><span class="type">org.xml.sax.InputSource</span><a id="25925">InputSource</a></span>(<span class="typed"><span class="type">String</span><a href="#67467">sysID</a></span>))

}

        </pre>
    </body>
</html>