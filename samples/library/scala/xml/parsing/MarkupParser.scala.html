<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/xml/parsing/MarkupParser.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: MarkupParser.scala 16893 2009-01-13 13:09:22Z cunei $</span>


<span class="keyword">package</span> scala.xml.parsing

<span class="keyword">import</span> scala.io.Source
<span class="keyword">import</span> scala.xml.dtd._

<span class="comment">/**
 * An XML parser.
 *
 * Parses XML 1.0, invokes callback methods of a MarkupHandler
 * and returns whatever the markup handler returns. Use
 * &lt;code&gt;ConstructingParser&lt;/code&gt; if you just want to parse XML to
 * construct instances of &lt;code&gt;scala.xml.Node&lt;/code&gt;.
 *
 * While XML elements are returned, DTD declarations - if handled - are 
 * collected using side-effects.
 *
 * @author  Burak Emir
 * @version 1.0
 */</span>
<span class="keyword">trait</span> <span class="typed"><span class="type">trait MarkupParser extends java.lang.Object with scala.xml.parsing.TokenTests with ScalaObject</span><a id="12525">MarkupParser</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">java.lang.Object</span><a id="2163">AnyRef</a></span> <span class="keyword">with</span> <span class="typed"><span class="type">scala.xml.parsing.TokenTests</span><a href="TokenTests.scala.html#12609">TokenTests</a></span> { self:  MarkupParser <span class="keyword">with</span> MarkupHandler =&gt;

  <span class="keyword">val</span> <span class="typed"><span class="type">=&gt; scala.io.Source</span><a id="44299">input</a></span>: <span class="typed"><span class="type">scala.io.Source</span><a href="../../io/Source.scala.html#9107">Source</a></span>

  <span class="comment">/** if true, does not remove surplus whitespace */</span>
  <span class="keyword">val</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="44300">preserveWS</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span>

  <span class="keyword">def</span> <span class="typed"><span class="type">(String)scala.io.Source</span><a id="44301">externalSource</a></span>(<span class="typed"><span class="type">String</span><a id="106143">systemLiteral</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">scala.io.Source</span><a href="../../io/Source.scala.html#9107">Source</a></span>

  <span class="comment">//</span>
  <span class="comment">// variables, values</span>
  <span class="comment">//</span>

  <span class="keyword">var</span> <span class="typed"><span class="type">scala.io.Source</span><span id="44304"><span id="44302"><span id="44303"><a id="106130">curInput</a></span></span></span></span>: <span class="typed"><span class="type">scala.io.Source</span><a href="../../io/Source.scala.html#9107">Source</a></span> = <span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44299">input</a></span>

  <span class="comment">/** the handler of the markup, returns this */</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.parsing.MarkupHandler</span><span id="44306"><a id="44305">handle</a></span></span>: <span class="typed"><span class="type">scala.xml.parsing.MarkupHandler</span><a href="MarkupHandler.scala.html#12582">MarkupHandler</a></span> = <span class="typed"><span class="type">&lt;refinement&gt; extends scala.xml.parsing.MarkupParser with scala.xml.parsing.MarkupHandler</span><a href="#12525" class="keyword">this</a></span>

  <span class="comment">/** stack of inputs */</span>
  <span class="keyword">var</span> <span class="typed"><span class="type">List[scala.io.Source]</span><span id="44309"><span id="44307"><span id="44308"><a id="106131">inpStack</a></span></span></span></span>: <span class="typed"><span class="type">List[scala.io.Source]</span><a href="../../List.scala.html#524">List</a></span>[Source] = <span class="typed"><span class="type">object Nil</span><a href="../../List.scala.html#333">Nil</a></span>

  <span class="comment">/** holds the position in the source file */</span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="44312"><span id="44310"><span id="44311"><a id="106132">pos</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = _


  <span class="comment">/* used when reading external subset */</span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="44315"><span id="44313"><span id="44314"><a id="106133">extIndex</a></span></span></span></span> = -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>

  <span class="comment">/** holds temporary values of pos */</span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="44318"><span id="44316"><span id="44317"><a id="106134">tmppos</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = _

  <span class="comment">/** holds the next character */</span>
  <span class="keyword">var</span> <span class="typed"><span class="type">Char</span><span id="44321"><span id="44319"><span id="44320"><a id="106135">ch</a></span></span></span></span>: <span class="typed"><span class="type">Char</span><a id="2387">Char</a></span> = _

  <span class="comment">/** character buffer, for names */</span>
  <span class="keyword">protected</span> <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><span id="44323"><a id="44322">cbuf</a></span></span> = <span class="typed"><span class="type">()StringBuilder</span><a href="../../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../../StringBuilder.scala.html#1433">StringBuilder</a></span>()

  <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.dtd.DTD</span><span id="44326"><span id="44324"><span id="44325"><a id="106140">dtd</a></span></span></span></span>: <span class="typed"><span class="type">scala.xml.dtd.DTD</span><a href="../dtd/DTD.scala.html#9818">DTD</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>

  <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.Document</span><span id="44329"><span id="44327"><span id="44328"><a id="106141">doc</a></span></span></span></span>: <span class="typed"><span class="type">scala.xml.Document</span><a href="../Document.scala.html#7204">Document</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>

  <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="44332"><span id="44330"><span id="44331"><a id="106142">eof</a></span></span></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>

  <span class="comment">//</span>
  <span class="comment">// methods</span>
  <span class="comment">//</span>

  <span class="comment">/** &amp;lt;? prolog ::= xml S ... ?&amp;gt;
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()scala.xml.MetaData</span><a id="44333">xmlProcInstr</a></span>(): <span class="typed"><span class="type">scala.xml.MetaData</span><a href="../MetaData.scala.html#7378">MetaData</a></span> = {
    <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;xml&quot;</a></span>)
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">(scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">scala.xml.MetaData</span><span id="106165"><a href="../../Tuple2.scala.html#19161" id="106145">md</a></span></span>,<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span id="106166"><a href="../../Tuple2.scala.html#19163" id="106146">scp</a></span></span>) = <span class="typed"><span class="type">(scala.xml.NamespaceBinding)(scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a href="#44341">xAttributes</a></span>(<span class="typed"><span class="type">object scala.xml.TopScope</span><a href="../TopScope.scala.html#7361">TopScope</a></span>)
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106146">scp</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">object scala.xml.TopScope</span><a href="../TopScope.scala.html#7361">TopScope</a></span>)
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;no xmlns definitions here, please.&quot;)</span><span class="string">&quot;no xmlns definitions here, please.&quot;</span></span>);
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('?')</span><span class="char">'?'</span></span>)
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
    <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106145">md</a></span>
  }

  <span class="comment">/** &amp;lt;? prolog ::= xml S?
   *  // this is a bit more lenient than necessary...
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()(Option[String], Option[String], Option[Boolean])</span><a id="44334">prolog</a></span>(): <span class="typed"><span class="type">(Option[String], Option[String], Option[Boolean])</span><a href="../../Tuple3.scala.html#446">Tuple3</a></span>[Option[String], Option[String], Option[Boolean]] = {

    <span class="comment">//Console.println(&quot;(DEBUG) prolog&quot;)</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="106173">n</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Option[String]</span><a id="106174">info_ver</a></span>: <span class="typed"><span class="type">Option[String]</span><a href="../../Option.scala.html#932">Option</a></span>[String] = <span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Option[String]</span><a id="106175">info_enc</a></span>: <span class="typed"><span class="type">Option[String]</span><a href="../../Option.scala.html#932">Option</a></span>[String] = <span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Option[Boolean]</span><a id="106176">info_stdl</a></span>: <span class="typed"><span class="type">Option[Boolean]</span><a href="../../Option.scala.html#932">Option</a></span>[Boolean] = <span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span>

    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.MetaData</span><a id="106177">m</a></span> = <span class="typed"><span class="type">()scala.xml.MetaData</span><a href="#44333">xmlProcInstr</a></span>()

    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>

    <span class="typed"><span class="type">(String)Seq[scala.xml.Node]</span><a href="../MetaData.scala.html#25459">m</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;version&quot;)</span><span class="string">&quot;version&quot;</span></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>  =&gt; ;
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Text</a>(<span class="typed"><span class="type">java.lang.String(&quot;1.0&quot;)</span><span class="string">&quot;1.0&quot;</span></span>) =&gt; <span class="typed"><span class="type">Option[String]</span><a href="#106174">info_ver</a></span> = <span class="typed"><span class="type">(java.lang.String)Some[java.lang.String]</span><a href="../../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;1.0&quot;)</span><span class="string">&quot;1.0&quot;</span></span>); <span class="typed"><span class="type">Int</span><a href="#106173">n</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _     =&gt; <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;cannot deal with versions != 1.0&quot;)</span><span class="string">&quot;cannot deal with versions != 1.0&quot;</span></span>)
    }

    <span class="typed"><span class="type">(String)Seq[scala.xml.Node]</span><a href="../MetaData.scala.html#25459">m</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;encoding&quot;)</span><span class="string">&quot;encoding&quot;</span></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> =&gt; ;
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Text</a>(<span class="typed"><span class="type">String</span><a id="106210">enc</a></span>) =&gt;
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">(Seq[Char])Boolean</span><a href="TokenTests.scala.html#25359">isValidIANAEncoding</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518">enc</a></span>))
          <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;&quot;)</span><span class="string">&quot;\&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">String</span><a href="#106210">enc</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot; is not a valid encoding&quot;)</span><span class="string">&quot;\&quot; is not a valid encoding&quot;</span></span>)
        <span class="keyword">else</span> {
          <span class="typed"><span class="type">Option[String]</span><a href="#106175">info_enc</a></span> = <span class="typed"><span class="type">(String)Some[String]</span><a href="../../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">String</span><a href="#106210">enc</a></span>)
          <span class="typed"><span class="type">Int</span><a href="#106173">n</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        }
    }
    <span class="typed"><span class="type">(String)Seq[scala.xml.Node]</span><a href="../MetaData.scala.html#25459">m</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;standalone&quot;)</span><span class="string">&quot;standalone&quot;</span></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> =&gt; ;
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Text</a>(<span class="typed"><span class="type">java.lang.String(&quot;yes&quot;)</span><span class="string">&quot;yes&quot;</span></span>) =&gt; <span class="typed"><span class="type">Option[Boolean]</span><a href="#106176">info_stdl</a></span> = <span class="typed"><span class="type">(Boolean)Some[Boolean]</span><a href="../../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>);  <span class="typed"><span class="type">Int</span><a href="#106173">n</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Text</a>(<span class="typed"><span class="type">java.lang.String(&quot;no&quot;)</span><span class="string">&quot;no&quot;</span></span>)  =&gt; <span class="typed"><span class="type">Option[Boolean]</span><a href="#106176">info_stdl</a></span> = <span class="typed"><span class="type">(Boolean)Some[Boolean]</span><a href="../../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>); <span class="typed"><span class="type">Int</span><a href="#106173">n</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _     =&gt; <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;either 'yes' or 'no' expected&quot;)</span><span class="string">&quot;either 'yes' or 'no' expected&quot;</span></span>)
    }

    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106177">m</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../MetaData.scala.html#25466">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int</span><a href="#106173">n</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3140">!=</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) {
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;VersionInfo EncodingDecl? SDDecl? or '?&gt;' expected!&quot;)</span><span class="string">&quot;VersionInfo EncodingDecl? SDDecl? or '?&gt;' expected!&quot;</span></span>);
    }
    <span class="comment">//Console.println(&quot;[MarkupParser::prolog] finished parsing prolog!&quot;);</span>
    <span class="typed"><span class="type">(Option[String],Option[String],Option[Boolean])(Option[String], Option[String], Option[Boolean])</span><a href="../../Tuple3.scala.html#21271">Tuple3</a></span>(<span class="typed"><span class="type">Option[String]</span><a href="#106174">info_ver</a></span>,<span class="typed"><span class="type">Option[String]</span><a href="#106175">info_enc</a></span>,<span class="typed"><span class="type">Option[Boolean]</span><a href="#106176">info_stdl</a></span>)
  }

  <span class="comment">/** prolog, but without standalone */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()(Option[String], Option[String])</span><a id="44335">textDecl</a></span>(): <span class="typed"><span class="type">(Option[String], Option[String])</span><a href="../../Tuple2.scala.html#1376">Tuple2</a></span>[Option[String],Option[String]] = {

    <span class="keyword">var</span> <span class="typed"><span class="type">Option[String]</span><a id="106294">info_ver</a></span>: <span class="typed"><span class="type">Option[String]</span><a href="../../Option.scala.html#932">Option</a></span>[String] = <span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Option[String]</span><a id="106295">info_enc</a></span>: <span class="typed"><span class="type">Option[String]</span><a href="../../Option.scala.html#932">Option</a></span>[String] = <span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span>

    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.MetaData</span><a id="106296">m</a></span> = <span class="typed"><span class="type">()scala.xml.MetaData</span><a href="#44333">xmlProcInstr</a></span>()
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="106297">n</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>

    <span class="typed"><span class="type">(String)Seq[scala.xml.Node]</span><a href="../MetaData.scala.html#25459">m</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;version&quot;)</span><span class="string">&quot;version&quot;</span></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> =&gt; ;
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Text</a>(<span class="typed"><span class="type">java.lang.String(&quot;1.0&quot;)</span><span class="string">&quot;1.0&quot;</span></span>) =&gt; <span class="typed"><span class="type">Option[String]</span><a href="#106294">info_ver</a></span> = <span class="typed"><span class="type">(java.lang.String)Some[java.lang.String]</span><a href="../../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;1.0&quot;)</span><span class="string">&quot;1.0&quot;</span></span>); <span class="typed"><span class="type">Int</span><a href="#106297">n</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _     =&gt; <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;cannot deal with versions != 1.0&quot;)</span><span class="string">&quot;cannot deal with versions != 1.0&quot;</span></span>)
    }

    <span class="typed"><span class="type">(String)Seq[scala.xml.Node]</span><a href="../MetaData.scala.html#25459">m</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;encoding&quot;)</span><span class="string">&quot;encoding&quot;</span></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> =&gt; ;
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Text</a>(<span class="typed"><span class="type">String</span><a id="106330">enc</a></span>)  =&gt;
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">(Seq[Char])Boolean</span><a href="TokenTests.scala.html#25359">isValidIANAEncoding</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518">enc</a></span>))
          <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&quot;&quot;)</span><span class="string">&quot;\&quot;&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">String</span><a href="#106330">enc</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot; is not a valid encoding&quot;)</span><span class="string">&quot;\&quot; is not a valid encoding&quot;</span></span>)
        <span class="keyword">else</span> {
          <span class="typed"><span class="type">Option[String]</span><a href="#106295">info_enc</a></span> = <span class="typed"><span class="type">(String)Some[String]</span><a href="../../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">String</span><a href="#106330">enc</a></span>)
          <span class="typed"><span class="type">Int</span><a href="#106297">n</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        }
    }

    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106296">m</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../MetaData.scala.html#25466">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int</span><a href="#106297">n</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3140">!=</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) {
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;VersionInfo EncodingDecl? or '?&gt;' expected!&quot;)</span><span class="string">&quot;VersionInfo EncodingDecl? or '?&gt;' expected!&quot;</span></span>);
    }
    <span class="comment">//Console.println(&quot;[MarkupParser::textDecl] finished parsing textdecl&quot;);</span>
    <span class="typed"><span class="type">(Option[String],Option[String])(Option[String], Option[String])</span><a href="../../Tuple2.scala.html#20366">Tuple2</a></span>(<span class="typed"><span class="type">Option[String]</span><a href="#106294">info_ver</a></span>, <span class="typed"><span class="type">Option[String]</span><a href="#106295">info_enc</a></span>);
  }

  <span class="comment">/**
   *[22]        prolog     ::=          XMLDecl? Misc* (doctypedecl Misc*)?
   *[23]        XMLDecl    ::=          '&amp;lt;?xml' VersionInfo EncodingDecl? SDDecl? S? '?&gt;'
   *[24]        VersionInfo        ::=          S 'version' Eq (&quot;'&quot; VersionNum &quot;'&quot; | '&quot;' VersionNum '&quot;')
   *[25]        Eq         ::=          S? '=' S?
   *[26]        VersionNum         ::=          '1.0'
   *[27]        Misc       ::=          Comment | PI | S
   */</span>

  <span class="keyword">def</span> <span class="typed"><span class="type">()scala.xml.Document</span><a id="44336">document</a></span>(): <span class="typed"><span class="type">scala.xml.Document</span><a href="../Document.scala.html#7204">Document</a></span> = {

    <span class="comment">//Console.println(&quot;(DEBUG) document&quot;)</span>
    <span class="typed"><span class="type">(scala.xml.Document)Unit</span><a href="#44328">doc</a></span> = <span class="typed"><span class="type">scala.xml.Document</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.Document</span><a href="../Document.scala.html#7204">Document</a></span>()

    <span class="typed"><span class="type">MarkupParser.this.type</span><a href="#12525" class="keyword">this</a></span>.<span class="typed"><span class="type">(scala.xml.dtd.DTD)Unit</span><a href="#44325">dtd</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">(Option[String], Option[String], Option[Boolean])</span><a id="106362">info_prolog</a></span>: <span class="typed"><span class="type">(Option[String], Option[String], Option[Boolean])</span><a href="../../Tuple3.scala.html#446">Tuple3</a></span>[Option[String], Option[String], Option[Boolean]] = <span class="typed"><span class="type">(object None,object None,object None)(object None, object None, object None)</span><a href="../../Tuple3.scala.html#21271">Tuple3</a></span>(<span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span>, <span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span>, <span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span>);
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('&lt;')</span><span class="char">'&lt;'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) {
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt; expected&quot;)</span><span class="string">&quot;&lt; expected&quot;</span></span>)
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
    }

    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span> <span class="comment">// is prolog ?</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.NodeSeq</span><a id="106363">children</a></span>: <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#7291">NodeSeq</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('?')</span><span class="char">'?'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) {
      <span class="comment">//Console.println(&quot;[MarkupParser::document] starts with xml declaration&quot;);</span>
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>;
      <span class="typed"><span class="type">(Option[String], Option[String], Option[Boolean])</span><a href="#106362">info_prolog</a></span> = <span class="typed"><span class="type">()(Option[String], Option[String], Option[Boolean])</span><a href="#44334">prolog</a></span>()
      <span class="typed"><span class="type">=&gt; scala.xml.Document</span><a href="#44327">doc</a></span>.<span class="typed"><span class="type">(Option[String])Unit</span><a href="../Document.scala.html#45069">version</a></span>    = <span class="typed"><span class="type">(Option[String], Option[String], Option[Boolean])</span><a href="#106362">info_prolog</a></span>.<span class="typed"><span class="type">=&gt; Option[String]</span><a href="../../Tuple3.scala.html#19143">_1</a></span>
      <span class="typed"><span class="type">=&gt; scala.xml.Document</span><a href="#44327">doc</a></span>.<span class="typed"><span class="type">(Option[String])Unit</span><a href="../Document.scala.html#45063">encoding</a></span>   = <span class="typed"><span class="type">(Option[String], Option[String], Option[Boolean])</span><a href="#106362">info_prolog</a></span>.<span class="typed"><span class="type">=&gt; Option[String]</span><a href="../../Tuple3.scala.html#19145">_2</a></span>
      <span class="typed"><span class="type">=&gt; scala.xml.Document</span><a href="#44327">doc</a></span>.<span class="typed"><span class="type">(Option[Boolean])Unit</span><a href="../Document.scala.html#45066">standAlone</a></span> = <span class="typed"><span class="type">(Option[String], Option[String], Option[Boolean])</span><a href="#106362">info_prolog</a></span>.<span class="typed"><span class="type">=&gt; Option[Boolean]</span><a href="../../Tuple3.scala.html#19147">_3</a></span>

      <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="#106363">children</a></span> = <span class="typed"><span class="type">(scala.xml.NamespaceBinding)scala.xml.NodeSeq</span><a href="#44351">content</a></span>(<span class="typed"><span class="type">object scala.xml.TopScope</span><a href="../TopScope.scala.html#7361">TopScope</a></span>) <span class="comment">// DTD handled as side effect</span>
    } <span class="keyword">else</span> {
      <span class="comment">//Console.println(&quot;[MarkupParser::document] does not start with xml declaration&quot;);</span>
 <span class="comment">//</span>

      <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a id="106378">ts</a></span> = <span class="typed"><span class="type">scala.xml.NodeBuffer</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#7231">NodeBuffer</a></span>();
      <span class="typed"><span class="type">(scala.xml.NamespaceBinding,scala.xml.NodeBuffer)Unit</span><a href="#44350">content1</a></span>(<span class="typed"><span class="type">object scala.xml.TopScope</span><a href="../TopScope.scala.html#7361">TopScope</a></span>, <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106378">ts</a></span>); <span class="comment">// DTD handled as side effect</span>
      <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106378">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">(scala.xml.NamespaceBinding)scala.xml.NodeSeq</span><a href="#44351">content</a></span>(<span class="typed"><span class="type">object scala.xml.TopScope</span><a href="../TopScope.scala.html#7361">TopScope</a></span>);
      <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="#106363">children</a></span> = <span class="typed"><span class="type">object scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#7292">NodeSeq</a></span>.<span class="typed"><span class="type">(Seq[scala.xml.Node])scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#34626">fromSeq</a></span>(<span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106378">ts</a></span>);
    }
    <span class="comment">//Console.println(&quot;[MarkupParser::document] children now: &quot;+children.toList);</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="106364">elemCount</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>;
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.Node</span><a id="106365">theNode</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>;
    <span class="keyword">for</span> (<span class="typed"><span class="type">((scala.xml.Node) =&gt; Unit)Unit</span><a href="../../Iterable.scala.html#17328" id="106382">c</a></span> &lt;- <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="#106363">children</a></span>) <span class="typed"><span class="type">scala.xml.Node</span><a href="#106382">c</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _:<span class="typed"><span class="type">scala.xml.ProcInstr</span><a href="../ProcInstr.scala.html#7285">ProcInstr</a></span> =&gt; ;
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _:<span class="typed"><span class="type">scala.xml.Comment</span><a href="../Comment.scala.html#7147">Comment</a></span> =&gt; ;
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _:<span class="typed"><span class="type">scala.xml.EntityRef</span><a href="../EntityRef.scala.html#7255">EntityRef</a></span> =&gt; <span class="comment">// todo: fix entities, shouldn't be &quot;special&quot;</span>
        <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;no entity references alllowed here&quot;)</span><span class="string">&quot;no entity references alllowed here&quot;</span></span>);
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">scala.xml.SpecialNode</span><a id="106384">s</a></span>:<span class="typed"><span class="type">scala.xml.SpecialNode</span><a href="../SpecialNode.scala.html#7249">SpecialNode</a></span> =&gt;
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.xml.SpecialNode</span><a href="#106384">s</a></span>.<span class="typed"><span class="type">()String</span><a href="../Node.scala.html#19959">toString</a></span>().<span class="typed"><span class="type">()java.lang.String</span><a id="5868">trim</a></span>().<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) <span class="comment">//non-empty text nodes not allowed</span>
          <span class="typed"><span class="type">Int</span><a href="#106364">elemCount</a></span> = <span class="typed"><span class="type">Int</span><a href="#106364">elemCount</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>;
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">scala.xml.Node</span><a id="106410">m</a></span>:<span class="typed"><span class="type">scala.xml.Node</span><a href="../Node.scala.html#7174">Node</a></span> =&gt;
        <span class="typed"><span class="type">Int</span><a href="#106364">elemCount</a></span> = <span class="typed"><span class="type">Int</span><a href="#106364">elemCount</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>;
        <span class="typed"><span class="type">scala.xml.Node</span><a href="#106365">theNode</a></span> = <span class="typed"><span class="type">scala.xml.Node</span><a href="#106410">m</a></span>;
    }
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3140">!=</a></span> <span class="typed"><span class="type">Int</span><a href="#106364">elemCount</a></span>) {
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;document must contain exactly one element&quot;)</span><span class="string">&quot;document must contain exactly one element&quot;</span></span>)
      <span class="typed"><span class="type">object Console</span><a href="../../Console.scala.html#438">Console</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../../Console.scala.html#31300">println</a></span>(<span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="#106363">children</a></span>.<span class="typed"><span class="type">=&gt; List[scala.xml.Node]</span><a href="../../Iterable.scala.html#17360">toList</a></span>)
    }

    <span class="typed"><span class="type">=&gt; scala.xml.Document</span><a href="#44327">doc</a></span>.<span class="typed"><span class="type">(Seq[scala.xml.Node])Unit</span><a href="../Document.scala.html#45049">children</a></span> = <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="#106363">children</a></span>
    <span class="typed"><span class="type">=&gt; scala.xml.Document</span><a href="#44327">doc</a></span>.<span class="typed"><span class="type">(scala.xml.Node)Unit</span><a href="../Document.scala.html#45052">docElem</a></span> = <span class="typed"><span class="type">scala.xml.Node</span><a href="#106365">theNode</a></span>
    <span class="typed"><span class="type">=&gt; scala.xml.Document</span><a href="#44327">doc</a></span>
  }

  <span class="comment">/** append Unicode character to name buffer*/</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Char)StringBuilder</span><a id="44337">putChar</a></span>(<span class="typed"><span class="type">Char</span><a id="106433">c</a></span>: <span class="typed"><span class="type">Char</span><a id="2387">Char</a></span>) = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char</span><a href="#106433">c</a></span>)

  <span class="comment">//var xEmbeddedBlock = false;</span>

  <span class="comment">/** this method assign the next character to ch and advances in input */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="44338">nextch</a></span> {
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44302">curInput</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../io/Source.scala.html#22173">hasNext</a></span>) {
      <span class="typed"><span class="type">(Char)Unit</span><a href="#44320">ch</a></span> = <span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44302">curInput</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../io/Source.scala.html#22174">next</a></span>
      <span class="typed"><span class="type">(Int)Unit</span><a href="#44311">pos</a></span> = <span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44302">curInput</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../io/Source.scala.html#22153">pos</a></span>
    } <span class="keyword">else</span> {
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="106439">ilen</a></span> = <span class="typed"><span class="type">=&gt; List[scala.io.Source]</span><a href="#44307">inpStack</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../List.scala.html#20887">length</a></span>;
      <span class="comment">//Console.println(&quot;  ilen = &quot;+ilen+ &quot; extIndex = &quot;+extIndex);</span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> ((<span class="typed"><span class="type">Int</span><a href="#106439">ilen</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3140">!=</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#44313">extIndex</a></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> (<span class="typed"><span class="type">Int</span><a href="#106439">ilen</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)) { 
        <span class="comment">/** for external source, inpStack == Nil ! need notify of eof! */</span>
        <span class="typed"><span class="type">()Unit</span><a href="#44377">pop</a></span>()
      } <span class="keyword">else</span> {
        <span class="typed"><span class="type">(Boolean)Unit</span><a href="#44331">eof</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
        <span class="typed"><span class="type">(Char)Unit</span><a href="#44320">ch</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>.<span class="typed"><span class="type">Char</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">Char</span><a id="2387">Char</a></span>]
      }
    }
  }

  <span class="comment">//final val enableEmbeddedExpressions: Boolean = false;</span>

  <span class="comment">/** munch expected XML token, report syntax error for unexpected
  */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Char)Unit</span><a id="44339">xToken</a></span>(<span class="typed"><span class="type">Char</span><a id="44425">that</a></span>: <span class="typed"><span class="type">Char</span><a id="2387">Char</a></span>) {
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char</span><a href="#44425">that</a></span>)
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="keyword">else</span>  {
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;'&quot;)</span><span class="string">&quot;'&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">Char</span><a href="#44425">that</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;' expected instead of '&quot;)</span><span class="string">&quot;' expected instead of '&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot;'&quot;)</span><span class="string">&quot;'&quot;</span></span>)
      <span class="typed"><span class="type">(String)Nothing</span><a href="../../Predef.scala.html#13358">error</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;FATAL&quot;)</span><span class="string">&quot;FATAL&quot;</span></span>)
    }
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(Seq[Char])Unit</span><a id="44340">xToken</a></span>(<span class="typed"><span class="type">Seq[Char]</span><a id="44424">that</a></span>: <span class="typed"><span class="type">Seq[Char]</span><a href="../../Seq.scala.html#761">Seq</a></span>[Char]): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Char]</span><a id="106446">it</a></span> = <span class="typed"><span class="type">Seq[Char]</span><a href="#44424">that</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="../../Iterable.scala.html#17309">elements</a></span>;
    <span class="typed"><span class="type">Unit</span><a href="#106447" class="keyword">while</a></span> (<span class="typed"><span class="type">Iterator[Char]</span><a href="#106446">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>)
      <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Iterator[Char]</span><a href="#106446">it</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span>);
  }

  <span class="comment">/** parse attribute and create namespace scope, metadata
   *  [41] Attributes    ::= { S Name Eq AttValue }
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.NamespaceBinding)(scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a id="44341">xAttributes</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="106164">pscope</a></span>:<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>): <span class="typed"><span class="type">(scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a href="../../Tuple2.scala.html#1376">(</a></span>MetaData,NamespaceBinding) = {
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="106449">scope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span> = <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106164">pscope</a></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.MetaData</span><a id="106450">aMap</a></span>: <span class="typed"><span class="type">scala.xml.MetaData</span><a href="../MetaData.scala.html#7378">MetaData</a></span> = <span class="typed"><span class="type">object scala.xml.Null</span><a href="../Null.scala.html#7298">Null</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#106451" class="keyword">while</a></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="TokenTests.scala.html#25356">isNameStart</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)) {
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="106452">pos</a></span> = <span class="typed"><span class="type">MarkupParser.this.type</span><a href="#12525" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="#44310">pos</a></span>

      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106453">qname</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">Unit</span><a id="106454">_</a></span>     = <span class="typed"><span class="type">=&gt; Unit</span><a href="#44357">xEQ</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106455">value</a></span> = <span class="typed"><span class="type">()String</span><a href="#44342">xAttributeValue</a></span>()

      <span class="typed"><span class="type">object scala.xml.Utility</span><a href="../Utility.scala.html#7277">Utility</a></span>.<span class="typed"><span class="type">(String)Option[String]</span><a href="../Utility.scala.html#25383">prefix</a></span>(<span class="typed"><span class="type">String</span><a href="#106453">qname</a></span>) <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">java.lang.String(&quot;xmlns&quot;)</span><span class="string">&quot;xmlns&quot;</span></span>) =&gt;
          <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="106460">prefix</a></span> = <span class="typed"><span class="type">String</span><a href="#106453">qname</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">Int(6)</span><span class="int">6</span></span> <span class="comment">/*xmlns:*/</span> , <span class="typed"><span class="type">String</span><a href="#106453">qname</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>);
          <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106449">scope</a></span> = <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>(<span class="typed"><span class="type">java.lang.String</span><a href="#106460">prefix</a></span>, <span class="typed"><span class="type">String</span><a href="#106455">value</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106449">scope</a></span>);
        
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">String</span><a id="106468">prefix</a></span>)       =&gt; 
          <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="106469">key</a></span> = <span class="typed"><span class="type">String</span><a href="#106453">qname</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">String</span><a href="#106468">prefix</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span><span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span><span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>, <span class="typed"><span class="type">String</span><a href="#106453">qname</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>);
          <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106450">aMap</a></span> = <span class="typed"><span class="type">scala.xml.PrefixedAttribute</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.PrefixedAttribute</span><a href="../PrefixedAttribute.scala.html#7243">PrefixedAttribute</a></span>(<span class="typed"><span class="type">String</span><a href="#106468">prefix</a></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#106469">key</a></span>, <span class="typed"><span class="type">(String)scala.xml.Text</span><a href="../Text.scala.html#22618">Text</a></span>(<span class="typed"><span class="type">String</span><a href="#106455">value</a></span>), <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106450">aMap</a></span>);

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _             =&gt; 
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span>( <span class="typed"><span class="type">String</span><a href="#106453">qname</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;xmlns&quot;)</span><span class="string">&quot;xmlns&quot;</span></span> ) 
            <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106449">scope</a></span> = <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>(<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">String</span><a href="#106455">value</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106449">scope</a></span>);
          <span class="keyword">else</span> 
            <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106450">aMap</a></span> = <span class="typed"><span class="type">scala.xml.UnprefixedAttribute</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.UnprefixedAttribute</span><a href="../UnprefixedAttribute.scala.html#7216">UnprefixedAttribute</a></span>(<span class="typed"><span class="type">String</span><a href="#106453">qname</a></span>, <span class="typed"><span class="type">(String)scala.xml.Text</span><a href="../Text.scala.html#22618">Text</a></span>(<span class="typed"><span class="type">String</span><a href="#106455">value</a></span>), <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106450">aMap</a></span>);
      }
            
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> ((<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char('/')</span><span class="char">'/'</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> (<span class="typed"><span class="type">Char('?')</span><span class="char">'?'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>))
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>; 
    }

    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106450">aMap</a></span>.<span class="typed"><span class="type">(scala.xml.NamespaceBinding)Boolean</span><a href="../MetaData.scala.html#25486">wellformed</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106449">scope</a></span>))
        <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>( <span class="typed"><span class="type">java.lang.String(&quot;double attribute&quot;)</span><span class="string">&quot;double attribute&quot;</span></span>);

    <span class="typed"><span class="type">(scala.xml.MetaData,scala.xml.NamespaceBinding)(scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106450">aMap</a></span>,<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106449">scope</a></span>)
  }

  <span class="comment">/** attribute value, terminated by either ' or &quot;. value may not contain &amp;lt;.
   *       AttValue     ::= `'` { _  } `'`
   *                      | `&quot;` { _ } `&quot;`
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="44342">xAttributeValue</a></span>(): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Char</span><a id="106507">endch</a></span> = <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#106509" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char</span><a href="#106507">endch</a></span>) {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('&lt;')</span><span class="char">'&lt;'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)
        <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>( <span class="typed"><span class="type">java.lang.String(&quot;'&lt;' not allowed in attrib value&quot;)</span><span class="string">&quot;'&lt;' not allowed in attrib value&quot;</span></span> );
      <span class="typed"><span class="type">(Char)StringBuilder</span><a href="#44337">putChar</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    }
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106508">str</a></span> = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>()
    <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>

    <span class="comment">// well-formedness constraint</span>
    <span class="typed"><span class="type">(String)String</span><a href="#44378">normalizeAttributeValue</a></span>(<span class="typed"><span class="type">String</span><a href="#106508">str</a></span>)
  }

  <span class="comment">/** entity value, terminated by either ' or &quot;. value may not contain &amp;lt;.
   *       AttValue     ::= `'` { _  } `'`
   *                      | `&quot;` { _ } `&quot;`
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="44343">xEntityValue</a></span>(): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Char</span><a id="106516">endch</a></span> = <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#106518" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char</span><a href="#106516">endch</a></span>) {
      <span class="typed"><span class="type">(Char)StringBuilder</span><a href="#44337">putChar</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    }
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106517">str</a></span> = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>()
    <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">String</span><a href="#106517">str</a></span>
  }


  <span class="comment">/** parse a start or empty tag.
   *  [40] STag         ::= '&amp;lt;' Name { S Attribute } [S] 
   *  [44] EmptyElemTag ::= '&amp;lt;' Name { S Attribute } [S] 
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.NamespaceBinding)(String, scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a id="44344">xTag</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="106521">pscope</a></span>:<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>): <span class="typed"><span class="type">(String, scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a href="../../Tuple3.scala.html#446">Tuple3</a></span>[String, MetaData, NamespaceBinding] = {
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106522">qname</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>

    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">(scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">scala.xml.MetaData</span><span id="106528"><a href="../../Tuple2.scala.html#19161" id="106524">aMap</a></span></span>: <span class="typed"><span class="type">scala.xml.MetaData</span><a href="../MetaData.scala.html#7378">MetaData</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span id="106529"><a href="../../Tuple2.scala.html#19163" id="106525">scope</a></span></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>) = {
      <span class="typed"><span class="type">(scala.xml.MetaData, scala.xml.NamespaceBinding)</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="TokenTests.scala.html#25356">isNameStart</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)) 
        <span class="typed"><span class="type">(scala.xml.NamespaceBinding)(scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a href="#44341">xAttributes</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106521">pscope</a></span>)
      <span class="keyword">else</span> 
        <span class="typed"><span class="type">(object scala.xml.Null,scala.xml.NamespaceBinding)(object scala.xml.Null, scala.xml.NamespaceBinding)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">object scala.xml.Null</span><a href="../Null.scala.html#7298">Null</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106521">pscope</a></span>)
    }
    <span class="typed"><span class="type">(String,scala.xml.MetaData,scala.xml.NamespaceBinding)(String, scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a href="../../Tuple3.scala.html#21271">(</a></span><span class="typed"><span class="type">String</span><a href="#106522">qname</a></span>, <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106524">aMap</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106525">scope</a></span>)
  }

  <span class="comment">/** [42]  '&amp;lt;' xmlEndTag ::=  '&amp;lt;' '/' Name S? '&amp;gt;'
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="44345">xEndTag</a></span>(<span class="typed"><span class="type">String</span><a id="106535">n</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) = {
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('/')</span><span class="char">'/'</span></span>)
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106537">m</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#106535">n</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">String</span><a href="#106537">m</a></span>)
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;expected closing tag of &quot;)</span><span class="string">&quot;expected closing tag of &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">String</span><a href="#106535">n</a></span><span class="comment">/* +&quot;, not &quot;+m*/</span>);
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
  }

  <span class="comment">/** '&amp;lt;! CharData ::= [CDATA[ ( {char} - {char}&quot;]]&amp;gt;&quot;{char} ) ']]&amp;gt;'
   *
   * see [15]
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.xml.NodeSeq</span><a id="44346">xCharData</a></span>: <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#7291">NodeSeq</a></span> = {
    <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;[CDATA[&quot;</a></span>)
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="106542">pos1</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#44310">pos</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="106543">sb</a></span>: <span class="typed"><span class="type">StringBuilder</span><a href="../../StringBuilder.scala.html#1433">StringBuilder</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a href="../../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../../StringBuilder.scala.html#1433">StringBuilder</a></span>()
    <span class="typed"><span class="type">Unit</span><a href="#106544" class="keyword">while</a></span> (<span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>) {
      <span class="typed"><span class="type">StringBuilder</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span><span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span><span class="typed"><span class="type">Char(']')</span><span class="char">']'</span></span>  <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span>
         { <span class="typed"><span class="type">StringBuilder</span><a href="#106543">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>); <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char(']')</span><span class="char">']'</span></span> } <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span>
         { <span class="typed"><span class="type">StringBuilder</span><a href="#106543">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>); <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span> } ) {
        <span class="typed"><span class="type">StringBuilder</span><a href="#106543">sb</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">StringBuilder</span><a href="#106543">sb</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../StringBuilder.scala.html#19624">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; 
        <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String)scala.xml.NodeSeq</span><a href="MarkupHandler.scala.html#44401">text</a></span>( <span class="typed"><span class="type">Int</span><a href="#106542">pos1</a></span>, <span class="typed"><span class="type">StringBuilder</span><a href="#106543">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>() );
      } <span class="keyword">else</span> <span class="typed"><span class="type">StringBuilder</span><a href="#106543">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>( <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> );
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; 
    }
    <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(String)scala.xml.parsing.FatalError</span><a href="FatalError.scala.html#44473">FatalError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;this cannot happen&quot;)</span><span class="string">&quot;this cannot happen&quot;</span></span>);
  };

  <span class="comment">/** CharRef ::= &quot;&amp;amp;#&quot; '0'..'9' {'0'..'9'} &quot;;&quot;
   *            | &quot;&amp;amp;#x&quot; '0'..'9'|'A'..'F'|'a'..'f' { hexdigit } &quot;;&quot;
   *
   * see [66]
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(() =&gt; Char,() =&gt; Unit)String</span><a id="44347">xCharRef</a></span>(<span class="typed"><span class="type">() =&gt; Char</span><a id="106579">ch</a></span>: () =&gt; Char, <span class="typed"><span class="type">() =&gt; Unit</span><a id="106580">nextch</a></span>: () =&gt; Unit): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="typed"><span class="type">object scala.xml.Utility</span><a href="../Utility.scala.html#7277">Utility</a></span>.<span class="typed"><span class="type">(() =&gt; Char,() =&gt; Unit,(String) =&gt; Unit)String</span><a href="../Utility.scala.html#25395">parseCharRef</a></span>(<span class="typed"><span class="type">() =&gt; Char</span><a href="#106579">ch</a></span>, <span class="typed"><span class="type">() =&gt; Unit</span><a href="#106580">nextch</a></span>, <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span> _)
    <span class="comment">/*
    val hex  = (ch() == 'x') &amp;&amp; { nextch(); true };
    val base = if (hex) 16 else 10;
    var i = 0;
    while (ch() != ';') {
      ch() match {
        case '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9' =&gt;
          i = i * base + Character.digit( ch(), base );
        case 'a' | 'b' | 'c' | 'd' | 'e' | 'f'
           | 'A' | 'B' | 'C' | 'D' | 'E' | 'F' =&gt;
          if (! hex) 
            reportSyntaxError(&quot;hex char not allowed in decimal char ref\n&quot;
                         +&quot;Did you mean to write &amp;#x ?&quot;);
          else 
            i = i * base + Character.digit(ch(), base);
        case _ =&gt;
          reportSyntaxError(&quot;character '&quot; + ch() + &quot; not allowed in char ref\n&quot;);
      }
      nextch();
    }
    new String(Array(i.asInstanceOf[char]))
    */</span>
  }


  <span class="comment">/** Comment ::= '&amp;lt;!--' ((Char - '-') | ('-' (Char - '-')))* '--&amp;gt;'
   *
   * see [15]
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.xml.NodeSeq</span><a id="44348">xComment</a></span>: <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#7291">NodeSeq</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="106586">sb</a></span>: <span class="typed"><span class="type">StringBuilder</span><a href="../../StringBuilder.scala.html#1433">StringBuilder</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a href="../../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../../StringBuilder.scala.html#1433">StringBuilder</a></span>()
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('-')</span><span class="char">'-'</span></span>)
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('-')</span><span class="char">'-'</span></span>)
    <span class="typed"><span class="type">Unit</span><a href="#106587" class="keyword">while</a></span> (<span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>) { 
      <span class="typed"><span class="type">StringBuilder</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('-')</span><span class="char">'-'</span></span>  <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> { <span class="typed"><span class="type">StringBuilder</span><a href="#106586">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>); <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('-')</span><span class="char">'-'</span></span> }) {
        <span class="typed"><span class="type">StringBuilder</span><a href="#106586">sb</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">StringBuilder</span><a href="#106586">sb</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../StringBuilder.scala.html#19624">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
        <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
        <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String)scala.xml.NodeSeq</span><a href="MarkupHandler.scala.html#44399">comment</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#44310">pos</a></span>, <span class="typed"><span class="type">StringBuilder</span><a href="#106586">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>())
      } <span class="keyword">else</span> <span class="typed"><span class="type">StringBuilder</span><a href="#106586">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    }
    <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(String)scala.xml.parsing.FatalError</span><a href="FatalError.scala.html#44473">FatalError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;this cannot happen&quot;)</span><span class="string">&quot;this cannot happen&quot;</span></span>)
  }

  <span class="comment">/* todo: move this into the NodeBuilder class */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Int,scala.xml.NodeBuffer,String)Unit</span><a id="44349">appendText</a></span>(<span class="typed"><span class="type">Int</span><a id="106616">pos</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a id="106617">ts</a></span>: <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#7231">NodeBuffer</a></span>, <span class="typed"><span class="type">String</span><a id="106618">txt</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = {
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#44300">preserveWS</a></span>)
      <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106617">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String)scala.xml.NodeSeq</span><a href="MarkupHandler.scala.html#44401">text</a></span>(<span class="typed"><span class="type">Int</span><a href="#106616">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#106618">txt</a></span>);
    <span class="keyword">else</span>
      <span class="keyword">for</span> (<span class="typed"><span class="type">((scala.xml.Text) =&gt; Unit)Unit</span><a href="../../Iterable.scala.html#17328" id="106620">t</a></span> &lt;- <span class="typed"><span class="type">object scala.xml.TextBuffer</span><a href="../TextBuffer.scala.html#7211">TextBuffer</a></span>.<span class="typed"><span class="type">(String)scala.xml.TextBuffer</span><a href="../TextBuffer.scala.html#48041">fromString</a></span>(<span class="typed"><span class="type">String</span><a href="#106618">txt</a></span>).<span class="typed"><span class="type">=&gt; Seq[scala.xml.Text]</span><a href="../TextBuffer.scala.html#48052">toText</a></span>) {
        <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106617">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String)scala.xml.NodeSeq</span><a href="MarkupHandler.scala.html#44401">text</a></span>(<span class="typed"><span class="type">Int</span><a href="#106616">pos</a></span>, <span class="typed"><span class="type">scala.xml.Text</span><a href="#106620">t</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="../Atom.scala.html#22633">text</a></span>);
      }
  }

  <span class="comment">/** '&amp;lt;' content1 ::=  ... */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.NamespaceBinding,scala.xml.NodeBuffer)Unit</span><a id="44350">content1</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="106379">pscope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>, <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a id="106380">ts</a></span>: <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#7231">NodeBuffer</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> =
    <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('!')</span><span class="char">'!'</span></span> =&gt;
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('[')</span><span class="char">'['</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)                 <span class="comment">// CDATA </span>
        <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106380">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">=&gt; scala.xml.NodeSeq</span><a href="#44346">xCharData</a></span>
      <span class="keyword">else</span> <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('D')</span><span class="char">'D'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) <span class="comment">// doctypedecl, parse DTD // @todo REMOVE HACK</span>
        <span class="typed"><span class="type">()Unit</span><a href="#44353">parseDTD</a></span>()
      <span class="keyword">else</span> <span class="comment">// comment</span>
        <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106380">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">=&gt; scala.xml.NodeSeq</span><a href="#44348">xComment</a></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('?')</span><span class="char">'?'</span></span> =&gt;                    <span class="comment">// PI</span>
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
        <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106380">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">=&gt; scala.xml.NodeSeq</span><a href="#44360">xProcInstr</a></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _   =&gt; 
        <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106380">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">(scala.xml.NamespaceBinding)scala.xml.NodeSeq</span><a href="#44355">element1</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106379">pscope</a></span>)      <span class="comment">// child</span>
    }

  <span class="comment">/** content1 ::=  '&amp;lt;' content1 | '&amp;amp;' charref ... */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.NamespaceBinding)scala.xml.NodeSeq</span><a id="44351">content</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="106377">pscope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>): <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#7291">NodeSeq</a></span> = {
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a id="106627">ts</a></span> = <span class="typed"><span class="type">scala.xml.NodeBuffer</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#7231">NodeBuffer</a></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><a id="106628">exit</a></span> = <span class="typed"><span class="type">=&gt; Boolean</span><a href="#44330">eof</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#106630" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span> <span class="typed"><span class="type">Boolean</span><a href="#106628">exit</a></span>) {
      <span class="comment">//Console.println(&quot;in content, ch = '&quot;+ch+&quot;' line=&quot;+scala.io.Position.line(pos));</span>
      <span class="comment">/*      if( xEmbeddedBlock ) {
       ts.append( xEmbeddedExpr );
       } else {*/</span>
        <span class="typed"><span class="type">(Int)Unit</span><a href="#44317">tmppos</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#44310">pos</a></span>;
        <span class="typed"><span class="type">Boolean</span><a href="#106628">exit</a></span> = <span class="typed"><span class="type">=&gt; Boolean</span><a href="#44330">eof</a></span>;
        <span class="typed"><span class="type">Any</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">=&gt; Boolean</span><a href="#44330">eof</a></span>) 
          <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">Any</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('&lt;')</span><span class="char">'&lt;'</span></span> =&gt; <span class="comment">// another tag</span>
            <span class="comment">//Console.println(&quot;before ch = '&quot;+ch+&quot;' line=&quot;+scala.io.Position.line(pos)+&quot; pos=&quot;+pos);</span>
            <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; 
            <span class="comment">//Console.println(&quot;after ch = '&quot;+ch+&quot;' line=&quot;+scala.io.Position.line(pos)+&quot; pos=&quot;+pos);</span>

            <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span>(<span class="typed"><span class="type">Char('/')</span><span class="char">'/'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span><span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)
              <span class="typed"><span class="type">Boolean</span><a href="#106628">exit</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;                    <span class="comment">// end tag</span>
            <span class="keyword">else</span>
              <span class="typed"><span class="type">(scala.xml.NamespaceBinding,scala.xml.NodeBuffer)Unit</span><a href="#44350">content1</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106377">pscope</a></span>, <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106627">ts</a></span>)
          <span class="comment">//case '{' =&gt; </span>
<span class="comment">/*            if( xCheckEmbeddedBlock ) {
              ts.appendAll(xEmbeddedExpr);
            } else {*/</span>
          <span class="comment">//    val str = new StringBuilder(&quot;{&quot;);</span>
          <span class="comment">//    str.append(xText);</span>
          <span class="comment">//    appendText(tmppos, ts, str.toString());</span>
            <span class="comment">/*}*/</span>
          <span class="comment">// postcond: xEmbeddedBlock == false!</span>
          <span class="typed"><span class="type">Any</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('&amp;')</span><span class="char">'&amp;'</span></span> =&gt; <span class="comment">// EntityRef or CharRef </span>
            <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>;
            <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">Any</span><span class="keyword">match</span></span> {
              <span class="typed"><span class="type">scala.xml.NodeBuffer</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('#')</span><span class="char">'#'</span></span> =&gt; <span class="comment">// CharacterRef</span>
                <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>;
                <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.NodeSeq</span><a id="106633">theChar</a></span> = <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String)scala.xml.NodeSeq</span><a href="MarkupHandler.scala.html#44401">text</a></span>( <span class="typed"><span class="type">=&gt; Int</span><a href="#44316">tmppos</a></span>, 
                                          <span class="typed"><span class="type">(() =&gt; Char,() =&gt; Unit)String</span><a href="#44347">xCharRef</a></span> ({ ()=&gt; <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> },{ () =&gt; <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span> }) );
                <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char(';')</span><span class="char">';'</span></span>);
                <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106627">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="#106633">theChar</a></span> ;
              <span class="typed"><span class="type">Any</span><span class="keyword">case</span></span> _ =&gt; <span class="comment">// EntityRef</span>
                <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106637">n</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
                <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char(';')</span><span class="char">';'</span></span>)
                <span class="typed"><span class="type">String</span><a href="#106637">n</a></span> <span class="typed"><span class="type">Any</span><span class="keyword">match</span></span> {
                  <span class="typed"><span class="type">scala.xml.NodeBuffer</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;lt&quot;)</span><span class="string">&quot;lt&quot;</span></span>    =&gt; <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106627">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">Char('&lt;')</span><span class="char">'&lt;'</span></span>
                  <span class="typed"><span class="type">scala.xml.NodeBuffer</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;gt&quot;)</span><span class="string">&quot;gt&quot;</span></span>    =&gt; <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106627">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>
                  <span class="typed"><span class="type">scala.xml.NodeBuffer</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;amp&quot;)</span><span class="string">&quot;amp&quot;</span></span>   =&gt; <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106627">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">Char('&amp;')</span><span class="char">'&amp;'</span></span>
                  <span class="typed"><span class="type">scala.xml.NodeBuffer</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;quot&quot;)</span><span class="string">&quot;quot&quot;</span></span> =&gt; <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106627">ts</a></span> <span class="typed"><span class="type">(Any)scala.xml.NodeBuffer</span><a href="../NodeBuffer.scala.html#22591">&amp;+</a></span> <span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span>
                  <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt;
                    <span class="comment">/*
                     ts + handle.entityRef( tmppos, n ) ;
                     */</span>
                    <span class="typed"><span class="type">(String)Unit</span><a href="#44375">push</a></span>(<span class="typed"><span class="type">String</span><a href="#106637">n</a></span>)
                }
            }
          <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt; <span class="comment">// text content</span>
            <span class="comment">//Console.println(&quot;text content?? pos = &quot;+pos);</span>
            <span class="typed"><span class="type">(Int,scala.xml.NodeBuffer,String)Unit</span><a href="#44349">appendText</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#44316">tmppos</a></span>, <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106627">ts</a></span>, <span class="typed"><span class="type">=&gt; String</span><a href="#44361">xText</a></span>);
          <span class="comment">// here xEmbeddedBlock might be true</span>
          }
    <span class="comment">/*}*/</span>
    }
    <span class="keyword">val</span> <span class="typed"><span class="type">List[scala.xml.Node]</span><a id="106629">list</a></span> = <span class="typed"><span class="type">scala.xml.NodeBuffer</span><a href="#106627">ts</a></span>.<span class="typed"><span class="type">=&gt; List[scala.xml.Node]</span><a href="../../Iterable.scala.html#17360">toList</a></span>
    <span class="comment">// 2do: optimize seq repr.</span>
    <span class="typed"><span class="type">template $anon extends scala.xml.NodeSeq</span><a id="106647" class="keyword">new</a></span> <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#7291">NodeSeq</a></span> {
      <span class="keyword">val</span> <span class="typed"><span class="type">List[scala.xml.Node]</span><span id="106650"><a id="106649">theSeq</a></span></span> = <span class="typed"><span class="type">List[scala.xml.Node]</span><a href="#106629">list</a></span>
    }
  } <span class="comment">// content(NamespaceBinding)</span>

  <span class="comment">/** externalID ::= SYSTEM S syslit
   *                 PUBLIC S pubid S syslit
   */</span>

  <span class="keyword">def</span> <span class="typed"><span class="type">()scala.xml.dtd.ExternalID</span><a id="44352">externalID</a></span>(): <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a href="../dtd/ExternalID.scala.html#9749">ExternalID</a></span> = <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><span class="keyword">match</span></span> {
    <span class="typed"><span class="type">scala.xml.dtd.SystemID</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('S')</span><span class="char">'S'</span></span> =&gt;
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;YSTEM&quot;</a></span>)
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106652">sysID</a></span> = <span class="typed"><span class="type">()String</span><a href="#44362">systemLiteral</a></span>()
      <span class="typed"><span class="type">scala.xml.dtd.SystemID</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.dtd.SystemID</span><a href="../dtd/ExternalID.scala.html#9857">SystemID</a></span>(<span class="typed"><span class="type">String</span><a href="#106652">sysID</a></span>)
    <span class="typed"><span class="type">scala.xml.dtd.PublicID</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('P')</span><span class="char">'P'</span></span> =&gt;
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;UBLIC&quot;</a></span>)
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106658">pubID</a></span> = <span class="typed"><span class="type">()String</span><a href="#44363">pubidLiteral</a></span>()
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106659">sysID</a></span> = <span class="typed"><span class="type">()String</span><a href="#44362">systemLiteral</a></span>()
      <span class="typed"><span class="type">scala.xml.dtd.PublicID</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.dtd.PublicID</span><a href="../dtd/ExternalID.scala.html#9746">PublicID</a></span>(<span class="typed"><span class="type">String</span><a href="#106658">pubID</a></span>, <span class="typed"><span class="type">String</span><a href="#106659">sysID</a></span>)
  }


  <span class="comment">/** parses document type declaration and assigns it to instance variable
   *  dtd.
   *
   *  &amp;lt;! parseDTD ::= DOCTYPE name ... &gt;
   */</span> 
  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="44353">parseDTD</a></span>(): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = { <span class="comment">// dirty but fast</span>
    <span class="comment">//Console.println(&quot;(DEBUG) parseDTD&quot;);</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a id="106665">extID</a></span>: <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a href="../dtd/ExternalID.scala.html#9749">ExternalID</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">MarkupParser.this.type</span><a href="#12525" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; scala.xml.dtd.DTD</span><a href="#44324">dtd</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;unexpected character (DOCTYPE already defined&quot;)</span><span class="string">&quot;unexpected character (DOCTYPE already defined&quot;</span></span>);
    <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;DOCTYPE&quot;</a></span>)
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106666">n</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="comment">//external ID</span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('S')</span><span class="char">'S'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> <span class="typed"><span class="type">Char('P')</span><span class="char">'P'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) {
      <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a href="#106665">extID</a></span> = <span class="typed"><span class="type">()scala.xml.dtd.ExternalID</span><a href="#44352">externalID</a></span>()
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
    }

    <span class="comment">/* parse external subset of DTD 
     */</span>

    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> ((<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a href="#106665">extID</a></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a href="MarkupHandler.scala.html#44384">isValidating</a></span>) {

      <span class="typed"><span class="type">(String)Unit</span><a href="#44376">pushExternal</a></span>(<span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a href="#106665">extID</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="../dtd/ExternalID.scala.html#25340">systemId</a></span>)
      <span class="comment">//val extSubsetSrc = externalSource( extID.systemId );</span>

      <span class="typed"><span class="type">(Int)Unit</span><a href="#44314">extIndex</a></span> = <span class="typed"><span class="type">=&gt; List[scala.io.Source]</span><a href="#44307">inpStack</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../List.scala.html#20887">length</a></span>
      <span class="comment">/*
       .indexOf(':') != -1) { // assume URI
         Source.fromFile(new java.net.URI(extID.systemLiteral));
       } else {
         Source.fromFile(extID.systemLiteral);
       }
      */</span>
      <span class="comment">//Console.println(&quot;I'll print it now&quot;);</span>
      <span class="comment">//val old = curInput;</span>
      <span class="comment">//tmppos = curInput.pos;</span>
      <span class="comment">//val oldch = ch;</span>
      <span class="comment">//curInput = extSubsetSrc;</span>
      <span class="comment">//pos = 0;</span>
      <span class="comment">//nextch;</span>

      <span class="typed"><span class="type">()Unit</span><a href="#44364">extSubset</a></span>()

      <span class="typed"><span class="type">()Unit</span><a href="#44377">pop</a></span>()

      <span class="typed"><span class="type">(Int)Unit</span><a href="#44314">extIndex</a></span> = -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>

      <span class="comment">//curInput = old;</span>
      <span class="comment">//pos = curInput.pos;</span>
      <span class="comment">//ch = curInput.ch;</span>
      <span class="comment">//eof = false;</span>
      <span class="comment">//while(extSubsetSrc.hasNext)</span>
      <span class="comment">//Console.print(extSubsetSrc.next);</span>

      <span class="comment">//Console.println(&quot;returned from external, current ch = &quot;+ch )</span>
    }

    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('[')</span><span class="char">'['</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) { <span class="comment">// internal subset</span>
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      <span class="comment">/* TODO */</span>
      <span class="comment">//Console.println(&quot;hello&quot;);</span>
      <span class="typed"><span class="type">()Unit</span><a href="#44367">intSubset</a></span>()
      <span class="comment">//while(']' != ch)</span>
      <span class="comment">//  nextch;</span>
      <span class="comment">// TODO: do the DTD parsing?? ?!?!?!?!!</span>
      <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char(']')</span><span class="char">']'</span></span>)
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
    }
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
    <span class="typed"><span class="type">MarkupParser.this.type</span><a href="#12525" class="keyword">this</a></span>.<span class="typed"><span class="type">(scala.xml.dtd.DTD)Unit</span><a href="#44325">dtd</a></span> = <span class="typed"><span class="type">template $anon extends scala.xml.dtd.DTD</span><a id="106685" class="keyword">new</a></span> <span class="typed"><span class="type">scala.xml.dtd.DTD</span><a href="../dtd/DTD.scala.html#9818">DTD</a></span> {
      <span class="comment">/*override var*/</span> <span class="typed"><span class="type">(scala.xml.dtd.ExternalID)Unit</span><a href="../dtd/DTD.scala.html#58275">externalID</a></span> = <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a href="#106665">extID</a></span>
      <span class="comment">/*override val */</span><span class="typed"><span class="type">(List[scala.xml.dtd.Decl])Unit</span><a href="../dtd/DTD.scala.html#58289">decls</a></span>      = <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">=&gt; List[scala.xml.dtd.Decl]</span><a href="MarkupHandler.scala.html#44386">decls</a></span>.<span class="typed"><span class="type">=&gt; List[scala.xml.dtd.Decl]</span><a href="../../List.scala.html#20934">reverse</a></span>
    }
    <span class="comment">//this.dtd.initializeEntities();</span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; scala.xml.Document</span><a href="#44327">doc</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5793">ne</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)
      <span class="typed"><span class="type">=&gt; scala.xml.Document</span><a href="#44327">doc</a></span>.<span class="typed"><span class="type">(scala.xml.dtd.DTD)Unit</span><a href="../Document.scala.html#45055">dtd</a></span> = <span class="typed"><span class="type">MarkupParser.this.type</span><a href="#12525" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; scala.xml.dtd.DTD</span><a href="#44324">dtd</a></span>

    <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(String)Unit</span><a href="MarkupHandler.scala.html#44394">endDTD</a></span>(<span class="typed"><span class="type">String</span><a href="#106666">n</a></span>)
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.NamespaceBinding)scala.xml.NodeSeq</span><a id="44354">element</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="106689">pscope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>): <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#7291">NodeSeq</a></span> = {
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&lt;')</span><span class="char">'&lt;'</span></span>)
    <span class="typed"><span class="type">(scala.xml.NamespaceBinding)scala.xml.NodeSeq</span><a href="#44355">element1</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106689">pscope</a></span>)
  }

  <span class="comment">/** '&amp;lt;' element ::= xmlTag1 '&amp;gt;'  { xmlExpr | '{' simpleExpr '}' } ETag
   *               | xmlTag1 '/' '&amp;gt;'
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.NamespaceBinding)scala.xml.NodeSeq</span><a id="44355">element1</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="106626">pscope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="../NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>): <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#7291">NodeSeq</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="106691">pos</a></span> = <span class="typed"><span class="type">MarkupParser.this.type</span><a href="#12525" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="#44310">pos</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">(String, scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a href="../../Tuple3.scala.html#21271">Tuple3</a></span>(<span class="typed"><span class="type">String</span><span id="106701"><a href="../../Tuple3.scala.html#19143" id="106693">qname</a></span></span>, <span class="typed"><span class="type">scala.xml.MetaData</span><span id="106702"><a href="../../Tuple3.scala.html#19145" id="106694">aMap</a></span></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><span id="106703"><a href="../../Tuple3.scala.html#19147" id="106695">scope</a></span></span>) = <span class="typed"><span class="type">(scala.xml.NamespaceBinding)(String, scala.xml.MetaData, scala.xml.NamespaceBinding)</span><a href="#44344">xTag</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106626">pscope</a></span>)
    <span class="keyword">val</span> <span class="typed"><span class="type">(String, java.lang.String)</span><a href="../../Tuple2.scala.html#20366">Tuple2</a></span>(<span class="typed"><span class="type">String</span><span id="106737"><a href="../../Tuple2.scala.html#19161" id="106697">pre</a></span></span>, <span class="typed"><span class="type">java.lang.String</span><span id="106738"><a href="../../Tuple2.scala.html#19163" id="106698">local</a></span></span>) = <span class="typed"><span class="type">object scala.xml.Utility</span><a href="../Utility.scala.html#7277">Utility</a></span>.<span class="typed"><span class="type">(String)Option[String]</span><a href="../Utility.scala.html#25383">prefix</a></span>(<span class="typed"><span class="type">String</span><a href="#106693">qname</a></span>) <span class="typed"><span class="type">(String, java.lang.String)</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">(String, java.lang.String)</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">String</span><a id="106707">p</a></span>) =&gt; <span class="typed"><span class="type">(String,java.lang.String)(String, java.lang.String)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">String</span><a href="#106707">p</a></span>,<span class="typed"><span class="type">String</span><a href="#106693">qname</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">String</span><a href="#106707">p</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span><span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span><span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>, <span class="typed"><span class="type">String</span><a href="#106693">qname</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>))
      <span class="typed"><span class="type">(Null, String)</span><span class="keyword">case</span></span> _       =&gt; <span class="typed"><span class="type">(Null,String)(Null, String)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>,<span class="typed"><span class="type">String</span><a href="#106693">qname</a></span>)
    }
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.NodeSeq</span><a id="106699">ts</a></span> = {
      <span class="typed"><span class="type">scala.xml.NodeSeq</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('/')</span><span class="char">'/'</span></span>) {  <span class="comment">// empty element</span>
        <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('/')</span><span class="char">'/'</span></span>)
        <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
        <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String,String,scala.xml.MetaData,scala.xml.NamespaceBinding)Unit</span><a href="MarkupHandler.scala.html#44395">elemStart</a></span>(<span class="typed"><span class="type">Int</span><a href="#106691">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#106697">pre</a></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#106698">local</a></span>, <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106694">aMap</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106695">scope</a></span>)
        <span class="typed"><span class="type">object scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#7292">NodeSeq</a></span>.<span class="typed"><span class="type">=&gt; &lt;refinement&gt; extends scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#34624">Empty</a></span>
      }
      <span class="keyword">else</span> {           <span class="comment">// element with content</span>
        <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
        <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String,String,scala.xml.MetaData,scala.xml.NamespaceBinding)Unit</span><a href="MarkupHandler.scala.html#44395">elemStart</a></span>(<span class="typed"><span class="type">Int</span><a href="#106691">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#106697">pre</a></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#106698">local</a></span>, <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106694">aMap</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106695">scope</a></span>)
        <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.NodeSeq</span><a id="106745">tmp</a></span> = <span class="typed"><span class="type">(scala.xml.NamespaceBinding)scala.xml.NodeSeq</span><a href="#44351">content</a></span>(<span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106695">scope</a></span>)
        <span class="typed"><span class="type">(String)Unit</span><a href="#44345">xEndTag</a></span>(<span class="typed"><span class="type">String</span><a href="#106693">qname</a></span>)
        <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="#106745">tmp</a></span>
      }
    }
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.NodeSeq</span><a id="106700">res</a></span> = <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String,String,scala.xml.MetaData,scala.xml.NamespaceBinding,scala.xml.NodeSeq)scala.xml.NodeSeq</span><a href="MarkupHandler.scala.html#44397">elem</a></span>(<span class="typed"><span class="type">Int</span><a href="#106691">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#106697">pre</a></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#106698">local</a></span>, <span class="typed"><span class="type">scala.xml.MetaData</span><a href="#106694">aMap</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#106695">scope</a></span>, <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="#106699">ts</a></span>)
    <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String,String)Unit</span><a href="MarkupHandler.scala.html#44396">elemEnd</a></span>(<span class="typed"><span class="type">Int</span><a href="#106691">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#106697">pre</a></span>, <span class="typed"><span class="type">java.lang.String</span><a href="#106698">local</a></span>)
    <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="#106700">res</a></span>
  }

  <span class="comment">//def xEmbeddedExpr: MarkupType;</span>

  <span class="comment">/** Name ::= (Letter | '_' | ':') (NameChar)*
   *
   *  see  [5] of XML 1.0 specification
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="44356">xName</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="typed"><span class="type">String</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="TokenTests.scala.html#25356">isNameStart</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)) {
      <span class="typed"><span class="type">Unit</span><a href="#106749" class="keyword">while</a></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="TokenTests.scala.html#25355">isNameChar</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)) {
        <span class="typed"><span class="type">(Char)StringBuilder</span><a href="#44337">putChar</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      }
      <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.String</span><a id="106748">n</a></span> = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>().<span class="typed"><span class="type">()java.lang.String</span><a id="5884">intern</a></span>()
      <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
      <span class="typed"><span class="type">java.lang.String</span><a href="#106748">n</a></span>
    } <span class="keyword">else</span> {
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;name expected&quot;)</span><span class="string">&quot;name expected&quot;</span></span>)
      <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>
    }
  }

  <span class="comment">/** scan [S] '=' [S]*/</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="44357">xEQ</a></span> = { <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>; <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('=')</span><span class="char">'='</span></span>); <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span> }

  <span class="comment">/** skip optional space S? */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="44358">xSpaceOpt</a></span> = <span class="typed"><span class="type">Unit</span><a href="#106158" class="keyword">while</a></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="TokenTests.scala.html#25353">isSpace</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">=&gt; Boolean</span><a href="#44330">eof</a></span>) { <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; }

  <span class="comment">/** scan [3] S ::= (#x20 | #x9 | #xD | #xA)+ */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="44359">xSpace</a></span> =
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="TokenTests.scala.html#25353">isSpace</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)) { <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span> }
    <span class="keyword">else</span> <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;whitespace expected&quot;)</span><span class="string">&quot;whitespace expected&quot;</span></span>)

  <span class="comment">/** '&amp;lt;?' ProcInstr ::= Name [S ({Char} - ({Char}'&amp;gt;?' {Char})]'?&amp;gt;'
   *
   * see [15]
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.xml.NodeSeq</span><a id="44360">xProcInstr</a></span>: <span class="typed"><span class="type">scala.xml.NodeSeq</span><a href="../NodeSeq.scala.html#7291">NodeSeq</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="106751">sb</a></span>:<span class="typed"><span class="type">StringBuilder</span><a href="../../StringBuilder.scala.html#1433">StringBuilder</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a href="../../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../../StringBuilder.scala.html#1433">StringBuilder</a></span>()
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106752">n</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="TokenTests.scala.html#25353">isSpace</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)) {
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
      <span class="typed"><span class="type">Unit</span><a href="#106757" class="keyword">while</a></span> (<span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>) {
        <span class="typed"><span class="type">StringBuilder</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('?')</span><span class="char">'?'</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> { <span class="typed"><span class="type">StringBuilder</span><a href="#106751">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>( <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> ); <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span> }) {
          <span class="typed"><span class="type">StringBuilder</span><a href="#106751">sb</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">StringBuilder</span><a href="#106751">sb</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../StringBuilder.scala.html#19624">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>;
          <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>;
          <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String,String)scala.xml.NodeSeq</span><a href="MarkupHandler.scala.html#44398">procInstr</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#44316">tmppos</a></span>, <span class="typed"><span class="type">String</span><a href="#106752">n</a></span>, <span class="typed"><span class="type">StringBuilder</span><a href="#106751">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>);
        } <span class="keyword">else</span>
          <span class="typed"><span class="type">StringBuilder</span><a href="#106751">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>);
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      }
    };
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('?')</span><span class="char">'?'</span></span>)
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
    <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(Int,String,String)scala.xml.NodeSeq</span><a href="MarkupHandler.scala.html#44398">procInstr</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#44316">tmppos</a></span>, <span class="typed"><span class="type">String</span><a href="#106752">n</a></span>, <span class="typed"><span class="type">StringBuilder</span><a href="#106751">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>)
  }

  <span class="comment">/** parse character data.
   *   precondition: xEmbeddedBlock == false (we are not in a scala block)
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="44361">xText</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="comment">//if( xEmbeddedBlock ) throw FatalError(&quot;internal error: encountered embedded block&quot;); // assert</span>

    <span class="comment">/*if( xCheckEmbeddedBlock )
      return &quot;&quot;
    else {*/</span>
    <span class="comment">//Console.println(&quot;in xText! ch = '&quot;+ch+&quot;'&quot;);</span>
      <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><a id="106782">exit</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;
      <span class="typed"><span class="type">Unit</span><a href="#106784" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span> <span class="typed"><span class="type">Boolean</span><a href="#106782">exit</a></span>) {
        <span class="comment">//Console.println(&quot;LOOP in xText! ch = '&quot;+ch+&quot;' + pos=&quot;+pos);</span>
        <span class="typed"><span class="type">(Char)StringBuilder</span><a href="#44337">putChar</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>);
        <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="106785">opos</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#44310">pos</a></span>;
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>;

        <span class="comment">//Console.println(&quot;STILL LOOP in xText! ch = '&quot;+ch+&quot;' + pos=&quot;+pos+&quot; opos=&quot;+opos);</span>
        

        <span class="typed"><span class="type">Boolean</span><a href="#106782">exit</a></span> = <span class="typed"><span class="type">=&gt; Boolean</span><a href="#44330">eof</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> <span class="comment">/*{ nextch; xCheckEmbeddedBlock }||*/</span>( <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('&lt;')</span><span class="char">'&lt;'</span></span> ) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> ( <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('&amp;')</span><span class="char">'&amp;'</span></span> );
      }
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106783">str</a></span> = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>();
      <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>;
      <span class="typed"><span class="type">String</span><a href="#106783">str</a></span>
    <span class="comment">/*}*/</span>
  }

  <span class="comment">/** attribute value, terminated by either ' or &quot;. value may not contain &amp;lt;.
   *       AttValue     ::= `'` { _ } `'`
   *                      | `&quot;` { _ } `&quot;`
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="44362">systemLiteral</a></span>(): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Char</span><a id="106790">endch</a></span> = <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char(''')</span><span class="char">'\''</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span>)
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;quote ' or &quot; expected&quot;)</span><span class="string">&quot;quote ' or \&quot; expected&quot;</span></span>);
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#106792" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char</span><a href="#106790">endch</a></span>) {
      <span class="typed"><span class="type">(Char)StringBuilder</span><a href="#44337">putChar</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    }
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106791">str</a></span> = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>()
    <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">String</span><a href="#106791">str</a></span>
  }


  <span class="comment">/* [12]       PubidLiteral ::=        '&quot;' PubidChar* '&quot;' | &quot;'&quot; (PubidChar - &quot;'&quot;)* &quot;'&quot; */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()String</span><a id="44363">pubidLiteral</a></span>(): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Char</span><a id="106800">endch</a></span> = <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span><span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span><span class="typed"><span class="type">Char(''')</span><span class="char">'\''</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span>)
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;quote ' or &quot; expected&quot;)</span><span class="string">&quot;quote ' or \&quot; expected&quot;</span></span>);
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#106802" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char</span><a href="#106800">endch</a></span>) {
      <span class="typed"><span class="type">(Char)StringBuilder</span><a href="#44337">putChar</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)
      <span class="comment">//Console.println(&quot;hello '&quot;+ch+&quot;'&quot;+isPubIDChar(ch));</span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">(Char)Boolean</span><a href="TokenTests.scala.html#25358">isPubIDChar</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>))
        <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;char '&quot;)</span><span class="string">&quot;char '&quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">java.lang.String(&quot;' is not allowed in public id&quot;)</span><span class="string">&quot;' is not allowed in public id&quot;</span></span>);
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    }
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106801">str</a></span> = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>()
    <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">String</span><a href="#106801">str</a></span>
  }

  <span class="comment">//</span>
  <span class="comment">//  dtd parsing</span>
  <span class="comment">//</span>

  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="44364">extSubset</a></span>(): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = {
    <span class="keyword">var</span> <span class="typed"><span class="type">(Option[String], Option[String])</span><a id="106811">textdecl</a></span>:<span class="typed"><span class="type">(Option[String], Option[String])</span><a href="../../Tuple2.scala.html#1376">Tuple2</a></span>[Option[String],Option[String]] = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>;
    <span class="typed"><span class="type">Any</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span><span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span><span class="typed"><span class="type">Char('&lt;')</span><span class="char">'&lt;'</span></span>) {
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      <span class="typed"><span class="type">Any</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span><span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span><span class="typed"><span class="type">Char('?')</span><span class="char">'?'</span></span>) {
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
        <span class="typed"><span class="type">(Option[String], Option[String])</span><a href="#106811">textdecl</a></span> = <span class="typed"><span class="type">()(Option[String], Option[String])</span><a href="#44335">textDecl</a></span>()
      } <span class="keyword">else</span>
        <span class="typed"><span class="type">()Any</span><a href="#44365">markupDecl1</a></span>()
    }
    <span class="typed"><span class="type">Unit</span><a href="#106922" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">=&gt; Boolean</span><a href="#44330">eof</a></span>)
      <span class="typed"><span class="type">()Unit</span><a href="#44366">markupDecl</a></span>()
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">()Any</span><a id="44365">markupDecl1</a></span>() = {
    <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="106817">doInclude</a></span>() = {
      <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('[')</span><span class="char">'['</span></span>); <span class="typed"><span class="type">Unit</span><a href="#106819" class="keyword">while</a></span>(<span class="typed"><span class="type">Char(']')</span><span class="char">']'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) <span class="typed"><span class="type">()Unit</span><a href="#44366">markupDecl</a></span>(); <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span> <span class="comment">// ']'</span>
    }
    <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="106818">doIgnore</a></span>() = {
      <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('[')</span><span class="char">'['</span></span>); <span class="typed"><span class="type">Unit</span><a href="#106823" class="keyword">while</a></span>(<span class="typed"><span class="type">Char(']')</span><span class="char">']'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>; <span class="comment">// ']'</span>
    }
    <span class="typed"><span class="type">Any</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('?')</span><span class="char">'?'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) {
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      <span class="typed"><span class="type">=&gt; scala.xml.NodeSeq</span><a href="#44360">xProcInstr</a></span> <span class="comment">// simply ignore processing instructions!</span>
    } <span class="keyword">else</span> {
      <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('!')</span><span class="char">'!'</span></span>)
      <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">Any</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">scala.xml.NodeSeq</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('-')</span><span class="char">'-'</span></span> =&gt;
          <span class="typed"><span class="type">=&gt; scala.xml.NodeSeq</span><a href="#44348">xComment</a></span> <span class="comment">// ignore comments</span>

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('E')</span><span class="char">'E'</span></span> =&gt;
          <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('L')</span><span class="char">'L'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) {
            <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
            <span class="typed"><span class="type">()Unit</span><a href="#44368">elementDecl</a></span>()
          } <span class="keyword">else</span> 
            <span class="typed"><span class="type">()Unit</span><a href="#44370">entityDecl</a></span>()

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('A')</span><span class="char">'A'</span></span> =&gt;
          <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
          <span class="typed"><span class="type">()Unit</span><a href="#44369">attrDecl</a></span>()

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('N')</span><span class="char">'N'</span></span> =&gt;
          <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
          <span class="typed"><span class="type">()Unit</span><a href="#44371">notationDecl</a></span>()

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('[')</span><span class="char">'['</span></span> <span class="keyword">if</span> <span class="typed"><span class="type">=&gt; List[scala.io.Source]</span><a href="#44307">inpStack</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../List.scala.html#20887">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3144">&gt;=</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#44313">extIndex</a></span> =&gt;
          <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
          <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
          <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('%')</span><span class="char">'%'</span></span> =&gt;
              <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
              <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106897">ent</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
              <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char(';')</span><span class="char">';'</span></span>)
              <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
            <span class="comment">/*
              Console.println(&quot;hello, pushing!&quot;);
            {
              val test =  replacementText(ent);
              while(test.hasNext)
                Console.print(test.next);
            } */</span>
              <span class="typed"><span class="type">(String)Unit</span><a href="#44375">push</a></span>(<span class="typed"><span class="type">String</span><a href="#106897">ent</a></span>)
              <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
              <span class="comment">//Console.println(&quot;hello, getting name&quot;);</span>
              <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106898">stmt</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
              <span class="comment">//Console.println(&quot;hello, got name&quot;);</span>
              <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
            <span class="comment">//Console.println(&quot;how can we be eof = &quot;+eof);</span>

            <span class="comment">// eof = true because not external?!</span>
              <span class="comment">//if(!eof)</span>
              <span class="comment">//  error(&quot;expected only INCLUDE or IGNORE&quot;);</span>

              <span class="comment">//pop();</span>

              <span class="comment">//Console.println(&quot;hello, popped&quot;);</span>
              <span class="typed"><span class="type">String</span><a href="#106898">stmt</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                <span class="comment">// parameter entity</span>
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;INCLUDE&quot;)</span><span class="string">&quot;INCLUDE&quot;</span></span> =&gt;
                  <span class="typed"><span class="type">()Unit</span><a href="#106817">doInclude</a></span>()
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;IGNORE&quot;)</span><span class="string">&quot;IGNORE&quot;</span></span> =&gt;
                  <span class="typed"><span class="type">()Unit</span><a href="#106818">doIgnore</a></span>()
              }
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('I')</span><span class="char">'I'</span></span> =&gt;
              <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
              <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('G')</span><span class="char">'G'</span></span> =&gt;
                  <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
                  <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;NORE&quot;</a></span>)
                  <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
                  <span class="typed"><span class="type">()Unit</span><a href="#106818">doIgnore</a></span>()
                <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('N')</span><span class="char">'N'</span></span> =&gt;
                  <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
                  <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;NCLUDE&quot;</a></span>)
                  <span class="typed"><span class="type">()Unit</span><a href="#106817">doInclude</a></span>()
              }
          }
        <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char(']')</span><span class="char">']'</span></span>)
        <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _  =&gt;
          <span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44302">curInput</a></span>.<span class="typed"><span class="type">(Int,String)Unit</span><a href="../../io/Source.scala.html#22175">reportError</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#44310">pos</a></span>, <span class="typed"><span class="type">java.lang.String(&quot;unexpected character '&quot;)</span><span class="string">&quot;unexpected character '&quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">java.lang.String(&quot;', expected some markupdecl&quot;)</span><span class="string">&quot;', expected some markupdecl&quot;</span></span>)
        <span class="typed"><span class="type">Unit</span><a href="#106913" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span><span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span><span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
          <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      }
    }
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="44366">markupDecl</a></span>(): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
    <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('%')</span><span class="char">'%'</span></span> =&gt;                  <span class="comment">// parameter entity reference</span>
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106923">ent</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
      <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char(';')</span><span class="char">';'</span></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">=&gt; Boolean</span><a href="MarkupHandler.scala.html#44384">isValidating</a></span>)
        <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(String)Unit</span><a href="MarkupHandler.scala.html#44408">peReference</a></span>(<span class="typed"><span class="type">String</span><a href="#106923">ent</a></span>)  <span class="comment">//  n-v: just create PE-reference </span>
      <span class="keyword">else</span>
        <span class="typed"><span class="type">(String)Unit</span><a href="#44375">push</a></span>(<span class="typed"><span class="type">String</span><a href="#106923">ent</a></span>)                <span class="comment">//    v: parse replacementText</span>

    <span class="comment">//peReference</span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('&lt;')</span><span class="char">'&lt;'</span></span> =&gt;
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      <span class="typed"><span class="type">()Any</span><a href="#44365">markupDecl1</a></span>()
    <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ <span class="keyword">if</span> <span class="typed"><span class="type">(Char)Boolean</span><a href="TokenTests.scala.html#25353">isSpace</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) =&gt;
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt;
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;markupdecl: unexpected character '&quot;)</span><span class="string">&quot;markupdecl: unexpected character '&quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">java.lang.String(&quot;' #&quot;)</span><span class="string">&quot;' #&quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>.<span class="typed"><span class="type">Int</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>])
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
  }

  <span class="comment">/**  &quot;rec-xml/#ExtSubset&quot; pe references may not occur within markup 
   declarations 
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="44367">intSubset</a></span>() {
    <span class="comment">//Console.println(&quot;(DEBUG) intSubset()&quot;)</span>
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#106927" class="keyword">while</a></span> (<span class="typed"><span class="type">Char(']')</span><span class="char">']'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)
      <span class="typed"><span class="type">()Unit</span><a href="#44366">markupDecl</a></span>()
  }

  <span class="comment">/** &amp;lt;! element := ELEMENT
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="44368">elementDecl</a></span>() {
    <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;EMENT&quot;</a></span>)
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106930">n</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#106932" class="keyword">while</a></span> (<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) {
      <span class="comment">//Console.println(&quot;[&quot;+ch+&quot;]&quot;)</span>
      <span class="typed"><span class="type">(Char)StringBuilder</span><a href="#44337">putChar</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>)
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    }
    <span class="comment">//Console.println(&quot;END[&quot;+ch+&quot;]&quot;)</span>
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106931">cmstr</a></span> = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>()
    <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(String,String)Unit</span><a href="MarkupHandler.scala.html#44402">elemDecl</a></span>(<span class="typed"><span class="type">String</span><a href="#106930">n</a></span>, <span class="typed"><span class="type">String</span><a href="#106931">cmstr</a></span>)
  }

  <span class="comment">/** &amp;lt;! attlist := ATTLIST
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="44369">attrDecl</a></span>() = {
    <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;TTLIST&quot;</a></span>)
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106857">n</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">List[scala.xml.dtd.AttrDecl]</span><a id="106858">attList</a></span>: <span class="typed"><span class="type">List[scala.xml.dtd.AttrDecl]</span><a href="../../List.scala.html#524">List</a></span>[AttrDecl] = <span class="typed"><span class="type">object Nil</span><a href="../../List.scala.html#333">Nil</a></span>
    <span class="comment">// later: find the elemDecl for n</span>
    <span class="typed"><span class="type">Unit</span><a href="#106859" class="keyword">while</a></span> (<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106867">aname</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
      <span class="comment">//Console.println(&quot;attribute name: &quot;+aname);</span>
      <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.dtd.DefaultDecl</span><a id="106868">defdecl</a></span>: <span class="typed"><span class="type">scala.xml.dtd.DefaultDecl</span><a href="../dtd/Decl.scala.html#9713">DefaultDecl</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
      <span class="comment">// could be enumeration (foo,bar) parse this later :-/</span>
      <span class="typed"><span class="type">Unit</span><a href="#106870" class="keyword">while</a></span> (<span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Char(''')</span><span class="char">'\''</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Char('#')</span><span class="char">'#'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Char('&lt;')</span><span class="char">'&lt;'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) {
        <span class="typed"><span class="type">Any</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">(Char)Boolean</span><a href="TokenTests.scala.html#25353">isSpace</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>))
          <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>);
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>;
      }
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106869">atpe</a></span> = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>()
      <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
      <span class="comment">//Console.println(&quot;attr type: &quot;+atpe);</span>
      <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char(''')</span><span class="char">'\''</span></span> | <span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span> =&gt;
          <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106888">defValue</a></span> = <span class="typed"><span class="type">()String</span><a href="#44342">xAttributeValue</a></span>() <span class="comment">// default value</span>
          <span class="typed"><span class="type">scala.xml.dtd.DefaultDecl</span><a href="#106868">defdecl</a></span> = <span class="typed"><span class="type">(Boolean,String)scala.xml.dtd.DEFAULT</span><a href="../dtd/Decl.scala.html#59419">DEFAULT</a></span>(<span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>, <span class="typed"><span class="type">String</span><a href="#106888">defValue</a></span>)

        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('#')</span><span class="char">'#'</span></span> =&gt;
          <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
          <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;FIXED&quot;)</span><span class="string">&quot;FIXED&quot;</span></span> =&gt;
              <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
              <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106889">defValue</a></span> = <span class="typed"><span class="type">()String</span><a href="#44342">xAttributeValue</a></span>() <span class="comment">// default value</span>
              <span class="typed"><span class="type">scala.xml.dtd.DefaultDecl</span><a href="#106868">defdecl</a></span> = <span class="typed"><span class="type">(Boolean,String)scala.xml.dtd.DEFAULT</span><a href="../dtd/Decl.scala.html#59419">DEFAULT</a></span>(<span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>, <span class="typed"><span class="type">String</span><a href="#106889">defValue</a></span>)
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;IMPLIED&quot;)</span><span class="string">&quot;IMPLIED&quot;</span></span> =&gt;
              <span class="typed"><span class="type">scala.xml.dtd.DefaultDecl</span><a href="#106868">defdecl</a></span> = <span class="typed"><span class="type">object scala.xml.dtd.IMPLIED</span><a href="../dtd/Decl.scala.html#9744">IMPLIED</a></span>
            <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;REQUIRED&quot;)</span><span class="string">&quot;REQUIRED&quot;</span></span> =&gt;
              <span class="typed"><span class="type">scala.xml.dtd.DefaultDecl</span><a href="#106868">defdecl</a></span> = <span class="typed"><span class="type">object scala.xml.dtd.REQUIRED</span><a href="../dtd/Decl.scala.html#9852">REQUIRED</a></span>
          }
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt;
      }
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>

      <span class="typed"><span class="type">List[scala.xml.dtd.AttrDecl]</span><a href="#106858">attList</a></span> = <span class="typed"><span class="type">(String,String,scala.xml.dtd.DefaultDecl)scala.xml.dtd.AttrDecl</span><a href="../dtd/Decl.scala.html#59376">AttrDecl</a></span>(<span class="typed"><span class="type">String</span><a href="#106867">aname</a></span>, <span class="typed"><span class="type">String</span><a href="#106869">atpe</a></span>, <span class="typed"><span class="type">scala.xml.dtd.DefaultDecl</span><a href="#106868">defdecl</a></span>) <span class="typed"><span class="type">(scala.xml.dtd.AttrDecl)List[scala.xml.dtd.AttrDecl]</span><a href="../../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">List[scala.xml.dtd.AttrDecl]</span><a href="#106858">attList</a></span>
      <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    }
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
    <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(String,List[scala.xml.dtd.AttrDecl])Unit</span><a href="MarkupHandler.scala.html#44403">attListDecl</a></span>(<span class="typed"><span class="type">String</span><a href="#106857">n</a></span>, <span class="typed"><span class="type">List[scala.xml.dtd.AttrDecl]</span><a href="#106858">attList</a></span>.<span class="typed"><span class="type">=&gt; List[scala.xml.dtd.AttrDecl]</span><a href="../../List.scala.html#20934">reverse</a></span>)
  }

  <span class="comment">/** &amp;lt;! element := ELEMENT
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="44370">entityDecl</a></span>() = {
    <span class="comment">//Console.println(&quot;entityDecl()&quot;)</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><a id="106833">isParameterEntity</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.xml.dtd.EntityDef</span><a id="106834">entdef</a></span>: <span class="typed"><span class="type">scala.xml.dtd.EntityDef</span><a href="../dtd/Decl.scala.html#9719">EntityDef</a></span> = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
    <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;NTITY&quot;</a></span>)
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('%')</span><span class="char">'%'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) {
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      <span class="typed"><span class="type">Boolean</span><a href="#106833">isParameterEntity</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    }
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106835">n</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('S')</span><span class="char">'S'</span></span> | <span class="typed"><span class="type">Char('P')</span><span class="char">'P'</span></span> =&gt; <span class="comment">//sy</span>
        <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a id="106843">extID</a></span> = <span class="typed"><span class="type">()scala.xml.dtd.ExternalID</span><a href="#44352">externalID</a></span>()
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#106833">isParameterEntity</a></span>) {
          <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
          <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
          <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(String,scala.xml.dtd.EntityDef)Unit</span><a href="MarkupHandler.scala.html#44404">parameterEntityDecl</a></span>(<span class="typed"><span class="type">String</span><a href="#106835">n</a></span>, <span class="typed"><span class="type">(scala.xml.dtd.ExternalID)scala.xml.dtd.ExtDef</span><a href="../dtd/Decl.scala.html#95533">ExtDef</a></span>(<span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a href="#106843">extID</a></span>))
        } <span class="keyword">else</span> { <span class="comment">// notation?</span>
          <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span>) {
            <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;NDATA&quot;</a></span>)
            <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
            <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106847">notat</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
            <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
            <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
            <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(String,scala.xml.dtd.ExternalID,String)Unit</span><a href="MarkupHandler.scala.html#44406">unparsedEntityDecl</a></span>(<span class="typed"><span class="type">String</span><a href="#106835">n</a></span>, <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a href="#106843">extID</a></span>, <span class="typed"><span class="type">String</span><a href="#106847">notat</a></span>)
          } <span class="keyword">else</span> {
            <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
            <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(String,scala.xml.dtd.EntityDef)Unit</span><a href="MarkupHandler.scala.html#44405">parsedEntityDecl</a></span>(<span class="typed"><span class="type">String</span><a href="#106835">n</a></span>, <span class="typed"><span class="type">(scala.xml.dtd.ExternalID)scala.xml.dtd.ExtDef</span><a href="../dtd/Decl.scala.html#95533">ExtDef</a></span>(<span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a href="#106843">extID</a></span>))
          }
        }

      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span> | <span class="typed"><span class="type">Char(''')</span><span class="char">'\''</span></span> =&gt;
        <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106854">av</a></span> = <span class="typed"><span class="type">()String</span><a href="#44343">xEntityValue</a></span>()
        <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
        <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#106833">isParameterEntity</a></span>)
          <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(String,scala.xml.dtd.EntityDef)Unit</span><a href="MarkupHandler.scala.html#44404">parameterEntityDecl</a></span>(<span class="typed"><span class="type">String</span><a href="#106835">n</a></span>, <span class="typed"><span class="type">(String)scala.xml.dtd.IntDef</span><a href="../dtd/Decl.scala.html#90200">IntDef</a></span>(<span class="typed"><span class="type">String</span><a href="#106854">av</a></span>))
        <span class="keyword">else</span>
          <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(String,scala.xml.dtd.EntityDef)Unit</span><a href="MarkupHandler.scala.html#44405">parsedEntityDecl</a></span>(<span class="typed"><span class="type">String</span><a href="#106835">n</a></span>, <span class="typed"><span class="type">(String)scala.xml.dtd.IntDef</span><a href="../dtd/Decl.scala.html#90200">IntDef</a></span>(<span class="typed"><span class="type">String</span><a href="#106854">av</a></span>))
    }
    <span class="typed"><span class="type">Unit</span><span >{</span></span>}
  } <span class="comment">// entityDecl</span>

  <span class="comment">/** 'N' notationDecl ::= &quot;OTATION&quot;
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="44371">notationDecl</a></span>() {
    <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;OTATION&quot;</a></span>)
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106940">notat</a></span> = <span class="typed"><span class="type">=&gt; String</span><a href="#44356">xName</a></span>
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a id="106941">extID</a></span> = <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('S')</span><span class="char">'S'</span></span>) {
      <span class="typed"><span class="type">()scala.xml.dtd.ExternalID</span><a href="#44352">externalID</a></span>();
    }
    <span class="keyword">else</span> <span class="typed"><span class="type">scala.xml.dtd.PublicID</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('P')</span><span class="char">'P'</span></span>) {
      <span class="comment">/** PublicID (without system, only used in NOTATION) */</span>
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
      <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#44340">xToken</a></span>(<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;UBLIC&quot;</a></span>)
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44359">xSpace</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106951">pubID</a></span> = <span class="typed"><span class="type">()String</span><a href="#44363">pubidLiteral</a></span>()
      <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
      <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106952">sysID</a></span> = <span class="typed"><span class="type">String</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#44319">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
        <span class="typed"><span class="type">()String</span><a href="#44362">systemLiteral</a></span>()
      <span class="keyword">else</span>
        <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>;
      <span class="typed"><span class="type">scala.xml.dtd.PublicID</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.xml.dtd.PublicID</span><a href="../dtd/ExternalID.scala.html#9746">PublicID</a></span>(<span class="typed"><span class="type">String</span><a href="#106951">pubID</a></span>, <span class="typed"><span class="type">String</span><a href="#106952">sysID</a></span>);
    } <span class="keyword">else</span> {
      <span class="typed"><span class="type">(String)Unit</span><a href="#44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;PUBLIC or SYSTEM expected&quot;)</span><span class="string">&quot;PUBLIC or SYSTEM expected&quot;</span></span>);
      <span class="typed"><span class="type">(String)Nothing</span><a href="../../Predef.scala.html#13358">error</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;died parsing notationdecl&quot;)</span><span class="string">&quot;died parsing notationdecl&quot;</span></span>)
    }
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44358">xSpaceOpt</a></span>
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44339">xToken</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
    <span class="typed"><span class="type">=&gt; scala.xml.parsing.MarkupHandler</span><a href="#44305">handle</a></span>.<span class="typed"><span class="type">(String,scala.xml.dtd.ExternalID)Unit</span><a href="MarkupHandler.scala.html#44407">notationDecl</a></span>(<span class="typed"><span class="type">String</span><a href="#106940">notat</a></span>, <span class="typed"><span class="type">scala.xml.dtd.ExternalID</span><a href="#106941">extID</a></span>)
  }

  <span class="comment">/**
   * report a syntax error
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Int,String)Unit</span><a id="44372">reportSyntaxError</a></span>(<span class="typed"><span class="type">Int</span><a id="106160">pos</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">String</span><a id="106161">str</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) {
    <span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44302">curInput</a></span>.<span class="typed"><span class="type">(Int,String)Unit</span><a href="../../io/Source.scala.html#22175">reportError</a></span>(<span class="typed"><span class="type">Int</span><a href="#106160">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#106161">str</a></span>)
    <span class="comment">//error(&quot;MarkupParser::synerr&quot;) // DEBUG</span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="44373">reportSyntaxError</a></span>(<span class="typed"><span class="type">String</span><a id="106163">str</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = <span class="typed"><span class="type">(Int,String)Unit</span><a href="#44372">reportSyntaxError</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#44310">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#106163">str</a></span>)

  <span class="comment">/**
   * report a syntax error
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Int,String)Unit</span><a id="44374">reportValidationError</a></span>(<span class="typed"><span class="type">Int</span><a id="106968">pos</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">String</span><a id="106969">str</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) {
    <span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44302">curInput</a></span>.<span class="typed"><span class="type">(Int,String)Unit</span><a href="../../io/Source.scala.html#22175">reportError</a></span>(<span class="typed"><span class="type">Int</span><a href="#106968">pos</a></span>, <span class="typed"><span class="type">String</span><a href="#106969">str</a></span>)
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="44375">push</a></span>(<span class="typed"><span class="type">String</span><a id="106639">entityName</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) {
    <span class="comment">//Console.println(&quot;BEFORE PUSHING  &quot;+ch)</span>
    <span class="comment">//Console.println(&quot;BEFORE PUSHING  &quot;+pos)</span>
    <span class="comment">//Console.print(&quot;[PUSHING &quot;+entityName+&quot;]&quot;)</span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">=&gt; Boolean</span><a href="#44330">eof</a></span>)
      <span class="typed"><span class="type">(List[scala.io.Source])Unit</span><a href="#44308">inpStack</a></span> = <span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44302">curInput</a></span> <span class="typed"><span class="type">(scala.io.Source)List[scala.io.Source]</span><a href="../../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">=&gt; List[scala.io.Source]</span><a href="#44307">inpStack</a></span>

    <span class="typed"><span class="type">(scala.io.Source)Unit</span><a href="#44303">curInput</a></span> = <span class="typed"><span class="type">(String)scala.io.Source</span><a href="MarkupHandler.scala.html#44393">replacementText</a></span>(<span class="typed"><span class="type">String</span><a href="#106639">entityName</a></span>)
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
  }

  <span class="comment">/*
  def push(src:Source) = {
    curInput = src
    nextch
  }
  */</span>

  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="44376">pushExternal</a></span>(<span class="typed"><span class="type">String</span><a id="106679">systemId</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) {
    <span class="comment">//Console.print(&quot;BEFORE PUSH, curInput = $&quot;+curInput.descr)</span>
    <span class="comment">//Console.println(&quot; stack = &quot;+inpStack.map { x =&gt; &quot;$&quot;+x.descr })</span>

    <span class="comment">//Console.print(&quot;[PUSHING EXTERNAL &quot;+systemId+&quot;]&quot;)</span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">=&gt; Boolean</span><a href="#44330">eof</a></span>)
      <span class="typed"><span class="type">(List[scala.io.Source])Unit</span><a href="#44308">inpStack</a></span> = <span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44302">curInput</a></span> <span class="typed"><span class="type">(scala.io.Source)List[scala.io.Source]</span><a href="../../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">=&gt; List[scala.io.Source]</span><a href="#44307">inpStack</a></span>

    <span class="typed"><span class="type">(scala.io.Source)Unit</span><a href="#44303">curInput</a></span> = <span class="typed"><span class="type">(String)scala.io.Source</span><a href="#44301">externalSource</a></span>(<span class="typed"><span class="type">String</span><a href="#106679">systemId</a></span>)

    <span class="comment">//Console.print(&quot;AFTER PUSH, curInput = $&quot;+curInput.descr)</span>
    <span class="comment">//Console.println(&quot; stack = &quot;+inpStack.map { x =&gt; &quot;$&quot;+x.descr })</span>

    <span class="typed"><span class="type">=&gt; Unit</span><a href="#44338">nextch</a></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="44377">pop</a></span>() {
    <span class="typed"><span class="type">(scala.io.Source)Unit</span><a href="#44303">curInput</a></span> = <span class="typed"><span class="type">=&gt; List[scala.io.Source]</span><a href="#44307">inpStack</a></span>.<span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="../../List.scala.html#20869">head</a></span>
    <span class="typed"><span class="type">(List[scala.io.Source])Unit</span><a href="#44308">inpStack</a></span> = <span class="typed"><span class="type">=&gt; List[scala.io.Source]</span><a href="#44307">inpStack</a></span>.<span class="typed"><span class="type">=&gt; List[scala.io.Source]</span><a href="../../List.scala.html#20871">tail</a></span>
    <span class="typed"><span class="type">(Char)Unit</span><a href="#44320">ch</a></span> = <span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44302">curInput</a></span>.<span class="typed"><span class="type">=&gt; Char</span><a href="../../io/Source.scala.html#22156">ch</a></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#44311">pos</a></span> = <span class="typed"><span class="type">=&gt; scala.io.Source</span><a href="#44302">curInput</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../io/Source.scala.html#22153">pos</a></span>
    <span class="typed"><span class="type">(Boolean)Unit</span><a href="#44331">eof</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span> <span class="comment">// must be false, because of places where entity refs occur</span>
    <span class="comment">//Console.println(&quot;\n AFTER POP, curInput = $&quot;+curInput.descr);</span>
    <span class="comment">//Console.println(inpStack.map { x =&gt; x.descr });</span>
  }

  <span class="comment">/** for the moment, replace only character references 
   *  see spec 3.3.3
   *  precond: cbuf empty
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)String</span><a id="44378">normalizeAttributeValue</a></span>(<span class="typed"><span class="type">String</span><a id="106515">attval</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Seq[Char]</span><a id="106977">s</a></span>: <span class="typed"><span class="type">Seq[Char]</span><a href="../../Seq.scala.html#761">Seq</a></span>[Char] = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518">attval</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Char]</span><a id="106978">it</a></span> = <span class="typed"><span class="type">Seq[Char]</span><a href="#106977">s</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="../../Iterable.scala.html#17309">elements</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#106980" class="keyword">while</a></span> (<span class="typed"><span class="type">Iterator[Char]</span><a href="#106978">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>) {
      <span class="typed"><span class="type">Iterator[Char]</span><a href="#106978">it</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span> <span class="typed"><span class="type">StringBuilder</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char(' ')</span><span class="char">' '</span></span>|<span class="typed"><span class="type">Char('\011')</span><span class="char">'\t'</span></span>|<span class="typed"><span class="type">Char('\012')</span><span class="char">'\n'</span></span>|<span class="typed"><span class="type">Char('\015')</span><span class="char">'\r'</span></span> =&gt; 
          <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char(' ')</span><span class="char">' '</span></span>);
        <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('&amp;')</span><span class="char">'&amp;'</span></span> =&gt; <span class="typed"><span class="type">Iterator[Char]</span><a href="#106978">it</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span> <span class="typed"><span class="type">StringBuilder</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('#')</span><span class="char">'#'</span></span> =&gt;
            <span class="keyword">var</span> <span class="typed"><span class="type">Char</span><a id="106983">c</a></span> = <span class="typed"><span class="type">Iterator[Char]</span><a href="#106978">it</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span>
            <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106984">s</a></span> = <span class="typed"><span class="type">(() =&gt; Char,() =&gt; Unit)String</span><a href="#44347">xCharRef</a></span> ({ () =&gt; <span class="typed"><span class="type">Char</span><a href="#106983">c</a></span> }, { () =&gt; <span class="typed"><span class="type">Char</span><a href="#106983">c</a></span> = <span class="typed"><span class="type">Iterator[Char]</span><a href="#106978">it</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span> })
            <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(String)StringBuilder</span><a href="../../StringBuilder.scala.html#19639">append</a></span>(<span class="typed"><span class="type">String</span><a href="#106984">s</a></span>)
          <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char</span><a id="106989">nchar</a></span> =&gt;
            <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="106990">nbuf</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a href="../../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../../StringBuilder.scala.html#1433">StringBuilder</a></span>()
            <span class="keyword">var</span> <span class="typed"><span class="type">Char</span><a id="106991">d</a></span> = <span class="typed"><span class="type">Char</span><a href="#106989">nchar</a></span>
            <span class="typed"><span class="type">Unit</span><a href="#106992" class="keyword">do</a></span> {
              <span class="typed"><span class="type">StringBuilder</span><a href="#106990">nbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char</span><a href="#106991">d</a></span>)
              <span class="typed"><span class="type">Char</span><a href="#106991">d</a></span> = <span class="typed"><span class="type">Iterator[Char]</span><a href="#106978">it</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span>
            } <span class="keyword">while</span>(<span class="typed"><span class="type">Char</span><a href="#106991">d</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char(';')</span><span class="char">';'</span></span>);
            <span class="typed"><span class="type">StringBuilder</span><a href="#106990">nbuf</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>() <span class="typed"><span class="type">StringBuilder</span><span class="keyword">match</span></span> {
              <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;lt&quot;)</span><span class="string">&quot;lt&quot;</span></span>    =&gt; <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char('&lt;')</span><span class="char">'&lt;'</span></span>)
              <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;gt&quot;)</span><span class="string">&quot;gt&quot;</span></span>    =&gt; <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
              <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;amp&quot;)</span><span class="string">&quot;amp&quot;</span></span>   =&gt; <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char('&amp;')</span><span class="char">'&amp;'</span></span>)
              <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;apos&quot;)</span><span class="string">&quot;apos&quot;</span></span>  =&gt; <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char(''')</span><span class="char">'\''</span></span>)
              <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;quot&quot;)</span><span class="string">&quot;quot&quot;</span></span>  =&gt; <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span>)
              <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.String(&quot;quote&quot;)</span><span class="string">&quot;quote&quot;</span></span> =&gt; <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span>)
              <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">String</span><a id="107012">name</a></span> =&gt;
                <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char('&amp;')</span><span class="char">'&amp;'</span></span>)
                <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(String)StringBuilder</span><a href="../../StringBuilder.scala.html#19639">append</a></span>(<span class="typed"><span class="type">String</span><a href="#107012">name</a></span>)
                <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char(';')</span><span class="char">';'</span></span>)
            }
        }
        <span class="typed"><span class="type">StringBuilder</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char</span><a id="107019">c</a></span> =&gt;
          <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char</span><a href="#107019">c</a></span>)
      }
    }
    <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="106979">name</a></span> = <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>()
    <span class="typed"><span class="type">=&gt; StringBuilder</span><a href="#44322">cbuf</a></span>.<span class="typed"><span class="type">(Int)Unit</span><a href="../../StringBuilder.scala.html#19625">length</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">String</span><a href="#106979">name</a></span>
  }

}

        </pre>
    </body>
</html>