<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/xml/parsing/TokenTests.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |                                         **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: TokenTests.scala 16893 2009-01-13 13:09:22Z cunei $</span>


<span class="keyword">package</span> scala.xml.parsing;


<span class="comment">/**
 * Helper functions for parsing XML fragments
 */</span>
<span class="keyword">trait</span> <span class="typed"><span class="type">trait TokenTests extends java.lang.Object with ScalaObject</span><a id="12609">TokenTests</a></span> {

  <span class="comment">/** (#x20 | #x9 | #xD | #xA) */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Char)Boolean</span><a id="25353">isSpace</a></span>( <span class="typed"><span class="type">Char</span><a id="92097">ch</a></span>:<span class="typed"><span class="type">Char</span><a id="2387">Char</a></span> ): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = <span class="typed"><span class="type">Char</span><a href="#92097">ch</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
    <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('\011')</span><span class="char">'\u0009'</span></span> | <span class="typed"><span class="type">Char('\012')</span><span class="char">'\u000A'</span></span> | <span class="typed"><span class="type">Char('\015')</span><span class="char">'\u000D'</span></span> | <span class="typed"><span class="type">Char(' ')</span><span class="char">'\u0020'</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
    <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> _                                         =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;
  }

  <span class="comment">/** (#x20 | #x9 | #xD | #xA)+ */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Seq[Char])Boolean</span><a id="25354">isSpace</a></span>(<span class="typed"><span class="type">Seq[Char]</span><a id="92096">cs</a></span>: <span class="typed"><span class="type">Seq[Char]</span><a href="../../Seq.scala.html#761">Seq</a></span>[Char]): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Char]</span><a id="103639">it</a></span> = <span class="typed"><span class="type">Seq[Char]</span><a href="#92096">cs</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="../../Iterable.scala.html#17309">elements</a></span>;
    <span class="typed"><span class="type">Iterator[Char]</span><a href="#103639">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Iterator[Char]</span><a href="#103639">it</a></span>.<span class="typed"><span class="type">((Char) =&gt; Boolean)Boolean</span><a href="../../Iterator.scala.html#20002">forall</a></span> { <span class="typed"><span class="type">(Char)Boolean</span><a href="#25353">isSpace</a></span> };
  }

  <span class="comment">/** NameChar ::= Letter | Digit | '.' | '-' | '_' | ':' 
   *             | CombiningChar | Extender
   *
   * see [4] and Appendix B of XML 1.0 specification
  */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Char)Boolean</span><a id="25355">isNameChar</a></span>(<span class="typed"><span class="type">Char</span><a id="84209">ch</a></span>: <span class="typed"><span class="type">Char</span><a id="2387">Char</a></span>) = <span class="typed"><span class="type">(Char)Boolean</span><a href="#25356">isNameStart</a></span>(<span class="typed"><span class="type">Char</span><a href="#84209">ch</a></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> (<span class="typed"><span class="type">Char</span><a href="#84209">ch</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
    <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('.')</span><span class="char">'.'</span></span> | <span class="typed"><span class="type">Char('-')</span><span class="char">'-'</span></span> | <span class="typed"><span class="type">Char(':')</span><span class="char">':'</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;
    <span class="typed"><span class="type">Boolean</span><span class="keyword">case</span></span> _ =&gt; java.lang.<span class="typed"><span class="type">object java.lang.Character</span><a id="1944">Character</a></span>.<span class="typed"><span class="type">(Char)Int</span><a id="18793">getType</a></span>( <span class="typed"><span class="type">Char</span><a href="#84209">ch</a></span> ).<span class="typed"><span class="type">Byte</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">Byte</span><a id="2377">Byte</a></span>] <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> java.lang.Character.<span class="typed"><span class="type">Byte(8)</span><span >COMBINING_SPACING_MARK</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>; <span class="comment">// Mc</span>
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> java.lang.Character.<span class="typed"><span class="type">Byte(7)</span><span >ENCLOSING_MARK</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;         <span class="comment">// Me</span>
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> java.lang.Character.<span class="typed"><span class="type">Byte(6)</span><span >NON_SPACING_MARK</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;       <span class="comment">// Mn</span>
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> java.lang.Character.<span class="typed"><span class="type">Byte(4)</span><span >MODIFIER_LETTER</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;        <span class="comment">// Lm</span>
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> java.lang.Character.<span class="typed"><span class="type">Byte(9)</span><span >DECIMAL_DIGIT_NUMBER</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;   <span class="comment">// Nd</span>
      <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;
    }
  });

  <span class="comment">/** NameStart ::= ( Letter | '_' )
   *  where Letter means in one of the Unicode general 
   *  categories { Ll, Lu, Lo, Lt, Nl }
   *
   *  We do not allow a name to start with ':'.
   *  see [3] and Appendix B of XML 1.0 specification
   */</span> 
  <span class="keyword">def</span> <span class="typed"><span class="type">(Char)Boolean</span><a id="25356">isNameStart</a></span>(<span class="typed"><span class="type">Char</span><a id="84204">ch</a></span>: <span class="typed"><span class="type">Char</span><a id="2387">Char</a></span>) = 
    java.lang.<span class="typed"><span class="type">object java.lang.Character</span><a id="1944">Character</a></span>.<span class="typed"><span class="type">(Char)Int</span><a id="18793">getType</a></span>(<span class="typed"><span class="type">Char</span><a href="#84204">ch</a></span>).<span class="typed"><span class="type">Byte</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">Byte</span><a id="2377">Byte</a></span>] <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> java.lang.Character.<span class="typed"><span class="type">Byte(2)</span><span >LOWERCASE_LETTER</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> java.lang.Character.<span class="typed"><span class="type">Byte(1)</span><span >UPPERCASE_LETTER</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> java.lang.Character.<span class="typed"><span class="type">Byte(5)</span><span >OTHER_LETTER</span></span>     =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> java.lang.Character.<span class="typed"><span class="type">Byte(3)</span><span >TITLECASE_LETTER</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> java.lang.Character.<span class="typed"><span class="type">Byte(10)</span><span >LETTER_NUMBER</span></span>    =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;
      <span class="typed"><span class="type">Boolean</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Char</span><a href="#84204">ch</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('_')</span><span class="char">'_'</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
        <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> _ =&gt; <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;
      }
    }
  
  <span class="comment">/** Name ::= ( Letter | '_' ) (NameChar)*
   *
   *  see  [5] of XML 1.0 specification
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="25357">isName</a></span>(<span class="typed"><span class="type">String</span><a id="34423">s</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span>( <span class="typed"><span class="type">String</span><a href="#34423">s</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>() <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span> ) {
      <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Char]</span><a id="103645">y</a></span>           = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518">s</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="../../RandomAccessSeq.scala.html#17210">elements</a></span>;
      <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="#25356">isNameStart</a></span>(<span class="typed"><span class="type">Iterator[Char]</span><a href="#103645">y</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span>)) {
        <span class="typed"><span class="type">Unit</span><a href="#103654" class="keyword">while</a></span> (<span class="typed"><span class="type">Iterator[Char]</span><a href="#103645">y</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a href="#25355">isNameChar</a></span>(<span class="typed"><span class="type">Iterator[Char]</span><a href="#103645">y</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span>)) <span class="typed"><span class="type">Unit</span><span >{</span></span>};
        <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Iterator[Char]</span><a href="#103645">y</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>
      } <span class="keyword">else</span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;
    } <span class="keyword">else</span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(Char)Boolean</span><a id="25358">isPubIDChar</a></span>(<span class="typed"><span class="type">Char</span><a id="103655">ch</a></span>: <span class="typed"><span class="type">Char</span><a id="2387">Char</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="comment">//Console.println(&quot;char: '&quot; + ch + &quot;'&quot;);</span>
    <span class="typed"><span class="type">Char</span><a href="#103655">ch</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char(' ')</span><span class="char">'\u0020'</span></span> | <span class="typed"><span class="type">Char('\015')</span><span class="char">'\u000D'</span></span> | <span class="typed"><span class="type">Char('\012')</span><span class="char">'\u000A'</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> _ <span class="keyword">if</span>
        ((<span class="typed"><span class="type">Char('0')</span><span class="char">'0'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">Char</span><a href="#103655">ch</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#103655">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">Char('9')</span><span class="char">'9'</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> (<span class="typed"><span class="type">Char('a')</span><span class="char">'a'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">Char</span><a href="#103655">ch</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#103655">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">Char('z')</span><span class="char">'z'</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span>
         (<span class="typed"><span class="type">Char('A')</span><span class="char">'A'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">Char</span><a href="#103655">ch</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#103655">ch</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">Char('Z')</span><span class="char">'Z'</span></span>)) =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('-')</span><span class="char">'-'</span></span> | <span class="typed"><span class="type">Char(''')</span><span class="char">'\''</span></span>| <span class="typed"><span class="type">Char('(')</span><span class="char">'('</span></span> | <span class="typed"><span class="type">Char(')')</span><span class="char">')'</span></span> | <span class="typed"><span class="type">Char('+')</span><span class="char">'+'</span></span> | <span class="typed"><span class="type">Char(',')</span><span class="char">','</span></span> | <span class="typed"><span class="type">Char('.')</span><span class="char">'.'</span></span> |
           <span class="typed"><span class="type">Char('/')</span><span class="char">'/'</span></span> | <span class="typed"><span class="type">Char(':')</span><span class="char">':'</span></span> | <span class="typed"><span class="type">Char('=')</span><span class="char">'='</span></span> | <span class="typed"><span class="type">Char('?')</span><span class="char">'?'</span></span> | <span class="typed"><span class="type">Char(';')</span><span class="char">';'</span></span> | <span class="typed"><span class="type">Char('!')</span><span class="char">'!'</span></span> | <span class="typed"><span class="type">Char('*')</span><span class="char">'*'</span></span> |
           <span class="typed"><span class="type">Char('#')</span><span class="char">'#'</span></span> | <span class="typed"><span class="type">Char('@')</span><span class="char">'@'</span></span> | <span class="typed"><span class="type">Char('$')</span><span class="char">'$'</span></span> | <span class="typed"><span class="type">Char('_')</span><span class="char">'_'</span></span> | <span class="typed"><span class="type">Char('%')</span><span class="char">'%'</span></span> =&gt; <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
      <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">case</span></span> _ =&gt;
        <span class="comment">//Console.println(&quot;false: '&quot; + ch + &quot;'&quot;);</span>
        <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;
    }
  }

  <span class="comment">/**
   * Returns true if the encoding name is a valid IANA encoding.
   * This method does not verify that there is a decoder available
   * for this encoding, only that the characters are valid for an
   * IANA encoding name.
   *
   * @param ianaEncoding The IANA encoding name.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Seq[Char])Boolean</span><a id="25359">isValidIANAEncoding</a></span>(<span class="typed"><span class="type">Seq[Char]</span><a id="103662">ianaEncoding</a></span>: <span class="typed"><span class="type">Seq[Char]</span><a href="../../Seq.scala.html#761">Seq</a></span>[Char]): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Char]</span><a id="103663">it</a></span> = <span class="typed"><span class="type">Seq[Char]</span><a href="#103662">ianaEncoding</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="../../Iterable.scala.html#17309">elements</a></span>;
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Iterator[Char]</span><a href="#103663">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>)
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;
    
    <span class="keyword">var</span> <span class="typed"><span class="type">Char</span><a id="103664">c</a></span> = <span class="typed"><span class="type">Iterator[Char]</span><a href="#103663">it</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span>;
    <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span> ((<span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3021">&gt;=</a></span> <span class="typed"><span class="type">Char('A')</span><span class="char">'A'</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">Char('Z')</span><span class="char">'Z'</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> (<span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3021">&gt;=</a></span> <span class="typed"><span class="type">Char('a')</span><span class="char">'a'</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">Char('z')</span><span class="char">'z'</span></span>)) {
      <span class="typed"><span class="type">Unit</span><a href="#103669" class="keyword">while</a></span> (<span class="typed"><span class="type">Iterator[Char]</span><a href="#103663">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>) {
        <span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> = <span class="typed"><span class="type">Iterator[Char]</span><a href="#103663">it</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span>;
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> ((<span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3018">&lt;</a></span> <span class="typed"><span class="type">Char('A')</span><span class="char">'A'</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> <span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3020">&gt;</a></span> <span class="typed"><span class="type">Char('Z')</span><span class="char">'Z'</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> (<span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3018">&lt;</a></span> <span class="typed"><span class="type">Char('a')</span><span class="char">'a'</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> <span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3020">&gt;</a></span> <span class="typed"><span class="type">Char('z')</span><span class="char">'z'</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span>
            (<span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3018">&lt;</a></span> <span class="typed"><span class="type">Char('0')</span><span class="char">'0'</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> <span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3020">&gt;</a></span> <span class="typed"><span class="type">Char('9')</span><span class="char">'9'</span></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char('.')</span><span class="char">'.'</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char('_')</span><span class="char">'_'</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span>
            <span class="typed"><span class="type">Char</span><a href="#103664">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3017">!=</a></span> <span class="typed"><span class="type">Char('-')</span><span class="char">'-'</span></span>) {
              <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;
            }
      }
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>;
    } <span class="keyword">else</span> 
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>;
  } <span class="comment">// isValidIANAEncoding(String): Boolean</span>
  
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="25360">checkSysID</a></span>( <span class="typed"><span class="type">String</span><a id="25363">s</a></span>:<span class="typed"><span class="type">String</span><a id="1859">String</a></span> ): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="typed"><span class="type">String</span><a href="#25363">s</a></span>.<span class="typed"><span class="type">(Int)Int</span><a id="5842">indexOf</a></span>(<span class="typed"><span class="type">Char('&quot;')</span><span class="char">'&quot;'</span></span>.<span class="typed"><span class="type">Int</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>]) <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> <span class="typed"><span class="type">String</span><a href="#25363">s</a></span>.<span class="typed"><span class="type">(Int)Int</span><a id="5842">indexOf</a></span>(<span class="typed"><span class="type">Char(''')</span><span class="char">'\''</span></span>.<span class="typed"><span class="type">Int</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>]) <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span> 
  }
    
  <span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="25361">checkPubID</a></span>(<span class="typed"><span class="type">String</span><a id="25441">s</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="comment">//Console.println(&quot;checkPubID of \&quot;&quot;+s+&quot;\&quot;&quot;);</span>
    <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#25441">s</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>() <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Char]</span><a id="103691">y</a></span> = <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518">s</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="../../RandomAccessSeq.scala.html#17210">elements</a></span>;
      <span class="keyword">var</span> <span class="typed"><span class="type">Char</span><a id="103692">c</a></span> = <span class="typed"><span class="type">Char(' ')</span><span class="char">' '</span></span>;
      <span class="typed"><span class="type">Unit</span><a href="#103693" class="keyword">while</a></span> (<span class="typed"><span class="type">Iterator[Char]</span><a href="#103691">y</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a href="#25358">isPubIDChar</a></span>(<span class="typed"><span class="type">Char</span><a href="#103692">c</a></span>)) { 
        <span class="comment">//Console.println(c);</span>
        <span class="typed"><span class="type">Char</span><a href="#103692">c</a></span> = <span class="typed"><span class="type">Iterator[Char]</span><a href="#103691">y</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span>
      };
      <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Iterator[Char]</span><a href="#103691">y</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>
    }
    <span class="keyword">else</span>
      <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
  }

}

        </pre>
    </body>
</html>