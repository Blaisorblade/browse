<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/xml/PrettyPrinter.scala</title>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: PrettyPrinter.scala 16893 2009-01-13 13:09:22Z cunei $</span>


<span class="keyword">package</span> scala.xml

<span class="keyword">import</span> scala.collection.Map

<span class="comment">/** Class for pretty printing. After instantiating, you can use the
 *  toPrettyXML methods to convert XML to a formatted string. The class 
 *  can be reused to pretty print any number of XML nodes.
 *
 *  @author  Burak Emir
 *  @version 1.0
 *
 *  @param width the width to fit the output into
 *  @step  indentation
 */</span>
<span class="keyword">class</span> <span class="typed"><span class="type">class PrettyPrinter extends java.lang.Object with ScalaObject</span><a id="7372">PrettyPrinter</a></span>( <span class="typed"><span class="type">Int</span><span id="47650"><a id="47693">width</a></span></span>:<span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">Int</span><span id="47651"><a id="47694">step</a></span></span>:<span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> ) {

  <span class="keyword">class</span> <span class="typed"><span class="type">class BrokenException extends java.lang.Exception with ScalaObject</span><a id="47653">BrokenException</a></span>() <span class="keyword">extends</span> java.lang.<span class="typed"><span class="type">java.lang.Exception</span><a id="2129">Exception</a></span>

  <span class="keyword">class</span> <span class="typed"><span class="type">class Item extends java.lang.Object with ScalaObject</span><a id="47654">Item</a></span>
  <span class="keyword">case</span> <span class="keyword">object</span> <span class="typed"><span class="type">object PrettyPrinter.this.Break</span><span id="19891"><span id="47655"><span id="47711"><span id="47713"><span id="47708"><span id="47709"><span id="3498"><a id="47710">Break</a></span></span></span></span></span></span></span></span> <span class="keyword">extends</span> <span class="typed"><span class="type">PrettyPrinter.this.Item</span><a href="#47654">Item</a></span> {
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()java.lang.String</span><a id="47705">toString</a></span>() = <span class="typed"><span class="type">java.lang.String(&quot;\&quot;)</span><span class="string">&quot;\\&quot;</span></span>
  }
  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Box extends PrettyPrinter.this.Item with ScalaObject with Product</span><span id="47733"><span id="47743"><span id="47726"><span id="47732"><span id="47738"><span id="47727"><span id="47744"><span id="2748"><span id="2749"><span id="47739"><span id="47731"><span id="5792"><span id="47742"><span id="19891"><span id="47729"><span id="3139"><span id="3507"><span id="47745"><span id="47658"><span id="3499"><span id="47728"><span id="47657"><a href="../runtime/ScalaRunTime.scala.html#19785" id="3498">Box</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">Int</span><span id="47717"><span id="47716"><span id="47724"><a id="47784">col</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">String</span><span id="47719"><span id="47718"><span id="47725"><a id="47785">s</a></span></span></span></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">PrettyPrinter.this.Item</span><a href="#47654">Item</a></span>
  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Para extends PrettyPrinter.this.Item with ScalaObject with Product</span><span id="47761"><span id="47660"><span id="47755"><span id="47769"><span id="47764"><span id="2749"><span id="2748"><span id="47760"><span id="5792"><span id="47661"><span id="47754"><span id="19891"><span id="47766"><span id="3507"><span id="47768"><span id="47759"><span id="47756"><span id="3499"><span id="47757"><span id="3498"><a href="../runtime/ScalaRunTime.scala.html#19785" id="47767">Para</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">String</span><span id="47749"><span id="47748"><span id="47753"><a id="47897">s</a></span></span></span></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">PrettyPrinter.this.Item</span><a href="#47654">Item</a></span>

  <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">List[PrettyPrinter.this.Item]</span><span id="47665"><span id="47663"><span id="47664"><a id="47691">items</a></span></span></span></span>: <span class="typed"><span class="type">List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#524">List</a></span>[Item] = <span class="typed"><span class="type">object Nil</span><a href="../List.scala.html#333">Nil</a></span>

  <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="47668"><span id="47666"><span id="47667"><a id="47692">cur</a></span></span></span></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
  <span class="comment">//protected var pmap:Map[String,String] = _</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="47669">reset</a></span>() = {
    <span class="typed"><span class="type">(Int)Unit</span><a href="#47667">cur</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">(List[PrettyPrinter.this.Item])Unit</span><a href="#47664">items</a></span> = <span class="typed"><span class="type">object Nil</span><a href="../List.scala.html#333">Nil</a></span>
  }

  <span class="comment">/** Try to cut at whitespace.
   *
   *  @param s   ...
   *  @param ind ...
   *  @return    ...
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String,Int)List[PrettyPrinter.this.Item]</span><a id="47670">cut</a></span>(<span class="typed"><span class="type">String</span><a id="47772">s</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>, <span class="typed"><span class="type">Int</span><a id="47773">ind</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>): <span class="typed"><span class="type">List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#524">List</a></span>[Item] = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="47774">tmp</a></span> = <span class="typed"><span class="type">Int</span><a href="#47650">width</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#47666">cur</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#47772">s</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#47774">tmp</a></span>)
      <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">(PrettyPrinter.this.Box*)List[PrettyPrinter.this.Box]</span><a href="../List.scala.html#16977">List</a></span>(<span class="typed"><span class="type">(Int,String)PrettyPrinter.this.Box</span><a href="#47731">Box</a></span>(<span class="typed"><span class="type">Int</span><a href="#47773">ind</a></span>, <span class="typed"><span class="type">String</span><a href="#47772">s</a></span>))
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="47775">sb</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a href="../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../StringBuilder.scala.html#1433">StringBuilder</a></span>()
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="47776">i</a></span> = <span class="typed"><span class="type">String</span><a href="#47772">s</a></span>.<span class="typed"><span class="type">(Int)Int</span><a id="5842">indexOf</a></span>(<span class="typed"><span class="type">Int(32)</span><span class="char">' '</span></span>)
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#47776">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int</span><a href="#47774">tmp</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> <span class="typed"><span class="type">Int</span><a href="#47776">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">PrettyPrinter.this.BrokenException</span><span class="keyword">new</span></span> <span class="typed"><span class="type">PrettyPrinter.this.BrokenException</span><a href="#47653">BrokenException</a></span>() <span class="comment">// cannot break</span>

    <span class="keyword">var</span> <span class="typed"><span class="type">List[Int]</span><a id="47777">last</a></span>: <span class="typed"><span class="type">List[Int]</span><a href="../List.scala.html#524">List</a></span>[Int] = <span class="typed"><span class="type">object Nil</span><a href="../List.scala.html#333">Nil</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#47779" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#47776">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3140">!=</a></span> -<span class="typed"><span class="type">Int(-1)</span><span class="int">1</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Int</span><a href="#47776">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#47774">tmp</a></span>) {
      <span class="typed"><span class="type">List[Int]</span><a href="#47777">last</a></span> = <span class="typed"><span class="type">Int</span><a href="#47776">i</a></span><span class="typed"><span class="type">(Int)List[Int]</span><a href="../List.scala.html#20872">::</a></span><span class="typed"><span class="type">List[Int]</span><a href="#47777">last</a></span>
      <span class="typed"><span class="type">Int</span><a href="#47776">i</a></span> = <span class="typed"><span class="type">String</span><a href="#47772">s</a></span>.<span class="typed"><span class="type">(Int,Int)Int</span><a id="5843">indexOf</a></span>(<span class="typed"><span class="type">Int(32)</span><span class="char">' '</span></span>, <span class="typed"><span class="type">Int</span><a href="#47776">i</a></span><span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span><span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
    }
    <span class="keyword">var</span> <span class="typed"><span class="type">List[PrettyPrinter.this.Item]</span><a id="47778">res</a></span>: <span class="typed"><span class="type">List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#524">List</a></span>[Item] = <span class="typed"><span class="type">object Nil</span><a href="../List.scala.html#333">Nil</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#47780" class="keyword">while</a></span> (<span class="typed"><span class="type">object Nil</span><a href="../List.scala.html#333">Nil</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">List[Int]</span><a href="#47777">last</a></span>) <span class="keyword">try</span> {
      <span class="keyword">val</span> <span class="typed"><span class="type">PrettyPrinter.this.Box</span><a id="47824">b</a></span> = <span class="typed"><span class="type">(Int,String)PrettyPrinter.this.Box</span><a href="#47731">Box</a></span>(<span class="typed"><span class="type">Int</span><a href="#47773">ind</a></span>, <span class="typed"><span class="type">String</span><a href="#47772">s</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="typed"><span class="type">List[Int]</span><a href="#47777">last</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../List.scala.html#20869">head</a></span>))
      <span class="typed"><span class="type">(Int)Unit</span><a href="#47667">cur</a></span> = <span class="typed"><span class="type">Int</span><a href="#47773">ind</a></span>
      <span class="typed"><span class="type">List[PrettyPrinter.this.Item]</span><a href="#47778">res</a></span> = <span class="typed"><span class="type">PrettyPrinter.this.Box</span><a href="#47824">b</a></span> <span class="typed"><span class="type">(PrettyPrinter.this.Item)List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">object PrettyPrinter.this.Break</span><a href="#47655">Break</a></span> <span class="typed"><span class="type">(PrettyPrinter.this.Item)List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">(String,Int)List[PrettyPrinter.this.Item]</span><a href="#47670">cut</a></span>(<span class="typed"><span class="type">String</span><a href="#47772">s</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">List[Int]</span><a href="#47777">last</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../List.scala.html#20869">head</a></span>, <span class="typed"><span class="type">String</span><a href="#47772">s</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>), <span class="typed"><span class="type">Int</span><a href="#47773">ind</a></span>)
       <span class="comment">// backtrack</span>
      <span class="typed"><span class="type">List[Int]</span><a href="#47777">last</a></span> = <span class="typed"><span class="type">List[Int]</span><a href="#47777">last</a></span>.<span class="typed"><span class="type">=&gt; List[Int]</span><a href="../List.scala.html#20871">tail</a></span>
    } <span class="keyword">catch</span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _:<span class="typed"><span class="type">PrettyPrinter.this.BrokenException</span><a href="#47653">BrokenException</a></span> =&gt; <span class="typed"><span class="type">List[Int]</span><a href="#47777">last</a></span> = <span class="typed"><span class="type">List[Int]</span><a href="#47777">last</a></span>.<span class="typed"><span class="type">=&gt; List[Int]</span><a href="../List.scala.html#20871">tail</a></span>
    }
    <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">PrettyPrinter.this.BrokenException</span><span class="keyword">new</span></span> <span class="typed"><span class="type">PrettyPrinter.this.BrokenException</span><a href="#47653">BrokenException</a></span>()
  }

  <span class="comment">/** Try to make indented box, if possible, else para.
   *
   *  @param ind ...
   *  @param s   ...
   *  @return    ...
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int,String)Unit</span><a id="47671">makeBox</a></span>(<span class="typed"><span class="type">Int</span><a id="47845">ind</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">String</span><a id="47846">s</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) = {
    <span class="typed"><span class="type">AnyVal with NotNull</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#47666">cur</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#47845">ind</a></span>)
      <span class="typed"><span class="type">=&gt; Int</span><a href="#47666">cur</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">Int</span><a href="#47845">ind</a></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#47666">cur</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">String</span><a href="#47846">s</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int</span><a href="#47650">width</a></span>) {            <span class="comment">// fits in this line</span>
      <span class="typed"><span class="type">(List[PrettyPrinter.this.Item])Unit</span><a href="#47664">items</a></span> = <span class="typed"><span class="type">(Int,String)PrettyPrinter.this.Box</span><a href="#47731">Box</a></span>(<span class="typed"><span class="type">Int</span><a href="#47845">ind</a></span>, <span class="typed"><span class="type">String</span><a href="#47846">s</a></span>) <span class="typed"><span class="type">(PrettyPrinter.this.Item)List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">=&gt; List[PrettyPrinter.this.Item]</span><a href="#47663">items</a></span>
      <span class="typed"><span class="type">(Int)Unit</span><a href="#47667">cur</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">String</span><a href="#47846">s</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>
    } <span class="keyword">else</span> <span class="keyword">try</span> {
      <span class="keyword">for</span> (<span class="typed"><span class="type">((PrettyPrinter.this.Item) =&gt; Unit)Unit</span><a href="../Iterator.scala.html#20001" id="47888">b</a></span> &lt;- <span class="typed"><span class="type">(String,Int)List[PrettyPrinter.this.Item]</span><a href="#47670">cut</a></span>(<span class="typed"><span class="type">String</span><a href="#47846">s</a></span>, <span class="typed"><span class="type">Int</span><a href="#47845">ind</a></span>).<span class="typed"><span class="type">=&gt; Iterator[PrettyPrinter.this.Item]</span><a href="../List.scala.html#20889">elements</a></span>)  <span class="comment">// break it up</span>
        <span class="typed"><span class="type">(List[PrettyPrinter.this.Item])Unit</span><a href="#47664">items</a></span> = <span class="typed"><span class="type">PrettyPrinter.this.Item</span><a href="#47888">b</a></span> <span class="typed"><span class="type">(PrettyPrinter.this.Item)List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">=&gt; List[PrettyPrinter.this.Item]</span><a href="#47663">items</a></span>
    } <span class="keyword">catch</span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _:<span class="typed"><span class="type">PrettyPrinter.this.BrokenException</span><a href="#47653">BrokenException</a></span> =&gt; <span class="typed"><span class="type">(Int,String)Unit</span><a href="#47672">makePara</a></span>(<span class="typed"><span class="type">Int</span><a href="#47845">ind</a></span>, <span class="typed"><span class="type">String</span><a href="#47846">s</a></span>) <span class="comment">// give up, para</span>
    }
  }

  <span class="comment">// dont respect indent in para, but afterwards</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int,String)Unit</span><a id="47672">makePara</a></span>(<span class="typed"><span class="type">Int</span><a id="47892">ind</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">String</span><a id="47893">s</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) = {
    <span class="typed"><span class="type">(List[PrettyPrinter.this.Item])Unit</span><a href="#47664">items</a></span> = <span class="typed"><span class="type">object PrettyPrinter.this.Break</span><a href="#47655">Break</a></span><span class="typed"><span class="type">(PrettyPrinter.this.Item)List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#20872">::</a></span><span class="typed"><span class="type">(String)PrettyPrinter.this.Para</span><a href="#47759">Para</a></span>(<span class="typed"><span class="type">String</span><a href="#47893">s</a></span>)<span class="typed"><span class="type">(PrettyPrinter.this.Item)List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#20872">::</a></span><span class="typed"><span class="type">object PrettyPrinter.this.Break</span><a href="#47655">Break</a></span><span class="typed"><span class="type">(PrettyPrinter.this.Item)List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#20872">::</a></span><span class="typed"><span class="type">=&gt; List[PrettyPrinter.this.Item]</span><a href="#47663">items</a></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#47667">cur</a></span> = <span class="typed"><span class="type">Int</span><a href="#47892">ind</a></span>
  }

  <span class="comment">// respect indent</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="47673">makeBreak</a></span>() = { <span class="comment">// using wrapping here...</span>
    <span class="typed"><span class="type">(List[PrettyPrinter.this.Item])Unit</span><a href="#47664">items</a></span> = <span class="typed"><span class="type">object PrettyPrinter.this.Break</span><a href="#47655">Break</a></span> <span class="typed"><span class="type">(PrettyPrinter.this.Item)List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">=&gt; List[PrettyPrinter.this.Item]</span><a href="#47663">items</a></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#47667">cur</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
  }

  <span class="comment">/**
   *  @param n ...
   *  @return  ...
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.Node)String</span><a id="47674">leafTag</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a id="47909">n</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="Node.scala.html#7174">Node</a></span>) = {
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="47911">sb</a></span> = <span class="typed"><span class="type">(String)StringBuilder</span><a href="../StringBuilder.scala.html#19622" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../StringBuilder.scala.html#1433">StringBuilder</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt;&quot;)</span><span class="string">&quot;&lt;&quot;</span></span>)
    <span class="typed"><span class="type">scala.xml.Node</span><a href="#47909">n</a></span>.<span class="typed"><span class="type">(StringBuilder)StringBuilder</span><a href="Node.scala.html#19960">nameToString</a></span>(<span class="typed"><span class="type">StringBuilder</span><a href="#47911">sb</a></span>)
    <span class="comment">//Utility.appendPrefixedName( n.prefix, n.label, pmap, sb );</span>
    <span class="typed"><span class="type">scala.xml.Node</span><a href="#47909">n</a></span>.<span class="typed"><span class="type">=&gt; scala.xml.MetaData</span><a href="Node.scala.html#19951">attributes</a></span>.<span class="typed"><span class="type">(StringBuilder)StringBuilder</span><a href="MetaData.scala.html#25485">toString</a></span>(<span class="typed"><span class="type">StringBuilder</span><a href="#47911">sb</a></span>)
    <span class="comment">//Utility.attr2xml( n.scope, n.attributes, pmap, sb );</span>
    <span class="typed"><span class="type">StringBuilder</span><a href="#47911">sb</a></span>.<span class="typed"><span class="type">(String)StringBuilder</span><a href="../StringBuilder.scala.html#19639">append</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;/&gt;&quot;)</span><span class="string">&quot;/&gt;&quot;</span></span>)
    <span class="typed"><span class="type">StringBuilder</span><a href="#47911">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../StringBuilder.scala.html#19672">toString</a></span>()
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding)(String, Int)</span><a id="47675">startTag</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a id="47920">n</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="Node.scala.html#7174">Node</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="47921">pscope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>): <span class="typed"><span class="type">(String, Int)</span><a href="../Tuple2.scala.html#1376">(</a></span>String, Int) = {
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="47922">sb</a></span> = <span class="typed"><span class="type">(String)StringBuilder</span><a href="../StringBuilder.scala.html#19622" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../StringBuilder.scala.html#1433">StringBuilder</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt;&quot;)</span><span class="string">&quot;&lt;&quot;</span></span>)
    <span class="typed"><span class="type">scala.xml.Node</span><a href="#47920">n</a></span>.<span class="typed"><span class="type">(StringBuilder)StringBuilder</span><a href="Node.scala.html#19960">nameToString</a></span>(<span class="typed"><span class="type">StringBuilder</span><a href="#47922">sb</a></span>) <span class="comment">//Utility.appendPrefixedName( n.prefix, n.label, pmap, sb );</span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="47923">i</a></span> = <span class="typed"><span class="type">StringBuilder</span><a href="#47922">sb</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../StringBuilder.scala.html#19624">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">scala.xml.Node</span><a href="#47920">n</a></span>.<span class="typed"><span class="type">=&gt; scala.xml.MetaData</span><a href="Node.scala.html#19951">attributes</a></span>.<span class="typed"><span class="type">(StringBuilder)StringBuilder</span><a href="MetaData.scala.html#25485">toString</a></span>(<span class="typed"><span class="type">StringBuilder</span><a href="#47922">sb</a></span>)
    <span class="typed"><span class="type">scala.xml.Node</span><a href="#47920">n</a></span>.<span class="typed"><span class="type">=&gt; scala.xml.NamespaceBinding</span><a href="Node.scala.html#19946">scope</a></span>.<span class="typed"><span class="type">(StringBuilder,scala.xml.NamespaceBinding)Unit</span><a href="NamespaceBinding.scala.html#42711">toString</a></span>(<span class="typed"><span class="type">StringBuilder</span><a href="#47922">sb</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#47921">pscope</a></span>)
    <span class="typed"><span class="type">StringBuilder</span><a href="#47922">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
    <span class="typed"><span class="type">(String,Int)(String, Int)</span><a href="../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">StringBuilder</span><a href="#47922">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../StringBuilder.scala.html#19672">toString</a></span>(), <span class="typed"><span class="type">Int</span><a href="#47923">i</a></span>)
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.Node)String</span><a id="47676">endTag</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a id="47942">n</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="Node.scala.html#7174">Node</a></span>) = {
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="47944">sb</a></span> = <span class="typed"><span class="type">(String)StringBuilder</span><a href="../StringBuilder.scala.html#19622" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../StringBuilder.scala.html#1433">StringBuilder</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;&lt;/&quot;)</span><span class="string">&quot;&lt;/&quot;</span></span>)
    <span class="typed"><span class="type">scala.xml.Node</span><a href="#47942">n</a></span>.<span class="typed"><span class="type">(StringBuilder)StringBuilder</span><a href="Node.scala.html#19960">nameToString</a></span>(<span class="typed"><span class="type">StringBuilder</span><a href="#47944">sb</a></span>) <span class="comment">//Utility.appendPrefixedName( n.prefix, n.label, pmap, sb );</span>
    <span class="typed"><span class="type">StringBuilder</span><a href="#47944">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char('&gt;')</span><span class="char">'&gt;'</span></span>)
    <span class="typed"><span class="type">StringBuilder</span><a href="#47944">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../StringBuilder.scala.html#19672">toString</a></span>()
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.Node)Boolean</span><a id="47677">childrenAreLeaves</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a id="47949">n</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="Node.scala.html#7174">Node</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[scala.xml.Node]</span><a id="47950">it</a></span> = <span class="typed"><span class="type">scala.xml.Node</span><a href="#47949">n</a></span>.<span class="typed"><span class="type">=&gt; Seq[scala.xml.Node]</span><a href="Node.scala.html#19952">child</a></span>.<span class="typed"><span class="type">=&gt; Iterator[scala.xml.Node]</span><a href="../Iterable.scala.html#17309">elements</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#47951" class="keyword">while</a></span> (<span class="typed"><span class="type">Iterator[scala.xml.Node]</span><a href="#47950">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../Iterator.scala.html#19975">hasNext</a></span>)
      <span class="typed"><span class="type">Iterator[scala.xml.Node]</span><a href="#47950">it</a></span>.<span class="typed"><span class="type">()scala.xml.Node</span><a href="../Iterator.scala.html#19976">next</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _:<span class="typed"><span class="type">scala.xml.Atom[_]</span><a href="Atom.scala.html#7201">Atom</a></span>[_] | _:<span class="typed"><span class="type">scala.xml.Comment</span><a href="Comment.scala.html#7147">Comment</a></span> | _:<span class="typed"><span class="type">scala.xml.EntityRef</span><a href="EntityRef.scala.html#7255">EntityRef</a></span> | _:<span class="typed"><span class="type">scala.xml.ProcInstr</span><a href="ProcInstr.scala.html#7285">ProcInstr</a></span> =&gt;
        <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> _:<span class="typed"><span class="type">scala.xml.Node</span><a href="Node.scala.html#7174">Node</a></span> =&gt;
          <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
      }
    <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)Boolean</span><a id="47678">fits</a></span>(<span class="typed"><span class="type">String</span><a id="47973">test</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) =
    <span class="typed"><span class="type">String</span><a href="#47973">test</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#47650">width</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#47666">cur</a></span>

  <span class="comment">/** @param tail: what we'd like to sqeeze in */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding,Int)Unit</span><a id="47679">traverse</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a id="47977">node</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="Node.scala.html#7174">Node</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="47978">pscope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>, <span class="typed"><span class="type">Int</span><a id="47979">ind</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> =  <span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {

      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Text</a>(<span class="typed"><span class="type">String</span><a id="47980">s</a></span>) <span class="keyword">if</span> <span class="typed"><span class="type">String</span><a href="#47980">s</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="5868">trim</a></span>() <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span> =&gt;
        ;
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _:<span class="typed"><span class="type">scala.xml.Atom[_]</span><a href="Atom.scala.html#7201">Atom</a></span>[_] | _:<span class="typed"><span class="type">scala.xml.Comment</span><a href="Comment.scala.html#7147">Comment</a></span> | _:<span class="typed"><span class="type">scala.xml.EntityRef</span><a href="EntityRef.scala.html#7255">EntityRef</a></span> | _:<span class="typed"><span class="type">scala.xml.ProcInstr</span><a href="ProcInstr.scala.html#7285">ProcInstr</a></span> =&gt; 
        <span class="typed"><span class="type">(Int,String)Unit</span><a href="#47671">makeBox</a></span>( <span class="typed"><span class="type">Int</span><a href="#47979">ind</a></span>, <span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span>.<span class="typed"><span class="type">()String</span><a href="Node.scala.html#19959">toString</a></span>().<span class="typed"><span class="type">()java.lang.String</span><a id="5868">trim</a></span>() )
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">scala.xml.Group</span><a id="47987">g</a></span> @ <a id="1">Group</a>(<span class="typed"><span class="type">Seq[scala.xml.Node]</span><a id="48007">xs</a></span>) =&gt;
        <span class="typed"><span class="type">(Iterator[scala.xml.Node],scala.xml.NamespaceBinding,Int)Unit</span><a href="#47680">traverse</a></span>(<span class="typed"><span class="type">Seq[scala.xml.Node]</span><a href="#48007">xs</a></span>.<span class="typed"><span class="type">=&gt; Iterator[scala.xml.Node]</span><a href="../Iterable.scala.html#17309">elements</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#47978">pscope</a></span>, <span class="typed"><span class="type">Int</span><a href="#47979">ind</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> _ =&gt;
        <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="48012">test</a></span> = {
          <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="48013">sb</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a href="../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../StringBuilder.scala.html#1433">StringBuilder</a></span>()
          <span class="typed"><span class="type">object scala.xml.Utility</span><a href="Utility.scala.html#7277">Utility</a></span>.<span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding,StringBuilder,Boolean)Unit</span><a href="Utility.scala.html#25381">toXML</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#47978">pscope</a></span>, <span class="typed"><span class="type">StringBuilder</span><a href="#48013">sb</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>)
          <span class="typed"><span class="type">String</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span>.<span class="typed"><span class="type">(String,String)Option[Seq[scala.xml.Node]]</span><a href="Node.scala.html#19950">attribute</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;http://www.w3.org/XML/1998/namespace&quot;)</span><span class="string">&quot;http://www.w3.org/XML/1998/namespace&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;space&quot;)</span><span class="string">&quot;space&quot;</span></span>) <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">java.lang.String(&quot;preserve&quot;)</span><span class="string">&quot;preserve&quot;</span></span>)
            <span class="typed"><span class="type">StringBuilder</span><a href="#48013">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../StringBuilder.scala.html#19672">toString</a></span>()
          <span class="keyword">else</span>
            <span class="typed"><span class="type">object scala.xml.TextBuffer</span><a href="TextBuffer.scala.html#7211">TextBuffer</a></span>.<span class="typed"><span class="type">(String)scala.xml.TextBuffer</span><a href="TextBuffer.scala.html#48041">fromString</a></span>(<span class="typed"><span class="type">StringBuilder</span><a href="#48013">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../StringBuilder.scala.html#19672">toString</a></span>()).<span class="typed"><span class="type">(Int)scala.xml.Text</span><a href="../Function1.scala.html#17300">toText</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>).<span class="typed"><span class="type">=&gt; String</span><a href="Text.scala.html#22635">_data</a></span>
        }
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(scala.xml.Node)Boolean</span><a href="#47677">childrenAreLeaves</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span>) <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">(String)Boolean</span><a href="#47678">fits</a></span>(<span class="typed"><span class="type">String</span><a href="#48012">test</a></span>)) {
          <span class="typed"><span class="type">(Int,String)Unit</span><a href="#47671">makeBox</a></span>(<span class="typed"><span class="type">Int</span><a href="#47979">ind</a></span>, <span class="typed"><span class="type">String</span><a href="#48012">test</a></span>)
        } <span class="keyword">else</span> {
          <span class="keyword">val</span> <span class="typed"><span class="type">(String, Int)</span><a href="../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">String</span><span id="48058"><a href="../Tuple2.scala.html#19161" id="48055">stg</a></span></span>, <span class="typed"><span class="type">Int</span><span id="48059"><a href="../Tuple2.scala.html#19163" id="48056">len2</a></span></span>) = <span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding)(String, Int)</span><a href="#47675">startTag</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#47978">pscope</a></span>)
          <span class="keyword">val</span> <span class="typed"><span class="type">String</span><a id="48057">etg</a></span> = <span class="typed"><span class="type">(scala.xml.Node)String</span><a href="#47676">endTag</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span>)
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">String</span><a href="#48055">stg</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#47650">width</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#47666">cur</a></span>) { <span class="comment">// start tag fits</span>
            <span class="typed"><span class="type">(Int,String)Unit</span><a href="#47671">makeBox</a></span>(<span class="typed"><span class="type">Int</span><a href="#47979">ind</a></span>, <span class="typed"><span class="type">String</span><a href="#48055">stg</a></span>)
            <span class="typed"><span class="type">()Unit</span><a href="#47673">makeBreak</a></span>()
            <span class="typed"><span class="type">(Iterator[scala.xml.Node],scala.xml.NamespaceBinding,Int)Unit</span><a href="#47680">traverse</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span>.<span class="typed"><span class="type">=&gt; Seq[scala.xml.Node]</span><a href="Node.scala.html#19952">child</a></span>.<span class="typed"><span class="type">=&gt; Iterator[scala.xml.Node]</span><a href="../Iterable.scala.html#17309">elements</a></span>, <span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span>.<span class="typed"><span class="type">=&gt; scala.xml.NamespaceBinding</span><a href="Node.scala.html#19946">scope</a></span>, <span class="typed"><span class="type">Int</span><a href="#47979">ind</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int</span><a href="#47651">step</a></span>)
            <span class="typed"><span class="type">(Int,String)Unit</span><a href="#47671">makeBox</a></span>(<span class="typed"><span class="type">Int</span><a href="#47979">ind</a></span>, <span class="typed"><span class="type">String</span><a href="#48057">etg</a></span>)
          } <span class="keyword">else</span> <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#48056">len2</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#47650">width</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#47666">cur</a></span>) {
            <span class="comment">// &lt;start label + attrs + tag + content + end tag</span>
            <span class="typed"><span class="type">(Int,String)Unit</span><a href="#47671">makeBox</a></span>(<span class="typed"><span class="type">Int</span><a href="#47979">ind</a></span>, <span class="typed"><span class="type">String</span><a href="#48055">stg</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>, <span class="typed"><span class="type">Int</span><a href="#48056">len2</a></span>))
            <span class="typed"><span class="type">()Unit</span><a href="#47673">makeBreak</a></span>() <span class="comment">// todo: break the rest in pieces</span>
            <span class="comment">/*{ //@todo
             val sq:Seq[String] = stg.split(&quot; &quot;);
             val it = sq.elements;
             it.next;
             for (c &lt;- it) {
               makeBox(ind+len2-2, c)
               makeBreak()
             }
             }*/</span>
            <span class="typed"><span class="type">(Int,String)Unit</span><a href="#47671">makeBox</a></span>(<span class="typed"><span class="type">Int</span><a href="#47979">ind</a></span>, <span class="typed"><span class="type">String</span><a href="#48055">stg</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.String</span><a id="5853">substring</a></span>(<span class="typed"><span class="type">Int</span><a href="#48056">len2</a></span>, <span class="typed"><span class="type">String</span><a href="#48055">stg</a></span>.<span class="typed"><span class="type">()Int</span><a id="5819">length</a></span>))
            <span class="typed"><span class="type">()Unit</span><a href="#47673">makeBreak</a></span>()
            <span class="typed"><span class="type">(Iterator[scala.xml.Node],scala.xml.NamespaceBinding,Int)Unit</span><a href="#47680">traverse</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span>.<span class="typed"><span class="type">=&gt; Seq[scala.xml.Node]</span><a href="Node.scala.html#19952">child</a></span>.<span class="typed"><span class="type">=&gt; Iterator[scala.xml.Node]</span><a href="../Iterable.scala.html#17309">elements</a></span>, <span class="typed"><span class="type">scala.xml.Node</span><a href="#47977">node</a></span>.<span class="typed"><span class="type">=&gt; scala.xml.NamespaceBinding</span><a href="Node.scala.html#19946">scope</a></span>, <span class="typed"><span class="type">Int</span><a href="#47979">ind</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int</span><a href="#47651">step</a></span>)
            <span class="typed"><span class="type">(Int,String)Unit</span><a href="#47671">makeBox</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#47666">cur</a></span>, <span class="typed"><span class="type">String</span><a href="#48057">etg</a></span>)
            <span class="typed"><span class="type">()Unit</span><a href="#47673">makeBreak</a></span>()
          } <span class="keyword">else</span> { <span class="comment">// give up</span>
            <span class="typed"><span class="type">(Int,String)Unit</span><a href="#47671">makeBox</a></span>(<span class="typed"><span class="type">Int</span><a href="#47979">ind</a></span>, <span class="typed"><span class="type">String</span><a href="#48012">test</a></span>)
            <span class="typed"><span class="type">()Unit</span><a href="#47673">makeBreak</a></span>()
          }
        }
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Iterator[scala.xml.Node],scala.xml.NamespaceBinding,Int)Unit</span><a id="47680">traverse</a></span>(<span class="typed"><span class="type">Iterator[scala.xml.Node]</span><a id="48009">it</a></span>: <span class="typed"><span class="type">Iterator[scala.xml.Node]</span><a href="../Iterator.scala.html#1337">Iterator</a></span>[Node], <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="48010">scope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>, <span class="typed"><span class="type">Int</span><a id="48011">ind</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> ): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> =
    <span class="keyword">for</span> (<span class="typed"><span class="type">((scala.xml.Node) =&gt; Unit)Unit</span><a href="../Iterator.scala.html#20001" id="48085">c</a></span> &lt;- <span class="typed"><span class="type">Iterator[scala.xml.Node]</span><a href="#48009">it</a></span>) {
      <span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding,Int)Unit</span><a href="#47679">traverse</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#48085">c</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#48010">scope</a></span>, <span class="typed"><span class="type">Int</span><a href="#48011">ind</a></span>)
      <span class="typed"><span class="type">()Unit</span><a href="#47673">makeBreak</a></span>()
    }

  <span class="comment">/** Appends a formatted string containing well-formed XML with
   *  given namespace to prefix mapping to the given string buffer.
   *
   * @param n    the node to be serialized
   * @param pmap the namespace to prefix mapping
   * @param sb   the stringbuffer to append to
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.Node,StringBuilder)Unit</span><a id="47681">format</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a id="48087">n</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="Node.scala.html#7174">Node</a></span>, <span class="typed"><span class="type">StringBuilder</span><a id="48088">sb</a></span>: <span class="typed"><span class="type">StringBuilder</span><a href="../StringBuilder.scala.html#1433">StringBuilder</a></span> ): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = <span class="comment">// entry point</span>
    <span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding,StringBuilder)Unit</span><a href="#47682">format</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#48087">n</a></span>, <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>, <span class="typed"><span class="type">StringBuilder</span><a href="#48088">sb</a></span>)

  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding,StringBuilder)Unit</span><a id="47682">format</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a id="48105">n</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="Node.scala.html#7174">Node</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="48106">pscope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>, <span class="typed"><span class="type">StringBuilder</span><a id="48107">sb</a></span>: <span class="typed"><span class="type">StringBuilder</span><a href="../StringBuilder.scala.html#1433">StringBuilder</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = { <span class="comment">// entry point</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><a id="48108">lastwasbreak</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
    <span class="typed"><span class="type">()Unit</span><a href="#47669">reset</a></span>()
    <span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding,Int)Unit</span><a href="#47679">traverse</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#48105">n</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#48106">pscope</a></span>, <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="48109">cur</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="keyword">for</span> (<span class="typed"><span class="type">((PrettyPrinter.this.Item) =&gt; Unit)Unit</span><a href="../List.scala.html#20910" id="48115">b</a></span> &lt;- <span class="typed"><span class="type">=&gt; List[PrettyPrinter.this.Item]</span><a href="#47663">items</a></span>.<span class="typed"><span class="type">=&gt; List[PrettyPrinter.this.Item]</span><a href="../List.scala.html#20934">reverse</a></span>) <span class="typed"><span class="type">PrettyPrinter.this.Item</span><a href="#48115">b</a></span> <span class="typed"><span class="type">Unit</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object PrettyPrinter.this.Break</span><a href="#47655">Break</a></span> =&gt;
        <span class="typed"><span class="type">Any</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Boolean</span><a href="#48108">lastwasbreak</a></span>) <span class="typed"><span class="type">StringBuilder</span><a href="#48107">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char('\012')</span><span class="char">'\n'</span></span>)  <span class="comment">// on windows: \r\n ?</span>
        <span class="typed"><span class="type">Boolean</span><a href="#48108">lastwasbreak</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
        <span class="typed"><span class="type">Int</span><a href="#48109">cur</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
<span class="comment">//        while( cur &lt; last ) {</span>
<span class="comment">//          sb.append(' '); </span>
<span class="comment">//          cur = cur + 1; </span>
<span class="comment">//        }</span>

      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Box</a>(<span class="typed"><span class="type">Int</span><a id="48124">i</a></span>, <span class="typed"><span class="type">String</span><a id="48125">s</a></span>) =&gt;
        <span class="typed"><span class="type">Boolean</span><a href="#48108">lastwasbreak</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
        <span class="typed"><span class="type">Unit</span><a href="#48126" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#48109">cur</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#48124">i</a></span>) {
          <span class="typed"><span class="type">StringBuilder</span><a href="#48107">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">Char(' ')</span><span class="char">' '</span></span>)
          <span class="typed"><span class="type">Int</span><a href="#48109">cur</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        }
        <span class="typed"><span class="type">StringBuilder</span><a href="#48107">sb</a></span>.<span class="typed"><span class="type">(String)StringBuilder</span><a href="../StringBuilder.scala.html#19639">append</a></span>(<span class="typed"><span class="type">String</span><a href="#48125">s</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">case</span></span> <a id="1">Para</a>( <span class="typed"><span class="type">String</span><a id="48154">s</a></span> ) =&gt;
        <span class="typed"><span class="type">Boolean</span><a href="#48108">lastwasbreak</a></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
        <span class="typed"><span class="type">StringBuilder</span><a href="#48107">sb</a></span>.<span class="typed"><span class="type">(String)StringBuilder</span><a href="../StringBuilder.scala.html#19639">append</a></span>(<span class="typed"><span class="type">String</span><a href="#48154">s</a></span>)
    }
  }

  <span class="comment">// public convenience methods</span>

  <span class="comment">/** returns a formatted string containing well-formed XML with 
   *  default namespace prefix mapping
   *
   *  @param n the node to be serialized
   *  @return  ...
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.Node)String</span><a id="47683">format</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a id="48092">n</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="Node.scala.html#7174">Node</a></span>): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = <span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding)String</span><a href="#47684">format</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#48092">n</a></span>, <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>) <span class="comment">//Utility.defaultPrefixes(n))</span>

  <span class="comment">/** Returns a formatted string containing well-formed XML with 
   *  given namespace to prefix mapping.
   *
   *  @param n    the node to be serialized
   *  @param pmap the namespace to prefix mapping
   *  @return     ...
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding)String</span><a id="47684">format</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a id="48090">n</a></span>: <span class="typed"><span class="type">scala.xml.Node</span><a href="Node.scala.html#7174">Node</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="48091">pscope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="48170">sb</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a href="../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../StringBuilder.scala.html#1433">StringBuilder</a></span>()
    <span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding,StringBuilder)Unit</span><a href="#47682">format</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#48090">n</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#48091">pscope</a></span>, <span class="typed"><span class="type">StringBuilder</span><a href="#48170">sb</a></span>)
    <span class="typed"><span class="type">StringBuilder</span><a href="#48170">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../StringBuilder.scala.html#19672">toString</a></span>()
  }

  <span class="comment">/** Returns a formatted string containing well-formed XML nodes with
   *  default namespace prefix mapping.
   *
   *  @param nodes ...
   *  @return      ...
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Seq[scala.xml.Node])String</span><a id="47685">formatNodes</a></span>(<span class="typed"><span class="type">Seq[scala.xml.Node]</span><a id="48187">nodes</a></span>: <span class="typed"><span class="type">Seq[scala.xml.Node]</span><a href="../Seq.scala.html#761">Seq</a></span>[Node]): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> =
    <span class="typed"><span class="type">(Seq[scala.xml.Node],scala.xml.NamespaceBinding)String</span><a href="#47686">formatNodes</a></span>(<span class="typed"><span class="type">Seq[scala.xml.Node]</span><a href="#48187">nodes</a></span>, <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>)

  <span class="comment">/** Returns a formatted string containing well-formed XML.
   *
   *  @param nodes the sequence of nodes to be serialized
   *  @param pmap  the namespace to prefix mapping
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Seq[scala.xml.Node],scala.xml.NamespaceBinding)String</span><a id="47686">formatNodes</a></span>(<span class="typed"><span class="type">Seq[scala.xml.Node]</span><a id="48192">nodes</a></span>: <span class="typed"><span class="type">Seq[scala.xml.Node]</span><a href="../Seq.scala.html#761">Seq</a></span>[Node], <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="48193">pscope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="keyword">var</span> <span class="typed"><span class="type">StringBuilder</span><a id="48206">sb</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a href="../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../StringBuilder.scala.html#1433">StringBuilder</a></span>()
    <span class="typed"><span class="type">(Seq[scala.xml.Node],scala.xml.NamespaceBinding,StringBuilder)Unit</span><a href="#47687">formatNodes</a></span>(<span class="typed"><span class="type">Seq[scala.xml.Node]</span><a href="#48192">nodes</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#48193">pscope</a></span>, <span class="typed"><span class="type">StringBuilder</span><a href="#48206">sb</a></span>)
    <span class="typed"><span class="type">StringBuilder</span><a href="#48206">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../StringBuilder.scala.html#19672">toString</a></span>()
  }

  <span class="comment">/** Appends a formatted string containing well-formed XML with
   *  the given namespace to prefix mapping to the given stringbuffer.
   *
   *  @param n    the node to be serialized
   *  @param pmap the namespace to prefix mapping
   *  @param sb   the string buffer to which to append to
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Seq[scala.xml.Node],scala.xml.NamespaceBinding,StringBuilder)Unit</span><a id="47687">formatNodes</a></span>(<span class="typed"><span class="type">Seq[scala.xml.Node]</span><a id="48189">nodes</a></span>: <span class="typed"><span class="type">Seq[scala.xml.Node]</span><a href="../Seq.scala.html#761">Seq</a></span>[Node], <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a id="48190">pscope</a></span>: <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="NamespaceBinding.scala.html#7324">NamespaceBinding</a></span>, <span class="typed"><span class="type">StringBuilder</span><a id="48191">sb</a></span>: <span class="typed"><span class="type">StringBuilder</span><a href="../StringBuilder.scala.html#1433">StringBuilder</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> =
    <span class="keyword">for</span> (<span class="typed"><span class="type">((scala.xml.Node) =&gt; Unit)Unit</span><a href="../Iterator.scala.html#20001" id="48225">n</a></span> &lt;- <span class="typed"><span class="type">Seq[scala.xml.Node]</span><a href="#48189">nodes</a></span>.<span class="typed"><span class="type">=&gt; Iterator[scala.xml.Node]</span><a href="../Iterable.scala.html#17309">elements</a></span>) {
      <span class="typed"><span class="type">StringBuilder</span><a href="#48191">sb</a></span>.<span class="typed"><span class="type">(String)StringBuilder</span><a href="../StringBuilder.scala.html#19639">append</a></span>(<span class="typed"><span class="type">(scala.xml.Node,scala.xml.NamespaceBinding)String</span><a href="#47684">format</a></span>(<span class="typed"><span class="type">scala.xml.Node</span><a href="#48225">n</a></span>, <span class="typed"><span class="type">scala.xml.NamespaceBinding</span><a href="#48190">pscope</a></span>))
    }

}

        </pre>
    </body>
</html>