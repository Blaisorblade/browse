<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/xml/dtd/Scanner.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2002-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: Scanner.scala 16842 2009-01-06 15:46:05Z michelou $</span>


<span class="keyword">package</span> scala.xml.dtd


<span class="comment">/** Scanner for regexps (content models in DTD element declarations) 
 *  todo: cleanup
 */</span>
<span class="keyword">class</span> <span class="typed"><span class="type">class Scanner extends scala.xml.dtd.Tokens with scala.xml.parsing.TokenTests with ScalaObject</span><a id="9710">Scanner</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">scala.xml.dtd.Tokens</span><a href="Tokens.scala.html#9893">Tokens</a></span> <span class="keyword">with</span> parsing.<span class="typed"><span class="type">scala.xml.parsing.TokenTests</span><a href="../parsing/TokenTests.scala.html#12609">TokenTests</a></span> {

  <span class="keyword">final</span> <span class="keyword">val</span> <span class="typed"><span class="type">Char('\00')</span><span id="112144"><a id="112143">ENDCH</a></span></span> = <span class="typed"><span class="type">Char('\00')</span><span class="char">'\u0000'</span></span>

  <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="112147"><span id="112145"><span id="112146"><a id="112166">token</a></span></span></span></span>:<span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">Int(10)</span><span >END</span></span>
  <span class="keyword">var</span> <span class="typed"><span class="type">String</span><span id="112150"><span id="112148"><span id="112149"><a id="112167">value</a></span></span></span></span>:<span class="typed"><span class="type">String</span><a id="1859">String</a></span> = _
  
  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Iterator[Char]</span><span id="112153"><span id="112151"><span id="112152"><a id="112168">it</a></span></span></span></span>: <span class="typed"><span class="type">Iterator[Char]</span><a href="../../Iterator.scala.html#1337">Iterator</a></span>[Char] = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Char</span><span id="112156"><span id="112154"><span id="112155"><a id="112169">c</a></span></span></span></span>: <span class="typed"><span class="type">Char</span><a id="2387">Char</a></span> = <span class="typed"><span class="type">Char('z')</span><span class="char">'z'</span></span>

  <span class="comment">/** initializes the scanner on input s */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(String)Unit</span><a id="112157">initScanner</a></span>(<span class="typed"><span class="type">String</span><a id="112170">s</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span>) {
    <span class="typed"><span class="type">(String)Unit</span><a href="#112149">value</a></span> = <span class="typed"><span class="type">java.lang.String(&quot;&quot;)</span><span class="string">&quot;&quot;</span></span>
    <span class="typed"><span class="type">(Iterator[Char])Unit</span><a href="#112152">it</a></span> = (<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518">s</a></span>).<span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="../../RandomAccessSeq.scala.html#17210">elements</a></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#112146">token</a></span> = <span class="int">1</span><span class="typed"><span class="type">Int(11)</span><span >+</span></span>END
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span>
    <span class="typed"><span class="type">=&gt; Unit</span><a href="#112158">nextToken</a></span>
  }

  <span class="comment">/** scans the next token */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="112158">nextToken</a></span> {
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#112145">token</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3140">!=</a></span> <span class="typed"><span class="type">Int(10)</span><span >END</span></span>) <span class="typed"><span class="type">(Int)Unit</span><a href="#112146">token</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#112163">readToken</a></span>
  }

  <span class="comment">// todo: see XML specification... probably isLetter,isDigit is fine</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="112159">isIdentChar</a></span> = ( (<span class="typed"><span class="type">Char('a')</span><span class="char">'a'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">Char('z')</span><span class="char">'z'</span></span>) 
                           <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> (<span class="typed"><span class="type">Char('A')</span><span class="char">'A'</span></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3019">&lt;=</a></span> <span class="typed"><span class="type">Char('Z')</span><span class="char">'Z'</span></span>));
  
  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="112160">next</a></span> = <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="#112151">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>) <span class="typed"><span class="type">(Char)Unit</span><a href="#112155">c</a></span> = <span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="#112151">it</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">(Char)Unit</span><a href="#112155">c</a></span> = <span class="typed"><span class="type">Char('\00')</span><span >ENDCH</span></span>

  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Char)Unit</span><a id="112161">acc</a></span>(<span class="typed"><span class="type">Char</span><a id="112209">d</a></span>: <span class="typed"><span class="type">Char</span><a id="2387">Char</a></span>) { 
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span> <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char</span><a href="#112209">d</a></span>) <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">(String)Nothing</span><a href="../../Predef.scala.html#13358">error</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;expected '&quot;)</span><span class="string">&quot;expected '&quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">Char</span><a href="#112209">d</a></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">java.lang.String(&quot;' found '&quot;)</span><span class="string">&quot;' found '&quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">java.lang.String(&quot;' !&quot;)</span><span class="string">&quot;' !&quot;</span></span>);
  }

  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Seq[Char])Unit</span><a id="112162">accS</a></span>(<span class="typed"><span class="type">Seq[Char]</span><a id="112212">ds</a></span>: <span class="typed"><span class="type">Seq[Char]</span><a href="../../Seq.scala.html#761">Seq</a></span>[Char]) { 
    <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Char]</span><a id="112213">jt</a></span> = <span class="typed"><span class="type">Seq[Char]</span><a href="#112212">ds</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="../../Iterable.scala.html#17309">elements</a></span>
    <span class="typed"><span class="type">Unit</span><a href="#112214" class="keyword">while</a></span> (<span class="typed"><span class="type">Iterator[Char]</span><a href="#112213">jt</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>) { <span class="typed"><span class="type">(Char)Unit</span><a href="#112161">acc</a></span>(<span class="typed"><span class="type">Iterator[Char]</span><a href="#112213">jt</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span>) }
  }

  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="112163">readToken</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = 
    <span class="typed"><span class="type">Int</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="../parsing/TokenTests.scala.html#25353">isSpace</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span>)) {
      <span class="typed"><span class="type">Unit</span><a href="#112216" class="keyword">while</a></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="../parsing/TokenTests.scala.html#25353">isSpace</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span>)) <span class="typed"><span class="type">(Char)Unit</span><a href="#112155">c</a></span> = <span class="typed"><span class="type">=&gt; Iterator[Char]</span><a href="#112151">it</a></span>.<span class="typed"><span class="type">()Char</span><a href="../../Iterator.scala.html#19976">next</a></span>
      <span class="typed"><span class="type">Int(13)</span><span >S</span></span>
    } <span class="keyword">else</span> <span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span> <span class="typed"><span class="type">Int</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('(')</span><span class="char">'('</span></span>   =&gt; <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span>; <span class="typed"><span class="type">Int(3)</span><span >LPAREN</span></span>
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char(')')</span><span class="char">')'</span></span>   =&gt; <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span>; <span class="typed"><span class="type">Int(4)</span><span >RPAREN</span></span>
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char(',')</span><span class="char">','</span></span>   =&gt; <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span>; <span class="typed"><span class="type">Int(5)</span><span >COMMA</span></span>
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('*')</span><span class="char">'*'</span></span>   =&gt; <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span>; <span class="typed"><span class="type">Int(6)</span><span >STAR</span></span>
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('+')</span><span class="char">'+'</span></span>   =&gt; <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span>; <span class="typed"><span class="type">Int(7)</span><span >PLUS</span></span>
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('?')</span><span class="char">'?'</span></span>   =&gt; <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span>; <span class="typed"><span class="type">Int(8)</span><span >OPT</span></span>
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('|')</span><span class="char">'|'</span></span>   =&gt; <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span>; <span class="typed"><span class="type">Int(9)</span><span >CHOICE</span></span>
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('#')</span><span class="char">'#'</span></span>   =&gt; <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span>; <span class="typed"><span class="type">(Seq[Char])Unit</span><a href="#112162">accS</a></span>( <span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../Predef.scala.html#13518" class="string">&quot;PCDATA&quot;</a></span> ); <span class="typed"><span class="type">Int(0)</span><span >TOKEN_PCDATA</span></span>
      <span class="typed"><span class="type">Int(10)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">Char('\00')</span><span >ENDCH</span></span> =&gt; <span class="typed"><span class="type">Int(10)</span><span >END</span></span>
      <span class="typed"><span class="type">Int</span><span class="keyword">case</span></span> _     =&gt; 
        <span class="typed"><span class="type">Int</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="../parsing/TokenTests.scala.html#25356">isNameStart</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span>)) <span class="typed"><span class="type">=&gt; Int</span><a href="#112164">name</a></span>; <span class="comment">// NAME </span>
        <span class="keyword">else</span> { <span class="typed"><span class="type">(String)Nothing</span><a href="../../Predef.scala.html#13358">error</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;unexpected character:&quot;)</span><span class="string">&quot;unexpected character:&quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span>); <span class="typed"><span class="type">Int(10)</span><span >END</span></span> }
    }
  
  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="112164">name</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">StringBuilder</span><a id="112220">sb</a></span> = <span class="typed"><span class="type">()StringBuilder</span><a href="../../StringBuilder.scala.html#19620" class="keyword">new</a></span> <span class="typed"><span class="type">StringBuilder</span><a href="../../StringBuilder.scala.html#1433">StringBuilder</a></span>()
    <span class="typed"><span class="type">Unit</span><a href="#112221" class="keyword">do</a></span> { <span class="typed"><span class="type">StringBuilder</span><a href="#112220">sb</a></span>.<span class="typed"><span class="type">(Char)StringBuilder</span><a href="../../StringBuilder.scala.html#19646">append</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span>); <span class="typed"><span class="type">=&gt; Unit</span><a href="#112160">next</a></span> } <span class="keyword">while</span> (<span class="typed"><span class="type">(Char)Boolean</span><a href="../parsing/TokenTests.scala.html#25355">isNameChar</a></span>(<span class="typed"><span class="type">=&gt; Char</span><a href="#112154">c</a></span>));
    <span class="typed"><span class="type">(String)Unit</span><a href="#112149">value</a></span> = <span class="typed"><span class="type">StringBuilder</span><a href="#112220">sb</a></span>.<span class="typed"><span class="type">()String</span><a href="../../StringBuilder.scala.html#19672">toString</a></span>()
    <span class="typed"><span class="type">Int(1)</span><span >NAME</span></span>
  }

}

        </pre>
    </body>
</html>