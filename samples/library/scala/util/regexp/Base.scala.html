<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/util/regexp/Base.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: Base.scala 16893 2009-01-13 13:09:22Z cunei $</span>


<span class="keyword">package</span> scala.util.regexp

<span class="comment">/** Basic regular expressions.
 *
 *  @author  Burak Emir
 *  @version 1.0
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Base extends java.lang.Object with ScalaObject</span><a id="13952">Base</a></span> {

  <span class="keyword">type</span> <span class="typed"><span class="type">&gt;: Nothing &lt;: Base.this.RegExp</span><a id="59154">_regexpT</a></span> &lt;: RegExp

  <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class RegExp extends java.lang.Object with ScalaObject</span><a id="59155">RegExp</a></span> {
    <span class="keyword">val</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="59244">isNullable</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span>
  }

  <span class="comment">/** Alt( R,R,R* ) */</span>
  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Alt extends Base.this.RegExp with ScalaObject with Product</span><span id="69747"><span id="69752"><span id="69745"><span id="2749"><span id="2748"><span id="69746"><span id="5792"><span id="69754"><span id="19891"><span id="69751"><span id="69753"><span id="59156"><span id="59157"><span id="69748"><span id="59534"><span id="69744"><span id="3499"><span id="59533"><span id="59526"><a href="../../runtime/ScalaRunTime.scala.html#19785" id="3498">Alt</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">Base.this._regexpT*</span><span id="59529"><span id="59528"><span id="59537"><a id="69841">rs</a></span></span></span></span>: <span class="typed"><span class="type">Base.this._regexpT*</span><a id="2739">_regexpT</a></span>*)  <span class="keyword">extends</span> <span class="typed"><span class="type">Base.this.RegExp</span><a href="#59155">RegExp</a></span> {

    <span class="comment">// check rs \in R,R,R*</span>
    <span class="comment">// @todo: flattening</span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> ({ <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a id="69743">it</a></span> = <span class="typed"><span class="type">=&gt; Base.this._regexpT*</span><a href="#59528">rs</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Base.this._regexpT]</span><a href="../../Iterable.scala.html#17309">elements</a></span>; <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a href="#69743">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> {<span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a href="#69743">it</a></span>.<span class="typed"><span class="type">()Base.this._regexpT</span><a href="../../Iterator.scala.html#19976">next</a></span>; <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a href="#69743">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span> }})
      <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">scala.util.regexp.SyntaxError</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.util.regexp.SyntaxError</span><a href="SyntaxError.scala.html#13919">SyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;need at least 2 branches in Alt&quot;)</span><span class="string">&quot;need at least 2 branches in Alt&quot;</span></span>);

    <span class="keyword">final</span> <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><span id="59532"><a id="59531">isNullable</a></span></span> = {
      <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a id="69741">it</a></span> = <span class="typed"><span class="type">=&gt; Base.this._regexpT*</span><a href="#59528">rs</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Base.this._regexpT]</span><a href="../../Iterable.scala.html#17309">elements</a></span>
      <span class="typed"><span class="type">Unit</span><a href="#69742" class="keyword">while</a></span> (<span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a href="#69741">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a href="#69741">it</a></span>.<span class="typed"><span class="type">()Base.this._regexpT</span><a href="../../Iterator.scala.html#19976">next</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="#59244">isNullable</a></span>) <span class="typed"><span class="type">Unit</span><span >{</span></span>}
      <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a href="#69741">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>
    }
  }

  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Sequ extends Base.this.RegExp with ScalaObject with Product</span><span id="69771"><span id="59160"><span id="69778"><span id="69768"><span id="2749"><span id="2748"><span id="69773"><span id="69770"><span id="5792"><span id="69783"><span id="19891"><span id="69782"><span id="69775"><span id="69781"><span id="69769"><span id="69784"><span id="59159"><span id="3499"><span id="69774"><a href="../../runtime/ScalaRunTime.scala.html#19785" id="3498">Sequ</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">Base.this._regexpT*</span><span id="69758"><span id="69757"><span id="69766"><a id="69836">rs</a></span></span></span></span>: <span class="typed"><span class="type">Base.this._regexpT*</span><a id="2739">_regexpT</a></span>*) <span class="keyword">extends</span> <span class="typed"><span class="type">Base.this.RegExp</span><a href="#59155">RegExp</a></span> {
    <span class="comment">// @todo: flattening</span>
    <span class="comment">// check rs \in R,R* </span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> ({ <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a id="69767">it</a></span> = <span class="typed"><span class="type">=&gt; Base.this._regexpT*</span><a href="#69757">rs</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Base.this._regexpT]</span><a href="../../Iterable.scala.html#17309">elements</a></span>; <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a href="#69767">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span> }) 
      <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">scala.util.regexp.SyntaxError</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.util.regexp.SyntaxError</span><a href="SyntaxError.scala.html#13919">SyntaxError</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;need at least 1 item in Sequ&quot;)</span><span class="string">&quot;need at least 1 item in Sequ&quot;</span></span>)

    <span class="keyword">final</span> <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><span id="69761"><a id="69760">isNullable</a></span></span> = {
      <span class="keyword">val</span> <span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a id="69764">it</a></span> = <span class="typed"><span class="type">=&gt; Base.this._regexpT*</span><a href="#69757">rs</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Base.this._regexpT]</span><a href="../../Iterable.scala.html#17309">elements</a></span>
      <span class="typed"><span class="type">Unit</span><a href="#69765" class="keyword">while</a></span> (<span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a href="#69764">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a href="#69764">it</a></span>.<span class="typed"><span class="type">()Base.this._regexpT</span><a href="../../Iterator.scala.html#19976">next</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="#59244">isNullable</a></span>) <span class="typed"><span class="type">Unit</span><span >{</span></span>}
      <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Iterator[Base.this._regexpT]</span><a href="#69764">it</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>
    }
  }

  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Star extends Base.this.RegExp with ScalaObject with Product</span><span id="69810"><span id="69807"><span id="69800"><span id="2749"><span id="2748"><span id="69795"><span id="59163"><span id="69798"><span id="5792"><span id="69805"><span id="19891"><span id="69797"><span id="3507"><span id="69796"><span id="69809"><span id="69808"><span id="69801"><span id="3499"><span id="69802"><span id="59162"><a href="../../runtime/ScalaRunTime.scala.html#19785" id="3498">Star</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">Base.this._regexpT</span><span id="69788"><span id="69787"><span id="69794"><a id="69838">r</a></span></span></span></span>: <span class="typed"><span class="type">Base.this._regexpT</span><a href="#59154">_regexpT</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">Base.this.RegExp</span><a href="#59155">RegExp</a></span> {
    <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><a id="69791">isNullable</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
  }

  <span class="keyword">case</span> <span class="keyword">object</span> <span class="typed"><span class="type">object Base.this.Eps</span><span id="19891"><span id="69821"><span id="69818"><span id="59165"><span id="69819"><span id="69823"><span id="69820"><a id="3498">Eps</a></span></span></span></span></span></span></span></span> <span class="keyword">extends</span> <span class="typed"><span class="type">Base.this.RegExp</span><a href="#59155">RegExp</a></span> {
    <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><a id="69814">isNullable</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()java.lang.String</span><a id="69815">toString</a></span>() = <span class="typed"><span class="type">java.lang.String(&quot;Eps&quot;)</span><span class="string">&quot;Eps&quot;</span></span>
  }

  <span class="comment">/** this class can be used to add meta information to regexps */</span>
  <span class="keyword">class</span> <span class="typed"><span class="type">class Meta extends Base.this.RegExp with ScalaObject</span><a id="59167">Meta</a></span>(<span class="typed"><span class="type">Base.this._regexpT</span><span id="69825"><a id="69832">r1</a></span></span>: <span class="typed"><span class="type">Base.this._regexpT</span><a href="#59154">_regexpT</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">Base.this.RegExp</span><a href="#59155">RegExp</a></span> {
    <span class="keyword">final</span> <span class="keyword">val</span> <span class="typed"><span class="type">Boolean</span><span id="69828"><a id="69827">isNullable</a></span></span> = <span class="typed"><span class="type">Base.this._regexpT</span><a href="#69825">r1</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="#59244">isNullable</a></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Base.this._regexpT</span><a id="69829">r</a></span> = <span class="typed"><span class="type">Base.this._regexpT</span><a href="#69825">r1</a></span>
  }

  <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Base.this._regexpT*)Base.this.RegExp</span><a id="59168">mkSequ</a></span>(<span class="typed"><span class="type">Base.this._regexpT*</span><a id="69835">rs</a></span>: <span class="typed"><span class="type">Base.this._regexpT*</span><a id="2739">_regexpT</a></span> *): <span class="typed"><span class="type">Base.this.RegExp</span><a href="#59155">RegExp</a></span> =
    <span class="typed"><span class="type">Base.this.RegExp</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Base.this._regexpT*</span><a href="#69835">rs</a></span>.<span class="typed"><span class="type">=&gt; Iterator[Base.this._regexpT]</span><a href="../../Iterable.scala.html#17309">elements</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Iterator.scala.html#19975">hasNext</a></span>)
      <span class="typed"><span class="type">object Base.this.Eps</span><a href="#59165">Eps</a></span>
    <span class="keyword">else</span>
      <span class="typed"><span class="type">(Base.this._regexpT*)Base.this.Sequ</span><a href="#69773">Sequ</a></span>(<span class="typed"><span class="type">Base.this._regexpT*</span><a href="#69835">rs</a></span>:_*)

}

        </pre>
    </body>
</html>