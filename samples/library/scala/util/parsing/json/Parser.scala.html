<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/util/parsing/json/Parser.scala</title>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2006-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: Parser.scala 16893 2009-01-13 13:09:22Z cunei $</span>


<span class="keyword">package</span> scala.util.parsing.json

<span class="keyword">import</span> scala.util.parsing.combinator._
<span class="keyword">import</span> scala.util.parsing.combinator.syntactical._
<span class="keyword">import</span> scala.util.parsing.combinator.lexical._

<span class="comment">/**
 *  @author Derek Chen-Becker &lt;&quot;java&quot;+@+&quot;chen-becker&quot;+&quot;.&quot;+&quot;org&quot;&gt;
 */</span>
<span class="keyword">class</span> <span class="typed"><span class="type">class Parser extends java.lang.Object with scala.util.parsing.combinator.syntactical.StdTokenParsers with scala.util.parsing.combinator.ImplicitConversions with ScalaObject</span><a id="14530">Parser</a></span> <span class="keyword">extends</span> <span class="typed"><span class="type">scala.util.parsing.combinator.syntactical.StdTokenParsers</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#7100">StdTokenParsers</a></span> <span class="keyword">with</span> <span class="typed"><span class="type">scala.util.parsing.combinator.ImplicitConversions</span><a href="../combinator/ImplicitConversions.scala.html#7019">ImplicitConversions</a></span> {
  <span class="comment">// Fill in abstract defs</span>
  <span class="keyword">type</span> <span class="typed"><span class="type">scala.util.parsing.json.Lexer</span><a id="67963">Tokens</a></span> = <span class="typed"><span class="type">scala.util.parsing.json.Lexer</span><a href="Lexer.scala.html#14326">Lexer</a></span>
  <span class="keyword">val</span> <span class="typed"><span class="type">scala.util.parsing.json.Lexer</span><span id="67965"><a id="67964">lexical</a></span></span> = <span class="typed"><span class="type">scala.util.parsing.json.Lexer</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.util.parsing.json.Lexer</span><a href="#67963">Tokens</a></span>

  <span class="comment">// Configure lexical parsing</span>
  <span class="typed"><span class="type">=&gt; scala.util.parsing.json.Lexer</span><a href="#67964">lexical</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.HashSet[String]</span><a href="../combinator/lexical/StdLexical.scala.html#18134">reserved</a></span> <span class="typed"><span class="type">(Iterable[String])Unit</span><a href="../../../collection/mutable/Set.scala.html#34727">++=</a></span> <span class="typed"><span class="type">(java.lang.String*)List[java.lang.String]</span><a href="../../../List.scala.html#16977">List</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;true&quot;)</span><span class="string">&quot;true&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;false&quot;)</span><span class="string">&quot;false&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;null&quot;)</span><span class="string">&quot;null&quot;</span></span>)
  <span class="typed"><span class="type">=&gt; scala.util.parsing.json.Lexer</span><a href="#67964">lexical</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.HashSet[String]</span><a href="../combinator/lexical/StdLexical.scala.html#18136">delimiters</a></span> <span class="typed"><span class="type">(Iterable[String])Unit</span><a href="../../../collection/mutable/Set.scala.html#34727">++=</a></span> <span class="typed"><span class="type">(java.lang.String*)List[java.lang.String]</span><a href="../../../List.scala.html#16977">List</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;{&quot;)</span><span class="string">&quot;{&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;}&quot;)</span><span class="string">&quot;}&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;[&quot;)</span><span class="string">&quot;[&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;]&quot;)</span><span class="string">&quot;]&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;:&quot;)</span><span class="string">&quot;:&quot;</span></span>, <span class="typed"><span class="type">java.lang.String(&quot;,&quot;)</span><span class="string">&quot;,&quot;</span></span>)

  <span class="comment">/** Type signature for functions that can parse numeric literals */</span>
  <span class="keyword">type</span> <span class="typed"><span class="type">(String) =&gt; Any</span><a id="67966">NumericParser</a></span> = String =&gt; Any
  
  <span class="comment">// Global default number parsing function</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">(String) =&gt; Any</span><span id="67969"><span id="67967"><span id="67968"><a id="74928">defaultNumberParser</a></span></span></span></span> : <span class="typed"><span class="type">(String) =&gt; Any</span><a href="../../../Function1.scala.html#179">NumericParser</a></span> = {<span class="typed"><span class="type">implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString</span><a href="../../../Predef.scala.html#13518">_</a></span>.<span class="typed"><span class="type">=&gt; Double</span><a href="../../../runtime/RichString.scala.html#19308">toDouble</a></span>}
  
  <span class="comment">// Per-thread default number parsing function</span>
  <span class="keyword">protected</span> <span class="keyword">val</span> <span class="typed"><span class="type">java.lang.ThreadLocal[(String) =&gt; Any]</span><span id="67971"><a id="67970">numberParser</a></span></span> = <span class="typed"><span class="type">template $anon extends java.lang.ThreadLocal[(String) =&gt; Any]</span><a id="68257" class="keyword">new</a></span> <span class="typed"><span class="type">java.lang.ThreadLocal[(String) =&gt; Any]</span><a id="1679">ThreadLocal</a></span>[NumericParser]() {
    <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()(String) =&gt; Any</span><a id="68259">initialValue</a></span>() = <span class="typed"><span class="type">=&gt; (String) =&gt; Any</span><a href="#67967">defaultNumberParser</a></span>
  }
  
  <span class="comment">// Define the grammar</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[List[Any]]</span><a id="67972">root</a></span>       = <span class="typed"><span class="type">=&gt; Parser.this.Parser[List[(String, Any)]]</span><a href="#67973">jsonObj</a></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[List[Any]])Parser.this.Parser[List[Any]]</span><a href="../combinator/Parsers.scala.html#24041">|</a></span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[List[Any]]</span><a href="#67974">jsonArray</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[List[(String, Any)]]</span><a id="67973">jsonObj</a></span>    = <span class="typed"><span class="type">implicit scala.util.parsing.combinator.syntactical.StdTokenParsers.keyword : (String)Parser.this.Parser[String]</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#18103" class="string">&quot;{&quot;</a></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[List[(String, Any)]])Parser.this.Parser[List[(String, Any)]]</span><a href="../combinator/Parsers.scala.html#24032">~&gt;</a></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[(String, Any)],=&gt; Parser.this.Parser[Any])Parser.this.Parser[List[(String, Any)]]</span><a href="../combinator/Parsers.scala.html#18047">repsep</a></span>(<span class="typed"><span class="type">=&gt; Parser.this.Parser[(String, Any)]</span><a href="#67975">objEntry</a></span>, <span class="typed"><span class="type">implicit scala.util.parsing.combinator.syntactical.StdTokenParsers.keyword : (String)Parser.this.Parser[String]</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#18103" class="string">&quot;,&quot;</a></span>) <span class="typed"><span class="type">(=&gt; Parser.this.Parser[String])Parser.this.Parser[List[(String, Any)]]</span><a href="../combinator/Parsers.scala.html#24035">&lt;~</a></span> <span class="typed"><span class="type">implicit scala.util.parsing.combinator.syntactical.StdTokenParsers.keyword : (String)Parser.this.Parser[String]</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#18103" class="string">&quot;}&quot;</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[List[Any]]</span><a id="67974">jsonArray</a></span>  = <span class="typed"><span class="type">implicit scala.util.parsing.combinator.syntactical.StdTokenParsers.keyword : (String)Parser.this.Parser[String]</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#18103" class="string">&quot;[&quot;</a></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[List[Any]])Parser.this.Parser[List[Any]]</span><a href="../combinator/Parsers.scala.html#24032">~&gt;</a></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[Any],=&gt; Parser.this.Parser[Any])Parser.this.Parser[List[Any]]</span><a href="../combinator/Parsers.scala.html#18047">repsep</a></span>(<span class="typed"><span class="type">=&gt; Parser.this.Parser[Any]</span><a href="#67976">value</a></span>, <span class="typed"><span class="type">implicit scala.util.parsing.combinator.syntactical.StdTokenParsers.keyword : (String)Parser.this.Parser[String]</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#18103" class="string">&quot;,&quot;</a></span>) <span class="typed"><span class="type">(=&gt; Parser.this.Parser[String])Parser.this.Parser[List[Any]]</span><a href="../combinator/Parsers.scala.html#24035">&lt;~</a></span> <span class="typed"><span class="type">implicit scala.util.parsing.combinator.syntactical.StdTokenParsers.keyword : (String)Parser.this.Parser[String]</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#18103" class="string">&quot;]&quot;</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[(String, Any)]</span><a id="67975">objEntry</a></span>   = <span class="typed"><span class="type">=&gt; Parser.this.Parser[String]</span><a href="#67977">stringVal</a></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[Any])Parser.this.Parser[Parser.this.~[String,Any]]</span><a href="../combinator/Parsers.scala.html#24029">~</a></span> (<span class="typed"><span class="type">implicit scala.util.parsing.combinator.syntactical.StdTokenParsers.keyword : (String)Parser.this.Parser[String]</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#18103" class="string">&quot;:&quot;</a></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[Any])Parser.this.Parser[Any]</span><a href="../combinator/Parsers.scala.html#24032">~&gt;</a></span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[Any]</span><a href="#67976">value</a></span>) <span class="typed"><span class="type">((Parser.this.~[String,Any]) =&gt; (String, Any))Parser.this.Parser[(String, Any)]</span><a href="../combinator/Parsers.scala.html#24047">^^</a></span> <span class="typed"><span class="type">(String, Any)</span><a href="#68150">{</a></span> <span class="typed"><span class="type">(String, Any)</span><span class="keyword">case</span></span> <span class="typed"><span class="type">String</span><a id="68151">x</a></span> <a id="1">~</a> <span class="typed"><span class="type">Any</span><a id="68152">y</a></span> =&gt; <span class="typed"><span class="type">(String,Any)(String, Any)</span><a href="../../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">String</span><a href="#68151">x</a></span>, <span class="typed"><span class="type">Any</span><a href="#68152">y</a></span>) }
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[Any]</span><a id="67976">value</a></span>: <span class="typed"><span class="type">Parser.this.Parser[Any]</span><a href="../combinator/Parsers.scala.html#18008">Parser</a></span>[Any] = (<span class="typed"><span class="type">=&gt; Parser.this.Parser[List[(String, Any)]]</span><a href="#67973">jsonObj</a></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[List[Any]])Parser.this.Parser[List[Any]]</span><a href="../combinator/Parsers.scala.html#24041">|</a></span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[List[Any]]</span><a href="#67974">jsonArray</a></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[Any])Parser.this.Parser[Any]</span><a href="../combinator/Parsers.scala.html#24041">|</a></span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[Any]</span><a href="#67978">number</a></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[Any])Parser.this.Parser[Any]</span><a href="../combinator/Parsers.scala.html#24041">|</a></span> <span class="typed"><span class="type">implicit scala.util.parsing.combinator.syntactical.StdTokenParsers.keyword : (String)Parser.this.Parser[String]</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#18103" class="string">&quot;true&quot;</a></span> <span class="typed"><span class="type">(Boolean)Parser.this.Parser[Boolean]</span><a href="../combinator/Parsers.scala.html#24050">^^^</a></span> <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[Any])Parser.this.Parser[Any]</span><a href="../combinator/Parsers.scala.html#24041">|</a></span> <span class="typed"><span class="type">implicit scala.util.parsing.combinator.syntactical.StdTokenParsers.keyword : (String)Parser.this.Parser[String]</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#18103" class="string">&quot;false&quot;</a></span> <span class="typed"><span class="type">(Boolean)Parser.this.Parser[Boolean]</span><a href="../combinator/Parsers.scala.html#24050">^^^</a></span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[Any])Parser.this.Parser[Any]</span><a href="../combinator/Parsers.scala.html#24041">|</a></span> <span class="typed"><span class="type">implicit scala.util.parsing.combinator.syntactical.StdTokenParsers.keyword : (String)Parser.this.Parser[String]</span><a href="../combinator/syntactical/StdTokenParsers.scala.html#18103" class="string">&quot;null&quot;</a></span> <span class="typed"><span class="type">(Null)Parser.this.Parser[Null]</span><a href="../combinator/Parsers.scala.html#24050">^^^</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(=&gt; Parser.this.Parser[Any])Parser.this.Parser[Any]</span><a href="../combinator/Parsers.scala.html#24041">|</a></span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[String]</span><a href="#67977">stringVal</a></span>)
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[String]</span><a id="67977">stringVal</a></span>  = <span class="typed"><span class="type">(String,PartialFunction[Parser.this.Elem,String])Parser.this.Parser[String]</span><a href="../combinator/Parsers.scala.html#18026">accept</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;string&quot;)</span><span class="string">&quot;string&quot;</span></span>, <span class="typed"><span class="type">String</span><a href="#68135">{</a></span> <span class="typed"><span class="type">String</span><span class="keyword">case</span></span> lexical.<a id="1">StringLit</a>(<span class="typed"><span class="type">String</span><a id="68140">n</a></span>) =&gt; <span class="typed"><span class="type">String</span><a href="#68140">n</a></span>} )
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Parser.this.Parser[Any]</span><a id="67978">number</a></span>     = <span class="typed"><span class="type">(String,PartialFunction[Parser.this.Elem,Any])Parser.this.Parser[Any]</span><a href="../combinator/Parsers.scala.html#18026">accept</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;number&quot;)</span><span class="string">&quot;number&quot;</span></span>, <span class="typed"><span class="type">Any</span><a href="#74958">{</a></span> <span class="typed"><span class="type">Any</span><span class="keyword">case</span></span> lexical.<a id="1">NumericLit</a>(<span class="typed"><span class="type">String</span><a id="74963">n</a></span>) =&gt; <span class="typed"><span class="type">=&gt; java.lang.ThreadLocal[(String) =&gt; Any]</span><a href="#67970">numberParser</a></span>.<span class="typed"><span class="type">()(String) =&gt; Any</span><a id="20499">get</a></span>.<span class="typed"><span class="type">(String)Any</span><a href="../../../Function1.scala.html#17300">apply</a></span>(<span class="typed"><span class="type">String</span><a href="#74963">n</a></span>)} )
}


        </pre>
    </body>
</html>