<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/util/parsing/input/OffsetPosition.scala</title>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2006-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="keyword">package</span> scala.util.parsing.input

<span class="keyword">import</span> collection.mutable.ArrayBuffer

<span class="comment">/** &lt;p&gt;
 *    &lt;code&gt;OffsetPosition&lt;/code&gt; is a standard class for positions
 *    represented as offsets into a source ``document''.
 *    @param source   The source document
 *    @param offset   The offset indicating the position
 *
 * @author Martin Odersky
 */</span>
<span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class OffsetPosition extends java.lang.Object with scala.util.parsing.input.Position with ScalaObject with Product</span><span id="10045"><span id="118525"><span id="118523"><span id="118517"><span id="2748"><span id="2749"><span id="118522"><span id="118504"><span id="5792"><span id="118515"><span id="118516"><span id="19891"><span id="3139"><span id="3507"><span id="118503"><span id="118524"><span id="10044"><span id="118502"><span id="3499"><span id="118518"><span id="118519"><a href="../../../runtime/ScalaRunTime.scala.html#19785" id="3498">OffsetPosition</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">java.lang.CharSequence</span><span id="35586"><span id="35585"><span id="35597"><a id="118528">source</a></span></span></span></span>: java.lang.<span class="typed"><span class="type">java.lang.CharSequence</span><a id="2120">CharSequence</a></span>, <span class="typed"><span class="type">Int</span><span id="35588"><span id="35587"><span id="35598"><a id="118529">offset</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">scala.util.parsing.input.Position</span><a href="Position.scala.html#10053">Position</a></span> {

  <span class="comment">/** An index that contains all line starts, including first line, and eof */</span>
  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <span class="typed"><span class="type">Array[Int]</span><a id="35591">index</a></span>: <span class="typed"><span class="type">Array[Int]</span><a href="../../../Array.scala.html#1070">Array</a></span>[Int] = {
    <span class="keyword">var</span> <span class="typed"><span class="type">scala.collection.mutable.ArrayBuffer[Int]</span><a id="118365">lineStarts</a></span> = <span class="typed"><span class="type">scala.collection.mutable.ArrayBuffer[Int]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.collection.mutable.ArrayBuffer[Int]</span><a href="../../../collection/mutable/ArrayBuffer.scala.html#11377">ArrayBuffer</a></span>[Int]
    <span class="typed"><span class="type">scala.collection.mutable.ArrayBuffer[Int]</span><a href="#118365">lineStarts</a></span> <span class="typed"><span class="type">(Int)Unit</span><a href="../../../collection/mutable/ArrayBuffer.scala.html#22574">+=</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="keyword">for</span> (<span class="typed"><span class="type">((Int) =&gt; Unit)Unit</span><a href="../../../Range.scala.html#25001" id="118377">i</a></span> &lt;- <span class="typed"><span class="type">implicit scala.Predef.intWrapper : (Int)scala.runtime.RichInt</span><a href="../../../Predef.scala.html#13511" class="int">0</a></span> <span class="typed"><span class="type">(Int)Range</span><a href="../../../runtime/RichInt.scala.html#19402">until</a></span> <span class="typed"><span class="type">=&gt; java.lang.CharSequence</span><a href="#35585">source</a></span>.<span class="typed"><span class="type">()Int</span><a id="18301">length</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; java.lang.CharSequence</span><a href="#35585">source</a></span>.<span class="typed"><span class="type">(Int)Char</span><a id="18302">charAt</a></span>(<span class="typed"><span class="type">Int</span><a href="#118377">i</a></span>) <span class="typed"><span class="type">(Char)Boolean</span><a id="3016">==</a></span> <span class="typed"><span class="type">Char('\012')</span><span class="char">'\n'</span></span>) <span class="typed"><span class="type">scala.collection.mutable.ArrayBuffer[Int]</span><a href="#118365">lineStarts</a></span> <span class="typed"><span class="type">(Int)Unit</span><a href="../../../collection/mutable/ArrayBuffer.scala.html#22574">+=</a></span> (<span class="typed"><span class="type">Int</span><a href="#118377">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
    <span class="typed"><span class="type">scala.collection.mutable.ArrayBuffer[Int]</span><a href="#118365">lineStarts</a></span> <span class="typed"><span class="type">(Int)Unit</span><a href="../../../collection/mutable/ArrayBuffer.scala.html#22574">+=</a></span> <span class="typed"><span class="type">=&gt; java.lang.CharSequence</span><a href="#35585">source</a></span>.<span class="typed"><span class="type">()Int</span><a id="18301">length</a></span>
    <span class="typed"><span class="type">scala.collection.mutable.ArrayBuffer[Int]</span><a href="#118365">lineStarts</a></span>.<span class="typed"><span class="type">Array[Int]</span><a href="../../../Seq.scala.html#17185">toArray</a></span>
  }

  <span class="comment">/** The line number referred to by the position; line numbers start at 1 */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="35592">line</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="118406">lo</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="118407">hi</a></span> = <span class="typed"><span class="type">=&gt; Array[Int]</span><a href="#35590">index</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../../Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">Unit</span><a href="#118408" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#118406">lo</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#118407">hi</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="118412">mid</a></span> = (<span class="typed"><span class="type">Int</span><a href="#118407">hi</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int</span><a href="#118406">lo</a></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3148">/</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#35587">offset</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">(Int)Int</span><a href="../../../Array.scala.html#17253">index</a></span>(<span class="typed"><span class="type">Int</span><a href="#118412">mid</a></span>)) <span class="typed"><span class="type">Int</span><a href="#118407">hi</a></span> = <span class="typed"><span class="type">Int</span><a href="#118412">mid</a></span>
      <span class="keyword">else</span> <span class="typed"><span class="type">Int</span><a href="#118406">lo</a></span> = <span class="typed"><span class="type">Int</span><a href="#118412">mid</a></span>
    } 
    <span class="typed"><span class="type">Int</span><a href="#118406">lo</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
  }
   
  <span class="comment">/** The column number referred to by the position; column numbers start at 1 */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="35593">column</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#35587">offset</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">(Int)Int</span><a href="../../../Array.scala.html#17253">index</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#35592">line</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>

  <span class="comment">/** The contents of the line numbered `lnum' (must not contain a new-line character).
   * 
   * @param lnum a 1-based integer index into the `document'
   * @return the line at `lnum' (not including a newline)
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; String</span><a id="35594">lineContents</a></span>: <span class="typed"><span class="type">String</span><a id="1859">String</a></span> =
    <span class="typed"><span class="type">=&gt; java.lang.CharSequence</span><a href="#35585">source</a></span>.<span class="typed"><span class="type">(Int,Int)java.lang.CharSequence</span><a id="18303">subSequence</a></span>(<span class="typed"><span class="type">(Int)Int</span><a href="../../../Array.scala.html#17253">index</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#35592">line</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>), <span class="typed"><span class="type">(Int)Int</span><a href="../../../Array.scala.html#17253">index</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#35592">line</a></span>)).<span class="typed"><span class="type">()java.lang.String</span><a id="5783">toString</a></span>
  
  <span class="comment">/** Returns a string representation of the `Position', of the form `line.column' */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()java.lang.String</span><a id="35595">toString</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#35592">line</a></span><span class="typed"><span class="type">(java.lang.String)java.lang.String</span><a id="3087">+</a></span><span class="typed"><span class="type">java.lang.String(&quot;.&quot;)</span><span class="string">&quot;.&quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">=&gt; Int</span><a href="#35593">column</a></span>

  <span class="comment">/** Compare this position to another, by first comparing their line numbers,
   * and then -- if necessary -- using the columns to break a tie.
   *
   * @param `that' a `Position' to compare to this `Position'
   * @return true if this position's line or (in case of a tie wrt. line numbers)
   *         its column is smaller than the corresponding components of `that'
   */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.util.parsing.input.Position)Boolean</span><a id="35596">&lt;</a></span>(<span class="typed"><span class="type">scala.util.parsing.input.Position</span><a id="118499">that</a></span>: <span class="typed"><span class="type">scala.util.parsing.input.Position</span><a href="Position.scala.html#10053">Position</a></span>) = <span class="typed"><span class="type">scala.util.parsing.input.Position</span><a href="#118499">that</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">match</span></span> {
    <span class="typed"><span class="type">Boolean</span><span class="keyword">case</span></span> <a id="1">OffsetPosition</a>(_, <span class="typed"><span class="type">Int</span><a id="118509">that_offset</a></span>) =&gt;
      <span class="typed"><span class="type">OffsetPosition.this.type</span><a href="#10044" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="#35587">offset</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#118509">that_offset</a></span>
    <span class="typed"><span class="type">Boolean</span><span class="keyword">case</span></span> _ =&gt;
      <span class="typed"><span class="type">OffsetPosition.this.type</span><a href="#10044" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="#35592">line</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">scala.util.parsing.input.Position</span><a href="#118499">that</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="Position.scala.html#23449">line</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2748">||</a></span> 
      <span class="typed"><span class="type">OffsetPosition.this.type</span><a href="#10044" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="#35592">line</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">scala.util.parsing.input.Position</span><a href="#118499">that</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="Position.scala.html#23449">line</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">OffsetPosition.this.type</span><a href="#10044" class="keyword">this</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="#35593">column</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">scala.util.parsing.input.Position</span><a href="#118499">that</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="Position.scala.html#23450">column</a></span>
  }
}

        </pre>
    </body>
</html>