<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/testing/Show.scala</title>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="keyword">package</span> scala.testing

<span class="comment">/** Classes inheriting trait `Show` can test their member methods using the notattion
 *  'meth(arg_1, ..., arg_n), where `meth' is the name of the method and `arg_1,...,arg_n' are
 *  the arguments. The only difference to a normal method call is the leading quote character (').
 *  A quoted method call like the one above will produces a legible diagnostic to be printed on Console.
 *  It is of the form
 * 
 *    meth(arg_1, ..., arg_n)  gives  &lt;result&gt;
 * 
 *  where &lt;result&gt; is the result of evaluating the call.
 */</span>
<span class="keyword">trait</span> <span class="typed"><span class="type">trait Show extends java.lang.Object with ScalaObject</span><a id="15455">Show</a></span> {

  <span class="comment">/** The result class of wrapper `symApply`. 
   *  Prints out diagnostics of method applications.
   */</span>
  <span class="keyword">class</span> <span class="typed"><span class="type">class SymApply extends java.lang.Object with ScalaObject</span><a id="116885">SymApply</a></span>(<span class="typed"><span class="type">Symbol</span><span id="116893"><a id="116900">f</a></span></span>: <span class="typed"><span class="type">Symbol</span><a href="../Symbol.scala.html#860">Symbol</a></span>) {
    <span class="keyword">def</span> <span class="typed"><span class="type">[A](A*)Unit</span><a id="116895">apply</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="116897">A</a></span>](<span class="typed"><span class="type">A*</span><a id="116901">args</a></span>: <span class="typed"><span class="type">A*</span><a id="2739">A</a></span>*) {
      <span class="typed"><span class="type">(Any)Unit</span><a href="../Predef.scala.html#13489">println</a></span>(<span class="typed"><span class="type">(Symbol,A*)String</span><a href="#116887">test</a></span>(<span class="typed"><span class="type">Symbol</span><a href="#116893">f</a></span>, <span class="typed"><span class="type">A*</span><a href="#116901">args</a></span>: _*))
    }
  }

  <span class="comment">/** An implicit definition that adds an apply method to Symbol which forwards to `test`. 
   */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <span class="typed"><span class="type">implicit scala.testing.Show.symApply : (Symbol)Show.this.SymApply</span><a id="116886">symApply</a></span>(<span class="typed"><span class="type">Symbol</span><a id="116906">sym</a></span>: <span class="typed"><span class="type">Symbol</span><a href="../Symbol.scala.html#860">Symbol</a></span>) = <span class="typed"><span class="type">Show.this.SymApply</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Show.this.SymApply</span><a href="#116885">SymApply</a></span>(<span class="typed"><span class="type">Symbol</span><a href="#116906">sym</a></span>)

  <span class="comment">/** Apply method with name of given symbol `f` to given arguments and return
   *  a result diagnostics.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">[A](Symbol,A*)String</span><a id="116887">test</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="116889">A</a></span>](<span class="typed"><span class="type">Symbol</span><a id="116903">f</a></span>: <span class="typed"><span class="type">Symbol</span><a href="../Symbol.scala.html#860">Symbol</a></span>, <span class="typed"><span class="type">A*</span><a id="116904">args</a></span>: <span class="typed"><span class="type">A*</span><a id="2739">A</a></span>*): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Seq[AnyRef]</span><a id="116908">args1</a></span> = <span class="typed"><span class="type">A*</span><a href="#116904">args</a></span> <span class="typed"><span class="type">((A) =&gt; AnyRef)Seq[AnyRef]</span><a href="../Seq.scala.html#17169">map</a></span> (<span class="typed"><span class="type">A</span><a href="#116912">_</a></span>.<span class="typed"><span class="type">AnyRef</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">AnyRef</span><a id="2015">AnyRef</a></span>])
    <span class="keyword">def</span> <span class="typed"><span class="type">(java.lang.reflect.Method)String</span><a id="116909">testMethod</a></span>(<span class="typed"><span class="type">java.lang.reflect.Method</span><a id="116913">meth</a></span>: java.lang.reflect.<span class="typed"><span class="type">java.lang.reflect.Method</span><a id="3862">Method</a></span>): <span class="typed"><span class="type">String</span><a id="1859">String</a></span> =
      <span class="typed"><span class="type">Symbol</span><a href="#116903">f</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="../Symbol.scala.html#21445">name</a></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">java.lang.String(&quot;(&quot;)</span><span class="string">&quot;(&quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span>(<span class="typed"><span class="type">A*</span><a href="#116904">args</a></span> <span class="typed"><span class="type">(String)String</span><a href="../Iterable.scala.html#17364">mkString</a></span> <span class="typed"><span class="type">java.lang.String(&quot;,&quot;)</span><span class="string">&quot;,&quot;</span></span>)<span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">java.lang.String(&quot;)  gives  &quot;)</span><span class="string">&quot;)  gives  &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span>
      {
        <span class="keyword">try</span> {
          <span class="typed"><span class="type">java.lang.reflect.Method</span><a href="#116913">meth</a></span>.<span class="typed"><span class="type">(Any,java.lang.Object*)java.lang.Object</span><a id="86862">invoke</a></span>(<span class="typed"><span class="type">scala.testing.Show</span><a href="#15455" class="keyword">this</a></span>, <span class="typed"><span class="type">Seq[AnyRef]</span><a href="#116908">args1</a></span>: _*)
        } <span class="keyword">catch</span> {
          <span class="typed"><span class="type">java.lang.IllegalAccessException</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.IllegalAccessException</span><a id="116915">ex</a></span>: <span class="typed"><span class="type">java.lang.IllegalAccessException</span><a id="1865">IllegalAccessException</a></span> =&gt; <span class="typed"><span class="type">java.lang.IllegalAccessException</span><a href="#116915">ex</a></span>
          <span class="typed"><span class="type">IllegalArgumentException</span><span class="keyword">case</span></span> <span class="typed"><span class="type">IllegalArgumentException</span><a id="116918">ex</a></span>: <span class="typed"><span class="type">IllegalArgumentException</span><a id="1970">IllegalArgumentException</a></span> =&gt; <span class="typed"><span class="type">IllegalArgumentException</span><a href="#116918">ex</a></span>
          <span class="typed"><span class="type">java.lang.reflect.InvocationTargetException</span><span class="keyword">case</span></span> <span class="typed"><span class="type">java.lang.reflect.InvocationTargetException</span><a id="116919">ex</a></span>: java.lang.reflect.<span class="typed"><span class="type">java.lang.reflect.InvocationTargetException</span><a id="3904">InvocationTargetException</a></span> =&gt; <span class="typed"><span class="type">java.lang.reflect.InvocationTargetException</span><a href="#116919">ex</a></span>
        }
      }
    <span class="typed"><span class="type">()java.lang.Class[_ &lt;: java.lang.Object]</span><a href="#15455" id="3509">getClass</a></span>.<span class="typed"><span class="type">()Array[java.lang.reflect.Method]</span><a id="4335">getMethods</a></span>.<span class="typed"><span class="type">=&gt; List[java.lang.reflect.Method]</span><a href="../Iterable.scala.html#17360">toList</a></span> <span class="typed"><span class="type">((java.lang.reflect.Method) =&gt; Boolean)List[java.lang.reflect.Method]</span><a href="../List.scala.html#20911">filter</a></span> (<span class="typed"><span class="type">java.lang.reflect.Method</span><a href="#116928">_</a></span>.<span class="typed"><span class="type">()java.lang.String</span><a id="86842">getName</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">Symbol</span><a href="#116903">f</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="../Symbol.scala.html#21445">name</a></span>) <span class="typed"><span class="type">String</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">java.lang.String</span><span class="keyword">case</span></span> <span class="typed"><span class="type">(List[java.lang.reflect.Method])Some[List[java.lang.reflect.Method]]</span><a href="../List.scala.html#16980">List</a></span>() =&gt; 
        <span class="typed"><span class="type">Symbol</span><a href="#116903">f</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="../Symbol.scala.html#21445">name</a></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">java.lang.String(&quot; is not defined&quot;)</span><span class="string">&quot; is not defined&quot;</span></span>
      <span class="typed"><span class="type">String</span><span class="keyword">case</span></span> <span class="typed"><span class="type">(List[java.lang.reflect.Method])Some[List[java.lang.reflect.Method]]</span><a href="../List.scala.html#16980">List</a></span>(<span class="typed"><span class="type">java.lang.reflect.Method</span><a id="116937">m</a></span>) =&gt; 
        <span class="typed"><span class="type">(java.lang.reflect.Method)String</span><a href="#116909">testMethod</a></span>(<span class="typed"><span class="type">java.lang.reflect.Method</span><a href="#116937">m</a></span>)
      <span class="typed"><span class="type">String</span><span class="keyword">case</span></span> <span class="typed"><span class="type">List[java.lang.reflect.Method]</span><a id="116938">ms</a></span> =&gt; <span class="comment">// multiple methods, disambiguate by number of arguments</span>
        <span class="typed"><span class="type">List[java.lang.reflect.Method]</span><a href="#116938">ms</a></span> <span class="typed"><span class="type">((java.lang.reflect.Method) =&gt; Boolean)List[java.lang.reflect.Method]</span><a href="../List.scala.html#20911">filter</a></span> (<span class="typed"><span class="type">java.lang.reflect.Method</span><a href="#116940">_</a></span>.<span class="typed"><span class="type">()Array[java.lang.Class[_]]</span><a id="86851">getParameterTypes</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">A*</span><a href="#116904">args</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../Seq.scala.html#17146">length</a></span>) <span class="typed"><span class="type">String</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">String</span><span class="keyword">case</span></span> <span class="typed"><span class="type">(List[java.lang.reflect.Method])Some[List[java.lang.reflect.Method]]</span><a href="../List.scala.html#16980">List</a></span>() =&gt; 
            <span class="typed"><span class="type">(java.lang.reflect.Method)String</span><a href="#116909">testMethod</a></span>(<span class="typed"><span class="type">List[java.lang.reflect.Method]</span><a href="#116938">ms</a></span>.<span class="typed"><span class="type">=&gt; java.lang.reflect.Method</span><a href="../List.scala.html#20869">head</a></span>) <span class="comment">// go ahead anyway, to get an exception</span>
          <span class="typed"><span class="type">String</span><span class="keyword">case</span></span> <span class="typed"><span class="type">(List[java.lang.reflect.Method])Some[List[java.lang.reflect.Method]]</span><a href="../List.scala.html#16980">List</a></span>(<span class="typed"><span class="type">java.lang.reflect.Method</span><a id="116950">m</a></span>) =&gt;
            <span class="typed"><span class="type">(java.lang.reflect.Method)String</span><a href="#116909">testMethod</a></span>(<span class="typed"><span class="type">java.lang.reflect.Method</span><a href="#116950">m</a></span>)
          <span class="typed"><span class="type">java.lang.String</span><span class="keyword">case</span></span> <span class="typed"><span class="type">List[java.lang.reflect.Method]</span><a id="116951">ms</a></span> =&gt;
            <span class="typed"><span class="type">java.lang.String(&quot;cannot disambiguate between multiple implementations of &quot;)</span><span class="string">&quot;cannot disambiguate between multiple implementations of &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">Symbol</span><a href="#116903">f</a></span>.<span class="typed"><span class="type">=&gt; String</span><a href="../Symbol.scala.html#21445">name</a></span>
        }	
    }	
  }
}

        </pre>
    </body>
</html>