<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/reflect/RichClass.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style">
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2002-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

// $Id$

<span class="keyword">package</span> scala.reflect

<span class="keyword">import</span> annotation.experimental
<span class="keyword">import</span> util.control.Exception._
<span class="keyword">import</span> util.ScalaClassLoader._
<span class="keyword">import</span> java.lang.{ Class =&gt; JClass }
<span class="keyword">import</span> java.lang.reflect. { Constructor =&gt; JConstructor }

<span class="keyword">object</span> <a title="object scala.reflect.RichClass" id="11542">RichClass</a>
<a href="../ScalaObject.scala.html#969" title="ScalaObject">{</a>
  // We can't put this in Predef at the moment because everything referenced
  // from Predef has to be buildable at the first bootstraping phase.
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](x: java.lang.Class[T])scala.reflect.RichClass[T]" id="138320">classWrapper</a>[<a title="&gt;: Nothing &lt;: Any" id="138322">T</a>](<a title="java.lang.Class[T]" id="138344">x</a>: <span title="java.lang.Class[T]">JClass</span>[T]): <a href="#11541" title="scala.reflect.RichClass[T]">RichClass</a>[T] = <span title="scala.reflect.RichClass[T]" class="keyword">new</span> <a href="#11541" title="scala.reflect.RichClass[T]">RichClass</a>(<a href="#138344" title="java.lang.Class[T]">x</a>)
}

@experimental
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class RichClass[T] extends java.lang.Object with Proxy with ScalaObject" id="11541">RichClass</a>[<a title="&gt;: Nothing &lt;: Any" id="14298">T</a>]<a href="../ScalaObject.scala.html#969" title="ScalaObject">(</a><span class="keyword">val</span> <a title="java.lang.Class[T]" id="138340">self</a>: <span title="java.lang.Class[T]">JClass</span>[T]) <span class="keyword">extends</span> <a href="../Proxy.scala.html#183" title="Proxy">Proxy</a>
{
  // The getConstructors and getDeclaredConstructors methods on java.lang.Class[T]
  // return &quot;raw type&quot; Constructors rather than Constructor[T]s as one would want.
  // The &quot;why&quot; from http://java.sun.com/javase/6/docs/api/java/lang/Class.html is:
  //
  // Note that while this method returns an array of Constructor&lt;T&gt; objects (that is an array 
  // of constructors from this class), the return type of this method is Constructor&lt;?&gt;[] and
  // not Constructor&lt;T&gt;[] as might be expected. This less informative return type is necessary
  // since after being returned from this method, the array could be modified to hold Constructor
  // objects for different classes, which would violate the type guarantees of Constructor&lt;T&gt;[]
  //
  // Since this reasoning is invalid in scala due to its abandonment of Array covariance,
  // these methods exist to correct the return types.
  //
  // In addition, at this writing because of ticket #1560 the compiler crashes on the
  // untyped constructors but not on these.
    
  <span class="keyword">def</span> <a title="()Array[java.lang.reflect.Constructor[T]]" id="138327">getConstructorsTyped</a>(): <a href="../Array.scala.html#897" title="Array[java.lang.reflect.Constructor[T]]">Array</a>[JConstructor[T]] =
    <a href="#138340" title="=&gt; java.lang.Class[T]">self</a>.<a title="()Array[java.lang.reflect.Constructor[_]]" id="4892">getConstructors</a><a href="../collection/generic/TraversableTemplate.scala.html#17268" title="(f: (java.lang.reflect.Constructor[_]) =&gt; java.lang.reflect.Constructor[T])(implicit bf: scala.collection.generic.BuilderFactory[java.lang.reflect.Constructor[T],Array[java.lang.reflect.Constructor[T]],Array[java.lang.reflect.Constructor[_]]])Array[java.lang.reflect.Constructor[T]]">(</a>) <a href="../Array.scala.html#29314" title="scala.collection.generic.BuilderFactory[java.lang.reflect.Constructor[T],Array[java.lang.reflect.Constructor[T]],Array[_]]">map</a> (<a href="#138448" title="java.lang.reflect.Constructor[_]">_</a>.<span title="[T0]T0">asInstanceOf</span><span title="java.lang.reflect.Constructor[T]">[</span><span title="java.lang.reflect.Constructor[T]">JConstructor</span>[T]])
  
  <span class="keyword">def</span> <a title="()Array[java.lang.reflect.Constructor[T]]" id="138328">getDeclaredConstructorsTyped</a>(): <a href="../Array.scala.html#897" title="Array[java.lang.reflect.Constructor[T]]">Array</a>[JConstructor[T]] =
    <a href="#138340" title="=&gt; java.lang.Class[T]">self</a>.<a title="()Array[java.lang.reflect.Constructor[_]]" id="4918">getDeclaredConstructors</a><a href="../collection/generic/TraversableTemplate.scala.html#17268" title="(f: (java.lang.reflect.Constructor[_]) =&gt; java.lang.reflect.Constructor[T])(implicit bf: scala.collection.generic.BuilderFactory[java.lang.reflect.Constructor[T],Array[java.lang.reflect.Constructor[T]],Array[java.lang.reflect.Constructor[_]]])Array[java.lang.reflect.Constructor[T]]">(</a>) <a href="../Array.scala.html#29314" title="scala.collection.generic.BuilderFactory[java.lang.reflect.Constructor[T],Array[java.lang.reflect.Constructor[T]],Array[_]]">map</a> (<a href="#138528" title="java.lang.reflect.Constructor[_]">_</a>.<span title="[T0]T0">asInstanceOf</span><span title="java.lang.reflect.Constructor[T]">[</span><span title="java.lang.reflect.Constructor[T]">JConstructor</span>[T]])
  
  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.lang.ClassLoader" id="138330">classLoader</a> = <a href="#138340" title="=&gt; java.lang.Class[T]">self</a>.<a title="()java.lang.ClassLoader" id="4123">getClassLoader</a> <span title="java.lang.ClassLoader" class="keyword">match</span> {
    <span title="java.lang.ClassLoader" class="keyword">case</span> <span title="Null(null)" class="keyword">null</span>   =&gt; <a href="../util/ClassLoader.scala.html#138314" title="()java.lang.ClassLoader">getSystemLoader</a>
    <span title="java.lang.ClassLoader" class="keyword">case</span> <a title="java.lang.ClassLoader" id="138364">x</a>      =&gt; <a href="#138364" title="java.lang.ClassLoader">x</a>
  }
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="List[java.lang.Class[_ &gt;: ClassCastException with NullPointerException with java.lang.SecurityException with java.lang.NoSuchMethodException with java.lang.ClassNotFoundException &lt;: java.lang.Exception]]" id="138331">exceptions</a> = <a href="../collection/immutable/List.scala.html#17642" title="(xs: java.lang.Class[_ &gt;: ClassCastException with NullPointerException with java.lang.SecurityException with java.lang.NoSuchMethodException with java.lang.ClassNotFoundException &lt;: java.lang.Exception]*)List[java.lang.Class[_ &gt;: ClassCastException with NullPointerException with java.lang.SecurityException with java.lang.NoSuchMethodException with java.lang.ClassNotFoundException &lt;: java.lang.Exception]]">List</a>(
    classOf<span title="java.lang.Class[java.lang.ClassNotFoundException]">[</span>ClassNotFoundException],
    classOf<span title="java.lang.Class[java.lang.NoSuchMethodException]">[</span>NoSuchMethodException],
    classOf<span title="java.lang.Class[java.lang.SecurityException]">[</span>SecurityException],
    classOf<span title="java.lang.Class[NullPointerException]">[</span>NullPointerException],
    classOf<span title="java.lang.Class[ClassCastException]">[</span>ClassCastException]
  )
  
  // Experimental!
  // scala&gt; classOf[String].reflectiveCall[Array[String]](&quot;ababab&quot;, &quot;split&quot;)(&quot;b&quot;)
  // res0: Array[String] = Array(a, a, a)
    
  /** A class representing a reflective method call.  It is a function object
   *  and will make the call with whatever args are given via apply, or it will
   *  throw an exception at that point if there was an error in creation.
   */
  <span class="keyword">class</span> <a title="class ReflectiveCall[+U] extends java.lang.Object with ScalaObject" id="138333">ReflectiveCall</a>[+<a title="&gt;: Nothing &lt;: Any" id="138334">U</a>]<a href="../ScalaObject.scala.html#969" title="ScalaObject">(</a><a title="T" id="138604">obj</a>: <a href="#14298" title="T">T</a>, <a title="String" id="138605">name</a>: <span title="String">String</span>) {
    <span class="keyword">def</span> <a title="(args: AnyRef*)java.lang.reflect.Method" id="138598">methodForArgs</a>(<a title="AnyRef*" id="138608">args</a>: <span title="AnyRef*">AnyRef</span>*) = <a href="#138340" title="=&gt; java.lang.Class[T]">self</a>.<a title="(x$1: java.lang.String,x$2: java.lang.Class[_]*)java.lang.reflect.Method" id="4897">getMethod</a>(<a href="#138605" title="String">name</a>, <a href="../collection/generic/TraversableTemplate.scala.html#17268" title="(f: (AnyRef) =&gt; java.lang.Class[_])(implicit bf: scala.collection.generic.BuilderFactory[java.lang.Class[_],Sequence[java.lang.Class[_]],Sequence[AnyRef]])Sequence[java.lang.Class[_]]">args</a> <a href="../collection/Sequence.scala.html#22146" title="scala.collection.generic.BuilderFactory[java.lang.Class[_],Sequence[java.lang.Class[_]],Sequence#Coll]">map</a> (<a href="#138619" title="AnyRef">_</a>.<a title="()java.lang.Class[_]" id="3641">getClass</a>) : _*)
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="138599">isErroneous</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">def</span> <a title="(args: Any*)U" id="138600">apply</a>(<a title="Any*" id="138709">args</a>: <span title="Any*">Any</span>*): <a href="#138334" title="U">U</a> = {
      <span class="keyword">val</span> <a title="Sequence[AnyRef]" id="138711">ps</a> = <a href="../collection/generic/TraversableTemplate.scala.html#17268" title="(f: (Any) =&gt; AnyRef)(implicit bf: scala.collection.generic.BuilderFactory[AnyRef,Sequence[AnyRef],Sequence[Any]])Sequence[AnyRef]">args</a> <a href="../collection/Sequence.scala.html#22146" title="scala.collection.generic.BuilderFactory[AnyRef,Sequence[AnyRef],Sequence#Coll]">map</a> (<a href="#138721" title="Any">_</a>.<span title="[T0]T0">asInstanceOf</span><span title="AnyRef">[</span><a title="AnyRef" id="1771">AnyRef</a>])
      <span class="keyword">val</span> <a title="java.lang.reflect.Method" id="138712">m</a> = <a href="#138598" title="(args: AnyRef*)java.lang.reflect.Method">methodForArgs</a>(<a href="#138711" title="Sequence[AnyRef]">ps</a>: _*)
      <a href="#138712" title="java.lang.reflect.Method">m</a>.<a title="(x$1: Any,x$2: java.lang.Object*)java.lang.Object" id="135255">invoke</a>(<a href="#138604" title="T">obj</a>, <a href="#138711" title="Sequence[AnyRef]">ps</a>: _*).<span title="[T0]T0">asInstanceOf</span><span title="U">[</span><a href="#138334" title="U">U</a>]
    }
  }

  <span class="keyword">class</span> <a title="class FailedReflectiveCall[+U] extends RichClass.this.ReflectiveCall[U] with ScalaObject" id="138335">FailedReflectiveCall</a>[+<a title="&gt;: Nothing &lt;: Any" id="138336">U</a>]<a href="../ScalaObject.scala.html#969" title="ScalaObject">(</a><a title="Throwable" id="138763">ex</a>: <a title="Throwable" id="1900">Throwable</a>) <span class="keyword">extends</span> <a href="#138333" title="RichClass.this.ReflectiveCall[U]">ReflectiveCall</a>[U](<span title="Null(null)" class="keyword">null</span>.<span title="[T0]T0">asInstanceOf</span><span title="T">[</span><a href="#14298" title="T">T</a>], <span title="Null(null)" class="keyword">null</span>) {
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="138759">isErroneous</a> = <span title="Boolean(true)" class="keyword">true</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(args: Any*)Nothing" id="138760">apply</a>(<a title="Any*" id="138769">args</a>: <span title="Any*">Any</span>*) = <span title="Nothing" class="keyword">throw</span> <a href="#138763" title="Throwable">ex</a>
  }

  <span class="keyword">def</span> <a title="[U](obj: T,method: String)RichClass.this.ReflectiveCall[U]" id="138337">reflectiveCall</a>[<a title="&gt;: Nothing &lt;: Any" id="138339">U</a>](<a title="T" id="138772">obj</a>: <a href="#14298" title="T">T</a>, <a title="String" id="138773">method</a>: <span title="String">String</span>): <a href="#138333" title="RichClass.this.ReflectiveCall[U]">ReflectiveCall</a>[U] = {
    (<a href="../util/control/Exception.scala.html#31347" title="(exceptions: Class[_]*)util.control.Exception.Catch[Nothing]">catching</a><a href="../util/control/Exception.scala.html#47598" title="(body: =&gt; RichClass.this.ReflectiveCall[U])Either[Throwable,RichClass.this.ReflectiveCall[U]]">(</a><a href="#138331" title="=&gt; List[java.lang.Class[_ &gt;: ClassCastException with NullPointerException with java.lang.SecurityException with java.lang.NoSuchMethodException with java.lang.ClassNotFoundException &lt;: java.lang.Exception]]">exceptions</a>: _*) either (<span title="RichClass.this.ReflectiveCall[U]" class="keyword">new</span> <a href="#138333" title="RichClass.this.ReflectiveCall[U]">ReflectiveCall</a>[U](<a href="#138772" title="T">obj</a>, <a href="#138773" title="String">method</a>))) <span title="RichClass.this.ReflectiveCall[U]" class="keyword">match</span> {
      <span title="RichClass.this.FailedReflectiveCall[U]" class="keyword">case</span> Left(<a title="Throwable" id="138801">x</a>)    =&gt; <span title="RichClass.this.FailedReflectiveCall[U]" class="keyword">new</span> <a href="#138335" title="RichClass.this.FailedReflectiveCall[U]">FailedReflectiveCall</a>[U](<a href="#138801" title="Throwable">x</a>)
      <span title="RichClass.this.ReflectiveCall[U]" class="keyword">case</span> Right(<a title="RichClass.this.ReflectiveCall[U]" id="138807">x</a>)   =&gt; <a href="#138807" title="RichClass.this.ReflectiveCall[U]">x</a>
    }
  } 
}


        </pre>
    </body>
</html>