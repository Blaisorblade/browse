<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/concurrent/pilib.scala</title>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: pilib.scala 16893 2009-01-13 13:09:22Z cunei $</span>


<span class="keyword">package</span> scala.concurrent


<span class="comment">/** &lt;p&gt;
 *    Library for using Pi-calculus concurrent primitives in
 *    &lt;a href=&quot;http://scala-lang.org/&quot; target=&quot;_top&quot;&gt;Scala&lt;/a&gt;. As an
 *    example, the definition of a two-place buffer using the &lt;code&gt;pilib&lt;/code&gt;
 *    library looks like:
 *  &lt;/p&gt;&lt;pre&gt;
 *  &lt;b&gt;def&lt;/b&gt; Buffer[a](put: Chan[a], get: Chan[a]) {
 *    &lt;b&gt;def&lt;/b&gt; B0 { choice ( put * { x =&gt; B1(x) } ) }
 *    &lt;b&gt;def&lt;/b&gt; B1(x: a) { choice ( get(x) * B0, put * { y =&gt; B2(x, y) } ) }
 *    &lt;b&gt;def&lt;/b&gt; B2(x: a, y: a) { choice ( get(x) * B1(y) ) }
 *    B0
 *  }
 *  &lt;/pre&gt;
 *
 *  @see     &lt;a href=&quot;http://scala-lang.org/docu/papers.html&quot; target=&quot;_top&quot;&gt;
 *           PiLib: A Hosted Language for Pi-Calculus Style Concurrency&lt;/a&gt;
 *  @author  Vincent Cremet, Martin Odersky
 *  @version 1.0
 */</span> 
<span class="keyword">object</span> <span class="typed"><span class="type">object scala.concurrent.pilib</span><a id="7833">pilib</a></span> {

  <span class="comment">//////////////////////////////// SPAWN /////////////////////////////////</span>

  <span class="comment">/**
   * Run several processes in parallel using the following syntax:
   * &lt;code&gt;spawn &amp;lt; p&lt;sub&gt;1&lt;/sub&gt; | ... | p&lt;sub&gt;n&lt;/sub&gt; &amp;gt;&lt;/code&gt;
   */</span>
  <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Spawn extends java.lang.Object with ScalaObject</span><a id="20433">Spawn</a></span> {
    <span class="keyword">def</span> <span class="typed"><span class="type">(=&gt; Unit)scala.concurrent.pilib.Spawn</span><a id="20460">&lt;</a></span>(<span class="typed"><span class="type">=&gt; Unit</span><a id="20860">p</a></span>: =&gt; Unit): <span class="typed"><span class="type">scala.concurrent.pilib.Spawn</span><a href="#20433">Spawn</a></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(=&gt; Unit)scala.concurrent.pilib.Spawn</span><a id="20461">|</a></span>(<span class="typed"><span class="type">=&gt; Unit</span><a id="20861">p</a></span>: =&gt; Unit): <span class="typed"><span class="type">scala.concurrent.pilib.Spawn</span><a href="#20433">Spawn</a></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="20462">&gt;</a></span> : <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span>
  }
  <span class="keyword">val</span> <span class="typed"><span class="type">scala.concurrent.pilib.Spawn</span><span id="20435"><a id="20434">spawn</a></span></span> = <span class="typed"><span class="type">template $anon extends scala.concurrent.pilib.Spawn</span><a id="20458" class="keyword">new</a></span> <span class="typed"><span class="type">scala.concurrent.pilib.Spawn</span><a href="#20433">Spawn</a></span> {
  <span class="comment">//object spawn extends Spawn { // BUG !</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(=&gt; Unit)scala.concurrent.pilib.Spawn</span><a id="20464">&lt;</a></span>(<span class="typed"><span class="type">=&gt; Unit</span><a id="20468">p</a></span>: =&gt; Unit): <span class="typed"><span class="type">scala.concurrent.pilib.Spawn</span><a href="#20433">Spawn</a></span> = { scala.concurrent.<span class="typed"><span class="type">object scala.concurrent.ops</span><a href="ops.scala.html#7728">ops</a></span>.<span class="typed"><span class="type">(=&gt; Unit)Unit</span><a href="ops.scala.html#20473">spawn</a></span>(<span class="typed"><span class="type">=&gt; Unit</span><a href="#20468">p</a></span>); <span class="typed"><span class="type">scala.concurrent.pilib.Spawn{ ... }</span><a href="#20458" class="keyword">this</a></span> }
    <span class="keyword">def</span> <span class="typed"><span class="type">(=&gt; Unit)scala.concurrent.pilib.Spawn</span><a id="20465">|</a></span>(<span class="typed"><span class="type">=&gt; Unit</span><a id="20854">p</a></span>: =&gt; Unit): <span class="typed"><span class="type">scala.concurrent.pilib.Spawn</span><a href="#20433">Spawn</a></span> = { scala.concurrent.<span class="typed"><span class="type">object scala.concurrent.ops</span><a href="ops.scala.html#7728">ops</a></span>.<span class="typed"><span class="type">(=&gt; Unit)Unit</span><a href="ops.scala.html#20473">spawn</a></span>(<span class="typed"><span class="type">=&gt; Unit</span><a href="#20854">p</a></span>); <span class="typed"><span class="type">scala.concurrent.pilib.Spawn{ ... }</span><a href="#20458" class="keyword">this</a></span> }
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Unit</span><a id="20466">&gt;</a></span> : <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = <span class="typed"><span class="type">Unit</span><span >(</span></span>)
  }

  <span class="comment">/////////////////////////// GUARDED PROCESSES //////////////////////////</span>

  <span class="comment">/** Untyped channel. */</span>
  <span class="keyword">class</span> <span class="typed"><span class="type">class UChan extends java.lang.Object with ScalaObject</span><a id="20436">UChan</a></span> {
    <span class="comment">/** Default log function. */</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">(Any) =&gt; Unit</span><span id="20973"><span id="20971"><span id="20972"><a id="20977">log</a></span></span></span></span> = (<span class="typed"><span class="type">Any</span><a id="20976">x</a></span>: <span class="typed"><span class="type">Any</span><a id="49">Any</a></span>) =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>)
  }

  <span class="comment">/** An untyped guarded process.
   *
   *  @param n         channel name
   *  @param polarity  input (true) or output (false)
   *  @param v         transmitted value
   *  @param c         continuation
   */</span>
  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class UGP extends java.lang.Object with ScalaObject with Product</span><span id="21044"><span id="2746"><span id="21000"><span id="21011"><span id="21002"><span id="21052"><span id="2748"><span id="2749"><span id="21013"><span id="21003"><span id="21051"><span id="21004"><span id="5792"><span id="21043"><span id="21050"><span id="3494"><span id="19891"><span id="21053"><span id="20438"><span id="3507"><span id="21045"><span id="21046"><span id="3499"><span id="20437"><span id="3498"><a href="../runtime/ScalaRunTime.scala.html#19785" id="21012">UGP</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><span id="20983"><span id="20982"><span id="20996"><a id="21071">n</a></span></span></span></span>: <span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><a href="#20436">UChan</a></span>, <span class="typed"><span class="type">Boolean</span><span id="20985"><span id="20984"><span id="20997"><a id="21072">polarity</a></span></span></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span>, <span class="typed"><span class="type">Any</span><span id="20987"><span id="20986"><span id="20998"><a id="21073">v</a></span></span></span></span>: <span class="typed"><span class="type">Any</span><a id="49">Any</a></span>, <span class="typed"><span class="type">(Any) =&gt; Any</span><span id="20989"><span id="20988"><span id="20999"><a id="21074">c</a></span></span></span></span>: Any =&gt; Any)

  <span class="comment">/** Typed guarded process. */</span>
  <span class="keyword">class</span> <span class="typed"><span class="type">class GP[a] extends java.lang.Object with ScalaObject</span><a id="20440">GP</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="20441">a</a></span>](<span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><span id="21059"><a id="21079">n</a></span></span>: <span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><a href="#20436">UChan</a></span>, <span class="typed"><span class="type">Boolean</span><span id="21060"><a id="21080">polarity</a></span></span>: <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span>, <span class="typed"><span class="type">Any</span><span id="21061"><a id="21081">v</a></span></span>: <span class="typed"><span class="type">Any</span><a id="49">Any</a></span>, <span class="typed"><span class="type">(Any) =&gt; a</span><span id="21062"><a id="21082">c</a></span></span>: Any =&gt; a) {
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.concurrent.pilib.UGP</span><span id="21065"><a id="21064">untyped</a></span></span> = <span class="typed"><span class="type">(scala.concurrent.pilib.UChan,Boolean,Any,(Any) =&gt; Any)scala.concurrent.pilib.UGP</span><a href="#21011">UGP</a></span>(<span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><a href="#21059">n</a></span>, <span class="typed"><span class="type">Boolean</span><a href="#21060">polarity</a></span>, <span class="typed"><span class="type">Any</span><a href="#21061">v</a></span>, <span class="typed"><span class="type">(Any) =&gt; a</span><a href="#21062">c</a></span>)
  }

  <span class="comment">//////////////////////////////// CHANNELS //////////////////////////////</span>

  <span class="comment">/**
   * Name on which one can emit, receive or that can be emitted or received
   * during a communication.
   */</span>
  <span class="keyword">class</span> <span class="typed"><span class="type">class Chan[A] extends scala.concurrent.pilib.UChan with (A) =&gt; scala.concurrent.pilib.Product[A] with ScalaObject</span><a id="20442">Chan</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="20443">A</a></span>] <span class="keyword">extends</span> <span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><a href="#20436">UChan</a></span> <span class="keyword">with</span> <span class="typed"><span class="type">(A) =&gt; scala.concurrent.pilib.Product[A]</span><a href="../Function1.scala.html#179">Function1</a></span>[A, Product[A]] {

    <span class="keyword">var</span> <span class="typed"><span class="type">A</span><span id="21086"><span id="21084"><span id="21085"><a id="21109">defaultValue</a></span></span></span></span>: <span class="typed"><span class="type">A</span><a href="#20443">A</a></span> = _

    <span class="comment">/** Creates an input guarded process. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">[B]((A) =&gt; B)scala.concurrent.pilib.GP[B]</span><a id="21087">input</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="21089">B</a></span>](<span class="typed"><span class="type">(A) =&gt; B</span><a id="21110">c</a></span>: A =&gt; B) =
      <span class="typed"><span class="type">scala.concurrent.pilib.GP[B]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.concurrent.pilib.GP[B]</span><a href="#20440">GP</a></span>(<span class="typed"><span class="type">scala.concurrent.pilib.Chan[A]</span><a href="#20442" class="keyword">this</a></span>, <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>, <span class="typed"><span class="type">Unit</span><span >(</span></span>), <span class="typed"><span class="type">Any</span><a id="21114">x</a></span> =&gt; <span class="typed"><span class="type">(A)B</span><a href="../Function1.scala.html#17300">c</a></span>(<span class="typed"><span class="type">Any</span><a href="#21114">x</a></span>.<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#20443">A</a></span>]))

    <span class="comment">/** Creates an input guarded process. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">[B](A,() =&gt; B)scala.concurrent.pilib.GP[B]</span><a id="21090">output</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="21092">B</a></span>](<span class="typed"><span class="type">A</span><a id="21115">v</a></span>: <span class="typed"><span class="type">A</span><a href="#20443">A</a></span>, <span class="typed"><span class="type">() =&gt; B</span><a id="21116">c</a></span>: () =&gt; B) =
      <span class="typed"><span class="type">scala.concurrent.pilib.GP[B]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.concurrent.pilib.GP[B]</span><a href="#20440">GP</a></span>(<span class="typed"><span class="type">scala.concurrent.pilib.Chan[A]</span><a href="#20442" class="keyword">this</a></span>, <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>, <span class="typed"><span class="type">A</span><a href="#21115">v</a></span>, <span class="typed"><span class="type">Any</span><a id="21120">x</a></span> =&gt; <span class="typed"><span class="type">()B</span><a href="../Function0.scala.html#21123">c</a></span>())

    <span class="comment">/** Blocking read. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; A</span><a id="21093">read</a></span> = {
      <span class="keyword">var</span> <span class="typed"><span class="type">A</span><a id="21127">res</a></span>: <span class="typed"><span class="type">A</span><a href="#20443">A</a></span> = <span class="typed"><span class="type">=&gt; A</span><a href="#21084">defaultValue</a></span>
      <span class="typed"><span class="type">(scala.concurrent.pilib.GP[Unit]*)Unit</span><a href="#20454">choice</a></span> ( <span class="typed"><span class="type">((A) =&gt; Unit)scala.concurrent.pilib.GP[Unit]</span><a href="#21087">input</a></span>(<span class="typed"><span class="type">A</span><a id="21132">x</a></span> =&gt; <span class="typed"><span class="type">A</span><a href="#21127">res</a></span> = <span class="typed"><span class="type">A</span><a href="#21132">x</a></span>) )
      <span class="typed"><span class="type">A</span><a href="#21127">res</a></span>
    }

    <span class="comment">/** Blocking write. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(A)Unit</span><a id="21094">write</a></span>(<span class="typed"><span class="type">A</span><a id="21133">x</a></span>: <span class="typed"><span class="type">A</span><a href="#20443">A</a></span>) =
      <span class="typed"><span class="type">(scala.concurrent.pilib.GP[Unit]*)Unit</span><a href="#20454">choice</a></span> ( <span class="typed"><span class="type">(A,() =&gt; Unit)scala.concurrent.pilib.GP[Unit]</span><a href="#21090">output</a></span>(<span class="typed"><span class="type">A</span><a href="#21133">x</a></span>, () =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>)) )

    <span class="comment">/** Syntactic sugar for input. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">[B]((A) =&gt; B)scala.concurrent.pilib.GP[B]</span><a id="21095">*</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="21097">B</a></span>](<span class="typed"><span class="type">(A) =&gt; B</span><a id="21138">f</a></span>: A =&gt; B) =
      <span class="typed"><span class="type">((A) =&gt; B)scala.concurrent.pilib.GP[B]</span><a href="#21087">input</a></span>(<span class="typed"><span class="type">(A) =&gt; B</span><a href="#21138">f</a></span>)

    <span class="comment">/** Syntactic sugar for output. */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(A)scala.concurrent.pilib.Product[A]</span><a id="21098">apply</a></span>(<span class="typed"><span class="type">A</span><a id="21141">v</a></span>: <span class="typed"><span class="type">A</span><a href="#20443">A</a></span>) =
      <span class="typed"><span class="type">scala.concurrent.pilib.Product[A]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">scala.concurrent.pilib.Product[A]</span><a href="#20444">Product</a></span>(<span class="typed"><span class="type">scala.concurrent.pilib.Chan[A]</span><a href="#20442" class="keyword">this</a></span>, <span class="typed"><span class="type">A</span><a href="#21141">v</a></span>)

    <span class="comment">/** Attach a function to be evaluated at each communication event
     *  on this channel. Replace previous attached function.
     */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">((A) =&gt; Unit)Unit</span><a id="21099">attach</a></span>(<span class="typed"><span class="type">(A) =&gt; Unit</span><a id="21146">f</a></span>: A =&gt; Unit) =
      <span class="typed"><span class="type">((Any) =&gt; Unit)Unit</span><a href="#20972">log</a></span> = <span class="typed"><span class="type">Any</span><a id="21149">x</a></span> =&gt; <span class="typed"><span class="type">(A)Unit</span><a href="../Function1.scala.html#17300">f</a></span>(<span class="typed"><span class="type">Any</span><a href="#21149">x</a></span>.<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#20443">A</a></span>])
  }

  <span class="keyword">class</span> <span class="typed"><span class="type">class Product[A] extends java.lang.Object with ScalaObject</span><a id="20444">Product</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="20445">A</a></span>](<span class="typed"><span class="type">scala.concurrent.pilib.Chan[A]</span><span id="21103"><a id="21144">c</a></span></span>: <span class="typed"><span class="type">scala.concurrent.pilib.Chan[A]</span><a href="#20442">Chan</a></span>[A], <span class="typed"><span class="type">A</span><span id="21104"><a id="21145">v</a></span></span>: <span class="typed"><span class="type">A</span><a href="#20445">A</a></span>) {
    <span class="keyword">def</span> <span class="typed"><span class="type">[B](=&gt; B)scala.concurrent.pilib.GP[B]</span><a id="21106">*</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="21108">B</a></span>](<span class="typed"><span class="type">=&gt; B</span><a id="21153">f</a></span>: =&gt; B) = <span class="typed"><span class="type">scala.concurrent.pilib.Chan[A]</span><a href="#21103">c</a></span>.<span class="typed"><span class="type">(A,() =&gt; B)scala.concurrent.pilib.GP[B]</span><a href="#21090">output</a></span>(<span class="typed"><span class="type">A</span><a href="#21104">v</a></span>, () =&gt; <span class="typed"><span class="type">=&gt; B</span><a href="#21153">f</a></span>)
  }

  <span class="comment">/////////////////////// SUM OF GUARDED PROCESSES ///////////////////////</span>

  <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Sum extends java.lang.Object with ScalaObject with Product</span><span id="21189"><span id="21190"><span id="2749"><span id="2748"><span id="21197"><span id="21187"><span id="5792"><span id="21184"><span id="19891"><span id="21199"><span id="20446"><span id="21185"><span id="3507"><span id="21198"><span id="21186"><span id="20447"><span id="21194"><span id="3499"><span id="21191"><span id="21196"><a href="../runtime/ScalaRunTime.scala.html#19785" id="3498">Sum</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>(<span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><span id="21159"><span id="21158"><span id="21173"><a id="21323">gs</a></span></span></span></span>: <span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a href="../List.scala.html#524">List</a></span>[UGP]) {

    <span class="comment">/** Continuation of the sum. */</span>
    <span class="keyword">var</span> <span class="typed"><span class="type">() =&gt; Any</span><span id="21163"><span id="21161"><span id="21162"><a id="21171">cont</a></span></span></span></span>: () =&gt; Any = _

    <span class="keyword">var</span> <span class="typed"><span class="type">Boolean</span><span id="21166"><span id="21164"><span id="21165"><a id="21172">initialized</a></span></span></span></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>

    <span class="comment">/** Block if not initialized otherwise continue with the
     *  continuation.
     */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Any</span><a id="21167">continue</a></span> = <span class="typed"><span class="type">(Any)Any</span><a href="#20446" id="5794">synchronized</a></span> {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">=&gt; Boolean</span><a href="#21164">initialized</a></span>) <span class="typed"><span class="type">()Unit</span><a href="#20446" id="5788">wait</a></span>()
      <span class="typed"><span class="type">()Any</span><a href="../Function0.scala.html#21123">cont</a></span>()
    }

    <span class="comment">/** Set the values of parameters and awake the sleeping sum.
     *
     *  @param f ...
     */</span>
    <span class="keyword">def</span> <span class="typed"><span class="type">(() =&gt; Any)Unit</span><a id="21168">set</a></span>(<span class="typed"><span class="type">() =&gt; Any</span><a id="21181">f</a></span>: () =&gt; Any) = <span class="typed"><span class="type">(Unit)Unit</span><a href="#20446" id="5794">synchronized</a></span> {
      <span class="typed"><span class="type">(() =&gt; Any)Unit</span><a href="#21162">cont</a></span> = <span class="typed"><span class="type">() =&gt; Any</span><a href="#21181">f</a></span>
      <span class="typed"><span class="type">(Boolean)Unit</span><a href="#21165">initialized</a></span> = <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
      <span class="typed"><span class="type">()Unit</span><a href="#20446" id="5784">notify</a></span>()
    }
  }

  <span class="comment">///////////////////////////// COMMUNICATION ////////////////////////////</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><span id="20451"><span id="20449"><span id="20450"><a id="20968">sums</a></span></span></span></span>: <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><a href="../List.scala.html#524">List</a></span>[Sum] = <span class="typed"><span class="type">object Nil</span><a href="../List.scala.html#333">Nil</a></span>

  <span class="comment">/** Test if two lists of guarded processes can communicate.
   *
   *  @param gs1 ...
   *  @param gs2 ...
   *  @return    ...
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(List[scala.concurrent.pilib.UGP],List[scala.concurrent.pilib.UGP])Option[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><a id="20452">matches</a></span>(<span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a id="21216">gs1</a></span>: <span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a href="../List.scala.html#524">List</a></span>[UGP], <span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a id="21217">gs2</a></span>: <span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a href="../List.scala.html#524">List</a></span>[UGP]): <span class="typed"><span class="type">Option[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><a href="../Option.scala.html#932">Option</a></span>[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)] =
    <span class="typed"><span class="type">(List[scala.concurrent.pilib.UGP],List[scala.concurrent.pilib.UGP])(List[scala.concurrent.pilib.UGP], List[scala.concurrent.pilib.UGP])</span><a href="../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a href="#21216">gs1</a></span>, <span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a href="#21217">gs2</a></span>) <span class="typed"><span class="type">Option[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">None.type</span><span class="keyword">case</span></span> <a id="1">(</a><span class="typed"><span class="type">object Nil</span><a href="../List.scala.html#333">Nil</a></span>, _) =&gt; <span class="typed"><span class="type">object None</span><a href="../Option.scala.html#534">None</a></span>
      <span class="typed"><span class="type">None.type</span><span class="keyword">case</span></span> <a id="1">(</a>_, <span class="typed"><span class="type">object Nil</span><a href="../List.scala.html#333">Nil</a></span>) =&gt; <span class="typed"><span class="type">object None</span><a href="../Option.scala.html#534">None</a></span>
      <span class="typed"><span class="type">Option[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><span class="keyword">case</span></span> <a id="1">(</a><a id="1">UGP</a>(<span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><a id="21257">a1</a></span>, <span class="typed"><span class="type">Boolean</span><a id="21258">d1</a></span>, <span class="typed"><span class="type">Any</span><a id="21259">v1</a></span>, <span class="typed"><span class="type">(Any) =&gt; Any</span><a id="21260">c1</a></span>) <a id="1">::</a> <span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a id="21261">rest1</a></span>, <a id="1">UGP</a>(<span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><a id="21262">a2</a></span>, <span class="typed"><span class="type">Boolean</span><a id="21263">d2</a></span>, <span class="typed"><span class="type">Any</span><a id="21264">v2</a></span>, <span class="typed"><span class="type">(Any) =&gt; Any</span><a id="21265">c2</a></span>) <a id="1">::</a> <span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a id="21266">rest2</a></span>) =&gt;
        <span class="typed"><span class="type">Option[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><a href="#21257">a1</a></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><a href="#21262">a2</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">Boolean</span><a href="#21258">d1</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2746">==</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">Boolean</span><a href="#21263">d2</a></span>)
          <span class="typed"><span class="type">((() =&gt; Unit, () =&gt; Any, () =&gt; Any))Some[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><a href="../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">(() =&gt; Unit,() =&gt; Any,() =&gt; Any)(() =&gt; Unit, () =&gt; Any, () =&gt; Any)</span><a href="../Tuple3.scala.html#21271">(</a></span>(() =&gt; <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean</span><a href="#21258">d1</a></span>) <span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><a href="#21257">a1</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../Function1.scala.html#17300">log</a></span>(<span class="typed"><span class="type">Any</span><a href="#21264">v2</a></span>) <span class="keyword">else</span> <span class="typed"><span class="type">scala.concurrent.pilib.UChan</span><a href="#21257">a1</a></span>.<span class="typed"><span class="type">(Any)Unit</span><a href="../Function1.scala.html#17300">log</a></span>(<span class="typed"><span class="type">Any</span><a href="#21259">v1</a></span>)), (() =&gt; <span class="typed"><span class="type">(Any)Any</span><a href="../Function1.scala.html#17300">c1</a></span>(<span class="typed"><span class="type">Any</span><a href="#21264">v2</a></span>)), (() =&gt; <span class="typed"><span class="type">(Any)Any</span><a href="../Function1.scala.html#17300">c2</a></span>(<span class="typed"><span class="type">Any</span><a href="#21259">v1</a></span>))))
        <span class="keyword">else</span> <span class="typed"><span class="type">(List[scala.concurrent.pilib.UGP],List[scala.concurrent.pilib.UGP])Option[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><a href="#20452">matches</a></span>(<span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a href="#21216">gs1</a></span>, <span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a href="#21266">rest2</a></span>) <span class="typed"><span class="type">Option[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><span class="keyword">match</span></span> {
          <span class="typed"><span class="type">Option[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a href="../Option.scala.html#534">None</a></span> =&gt; <span class="typed"><span class="type">(List[scala.concurrent.pilib.UGP],List[scala.concurrent.pilib.UGP])Option[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><a href="#20452">matches</a></span>(<span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a href="#21261">rest1</a></span>, <span class="typed"><span class="type">List[scala.concurrent.pilib.UGP]</span><a href="#21217">gs2</a></span>)
          <span class="typed"><span class="type">Some[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><span class="keyword">case</span></span> <a id="1">Some</a>(<span class="typed"><span class="type">(() =&gt; Unit, () =&gt; Any, () =&gt; Any)</span><a id="21294">t</a></span>) =&gt; <span class="typed"><span class="type">((() =&gt; Unit, () =&gt; Any, () =&gt; Any))Some[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><a href="../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">(() =&gt; Unit, () =&gt; Any, () =&gt; Any)</span><a href="#21294">t</a></span>)
        }
    }

  <span class="comment">/** Test if the given sum can react with one of the pending sums.
   *  If yes then do the reaction otherwise append the sum at the end
   *  of the pending sums.
   *
   *  @param s1 ...
   *  @param ss ...
   *  @return   ...
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.concurrent.pilib.Sum,List[scala.concurrent.pilib.Sum])List[scala.concurrent.pilib.Sum]</span><a id="20453">compare</a></span>(<span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a id="21296">s1</a></span>: <span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a href="#20446">Sum</a></span>, <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><a id="21297">ss</a></span>: <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><a href="../List.scala.html#524">List</a></span>[Sum]): <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><a href="../List.scala.html#524">List</a></span>[Sum] =
    <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><a href="#21297">ss</a></span> <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><span class="keyword">match</span></span> {
      <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object Nil</span><a href="../List.scala.html#333">Nil</a></span> =&gt; <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><a href="#21297">ss</a></span> <span class="typed"><span class="type">(List[scala.concurrent.pilib.Sum])List[scala.concurrent.pilib.Sum]</span><a href="../List.scala.html#20878">:::</a></span> <span class="typed"><span class="type">(scala.concurrent.pilib.Sum*)List[scala.concurrent.pilib.Sum]</span><a href="../List.scala.html#16977">List</a></span>(<span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a href="#21296">s1</a></span>)
      <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a id="21304">s2</a></span> <a id="1">::</a> <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><a id="21305">rest</a></span> =&gt; <span class="typed"><span class="type">(List[scala.concurrent.pilib.UGP],List[scala.concurrent.pilib.UGP])Option[(() =&gt; Unit, () =&gt; Any, () =&gt; Any)]</span><a href="#20452">matches</a></span>(<span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a href="#21296">s1</a></span>.<span class="typed"><span class="type">=&gt; List[scala.concurrent.pilib.UGP]</span><a href="#21158">gs</a></span>, <span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a href="#21304">s2</a></span>.<span class="typed"><span class="type">=&gt; List[scala.concurrent.pilib.UGP]</span><a href="#21158">gs</a></span>) <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a href="../Option.scala.html#534">None</a></span> =&gt; <span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a href="#21304">s2</a></span> <span class="typed"><span class="type">(scala.concurrent.pilib.Sum)List[scala.concurrent.pilib.Sum]</span><a href="../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">(scala.concurrent.pilib.Sum,List[scala.concurrent.pilib.Sum])List[scala.concurrent.pilib.Sum]</span><a href="#20453">compare</a></span>(<span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a href="#21296">s1</a></span>, <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><a href="#21305">rest</a></span>)
        <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><span class="keyword">case</span></span> <a id="1">Some</a>(<a id="1">(</a><span class="typed"><span class="type">() =&gt; Unit</span><a id="21319">log</a></span>, <span class="typed"><span class="type">() =&gt; Any</span><a id="21320">c1</a></span>, <span class="typed"><span class="type">() =&gt; Any</span><a id="21321">c2</a></span>)) =&gt;
          <span class="typed"><span class="type">()Unit</span><a href="../Function0.scala.html#21123">log</a></span>()
          <span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a href="#21296">s1</a></span>.<span class="typed"><span class="type">(() =&gt; Any)Unit</span><a href="#21168">set</a></span>(<span class="typed"><span class="type">() =&gt; Any</span><a href="#21320">c1</a></span>)
          <span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a href="#21304">s2</a></span>.<span class="typed"><span class="type">(() =&gt; Any)Unit</span><a href="#21168">set</a></span>(<span class="typed"><span class="type">() =&gt; Any</span><a href="#21321">c2</a></span>)
          <span class="typed"><span class="type">List[scala.concurrent.pilib.Sum]</span><a href="#21305">rest</a></span>
      }
    }

  <span class="comment">/** Pi-calculus non-deterministic choice.
   *
   *  @param s ...
   *  @return  ...
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">[A](scala.concurrent.pilib.GP[A]*)A</span><a id="20454">choice</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="20456">A</a></span>](<span class="typed"><span class="type">scala.concurrent.pilib.GP[A]*</span><a id="21128">s</a></span>: <span class="typed"><span class="type">scala.concurrent.pilib.GP[A]*</span><a id="2739">GP</a></span>[A]*): <span class="typed"><span class="type">A</span><a href="#20456">A</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a id="21322">sum</a></span> = <span class="typed"><span class="type">(List[scala.concurrent.pilib.UGP])scala.concurrent.pilib.Sum</span><a href="#21189">Sum</a></span>(<span class="typed"><span class="type">scala.concurrent.pilib.GP[A]*</span><a href="#21128">s</a></span>.<span class="typed"><span class="type">=&gt; List[scala.concurrent.pilib.GP[A]]</span><a href="../Iterable.scala.html#17360">toList</a></span> <span class="typed"><span class="type">((scala.concurrent.pilib.GP[A]) =&gt; scala.concurrent.pilib.UGP)List[scala.concurrent.pilib.UGP]</span><a href="../List.scala.html#20904">map</a></span> { <span class="typed"><span class="type">scala.concurrent.pilib.GP[A]</span><a href="#21331">_</a></span>.<span class="typed"><span class="type">=&gt; scala.concurrent.pilib.UGP</span><a href="#21064">untyped</a></span> })
    <span class="typed"><span class="type">(Unit)Unit</span><a id="5794">synchronized</a></span> { <span class="typed"><span class="type">(List[scala.concurrent.pilib.Sum])Unit</span><a href="#20450">sums</a></span> = <span class="typed"><span class="type">(scala.concurrent.pilib.Sum,List[scala.concurrent.pilib.Sum])List[scala.concurrent.pilib.Sum]</span><a href="#20453">compare</a></span>(<span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a href="#21322">sum</a></span>, <span class="typed"><span class="type">=&gt; List[scala.concurrent.pilib.Sum]</span><a href="#20449">sums</a></span>) }
    (<span class="typed"><span class="type">scala.concurrent.pilib.Sum</span><a href="#21322">sum</a></span>.<span class="typed"><span class="type">=&gt; Any</span><a href="#21167">continue</a></span>).<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#20456">A</a></span>]
  }

}

        </pre>
    </body>
</html>