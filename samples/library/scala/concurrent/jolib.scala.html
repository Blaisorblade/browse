<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/concurrent/jolib.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style">
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

// $Id: jolib.scala 18511 2009-08-19 03:27:37Z extempore $


<span class="keyword">package</span> scala.concurrent

<span class="keyword">import</span> ops._

/**
 * Library for using join-calculus concurrent primitives in Scala.
 *
 * @author  Vincent Cremet
 * @version 1.0, 17/10/2003
 */ 
@deprecated(<span class="string">&quot;Will be removed.&quot;</span>)
<span class="keyword">object</span> <a title="object scala.concurrent.jolib" id="8402">jolib</a> <a href="../ScalaObject.scala.html#969" title="ScalaObject">{</a>

  <span class="keyword">type</span> <a title="List[scala.concurrent.jolib.Signal]" id="210812">Pattern</a> = <a href="../collection/immutable/List.scala.html#9048" title="List[scala.concurrent.jolib.Signal]">List</a>[Signal]

  <span class="keyword">type</span> <a title="PartialFunction[List[Any],Unit]" id="210813">Rule</a> = <a href="../PartialFunction.scala.html#1098" title="PartialFunction[List[Any],Unit]">PartialFunction</a>[List[Any], Unit]

  /////////////////// JOIN DEFINITION /////////////////////////

  <span class="keyword">class</span> <a title="class Join extends java.lang.Object with ScalaObject" id="210814">Join</a> <a href="../ScalaObject.scala.html#969" title="ScalaObject">{</a>

    <span class="keyword">private</span> <span class="keyword">var</span> <a title="List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]" id="210824">ruls</a>: <a href="../collection/immutable/List.scala.html#9048" title="List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]">List</a>[(Pattern, Rule)] = <span title="Null(null)" class="keyword">null</span>

    <span class="keyword">def</span> <a title="(p: scala.concurrent.jolib.Pattern)Boolean" id="210826">canMatch</a>(<a title="scala.concurrent.jolib.Pattern" id="210834">p</a>: <a href="../collection/immutable/List.scala.html#9048" title="scala.concurrent.jolib.Pattern">Pattern</a>) =
      <a href="../collection/generic/LinearSequenceTemplate.scala.html#19512" title="(p: (scala.concurrent.jolib.Signal) =&gt; Boolean)Boolean">p</a> forall { <a title="scala.concurrent.jolib.Signal" id="210841">s</a> =&gt; <a title="=&gt; Boolean" id="2218">!</a><a href="#210841" title="scala.concurrent.jolib.Signal">s</a>.<a href="#210846" title="=&gt; scala.collection.mutable.Queue[s.C]">queue</a>.<a href="../collection/mutable/MutableList.scala.html#19646" title="=&gt; Boolean">isEmpty</a> }
    
    <span class="keyword">def</span> <a title="(p: scala.concurrent.jolib.Pattern)List[Any]" id="210827">values</a>(<a title="scala.concurrent.jolib.Pattern" id="210853">p</a>: <a href="../collection/immutable/List.scala.html#9048" title="scala.concurrent.jolib.Pattern">Pattern</a>): <a href="../collection/immutable/List.scala.html#9048" title="List[Any]">List</a>[Any] =
      <a href="../collection/generic/TraversableTemplate.scala.html#17268" title="(f: (scala.concurrent.jolib.Signal) =&gt; Any)(implicit bf: scala.collection.generic.BuilderFactory[Any,List[Any],List[scala.concurrent.jolib.Signal]])List[Any]">p</a> <a href="../collection/immutable/List.scala.html#17633" title="scala.collection.generic.BuilderFactory[Any,List[Any],List#Coll]">map</a> { <a title="scala.concurrent.jolib.Signal" id="210863">s</a> =&gt; <a href="#210863" title="scala.concurrent.jolib.Signal">s</a>.<a href="#210846" title="=&gt; scala.collection.mutable.Queue[s.C]">queue</a>.<a href="../collection/mutable/Queue.scala.html#19665" title="()s.C">dequeue</a>: <a title="Any" id="47">Any</a> }

    <span class="keyword">def</span> <a title="(rs: (scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)*)Unit" id="210828">rules</a>(<a title="(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)*" id="210893">rs</a>: <a title="(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)*" id="4191">(</a>Pattern, Rule)*) =
      <a href="#210824" title="(x$1: List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)])Unit">ruls</a> = <a href="#210893" title="(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)*">rs</a>.<a title="[T0]T0" id="3636">asInstanceOf</a><span title="List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]">[</span><a href="../collection/immutable/List.scala.html#9048" title="List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]">List</a>[(Pattern, Rule)]]

    <span class="keyword">def</span> <a title="=&gt; () =&gt; Unit" id="210829">tryMatch</a> =
      <a href="../collection/generic/LinearSequenceTemplate.scala.html#19515" title="(p: ((scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)) =&gt; Boolean)Option[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]">ruls</a> find <a href="#210906" title="Boolean">{</a> <span title="Boolean" class="keyword">case</span> (<a title="scala.concurrent.jolib.Pattern" id="210909">p</a>, _) =&gt; <a href="#210826" title="(p: scala.concurrent.jolib.Pattern)Boolean">canMatch</a>(<a href="#210909" title="scala.concurrent.jolib.Pattern">p</a>) } <span title="() =&gt; Unit" class="keyword">match</span> {
        <span title="() =&gt; Unit" class="keyword">case</span> <a href="../Option.scala.html#472" title="object None">None</a> =&gt; () =&gt; <span title="Unit">(</span>)
        <span title="() =&gt; Unit" class="keyword">case</span> Some((<a title="scala.concurrent.jolib.Pattern" id="210920">p</a>, <a title="scala.concurrent.jolib.Rule" id="210921">r</a>)) =&gt; {
          <span class="keyword">val</span> <a title="List[Any]" id="210926">args</a> = <a href="#210827" title="(p: scala.concurrent.jolib.Pattern)List[Any]">values</a>(<a href="#210920" title="scala.concurrent.jolib.Pattern">p</a>)
          () =&gt; <a href="ops.scala.html#52381" title="(p: =&gt; Unit)(implicit runner: scala.concurrent.TaskRunner[Unit])Unit">spawn</a><a href="ops.scala.html#52368" title="=&gt; scala.concurrent.TaskRunner[Unit]">(</a><a href="../Function1.scala.html#17226" title="(v1: List[Any])Unit">r</a>(<a href="#210926" title="List[Any]">args</a>))
        }
      }

  }

  /////////////////// SIGNALS /////////////////////////
  
  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Signal extends java.lang.Object with ScalaObject" id="210815">Signal</a><a href="../ScalaObject.scala.html#969" title="ScalaObject">(</a><a title="scala.concurrent.jolib.Join" id="210942">join</a>: <a href="#210814" title="scala.concurrent.jolib.Join">Join</a>) {
    <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: Any" id="210845">C</a>
    <span class="keyword">val</span> <a title="scala.collection.mutable.Queue[Signal.this.C]" id="210846">queue</a> = <span title="scala.collection.mutable.Queue[Signal.this.C]" class="keyword">new</span> collection.mutable.<a href="../collection/mutable/Queue.scala.html#7950" title="scala.collection.mutable.Queue[Signal.this.C]">Queue</a>[C]
    <span class="keyword">def</span> <a title="(x: Signal.this.C)Unit" id="210848">tryReduction</a>(<a title="Signal.this.C" id="210945">x</a>: <a href="#210845" title="Signal.this.C">C</a>) {
      <span class="keyword">val</span> <a title="() =&gt; Unit" id="210947">continuation</a> = <a href="#210942" title="(x$1: () =&gt; Unit)() =&gt; Unit" id="6598">join</a> synchronized {
        <a href="#210846" title="=&gt; scala.collection.mutable.Queue[Signal.this.C]">queue</a>.<a href="../collection/mutable/Queue.scala.html#19664" title="(elems: Signal.this.C*)Unit">enqueue</a>(<a href="#210945" title="Signal.this.C">x</a>)
        <a href="#210942" title="scala.concurrent.jolib.Join">join</a>.<a href="#210829" title="=&gt; () =&gt; Unit">tryMatch</a>
      }
      <a href="../Function0.scala.html#34209" title="()Unit">continuation</a>()
    }
  }

  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Asynchr extends scala.concurrent.jolib.Signal with ScalaObject" id="210816">Asynchr</a><a href="../ScalaObject.scala.html#969" title="ScalaObject">(</a><a title="scala.concurrent.jolib.Join" id="210964">join</a>: <a href="#210814" title="scala.concurrent.jolib.Join">Join</a>) <span class="keyword">extends</span> <a href="#210815" title="scala.concurrent.jolib.Signal">Signal</a>(<a href="#210964" title="scala.concurrent.jolib.Join">join</a>) {
    <span class="keyword">def</span> <a title="(x: Asynchr.this.C)Unit" id="210961">apply</a>(<a title="Asynchr.this.C" id="210967">x</a>: <a href="#210845" title="Asynchr.this.C">C</a>): <a title="Unit" id="1963">Unit</a> = <a href="#210848" title="(x: Asynchr.this.C)Unit">tryReduction</a>(<a href="#210967" title="Asynchr.this.C">x</a>)
  }

  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Synchr[A] extends scala.concurrent.jolib.Signal with ScalaObject" id="210817">Synchr</a>[<a title="&gt;: Nothing &lt;: Any" id="210818">A</a>]<a href="../ScalaObject.scala.html#969" title="ScalaObject">(</a><a title="scala.concurrent.jolib.Join" id="210979">join</a>: <a href="#210814" title="scala.concurrent.jolib.Join">Join</a>) <span class="keyword">extends</span> <a href="#210815" title="scala.concurrent.jolib.Signal">Signal</a>(<a href="#210979" title="scala.concurrent.jolib.Join">join</a>) {
    <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: scala.concurrent.SyncVar[A]" id="210975">C</a> &lt;: SyncVar[A]
    <span class="keyword">def</span> <a title="(x: Synchr.this.C)A" id="210976">apply</a>(<a title="Synchr.this.C" id="210982">x</a>: <a href="#210975" title="Synchr.this.C">C</a>): <a href="#210818" title="A">A</a> = {
      <a href="#210848" title="(x: Synchr.this.C)Unit">tryReduction</a>(<a href="#210982" title="Synchr.this.C">x</a>)
      <a href="#210982" title="Synchr.this.C">x</a>.<a href="SyncVar.scala.html#20889" title="=&gt; A">get</a>
    }
  }

}


        </pre>
    </body>
</html>