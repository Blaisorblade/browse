<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/concurrent/jolib.scala</title>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: jolib.scala 16893 2009-01-13 13:09:22Z cunei $</span>


<span class="keyword">package</span> scala.concurrent


<span class="comment">/**
 * Library for using join-calculus concurrent primitives in Scala.
 *
 * @author  Vincent Cremet
 * @version 1.0, 17/10/2003
 */</span> 
@<span class="typed"><span class="type">deprecated</span><a href="../deprecated.scala.html#215">deprecated</a></span> <span class="keyword">object</span> <span class="typed"><span class="type">object scala.concurrent.jolib</span><a id="7818">jolib</a></span> {

  <span class="keyword">type</span> <span class="typed"><span class="type">List[scala.concurrent.jolib.Signal]</span><a id="54402">Pattern</a></span> = <span class="typed"><span class="type">List[scala.concurrent.jolib.Signal]</span><a href="../List.scala.html#524">List</a></span>[Signal]

  <span class="keyword">type</span> <span class="typed"><span class="type">PartialFunction[List[Any],Unit]</span><a id="54403">Rule</a></span> = <span class="typed"><span class="type">PartialFunction[List[Any],Unit]</span><a href="../PartialFunction.scala.html#1295">PartialFunction</a></span>[List[Any], Unit]

  <span class="comment">/////////////////// JOIN DEFINITION /////////////////////////</span>

  <span class="keyword">class</span> <span class="typed"><span class="type">class Join extends java.lang.Object with ScalaObject</span><a id="54404">Join</a></span> {

    <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]</span><span id="54413"><span id="54411"><span id="54412"><a id="54419">ruls</a></span></span></span></span>: <span class="typed"><span class="type">List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]</span><a href="../List.scala.html#524">List</a></span>[(Pattern, Rule)] = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>

    <span class="keyword">def</span> <span class="typed"><span class="type">(scala.concurrent.jolib.Pattern)Boolean</span><a id="54414">canMatch</a></span>(<span class="typed"><span class="type">scala.concurrent.jolib.Pattern</span><a id="54420">p</a></span>: <span class="typed"><span class="type">scala.concurrent.jolib.Pattern</span><a href="../List.scala.html#524">Pattern</a></span>) =
      <span class="typed"><span class="type">scala.concurrent.jolib.Pattern</span><a href="#54420">p</a></span> <span class="typed"><span class="type">((scala.concurrent.jolib.Signal) =&gt; Boolean)Boolean</span><a href="../List.scala.html#20916">forall</a></span> { <span class="typed"><span class="type">scala.concurrent.jolib.Signal</span><a id="54424">s</a></span> =&gt; <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">scala.concurrent.jolib.Signal</span><a href="#54424">s</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.Queue[s.C]</span><a href="#54429">queue</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../collection/mutable/Queue.scala.html#52735">isEmpty</a></span> }
    
    <span class="keyword">def</span> <span class="typed"><span class="type">(scala.concurrent.jolib.Pattern)List[Any]</span><a id="54415">values</a></span>(<span class="typed"><span class="type">scala.concurrent.jolib.Pattern</span><a id="54433">p</a></span>: <span class="typed"><span class="type">scala.concurrent.jolib.Pattern</span><a href="../List.scala.html#524">Pattern</a></span>): <span class="typed"><span class="type">List[Any]</span><a href="../List.scala.html#524">List</a></span>[Any] =
      <span class="typed"><span class="type">scala.concurrent.jolib.Pattern</span><a href="#54433">p</a></span> <span class="typed"><span class="type">((scala.concurrent.jolib.Signal) =&gt; Any)List[Any]</span><a href="../List.scala.html#20904">map</a></span> { <span class="typed"><span class="type">scala.concurrent.jolib.Signal</span><a id="54436">s</a></span> =&gt; <span class="typed"><span class="type">scala.concurrent.jolib.Signal</span><a href="#54436">s</a></span>.<span class="typed"><span class="type">=&gt; scala.collection.mutable.Queue[s.C]</span><a href="#54429">queue</a></span>.<span class="typed"><span class="type">()s.C</span><a href="../collection/mutable/Queue.scala.html#52740">dequeue</a></span>: <span class="typed"><span class="type">Any</span><a id="49">Any</a></span> }

    <span class="keyword">def</span> <span class="typed"><span class="type">((scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)*)Unit</span><a id="54416">rules</a></span>(<span class="typed"><span class="type">(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)*</span><a id="54437">rs</a></span>: <span class="typed"><span class="type">(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)*</span><a id="2739">(</a></span>Pattern, Rule)*) =
      <span class="typed"><span class="type">(List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)])Unit</span><a href="#54412">ruls</a></span> = <span class="typed"><span class="type">(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)*</span><a href="#54437">rs</a></span>.<span class="typed"><span class="type">List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]</span><a href="../List.scala.html#524">List</a></span>[(Pattern, Rule)]]

    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; () =&gt; Unit</span><a id="54417">tryMatch</a></span> =
      <span class="typed"><span class="type">=&gt; List[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]</span><a href="#54411">ruls</a></span> <span class="typed"><span class="type">(((scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)) =&gt; Boolean)Option[(scala.concurrent.jolib.Pattern, scala.concurrent.jolib.Rule)]</span><a href="../List.scala.html#20918">find</a></span> <span class="typed"><span class="type">Boolean</span><a href="#54444">{</a></span> <span class="typed"><span class="type">Boolean</span><span class="keyword">case</span></span> <a id="1">(</a><span class="typed"><span class="type">scala.concurrent.jolib.Pattern</span><a id="54445">p</a></span>, _) =&gt; <span class="typed"><span class="type">(scala.concurrent.jolib.Pattern)Boolean</span><a href="#54414">canMatch</a></span>(<span class="typed"><span class="type">scala.concurrent.jolib.Pattern</span><a href="#54445">p</a></span>) } <span class="typed"><span class="type">() =&gt; Unit</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">() =&gt; Unit</span><span class="keyword">case</span></span> <span class="typed"><span class="type">object None</span><a href="../Option.scala.html#534">None</a></span> =&gt; () =&gt; <span class="typed"><span class="type">Unit</span><span >(</span></span>)
        <span class="typed"><span class="type">() =&gt; Unit</span><span class="keyword">case</span></span> <a id="1">Some</a>(<a id="1">(</a><span class="typed"><span class="type">scala.concurrent.jolib.Pattern</span><a id="54447">p</a></span>, <span class="typed"><span class="type">scala.concurrent.jolib.Rule</span><a id="54448">r</a></span>)) =&gt; {
          <span class="keyword">val</span> <span class="typed"><span class="type">List[Any]</span><a id="54449">args</a></span> = <span class="typed"><span class="type">(scala.concurrent.jolib.Pattern)List[Any]</span><a href="#54415">values</a></span>(<span class="typed"><span class="type">scala.concurrent.jolib.Pattern</span><a href="#54447">p</a></span>)
          () =&gt; concurrent.<span class="typed"><span class="type">object scala.concurrent.ops</span><a href="ops.scala.html#7728">ops</a></span>.<span class="typed"><span class="type">(=&gt; Unit)Unit</span><a href="ops.scala.html#20473">spawn</a></span>(<span class="typed"><span class="type">(List[Any])Unit</span><a href="../Function1.scala.html#17300">r</a></span>(<span class="typed"><span class="type">List[Any]</span><a href="#54449">args</a></span>))
        }
      }

  }

  <span class="comment">/////////////////// SIGNALS /////////////////////////</span>
  
  <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Signal extends java.lang.Object with ScalaObject</span><a id="54405">Signal</a></span>(<span class="typed"><span class="type">scala.concurrent.jolib.Join</span><span id="54426"><a id="54453">join</a></span></span>: <span class="typed"><span class="type">scala.concurrent.jolib.Join</span><a href="#54404">Join</a></span>) {
    <span class="keyword">type</span> <span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="54428">C</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.mutable.Queue[Signal.this.C]</span><span id="54430"><a id="54429">queue</a></span></span> = <span class="typed"><span class="type">scala.collection.mutable.Queue[Signal.this.C]</span><span class="keyword">new</span></span> collection.mutable.<span class="typed"><span class="type">scala.collection.mutable.Queue[Signal.this.C]</span><a href="../collection/mutable/Queue.scala.html#11488">Queue</a></span>[C]
    <span class="keyword">def</span> <span class="typed"><span class="type">(Signal.this.C)Unit</span><a id="54431">tryReduction</a></span>(<span class="typed"><span class="type">Signal.this.C</span><a id="54454">x</a></span>: <span class="typed"><span class="type">Signal.this.C</span><a href="#54428">C</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">() =&gt; Unit</span><a id="54455">continuation</a></span> = <span class="typed"><span class="type">scala.concurrent.jolib.Join</span><a href="#54426">join</a></span> <span class="typed"><span class="type">(() =&gt; Unit)() =&gt; Unit</span><a id="5794">synchronized</a></span> {
        <span class="typed"><span class="type">=&gt; scala.collection.mutable.Queue[Signal.this.C]</span><a href="#54429">queue</a></span>.<span class="typed"><span class="type">(Signal.this.C*)Unit</span><a href="../collection/mutable/Queue.scala.html#52739">enqueue</a></span>(<span class="typed"><span class="type">Signal.this.C</span><a href="#54454">x</a></span>)
        <span class="typed"><span class="type">scala.concurrent.jolib.Join</span><a href="#54426">join</a></span>.<span class="typed"><span class="type">=&gt; () =&gt; Unit</span><a href="#54417">tryMatch</a></span>
      }
      <span class="typed"><span class="type">()Unit</span><a href="../Function0.scala.html#21123">continuation</a></span>()
    }
  }

  <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Asynchr extends scala.concurrent.jolib.Signal with ScalaObject</span><a id="54406">Asynchr</a></span>(<span class="typed"><span class="type">scala.concurrent.jolib.Join</span><span id="54459"><a id="54464">join</a></span></span>: <span class="typed"><span class="type">scala.concurrent.jolib.Join</span><a href="#54404">Join</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">scala.concurrent.jolib.Signal</span><a href="#54405">Signal</a></span>(<span class="typed"><span class="type">scala.concurrent.jolib.Join</span><a href="#54464">join</a></span>) {
    <span class="keyword">def</span> <span class="typed"><span class="type">(Asynchr.this.C)Unit</span><a id="54461">apply</a></span>(<span class="typed"><span class="type">Asynchr.this.C</span><a id="54465">x</a></span>: <span class="typed"><span class="type">Asynchr.this.C</span><a href="#54428">C</a></span>): <span class="typed"><span class="type">Unit</span><a id="2167">Unit</a></span> = <span class="typed"><span class="type">(Asynchr.this.C)Unit</span><a href="#54431">tryReduction</a></span>(<span class="typed"><span class="type">Asynchr.this.C</span><a href="#54465">x</a></span>)
  }

  <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Synchr[A] extends scala.concurrent.jolib.Signal with ScalaObject</span><a id="54407">Synchr</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="54408">A</a></span>](<span class="typed"><span class="type">scala.concurrent.jolib.Join</span><span id="54467"><a id="54473">join</a></span></span>: <span class="typed"><span class="type">scala.concurrent.jolib.Join</span><a href="#54404">Join</a></span>) <span class="keyword">extends</span> <span class="typed"><span class="type">scala.concurrent.jolib.Signal</span><a href="#54405">Signal</a></span>(<span class="typed"><span class="type">scala.concurrent.jolib.Join</span><a href="#54473">join</a></span>) {
    <span class="keyword">type</span> <span class="typed"><span class="type">&gt;: Nothing &lt;: scala.concurrent.SyncVar[A]</span><a id="54469">C</a></span> &lt;: SyncVar[A]
    <span class="keyword">def</span> <span class="typed"><span class="type">(Synchr.this.C)A</span><a id="54470">apply</a></span>(<span class="typed"><span class="type">Synchr.this.C</span><a id="54492">x</a></span>: <span class="typed"><span class="type">Synchr.this.C</span><a href="#54469">C</a></span>): <span class="typed"><span class="type">A</span><a href="#54408">A</a></span> = {
      <span class="typed"><span class="type">(Synchr.this.C)Unit</span><a href="#54431">tryReduction</a></span>(<span class="typed"><span class="type">Synchr.this.C</span><a href="#54492">x</a></span>)
      <span class="typed"><span class="type">Synchr.this.C</span><a href="#54492">x</a></span>.<span class="typed"><span class="type">=&gt; A</span><a href="SyncVar.scala.html#54484">get</a></span>
    }
  }

}


        </pre>
    </body>
</html>