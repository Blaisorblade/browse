<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/concurrent/ops.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style">
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

// $Id: ops.scala 18585 2009-08-27 05:35:33Z extempore $


<span class="keyword">package</span> scala.concurrent

<span class="keyword">import</span> java.lang.Thread
<span class="keyword">import</span> scala.util.control.Exception.allCatch

/** The object &lt;code&gt;ops&lt;/code&gt; ...
 *
 *  @author  Martin Odersky, Stepan Koltsov, Philipp Haller
 */
<span class="keyword">object</span> <a title="object scala.concurrent.ops" id="8258">ops</a>
<a href="../ScalaObject.scala.html#969" title="ScalaObject">{</a>
  <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="scala.concurrent.TaskRunner[Unit]" id="52368">defaultRunner</a>: <a href="TaskRunner.scala.html#8272" title="scala.concurrent.TaskRunner[Unit]">TaskRunner</a>[Unit] =
    <a href="TaskRunners.scala.html#8357" title="object scala.concurrent.TaskRunners">TaskRunners</a>.<a href="TaskRunners.scala.html#71484" title="=&gt; scala.concurrent.TaskRunner[Unit]">threadRunner</a>

  /**
   *  If expression computed successfully return it in &lt;code&gt;Right&lt;/code&gt;,
   *  otherwise return exception in &lt;code&gt;Left&lt;/code&gt;.
   */
  <span class="keyword">def</span> <a title="[A](body: =&gt; A)Either[Throwable,A]" id="52370">tryCatch</a>[<a title="&gt;: Nothing &lt;: Any" id="52372">A</a>](<a title="=&gt; A" id="71488">body</a>: =&gt; A): <a href="../Either.scala.html#312" title="Either[Throwable,A]">Either</a>[Throwable, A] =
    <a href="../util/control/Exception.scala.html#31342" title="[T]util.control.Exception.Catch[T]">allCatch</a><a href="../util/control/Exception.scala.html#47598" title="(body: =&gt; A)Either[Throwable,A]">[</a><a href="#52372" title="A">A</a>] either <a href="#71488" title="=&gt; A">body</a>
  
  <span class="keyword">def</span> <a title="[A](body: =&gt; A)Either[Exception,A]" id="52373">tryCatchEx</a>[<a title="&gt;: Nothing &lt;: Any" id="52375">A</a>](<a title="=&gt; A" id="71503">body</a>: =&gt; A): <a href="../Either.scala.html#312" title="Either[Exception,A]">Either</a>[Exception, A] =
    <span class="keyword">try</span> <a href="../Either.scala.html#71507" title="(b: A)Right[Nothing,A]">Right</a>(<a href="#71503" title="=&gt; A">body</a>) <span class="keyword">catch</span> {
      <span title="Left[Exception,Nothing]" class="keyword">case</span> <a title="Exception" id="71536">ex</a>: <a title="Exception" id="1888">Exception</a>  =&gt; <a href="../Either.scala.html#71538" title="(a: Exception)Left[Exception,Nothing]">Left</a>(<a href="#71536" title="Exception">ex</a>)
    }
  
  <span class="keyword">def</span> <a title="[T &lt;: Throwable, A](x: Either[T,A])A" id="52376">getOrThrow</a>[<a title="&gt;: Nothing &lt;: Throwable" id="52379">T</a> &lt;: Throwable, <a title="&gt;: Nothing &lt;: Any" id="52380">A</a>](<a title="Either[T,A]" id="52391">x</a>: <a href="../Either.scala.html#312" title="Either[T,A]">Either</a>[T, A]): <a href="#52380" title="A">A</a> =
    <a href="#52391" title="Either[T,A]">x</a>.<a href="../Either.scala.html#52402" title="[X](fa: (T) =&gt; X,fb: (A) =&gt; X)X">fold</a><span title="(fa: (T) =&gt; A,fb: (A) =&gt; A)A">[</span><a href="#52380" title="A">A</a>](<span title="Nothing" class="keyword">throw</span> <a href="#71612" title="T">_</a>, <a href="../Predef.scala.html#16312" title="(x: A)A">identity</a> _)

  /** Evaluates an expression asynchronously.
   *
   *  @param  p the expression to evaluate
   */
  <span class="keyword">def</span> <a title="(p: =&gt; Unit)(implicit runner: scala.concurrent.TaskRunner[Unit])Unit" id="52381">spawn</a>(<a title="=&gt; Unit" id="71633">p</a>: =&gt; Unit)(<span class="keyword">implicit</span> <a title="scala.concurrent.TaskRunner[Unit]" id="71627">runner</a>: <a href="TaskRunner.scala.html#8272" title="scala.concurrent.TaskRunner[Unit]">TaskRunner</a>[Unit] = <a href="#52368" title="=&gt; scala.concurrent.TaskRunner[Unit]">defaultRunner</a>): <a title="Unit" id="1963">Unit</a> = {
    <a href="TaskRunner.scala.html#52168" title="(task: () =&gt; Unit)runner.Future[Unit]">runner</a> <span title="Unit">submit</span> (() =&gt; <a href="#71633" title="=&gt; Unit">p</a>)
  }

  /**
   *  @param p ...
   *  @return  ...
   */
  <span class="keyword">def</span> <a title="[A](p: =&gt; A)(implicit runner: scala.concurrent.TaskRunner[Unit])() =&gt; A" id="52382">future</a>[<a title="&gt;: Nothing &lt;: Any" id="71640">A</a>](<a title="=&gt; A" id="71666">p</a>: =&gt; A)(<span class="keyword">implicit</span> <a title="scala.concurrent.TaskRunner[Unit]" id="71638">runner</a>: <a href="TaskRunner.scala.html#8272" title="scala.concurrent.TaskRunner[Unit]">TaskRunner</a>[Unit] = <a href="#52368" title="=&gt; scala.concurrent.TaskRunner[Unit]">defaultRunner</a>): () =&gt; A = {
    <span class="keyword">val</span> <a title="scala.concurrent.SyncVar[Either[Throwable,A]]" id="71642">result</a> = <span title="scala.concurrent.SyncVar[Either[Throwable,A]]" class="keyword">new</span> <a href="SyncVar.scala.html#8467" title="scala.concurrent.SyncVar[Either[Throwable,A]]">SyncVar</a>[Either[Throwable, A]]
    <a href="#52381" title="(p: =&gt; Unit)(implicit runner: scala.concurrent.TaskRunner[Unit])Unit">spawn</a>({ <a href="SyncVar.scala.html#20892" title="(x: Either[Throwable,A])Unit">result</a> set <a href="#52370" title="(body: =&gt; A)Either[Throwable,A]">tryCatch</a>(<a href="#71666" title="=&gt; A">p</a>) })(<a href="#71638" title="scala.concurrent.TaskRunner[Unit]">runner</a>)
    () =&gt; <a href="#52376" title="(x: Either[Throwable,A])A">getOrThrow</a>(<a href="#71642" title="scala.concurrent.SyncVar[Either[Throwable,A]]">result</a>.<a href="SyncVar.scala.html#20889" title="=&gt; Either[Throwable,A]">get</a>)
  }

  /**
   *  @param xp ...
   *  @param yp ...
   *  @return   ...
   */
  <span class="keyword">def</span> <a title="[A, B](xp: =&gt; A,yp: =&gt; B)(A, B)" id="52385">par</a>[<a title="&gt;: Nothing &lt;: Any" id="52388">A</a>, <a title="&gt;: Nothing &lt;: Any" id="52389">B</a>](<a title="=&gt; A" id="71669">xp</a>: =&gt; A, <a title="=&gt; B" id="71670">yp</a>: =&gt; B): <a href="../Tuple2.scala.html#1167" title="(A, B)">(</a>A, B) = {
    <span class="keyword">val</span> <a title="scala.concurrent.SyncVar[Either[Throwable,B]]" id="71674">y</a> = <span title="scala.concurrent.SyncVar[Either[Throwable,B]]" class="keyword">new</span> <a href="SyncVar.scala.html#8467" title="scala.concurrent.SyncVar[Either[Throwable,B]]">SyncVar</a>[Either[Throwable, B]]
    <a href="#52381" title="(p: =&gt; Unit)(implicit runner: scala.concurrent.TaskRunner[Unit])Unit">spawn</a> <a href="#52368" title="=&gt; scala.concurrent.TaskRunner[Unit]">{</a> <a href="SyncVar.scala.html#20892" title="(x: Either[Throwable,B])Unit">y</a> set <a href="#52370" title="(body: =&gt; B)Either[Throwable,B]">tryCatch</a>(<a href="#71670" title="=&gt; B">yp</a>) }
    <a href="../Tuple2.scala.html#20777" title="(_1: A,_2: B)(A, B)">(</a><a href="#71669" title="=&gt; A">xp</a>, <a href="#52376" title="(x: Either[Throwable,B])B">getOrThrow</a>(<a href="#71674" title="scala.concurrent.SyncVar[Either[Throwable,B]]">y</a>.<a href="SyncVar.scala.html#20889" title="=&gt; Either[Throwable,B]">get</a>))
  }

  /**
   *  @param start ...
   *  @param end   ...
   *  @param p     ...
   */
  <span class="keyword">def</span> <a title="(start: Int,end: Int)(p: (Int) =&gt; Unit)Unit" id="52390">replicate</a>(<a title="Int" id="71708">start</a>: <span title="Int">Int</span>, <a title="Int" id="71709">end</a>: <span title="Int">Int</span>)(<a title="(Int) =&gt; Unit" id="71710">p</a>: Int =&gt; Unit) {
    <span title="Unit" class="keyword">if</span> (<a href="#71708" title="(x$1: Int)Boolean">start</a> == <a href="#71709" title="Int">end</a>) 
      <span title="Unit">(</span>)
    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> (<a href="#71708" title="(x$1: Int)Int">start</a> <span title="(x$1: Int)Boolean">+</span> <span title="Int(1)" class="int">1</span> == <a href="#71709" title="Int">end</a>)
      <a href="../Function1.scala.html#17226" title="(v1: Int)Unit">p</a>(<a href="#71708" title="Int">start</a>)
    <span class="keyword">else</span> {
      <span class="keyword">val</span> <a title="Int" id="71734">mid</a> = <a title="(x$1: Int)Int" id="2983">(</a><a href="#71708" title="(x$1: Int)Int">start</a> + <a href="#71709" title="Int">end</a>) / <span title="Int(2)" class="int">2</span>
      <a href="#52381" title="(p: =&gt; Unit)(implicit runner: scala.concurrent.TaskRunner[Unit])Unit">spawn</a> <a href="#52368" title="=&gt; scala.concurrent.TaskRunner[Unit]">{</a> <a href="#52390" title="(start: Int,end: Int)(p: (Int) =&gt; Unit)Unit">replicate</a>(<a href="#71708" title="Int">start</a>, <a href="#71734" title="Int">mid</a>)(<a href="#71710" title="(Int) =&gt; Unit">p</a>) }
      <a href="#52390" title="(start: Int,end: Int)(p: (Int) =&gt; Unit)Unit">replicate</a>(<a href="#71734" title="Int">mid</a>, <a href="#71709" title="Int">end</a>)(<a href="#71710" title="(Int) =&gt; Unit">p</a>)
    }
  }

/*
  def parMap[a,b](f: a =&gt; b, xs: Array[a]): Array[b] = {
    val results = new Array[b](xs.length);
    replicate(0, xs.length) { i =&gt; results(i) = f(xs(i)) }
    results
  }
*/

}

        </pre>
    </body>
</html>