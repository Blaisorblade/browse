<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/collection/mutable/FlatHashTable.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: FlatHashTable.scala 16893 2009-01-13 13:09:22Z cunei $</span>

<span class="keyword">package</span> scala.collection.mutable

<span class="keyword">import</span> Predef._

<span class="keyword">trait</span> <span class="typed"><span class="type">trait FlatHashTable[A] extends java.lang.Object with ScalaObject</span><a id="11431">FlatHashTable</a></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="15275">A</a></span>] {

  <span class="comment">/** The load factor for the hash table; must be &lt; 500 (0.5)
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="38153">loadFactor</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">Int(450)</span><span class="int">450</span></span>
  <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="38154">loadFactorDenum</a></span> = <span class="typed"><span class="type">Int(1000)</span><span class="int">1000</span></span>

  <span class="comment">/** The initial size of the hash table.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="38155">initialSize</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">Int(16)</span><span class="int">16</span></span>

  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">val</span> <span class="typed"><span class="type">Boolean(false)</span><span id="38157"><a id="38156">tableDebug</a></span></span> = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>

  <span class="comment">/** The actual hash table.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">Array[AnyRef]</span><span id="38160"><span id="38158"><span id="38159"><a id="89583">table</a></span></span></span></span>: <span class="typed"><span class="type">Array[AnyRef]</span><a href="../../Array.scala.html#1070">Array</a></span>[AnyRef] = 
    <span class="typed"><span class="type">Array[AnyRef]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#38155">initialSize</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="keyword">else</span> <span class="typed"><span class="type">Array[AnyRef]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Array[AnyRef]</span><a href="../../Array.scala.html#1070">Array</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#38155">initialSize</a></span>)

  <span class="comment">/** The number of mappings contained in this hash table.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="38163"><span id="38161"><span id="38162"><a id="89584">tableSize</a></span></span></span></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>

  <span class="comment">/** The next size value at which to resize (capacity * load factor).
   */</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="38166"><span id="38164"><span id="38165"><a id="89585">threshold</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#38178">newThreshold</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#38155">initialSize</a></span>)

  <span class="comment">/** Returns the number of entires in this hash table.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="38167">size</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#38161">tableSize</a></span>
  
  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Option[A]</span><a id="38168">findEntry</a></span>(<span class="typed"><span class="type">A</span><a id="89607">elem</a></span>: <span class="typed"><span class="type">A</span><a href="#15275">A</a></span>): <span class="typed"><span class="type">Option[A]</span><a href="../../Option.scala.html#932">Option</a></span>[A] = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="89608">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#38177">index</a></span>(<span class="typed"><span class="type">(A)Int</span><a href="#38175">elemHashCode</a></span>(<span class="typed"><span class="type">A</span><a href="#89607">elem</a></span>))
    <span class="keyword">var</span> <span class="typed"><span class="type">AnyRef</span><a id="89609">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89608">h</a></span>)
    <span class="typed"><span class="type">Unit</span><a href="#89610" class="keyword">while</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#89609">entry</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#89609">entry</a></span> <span class="typed"><span class="type">(Any)Boolean</span><a id="3495">!=</a></span> <span class="typed"><span class="type">A</span><a href="#89607">elem</a></span>) {
      <span class="typed"><span class="type">Int</span><a href="#89608">h</a></span> = (<span class="typed"><span class="type">Int</span><a href="#89608">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>
      <span class="typed"><span class="type">AnyRef</span><a href="#89609">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89608">h</a></span>)
    }
    <span class="typed"><span class="type">Option[A]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#89609">entry</a></span>) <span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span> <span class="keyword">else</span> <span class="typed"><span class="type">(A)Some[A]</span><a href="../../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">AnyRef</span><a href="#89609">entry</a></span>.<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15275">A</a></span>])
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Boolean</span><a id="38169">containsEntry</a></span>(<span class="typed"><span class="type">A</span><a id="62039">elem</a></span>: <span class="typed"><span class="type">A</span><a href="#15275">A</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="89700">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#38177">index</a></span>(<span class="typed"><span class="type">(A)Int</span><a href="#38175">elemHashCode</a></span>(<span class="typed"><span class="type">A</span><a href="#62039">elem</a></span>))
    <span class="keyword">var</span> <span class="typed"><span class="type">AnyRef</span><a id="89701">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89700">h</a></span>)
    <span class="typed"><span class="type">Unit</span><a href="#89702" class="keyword">while</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#89701">entry</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#89701">entry</a></span> <span class="typed"><span class="type">(Any)Boolean</span><a id="3495">!=</a></span> <span class="typed"><span class="type">A</span><a href="#62039">elem</a></span>) {
      <span class="typed"><span class="type">Int</span><a href="#89700">h</a></span> = (<span class="typed"><span class="type">Int</span><a href="#89700">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>
      <span class="typed"><span class="type">AnyRef</span><a href="#89701">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89700">h</a></span>)
    }
    <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#89701">entry</a></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Boolean</span><a id="38170">addEntry</a></span>(<span class="typed"><span class="type">A</span><a id="62044">elem</a></span>: <span class="typed"><span class="type">A</span><a href="#15275">A</a></span>) : <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="89733">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#38177">index</a></span>(<span class="typed"><span class="type">(A)Int</span><a href="#38175">elemHashCode</a></span>(<span class="typed"><span class="type">A</span><a href="#62044">elem</a></span>))
    <span class="keyword">var</span> <span class="typed"><span class="type">AnyRef</span><a id="89734">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89733">h</a></span>)
    <span class="typed"><span class="type">Unit</span><a href="#89735" class="keyword">while</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#89734">entry</a></span>) {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">AnyRef</span><a href="#89734">entry</a></span> <span class="typed"><span class="type">(Any)Boolean</span><a id="3494">==</a></span> <span class="typed"><span class="type">A</span><a href="#62044">elem</a></span>) <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
      <span class="typed"><span class="type">Int</span><a href="#89733">h</a></span> = (<span class="typed"><span class="type">Int</span><a href="#89733">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>
      <span class="typed"><span class="type">AnyRef</span><a href="#89734">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89733">h</a></span>)
    }
    <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89733">h</a></span>) = <span class="typed"><span class="type">A</span><a href="#62044">elem</a></span>.<span class="typed"><span class="type">AnyRef</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">AnyRef</span><a id="2015">AnyRef</a></span>]
    <span class="typed"><span class="type">(Int)Unit</span><a href="#38162">tableSize</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#38161">tableSize</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#38161">tableSize</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3144">&gt;=</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#38164">threshold</a></span>) <span class="typed"><span class="type">()Unit</span><a href="#38173">growTable</a></span>()
    <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Option[A]</span><a id="38171">removeEntry</a></span>(<span class="typed"><span class="type">A</span><a id="62047">elem</a></span>: <span class="typed"><span class="type">A</span><a href="#15275">A</a></span>) : <span class="typed"><span class="type">Option[A]</span><a href="../../Option.scala.html#932">Option</a></span>[A] = {
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean(false)</span><span >tableDebug</span></span>) <span class="typed"><span class="type">()Unit</span><a href="#38174">checkConsistent</a></span>()
    <span class="keyword">def</span> <span class="typed"><span class="type">(Int,Int)Boolean</span><a id="89784">precedes</a></span>(<span class="typed"><span class="type">Int</span><a id="89788">i</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">Int</span><a id="89789">j</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>) = {
      <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="89790">d</a></span> = <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3092">&gt;&gt;</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
      <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#89788">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3142">&lt;=</a></span> <span class="typed"><span class="type">Int</span><a href="#89789">j</a></span>) <span class="typed"><span class="type">Int</span><a href="#89789">j</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int</span><a href="#89788">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Int</span><a href="#89790">d</a></span>
      <span class="keyword">else</span> <span class="typed"><span class="type">Int</span><a href="#89788">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int</span><a href="#89789">j</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int</span><a href="#89790">d</a></span>
    }
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="89785">h</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#38177">index</a></span>(<span class="typed"><span class="type">(A)Int</span><a href="#38175">elemHashCode</a></span>(<span class="typed"><span class="type">A</span><a href="#62047">elem</a></span>))
    <span class="keyword">var</span> <span class="typed"><span class="type">AnyRef</span><a id="89786">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89785">h</a></span>)
    <span class="typed"><span class="type">Unit</span><a href="#89787" class="keyword">while</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#89786">entry</a></span>) {
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">AnyRef</span><a href="#89786">entry</a></span> <span class="typed"><span class="type">(Any)Boolean</span><a id="3494">==</a></span> <span class="typed"><span class="type">A</span><a href="#62047">elem</a></span>) {
        <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="89806">h0</a></span> = <span class="typed"><span class="type">Int</span><a href="#89785">h</a></span>
        <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="89807">h1</a></span> = (<span class="typed"><span class="type">Int</span><a href="#89806">h0</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>
        <span class="typed"><span class="type">Unit</span><a href="#89808" class="keyword">while</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89807">h1</a></span>)) {
          <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="89818">h2</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#38177">index</a></span>(<span class="typed"><span class="type">(A)Int</span><a href="#38175">elemHashCode</a></span>(<span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89807">h1</a></span>).<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15275">A</a></span>]))
          <span class="comment">//Console.println(&quot;shift at &quot;+h1+&quot;:&quot;+table(h1)+&quot; with h2 = &quot;+h2+&quot;? &quot;+(h2 != h1)+precedes(h2, h0)+table.length)</span>
          <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#89818">h2</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3140">!=</a></span> <span class="typed"><span class="type">Int</span><a href="#89807">h1</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">(Int,Int)Boolean</span><a href="#89784">precedes</a></span>(<span class="typed"><span class="type">Int</span><a href="#89818">h2</a></span>, <span class="typed"><span class="type">Int</span><a href="#89806">h0</a></span>)) {
            <span class="comment">//Console.println(&quot;shift &quot;+h1+&quot; to &quot;+h0+&quot;!&quot;)</span>
            <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89806">h0</a></span>) = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89807">h1</a></span>)
            <span class="typed"><span class="type">Int</span><a href="#89806">h0</a></span> = <span class="typed"><span class="type">Int</span><a href="#89807">h1</a></span>
          } 
          <span class="typed"><span class="type">Int</span><a href="#89807">h1</a></span> = (<span class="typed"><span class="type">Int</span><a href="#89807">h1</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>
        }
        <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89806">h0</a></span>) = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>
        <span class="typed"><span class="type">(Int)Unit</span><a href="#38162">tableSize</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean(false)</span><span >tableDebug</span></span>) <span class="typed"><span class="type">()Unit</span><a href="#38174">checkConsistent</a></span>()
        <span class="typed"><span class="type">Nothing</span><span class="keyword">return</span></span> <span class="typed"><span class="type">(A)Some[A]</span><a href="../../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">AnyRef</span><a href="#89786">entry</a></span>.<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15275">A</a></span>])
      }
      <span class="typed"><span class="type">Int</span><a href="#89785">h</a></span> = (<span class="typed"><span class="type">Int</span><a href="#89785">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3149">%</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>
      <span class="typed"><span class="type">AnyRef</span><a href="#89786">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89785">h</a></span>)
    }
    <span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span>
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; &lt;refinement&gt; extends java.lang.Object with Iterator[A]</span><a id="38172">elements</a></span> = <span class="typed"><span class="type">template $anon extends java.lang.Object with Iterator[A]</span><a id="62144" class="keyword">new</a></span> <span class="typed"><span class="type">Iterator[A]</span><a href="../../Iterator.scala.html#1337">Iterator</a></span>[A] {
    <span class="keyword">private</span> <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><span id="62148"><span id="62146"><span id="62147"><a id="62153">i</a></span></span></span></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="62149">hasNext</a></span>: <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> = {
      <span class="typed"><span class="type">Unit</span><a href="#62155" class="keyword">while</a></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#62146">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="3507">==</a></span> <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#62146">i</a></span>))) <span class="typed"><span class="type">(Int)Unit</span><a href="#62147">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>;
      <span class="typed"><span class="type">=&gt; Int</span><a href="#62146">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>
    }
    <span class="keyword">def</span> <span class="typed"><span class="type">()A</span><a id="62150">next</a></span>(): <span class="typed"><span class="type">A</span><a href="#15275">A</a></span> =
      <span class="typed"><span class="type">A</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Boolean</span><a href="#62149">hasNext</a></span>) { <span class="typed"><span class="type">(Int)Unit</span><a href="#62147">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>; <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#62146">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>).<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15275">A</a></span>] }
      <span class="keyword">else</span> <span class="typed"><span class="type">object Iterator</span><a href="../../Iterator.scala.html#1338">Iterator</a></span>.<span class="typed"><span class="type">=&gt; &lt;refinement&gt; extends java.lang.Object with Iterator[Nothing]</span><a href="../../Iterator.scala.html#22746">empty</a></span>.<span class="typed"><span class="type">()Nothing</span><a href="../../Iterator.scala.html#19976">next</a></span>
  }

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="38173">growTable</a></span>() {
    <span class="keyword">val</span> <span class="typed"><span class="type">Array[AnyRef]</span><a id="89885">oldtable</a></span> = <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>
    <span class="typed"><span class="type">(Array[AnyRef])Unit</span><a href="#38159">table</a></span> = <span class="typed"><span class="type">Array[AnyRef]</span><span class="keyword">new</span></span> <span class="typed"><span class="type">Array[AnyRef]</span><a href="../../Array.scala.html#1070">Array</a></span>[AnyRef](<span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">*</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>)
    <span class="typed"><span class="type">(Int)Unit</span><a href="#38162">tableSize</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">(Int)Unit</span><a href="#38165">threshold</a></span> = <span class="typed"><span class="type">(Int)Int</span><a href="#38178">newThreshold</a></span>(<span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>)
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="89886">i</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
    <span class="typed"><span class="type">Unit</span><a href="#89887" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#89886">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> <span class="typed"><span class="type">Array[AnyRef]</span><a href="#89885">oldtable</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>) {
      <span class="keyword">val</span> <span class="typed"><span class="type">AnyRef</span><a id="89906">entry</a></span> = <span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">oldtable</a></span>(<span class="typed"><span class="type">Int</span><a href="#89886">i</a></span>)
      <span class="typed"><span class="type">AnyVal with NotNull</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">AnyRef</span><a href="#89906">entry</a></span>) <span class="typed"><span class="type">(A)Boolean</span><a href="#38170">addEntry</a></span>(<span class="typed"><span class="type">AnyRef</span><a href="#89906">entry</a></span>.<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15275">A</a></span>])
      <span class="typed"><span class="type">Int</span><a href="#89886">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    }
    <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Boolean(false)</span><span >tableDebug</span></span>) <span class="typed"><span class="type">()Unit</span><a href="#38174">checkConsistent</a></span>()
  }

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="38174">checkConsistent</a></span>() {
    <span class="keyword">for</span> (<span class="typed"><span class="type">((Int) =&gt; Unit)Unit</span><a href="../../Range.scala.html#25001" id="89950">i</a></span> &lt;- <span class="typed"><span class="type">implicit scala.Predef.intWrapper : (Int)scala.runtime.RichInt</span><a href="../../Predef.scala.html#13511" class="int">0</a></span> <span class="typed"><span class="type">(Int)Range</span><a href="../../runtime/RichInt.scala.html#19402">until</a></span> <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span>)
      <span class="typed"><span class="type">Unit</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89950">i</a></span>) <span class="typed"><span class="type">(AnyRef)Boolean</span><a id="5791">!=</a></span> <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span> <span class="typed"><span class="type">(Boolean)Boolean</span><a id="2749">&amp;&amp;</a></span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">(A)Boolean</span><a href="#38169">containsEntry</a></span>(<span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89950">i</a></span>).<span class="typed"><span class="type">A</span><a id="3501">asInstanceOf</a></span>[<span class="typed"><span class="type">A</span><a href="#15275">A</a></span>]))
        <span class="typed"><span class="type">(Boolean,=&gt; Any)Unit</span><a href="../../Predef.scala.html#13362">assert</a></span>(<span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>, <span class="typed"><span class="type">Int</span><a href="#89950">i</a></span><span class="typed"><span class="type">(java.lang.String)java.lang.String</span><a id="3087">+</a></span><span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">(Int)AnyRef</span><a href="../../Array.scala.html#17253">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89950">i</a></span>)<span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">java.lang.String(&quot; &quot;)</span><span class="string">&quot; &quot;</span></span><span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span><span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">()String</span><a href="../../Collection.scala.html#17380">toString</a></span>)
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(A)Int</span><a id="38175">elemHashCode</a></span>(<span class="typed"><span class="type">A</span><a id="89666">elem</a></span>: <span class="typed"><span class="type">A</span><a href="#15275">A</a></span>) = <span class="typed"><span class="type">A</span><a href="#89666">elem</a></span>.<span class="typed"><span class="type">()Int</span><a id="3497">hashCode</a></span>()

  <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int)Int</span><a id="38176">improve</a></span>(<span class="typed"><span class="type">Int</span><a id="89613">hcode</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>) = {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="89615">h</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">Int</span><a href="#89613">hcode</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">=&gt; Int</span><a id="3096">~</a></span>(<span class="typed"><span class="type">Int</span><a href="#89613">hcode</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3088">&lt;&lt;</a></span> <span class="typed"><span class="type">Int(9)</span><span class="int">9</span></span>)
    <span class="typed"><span class="type">Int</span><a href="#89615">h</a></span> = <span class="typed"><span class="type">Int</span><a href="#89615">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3152">^</a></span> (<span class="typed"><span class="type">Int</span><a href="#89615">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3090">&gt;&gt;&gt;</a></span> <span class="typed"><span class="type">Int(14)</span><span class="int">14</span></span>)
    <span class="typed"><span class="type">Int</span><a href="#89615">h</a></span> = <span class="typed"><span class="type">Int</span><a href="#89615">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> (<span class="typed"><span class="type">Int</span><a href="#89615">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3088">&lt;&lt;</a></span> <span class="typed"><span class="type">Int(4)</span><span class="int">4</span></span>)
    <span class="typed"><span class="type">Int</span><a href="#89615">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3152">^</a></span> (<span class="typed"><span class="type">Int</span><a href="#89615">h</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3090">&gt;&gt;&gt;</a></span> <span class="typed"><span class="type">Int(10)</span><span class="int">10</span></span>)
  }

  <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int)Int</span><a id="38177">index</a></span>(<span class="typed"><span class="type">Int</span><a id="89611">hcode</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>) = <span class="typed"><span class="type">(Int)Int</span><a href="#38176">improve</a></span>(<span class="typed"><span class="type">Int</span><a href="#89611">hcode</a></span>) <span class="typed"><span class="type">(Int)Int</span><a id="3151">&amp;</a></span> (<span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)

  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int)Int</span><a id="38178">newThreshold</a></span>(<span class="typed"><span class="type">Int</span><a id="89593">size</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>) = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="89595">lf</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#38153">loadFactor</a></span>
    <span class="typed"><span class="type">(Boolean,=&gt; Any)Unit</span><a href="../../Predef.scala.html#13362">assert</a></span>(<span class="typed"><span class="type">Int</span><a href="#89595">lf</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3141">&lt;</a></span> (<span class="typed"><span class="type">=&gt; Int</span><a href="#38154">loadFactorDenum</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">/</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>), <span class="typed"><span class="type">java.lang.String(&quot;loadFactor too large; must be &lt; 0.5&quot;)</span><span class="string">&quot;loadFactor too large; must be &lt; 0.5&quot;</span></span>)
    (<span class="typed"><span class="type">Int</span><a href="#89593">size</a></span>.<span class="typed"><span class="type">=&gt; Long</span><a id="3084">toLong</a></span> <span class="typed"><span class="type">(Int)Long</span><a id="3256">*</a></span> <span class="typed"><span class="type">Int</span><a href="#89595">lf</a></span> <span class="typed"><span class="type">(Int)Long</span><a id="3257">/</a></span> <span class="typed"><span class="type">=&gt; Int</span><a href="#38154">loadFactorDenum</a></span> ).<span class="typed"><span class="type">=&gt; Int</span><a id="3192">toInt</a></span>
  }

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Unit</span><a id="38179">clear</a></span>() {
    <span class="keyword">var</span> <span class="typed"><span class="type">Int</span><a id="89974">i</a></span> = <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>.<span class="typed"><span class="type">=&gt; Int</span><a href="../../Array.scala.html#17252">length</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">Unit</span><a href="#89975" class="keyword">while</a></span> (<span class="typed"><span class="type">Int</span><a href="#89974">i</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3144">&gt;=</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>) { <span class="typed"><span class="type">=&gt; Array[AnyRef]</span><a href="#38158">table</a></span>(<span class="typed"><span class="type">Int</span><a href="#89974">i</a></span>) = <span class="typed"><span class="type">Null(null)</span><span class="keyword">null</span></span>; <span class="typed"><span class="type">Int</span><a href="#89974">i</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-=</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span> }
    <span class="typed"><span class="type">(Int)Unit</span><a href="#38162">tableSize</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
  }
}

        </pre>
    </body>
</html>