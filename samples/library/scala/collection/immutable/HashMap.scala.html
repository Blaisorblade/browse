<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/collection/immutable/HashMap.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

// $Id: HashMap.scala 18387 2009-07-24 15:28:37Z odersky $


<span class="keyword">package</span> scala.collection.immutable

<span class="keyword">import</span> scala.collection.generic._
<span class="keyword">import</span> scala.collection.mutable
<span class="keyword">import</span> annotation.unchecked.uncheckedVariance

/** This class implements immutable maps using a hash table.
 * It is optimized for sequential accesses where the last updated table is accessed most often.
 * It supports with reasonable efficiency accesses to previous versions of the table by keeping
 * a change log that's regularly compacted.
 * It needs to synchronize most methods, so it is less suitable for highly concurrent accesses.
 *
 * @note the builder of a hash map returns specialized representations EmptyMap,Map1,..., Map4
 * for maps of size &lt;= 4.
 *
 *  @author  Martin Odersky
 *  @version 2.0, 19/01/2007
 */
@serializable
<span class="keyword">class</span> <a title="class HashMap[A, +B] extends java.lang.Object with scala.collection.immutable.Map[A,B] with scala.collection.generic.ImmutableMapTemplate[A,B,scala.collection.immutable.HashMap[A,B]] with scala.collection.mutable.HashTable[A] with ScalaObject" id="9165">HashMap</a>[<a title="&gt;: Nothing &lt;: Any" id="14411">A</a>, +<a title="&gt;: Nothing &lt;: Any" id="14412">B</a>] <a href="../../ScalaObject.scala.html#969" title="ScalaObject" class="keyword">extends</a> <a href="Map.scala.html#8949" title="scala.collection.immutable.Map[A,B]">Map</a>[A,B] <span class="keyword">with</span> <a href="../generic/ImmutableMapTemplate.scala.html#10396" title="scala.collection.generic.ImmutableMapTemplate[A,B,scala.collection.immutable.HashMap[A,B]]">ImmutableMapTemplate</a>[A, B, HashMap[A, B]] <span class="keyword">with</span> mutable.<a href="../mutable/HashTable.scala.html#7908" title="scala.collection.mutable.HashTable[A]">HashTable</a>[A] {

  <span class="keyword">type</span> <a title="scala.collection.mutable.DefaultEntry[A,Any]" id="43416">Entry</a> = collection.mutable.<a href="../mutable/DefaultEntry.scala.html#7671" title="scala.collection.mutable.DefaultEntry[A,Any]">DefaultEntry</a>[A, Any]

  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="scala.collection.immutable.HashMap[A,B]" id="43418">later</a>: <a href="#9165" title="scala.collection.immutable.HashMap[A,B @scala.annotation.unchecked.uncheckedVariance]">HashMap</a>[A, B @uncheckedVariance] = <span title="Null(null)" class="keyword">null</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="A" id="43421">oldKey</a>: <a href="#14411" title="A">A</a> = _
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="Option[B]" id="43424">oldValue</a>: <a href="../../Option.scala.html#789" title="Option[B @scala.annotation.unchecked.uncheckedVariance]">Option</a>[B @uncheckedVariance] = _
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="Int" id="43427">deltaSize</a>: <span title="Int">Int</span> = _
  
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.HashMap[A,B]" id="43429">empty</a> = <a href="#9166" title="object scala.collection.immutable.HashMap">HashMap</a>.<a href="#143691" title="[A, B]scala.collection.immutable.HashMap[A,B]">empty</a><span title="scala.collection.immutable.HashMap[A,B]">[</span><a href="#14411" title="A">A</a>, <a href="#14412" title="B">B</a>]

  <span class="keyword">def</span> <a title="(key: A)Option[B]" id="43430">get</a>(<a title="A" id="143698">key</a>: <a href="#14411" title="A">A</a>): <a href="../../Option.scala.html#789" title="Option[B]">Option</a>[B] = <a href="#9165" title="(x$1: Option[B])Option[B]">synchronized</a> {
    <span class="keyword">var</span> <a title="scala.collection.immutable.HashMap[A, _ &gt;: B]" id="143703">m</a>: <a href="#9165" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">HashMap</a>[A, _ &gt;: B] = <a href="#9165" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a>
    <span class="keyword">var</span> <a title="Int" id="143704">cnt</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> (<a href="#143703" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43418" title="(x$1: AnyRef)Boolean">later</a> != <span title="Null(null)" class="keyword">null</span>) <a href="#143706" title="()Unit">{</a>
      <span title="Unit" class="keyword">if</span> (<a href="#143698" title="(x$1: Any)Boolean" id="3625">key</a> == <a href="#143703" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43421" title="=&gt; A">oldKey</a>) <span title="Nothing" class="keyword">return</span> <a href="#143703" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43424" title="=&gt; Option[_$1]">oldValue</a>.<span title="[T0]T0">asInstanceOf</span><span title="Option[B]">[</span><a href="../../Option.scala.html#789" title="Option[B]">Option</a>[B]]
      <a href="#143704" title="Int">cnt</a> += <span title="Int(1)" class="int">1</span>
      <a href="#143703" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a> = <a href="#143703" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43418" title="=&gt; scala.collection.immutable.HashMap[A,_$1]">later</a>
    }
    <span title="Unit" class="keyword">if</span> (<a href="#143704" title="(x$1: Int)Boolean">cnt</a> &gt; <a href="#43444" title="=&gt; Int">logLimit</a>) <a href="#43446" title="(last: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit">makeCopy</a>(<a href="#143703" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>)
    <span class="keyword">val</span> <a title="scala.collection.mutable.DefaultEntry[A,Any]" id="143705">e</a> = <a href="#143703" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="../mutable/HashTable.scala.html#43467" title="(key: A)scala.collection.mutable.DefaultEntry[A,Any]">findEntry</a>(<a href="#143698" title="A">key</a>)
    <span title="Option[B]" class="keyword">if</span> (<a href="#143705" title="(x$1: AnyRef)Boolean">e</a> == <span title="Null(null)" class="keyword">null</span>) <a href="../../Option.scala.html#472" title="object None">None</a>
    <span class="keyword">else</span> <a href="../../Option.scala.html#19907" title="(x: B)Some[B]">Some</a>(<a href="#43443" title="(e: HashMap.this.Entry)B">getValue</a>(<a href="#143705" title="scala.collection.mutable.DefaultEntry[A,Any]">e</a>))
  }

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B1 &gt;: B](key: A,value: B1)scala.collection.immutable.HashMap[A,B1]" id="43431">updated</a> [<a title="&gt;: B &lt;: Any" id="43433">B1</a> &gt;: B] (<a title="A" id="143810">key</a>: <a href="#14411" title="A">A</a>, <a title="B1" id="143811">value</a>: <a href="#43433" title="B1">B1</a>): <a href="#9165" title="scala.collection.immutable.HashMap[A,B1]">HashMap</a>[A, B1] = <a href="#9165" title="(x$1: scala.collection.immutable.HashMap[A,B1])scala.collection.immutable.HashMap[A,B1]">synchronized</a> {
    <a href="#43447" title="()Unit">makeCopyIfUpdated</a>()
    <span class="keyword">val</span> <a title="HashMap.this.Entry" id="143865">e</a> = <a href="../mutable/HashTable.scala.html#43467" title="(key: A)HashMap.this.Entry">findEntry</a>(<a href="#143810" title="A">key</a>)
    <span title="Unit" class="keyword">if</span> (<a href="#143865" title="(x$1: AnyRef)Boolean">e</a> == <span title="Null(null)" class="keyword">null</span>) { 
      <a href="#43445" title="(key: A,ov: Option[B],delta: Int)Unit">markUpdated</a>(<a href="#143810" title="A">key</a>, <a href="../../Option.scala.html#472" title="object None">None</a>, <span title="Int(1)" class="int">1</span>)
      <a href="#43418" title="=&gt; scala.collection.immutable.HashMap[A,B]">later</a>.<a href="../mutable/HashTable.scala.html#43468" title="(e: scala.collection.mutable.DefaultEntry[A,Any])Unit">addEntry</a>(<span title="scala.collection.mutable.DefaultEntry[A,Any]" class="keyword">new</span> <a href="#43416" title="scala.collection.mutable.DefaultEntry[A,Any]">Entry</a>(<a href="#143810" title="A">key</a>, <a href="#143811" title="B1">value</a>))
    } <span class="keyword">else</span> {
      <a href="#43445" title="(key: A,ov: Option[B],delta: Int)Unit">markUpdated</a>(<a href="#143810" title="A">key</a>, <a href="../../Option.scala.html#19907" title="(x: B)Some[B]">Some</a>(<a href="#43443" title="(e: HashMap.this.Entry)B">getValue</a>(<a href="#143865" title="HashMap.this.Entry">e</a>)), <span title="Int(0)" class="int">0</span>)
      <a href="#143865" title="HashMap.this.Entry">e</a>.<a href="../mutable/DefaultEntry.scala.html#143679" title="(x$1: Any)Unit">value</a> = <a href="#143811" title="B1">value</a>
    }
    <a href="#43418" title="=&gt; scala.collection.immutable.HashMap[A,B]">later</a>.<span title="[T0]T0">asInstanceOf</span><span title="scala.collection.immutable.HashMap[A,B1]">[</span><a href="#9165" title="scala.collection.immutable.HashMap[A,B1]">HashMap</a>[A, B1]]
  }

  /** Add a key/value pair to this map. 
   *  @param    kv the key/value pair
   *  @return   A new map with the new binding added to this map
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B1 &gt;: B](kv: (A, B1))scala.collection.immutable.HashMap[A,B1]" id="43434">+</a> [<a title="&gt;: B &lt;: Any" id="43436">B1</a> &gt;: B] (<a title="(A, B1)" id="43487">kv</a>: <a href="../../Tuple2.scala.html#1167" title="(A, B1)">(</a>A, B1)): <a href="#9165" title="scala.collection.immutable.HashMap[A,B1]">HashMap</a>[A, B1] = <a href="#43431" title="(key: A,value: B1)scala.collection.immutable.HashMap[A,B1]">updated</a>(<a href="#43487" title="(A, B1)">kv</a>.<a href="../../Tuple2.scala.html#20579" title="=&gt; A">_1</a>, <a href="#43487" title="(A, B1)">kv</a>.<a href="../../Tuple2.scala.html#20581" title="=&gt; B1">_2</a>)

  /** Adds two or more elements to this collection and returns
   *  either the collection itself (if it is mutable), or a new collection
   *  with the added elements.
   *
   *  @param elem1 the first element to add.
   *  @param elem2 the second element to add.
   *  @param elems the remaining elements to add.
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B1 &gt;: B](elem1: (A, B1),elem2: (A, B1),elems: (A, B1)*)scala.collection.immutable.HashMap[A,B1]" id="43437">+</a> [<a title="&gt;: B &lt;: Any" id="43439">B1</a> &gt;: B] (<a title="(A, B1)" id="43611">elem1</a>: <a href="../../Tuple2.scala.html#1167" title="(A, B1)">(</a>A, B1), <a title="(A, B1)" id="43612">elem2</a>: <a href="../../Tuple2.scala.html#1167" title="(A, B1)">(</a>A, B1), <a title="(A, B1)*" id="43613">elems</a>: <a title="(A, B1)*" id="4191">(</a>A, B1) *): <a href="#9165" title="scala.collection.immutable.HashMap[A,B1]">HashMap</a>[A, B1] =
    <a href="#43434" title="(kv: (A, B1))scala.collection.immutable.HashMap[A,B1]" class="keyword">this</a> <a href="#43434" title="(kv: (A, B1))scala.collection.immutable.HashMap[A,B1]">+</a> <a href="#43611" title="(A, B1)">elem1</a> <a href="../generic/TraversableTemplate.scala.html#17258" title="(that: Traversable[(A, B1)])(implicit bf: scala.collection.generic.BuilderFactory[(A, B1),scala.collection.immutable.HashMap[A,B1],scala.collection.immutable.HashMap[A,B1]])scala.collection.immutable.HashMap[A,B1]">+</a> <a href="#43612" title="(A, B1)">elem2</a> <a href="#143686" title="scala.collection.generic.BuilderFactory[(A, B1),scala.collection.immutable.HashMap[A,B1],scala.collection.immutable.HashMap#Coll]">++</a> <a href="#43613" title="(A, B1)*">elems</a>

  <span class="keyword">def</span> <a title="(key: A)scala.collection.immutable.HashMap[A,B]" id="43440">-</a> (<a title="A" id="144410">key</a>: <a href="#14411" title="A">A</a>): <a href="#9165" title="scala.collection.immutable.HashMap[A,B]">HashMap</a>[A, B] = <a href="#9165" title="(x$1: scala.collection.immutable.HashMap[A,B])scala.collection.immutable.HashMap[A,B]">synchronized</a> {
    <a href="#43447" title="()Unit">makeCopyIfUpdated</a>()
    <span class="keyword">val</span> <a title="HashMap.this.Entry" id="144429">e</a> = <a href="../mutable/HashTable.scala.html#43467" title="(key: A)HashMap.this.Entry">findEntry</a>(<a href="#144410" title="A">key</a>)
    <span title="scala.collection.immutable.HashMap[A,B]" class="keyword">if</span> (<a href="#144429" title="(x$1: AnyRef)Boolean">e</a> == <span title="Null(null)" class="keyword">null</span>) <a href="#9165" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a> 
    <span class="keyword">else</span> {
      <a href="#43445" title="(key: A,ov: Option[B],delta: Int)Unit">markUpdated</a>(<a href="#144410" title="A">key</a>, <a href="../../Option.scala.html#19907" title="(x: B)Some[B]">Some</a>(<a href="#43443" title="(e: HashMap.this.Entry)B">getValue</a>(<a href="#144429" title="HashMap.this.Entry">e</a>)), <span title="Int(-1)">-</span><span class="int">1</span>)
      <a href="../mutable/HashTable.scala.html#43469" title="(key: A)scala.collection.mutable.DefaultEntry[A,Any]">later</a> removeEntry <a href="#144410" title="A">key</a>
      <a href="#43418" title="=&gt; scala.collection.immutable.HashMap[A,B]">later</a>.<span title="[T0]T0">asInstanceOf</span><span title="scala.collection.immutable.HashMap[A,B]">[</span><a href="#9165" title="scala.collection.immutable.HashMap[A,B]">HashMap</a>[A, B]]
    } 
  }

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="43441">size</a>: <span title="Int">Int</span> = <a href="#9165" title="(x$1: Int)Int">synchronized</a> {
    <span class="keyword">var</span> <a title="scala.collection.immutable.HashMap[A, _ &gt;: B]" id="144467">m</a>: <a href="#9165" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">HashMap</a>[A, _ &gt;: B] = <a href="#9165" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a>
    <span class="keyword">var</span> <a title="Int" id="144468">cnt</a> = <span title="Int(0)" class="int">0</span>
    <span class="keyword">var</span> <a title="Int" id="144469">s</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> (<a href="#144467" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43418" title="(x$1: AnyRef)Boolean">later</a> != <span title="Null(null)" class="keyword">null</span>) <a href="#144470" title="()Unit">{</a>
      <a href="#144469" title="Int" id="2979">s</a> -= <a href="#144467" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43427" title="=&gt; Int">deltaSize</a>
      <a href="#144468" title="Int">cnt</a> += <span title="Int(1)" class="int">1</span>
      <a href="#144467" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a> = <a href="#144467" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43418" title="=&gt; scala.collection.immutable.HashMap[A,_$2]">later</a>
    }
    <a href="#144469" title="Int">s</a> += <a href="#144467" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="../mutable/HashTable.scala.html#43460" title="=&gt; Int">tableSize</a>
    <span title="Unit" class="keyword">if</span> (<a href="#144468" title="(x$1: Int)Boolean">cnt</a> &gt; <a href="#43444" title="=&gt; Int">logLimit</a>) <a href="#43446" title="(last: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit">makeCopy</a>(<a href="#144467" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>)  
    <a href="#144469" title="Int">s</a>
  }

  <span class="keyword">def</span> <a title="=&gt; Iterator[(A, B)]" id="43442">iterator</a> = <a href="#9165" title="(x$1: Iterator[(A, B)])Iterator[(A, B)]">synchronized</a> {
    <a href="#43447" title="()Unit">makeCopyIfUpdated</a>()
    <a href="../Iterator.scala.html#19296" title="(f: (HashMap.this.Entry) =&gt; (A, B))Iterator[(A, B)]">entriesIterator</a> map {<a title="HashMap.this.Entry" id="144610">e</a> =&gt; <a href="../../Tuple2.scala.html#20777" title="(_1: A,_2: B)(A, B)">(</a><a href="#144610" title="HashMap.this.Entry">e</a>.<a href="../mutable/DefaultEntry.scala.html#143676" title="=&gt; A">key</a>, <a href="#43443" title="(e: HashMap.this.Entry)B">getValue</a>(<a href="#144610" title="HashMap.this.Entry">e</a>))}
  }
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(e: HashMap.this.Entry)B" id="43443">getValue</a>(<a title="HashMap.this.Entry" id="143799">e</a>: <a href="../mutable/DefaultEntry.scala.html#7671" title="HashMap.this.Entry">Entry</a>) = 
    <a href="#143799" title="HashMap.this.Entry">e</a>.<a href="../mutable/DefaultEntry.scala.html#143678" title="=&gt; Any">value</a>.<span title="[T0]T0">asInstanceOf</span><span title="B">[</span><a href="#14412" title="B">B</a>]

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Int" id="43444">logLimit</a>: <span title="Int">Int</span> = <a href="../../Math.scala.html#535" title="object Math">Math</a>.<a href="../../Math.scala.html#22824" title="(x: Double)Double">sqrt</a>(<a href="../mutable/HashTable.scala.html#43457" title="=&gt; Array[scala.collection.mutable.HashEntry[A,HashMap.this.Entry]]">table</a>.<a href="../../Predef.scala.html#16492" title="implicit scala.Predef.int2double : (x: Int)Double">length</a>).<a title="=&gt; Int" id="3441">toInt</a>

  <span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">def</span> <a title="(key: A,ov: Option[B],delta: Int)Unit" id="43445">markUpdated</a>(<a title="A" id="143878">key</a>: <a href="#14411" title="A">A</a>, <a title="Option[B]" id="143879">ov</a>: <a href="../../Option.scala.html#789" title="Option[B]">Option</a>[B], <a title="Int" id="143880">delta</a>: <span title="Int">Int</span>) { 
    <span class="keyword">val</span> <a title="Int" id="144636">lv</a> = <a href="../mutable/HashTable.scala.html#43452" title="=&gt; Int">loadFactor</a>
    <a href="#43418" title="(x$1: scala.collection.immutable.HashMap[A,B])Unit">later</a> = <a href="#144640" title="scala.collection.immutable.HashMap[A,B]{ ... }" class="keyword">new</a> <a title="anonymous class $anon extends scala.collection.immutable.HashMap[A,B]" id="144640">HashMap</a>[A, B] {
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="144642">initialSize</a> = <span title="Int(0)" class="int">0</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="144643">loadFactor</a> = <a href="#144636" title="Int">lv</a>        
      <a href="../mutable/HashTable.scala.html#43458" title="(x$1: Array[scala.collection.mutable.HashEntry[A,this.Entry]])Unit">table</a>     = <a href="#9165" title="HashMap.this.type">HashMap</a>.<span class="keyword">this</span>.<a href="../mutable/HashTable.scala.html#43457" title="=&gt; Array[scala.collection.mutable.HashEntry[A,HashMap.this.Entry]]">table</a>
      <a href="../mutable/HashTable.scala.html#43461" title="(x$1: Int)Unit">tableSize</a> = <a href="#9165" title="HashMap.this.type">HashMap</a>.<span class="keyword">this</span>.<a href="../mutable/HashTable.scala.html#43460" title="=&gt; Int">tableSize</a>
      <a href="../mutable/HashTable.scala.html#43464" title="(x$1: Int)Unit">threshold</a> = <a href="#9165" title="HashMap.this.type">HashMap</a>.<span class="keyword">this</span>.<a href="../mutable/HashTable.scala.html#43463" title="=&gt; Int">threshold</a>
    }
    <a href="#43421" title="(x$1: A)Unit">oldKey</a> = <a href="#143878" title="A">key</a>
    <a href="#43424" title="(x$1: Option[B])Unit">oldValue</a> = <a href="#143879" title="Option[B]">ov</a>
    <a href="#43427" title="(x$1: Int)Unit">deltaSize</a> = <a href="#143880" title="Int">delta</a>
  }

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(last: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit" id="43446">makeCopy</a>(<a title="scala.collection.immutable.HashMap[A, _ &gt;: B]" id="143770">last</a>: <a href="#9165" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">HashMap</a>[A, _ &gt;: B]) {
    <span class="keyword">def</span> <a title="(m: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit" id="144674">undo</a>(<a title="scala.collection.immutable.HashMap[A, _ &gt;: B]" id="144680">m</a>: <a href="#9165" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">HashMap</a>[A, _ &gt;: B]) {
      <span title="Unit" class="keyword">if</span> (<a href="#144680" title="(x$1: AnyRef)Boolean">m</a> ne <a href="#143770" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">last</a>) {
        <a href="#144674" title="(m: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit">undo</a>(<a href="#144680" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43418" title="=&gt; scala.collection.immutable.HashMap[A,Any]">later</a>)
        <span title="Unit" class="keyword">if</span> (<a href="#144680" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43427" title="(x$1: Int)Boolean">deltaSize</a> == <span title="Int(1)" class="int">1</span>) <a href="../mutable/HashTable.scala.html#43469" title="(key: A)HashMap.this.Entry">removeEntry</a><span title="Unit">(</span><a href="#144680" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43421" title="=&gt; A">oldKey</a>)
        <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> (<a href="#144680" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43427" title="(x$1: Int)Boolean">deltaSize</a> == <span title="Int(0)" class="int">0</span>) <a href="../mutable/HashTable.scala.html#43467" title="(key: A)HashMap.this.Entry">findEntry</a>(<a href="#144680" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43421" title="=&gt; A">oldKey</a>).<a href="../mutable/DefaultEntry.scala.html#143679" title="(x$1: Any)Unit">value</a> = <a href="#144680" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43424" title="=&gt; Option[Any]">oldValue</a>.<a href="../../Option.scala.html#19866" title="=&gt; Any">get</a>
        <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> (<a href="#144680" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43427" title="(x$1: Int)Boolean">deltaSize</a> == <span title="Int(-1)">-</span><span class="int">1</span>) <a href="../mutable/HashTable.scala.html#43468" title="(e: HashMap.this.Entry)Unit">addEntry</a>(<span title="scala.collection.mutable.DefaultEntry[A,Any]" class="keyword">new</span> <a href="#43416" title="scala.collection.mutable.DefaultEntry[A,Any]">Entry</a>(<a href="#144680" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43421" title="=&gt; A">oldKey</a>, <a href="#144680" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43424" title="=&gt; Option[Any]">oldValue</a>.<a href="../../Option.scala.html#19866" title="=&gt; Any">get</a>))
      }
    }
    <span class="keyword">def</span> <a title="(e: HashMap.this.Entry)HashMap.this.Entry" id="144675">copy</a>(<a title="HashMap.this.Entry" id="144742">e</a>: <a href="../mutable/DefaultEntry.scala.html#7671" title="HashMap.this.Entry">Entry</a>): <a href="../mutable/DefaultEntry.scala.html#7671" title="HashMap.this.Entry">Entry</a> = 
      <span title="HashMap.this.Entry" class="keyword">if</span> (<a href="#144742" title="(x$1: AnyRef)Boolean">e</a> == <span title="Null(null)" class="keyword">null</span>) <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">else</span> {
        <span class="keyword">val</span> <a title="HashMap.this.Entry" id="144749">rest</a> = <a href="#144675" title="(e: HashMap.this.Entry)HashMap.this.Entry">copy</a>(<a href="#144742" title="HashMap.this.Entry">e</a>.<a href="../mutable/HashEntry.scala.html#50512" title="=&gt; scala.collection.mutable.DefaultEntry[A,Any]">next</a>)
        <span class="keyword">val</span> <a title="scala.collection.mutable.DefaultEntry[A,Any]" id="144750">result</a> = <span title="scala.collection.mutable.DefaultEntry[A,Any]" class="keyword">new</span> <a href="#43416" title="scala.collection.mutable.DefaultEntry[A,Any]">Entry</a>(<a href="#144742" title="HashMap.this.Entry">e</a>.<a href="../mutable/DefaultEntry.scala.html#143676" title="=&gt; A">key</a>, <a href="#144742" title="HashMap.this.Entry">e</a>.<a href="../mutable/DefaultEntry.scala.html#143678" title="=&gt; Any">value</a>)
        <a href="#144750" title="scala.collection.mutable.DefaultEntry[A,Any]">result</a>.<a href="../mutable/HashEntry.scala.html#50513" title="(x$1: scala.collection.mutable.DefaultEntry[A,Any])Unit">next</a> = <a href="#144749" title="HashMap.this.Entry">rest</a>
        <a href="#144750" title="scala.collection.mutable.DefaultEntry[A,Any]">result</a>
      }
    <span class="keyword">val</span> <a title="Array[scala.collection.mutable.HashEntry[A,last.Entry]]" id="144676">ltable</a> = <a href="#143770" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">last</a>.<a href="../mutable/HashTable.scala.html#43457" title="=&gt; Array[scala.collection.mutable.HashEntry[A,last.Entry]]">table</a>
    <span class="keyword">val</span> <a title="Int" id="144677">s</a> = <a href="#144676" title="Array[scala.collection.mutable.HashEntry[A,last.Entry]]">ltable</a>.<a href="../../Array.scala.html#17822" title="=&gt; Int">length</a>
    <a href="../mutable/HashTable.scala.html#43458" title="(x$1: Array[scala.collection.mutable.HashEntry[A,HashMap.this.Entry]])Unit">table</a> = <span title="Array[scala.collection.mutable.HashEntry[A,HashMap.this.Entry]]" class="keyword">new</span> scala.<a href="../../Array.scala.html#897" title="Array[scala.collection.mutable.HashEntry[A,HashMap.this.Entry]]">Array</a>[collection.mutable.HashEntry[A, Entry]](<a href="#144677" title="Int">s</a>)
    <span class="keyword">var</span> <a title="Int" id="144678">i</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> (<a href="#144678" title="(x$1: Int)Boolean" id="2969">i</a> &lt; <a href="#144677" title="Int">s</a>) <a href="#144679" title="()Unit">{</a>
      <a href="../../Array.scala.html#17824" title="(i: Int,x: scala.collection.mutable.HashEntry[A,HashMap.this.Entry])Unit">table</a>(<a href="#144678" title="Int">i</a>) = <a href="#144675" title="(e: HashMap.this.Entry)HashMap.this.Entry">copy</a>(<a href="../../Array.scala.html#17823" title="(i: Int)scala.collection.mutable.HashEntry[A,last.Entry]">ltable</a>(<a href="#144678" title="Int">i</a>).<span title="[T0]T0">asInstanceOf</span><span title="HashMap.this.Entry">[</span><a href="../mutable/DefaultEntry.scala.html#7671" title="HashMap.this.Entry">Entry</a>])
      <a href="#144678" title="Int">i</a> += <span title="Int(1)" class="int">1</span>
    }
    <a href="../mutable/HashTable.scala.html#43461" title="(x$1: Int)Unit">tableSize</a> = <a href="#143770" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">last</a>.<a href="../mutable/HashTable.scala.html#43460" title="=&gt; Int">tableSize</a>
    <a href="../mutable/HashTable.scala.html#43464" title="(x$1: Int)Unit">threshold</a> = <a href="#143770" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">last</a>.<a href="../mutable/HashTable.scala.html#43463" title="=&gt; Int">threshold</a>
    <a href="#144674" title="(m: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit">undo</a>(<a href="#9165" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a>)
    <a href="#43418" title="(x$1: scala.collection.immutable.HashMap[A,B])Unit">later</a> = <span title="Null(null)" class="keyword">null</span>
  }

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="43447">makeCopyIfUpdated</a>() {
    <span class="keyword">var</span> <a title="scala.collection.immutable.HashMap[A, _ &gt;: B]" id="144843">m</a>: <a href="#9165" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">HashMap</a>[A, _ &gt;: B] = <a href="#9165" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a>
    <span title="Unit" class="keyword">while</span> (<a href="#144843" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43418" title="(x$1: AnyRef)Boolean">later</a> != <span title="Null(null)" class="keyword">null</span>) <a href="#144843" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a> = <a href="#144843" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43418" title="=&gt; scala.collection.immutable.HashMap[A,_$5]">later</a>
    <span title="Unit" class="keyword">if</span> (<a href="#144843" title="(x$1: AnyRef)Boolean">m</a> ne <a href="#9165" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a>) <a href="#43446" title="(last: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit">makeCopy</a>(<a href="#144843" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>)
  }
}

/** A factory object for immutable HashMaps.
 *
 *  @author  Martin Odersky
 *  @version 2.8
 */
<span class="keyword">object</span> <a title="object scala.collection.immutable.HashMap" id="9166">HashMap</a> <a href="../../ScalaObject.scala.html#969" title="ScalaObject" class="keyword">extends</a> <a href="../generic/ImmutableMapFactory.scala.html#10468" title="scala.collection.generic.ImmutableMapFactory[scala.collection.immutable.HashMap]">ImmutableMapFactory</a>[HashMap] {
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A, B]scala.collection.generic.BuilderFactory[(A, B),scala.collection.immutable.HashMap[A,B],scala.collection.immutable.HashMap.Coll]" id="143686">builderFactory</a>[<a title="&gt;: Nothing &lt;: Any" id="143689">A</a>, <a title="&gt;: Nothing &lt;: Any" id="143690">B</a>]: <a href="../generic/BuilderFactory.scala.html#10906" title="scala.collection.generic.BuilderFactory[(A, B),scala.collection.immutable.HashMap[A,B],scala.collection.immutable.HashMap.Coll]">BuilderFactory</a>[(A, B), HashMap[A, B], Coll] = <span title="scala.collection.immutable.HashMap.MapBuilderFactory[A,B]" class="keyword">new</span> <a href="../generic/MapFactory.scala.html#35299" title="scala.collection.immutable.HashMap.MapBuilderFactory[A,B]">MapBuilderFactory</a>[A, B]
  <span class="keyword">def</span> <a title="[A, B]scala.collection.immutable.HashMap[A,B]" id="143691">empty</a>[<a title="&gt;: Nothing &lt;: Any" id="143694">A</a>, <a title="&gt;: Nothing &lt;: Any" id="143695">B</a>]: <a href="#9165" title="scala.collection.immutable.HashMap[A,B]">HashMap</a>[A, B] = <span title="scala.collection.immutable.HashMap[A,Nothing]" class="keyword">new</span> <a href="#9165" title="scala.collection.immutable.HashMap[A,Nothing]">HashMap</a>
}


        </pre>
    </body>
</html>