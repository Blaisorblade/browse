<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/collection/immutable/HashMap.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

// $Id: HashMap.scala 18387 2009-07-24 15:28:37Z odersky $


<span class="keyword">package</span> scala.collection.immutable

<span class="keyword">import</span> scala.collection.generic._
<span class="keyword">import</span> scala.collection.mutable
<span class="keyword">import</span> annotation.unchecked.uncheckedVariance

/** This class implements immutable maps using a hash table.
 * It is optimized for sequential accesses where the last updated table is accessed most often.
 * It supports with reasonable efficiency accesses to previous versions of the table by keeping
 * a change log that's regularly compacted.
 * It needs to synchronize most methods, so it is less suitable for highly concurrent accesses.
 *
 * @note the builder of a hash map returns specialized representations EmptyMap,Map1,..., Map4
 * for maps of size &lt;= 4.
 *
 *  @author  Martin Odersky
 *  @version 2.0, 19/01/2007
 */
@serializable
<span class="keyword">class</span> <a title="class HashMap[A, +B] extends java.lang.Object with scala.collection.immutable.Map[A,B] with scala.collection.generic.ImmutableMapTemplate[A,B,scala.collection.immutable.HashMap[A,B]] with scala.collection.mutable.HashTable[A] with ScalaObject" id="9090">HashMap</a>[<a title="&gt;: Nothing &lt;: Any" id="14306">A</a>, +<a title="&gt;: Nothing &lt;: Any" id="14307">B</a>] <a href="../../ScalaObject.scala.html#957" title="ScalaObject" class="keyword">extends</a> <a href="Map.scala.html#8874" title="scala.collection.immutable.Map[A,B]">Map</a>[A,B] <span class="keyword">with</span> <a href="../generic/ImmutableMapTemplate.scala.html#10313" title="scala.collection.generic.ImmutableMapTemplate[A,B,scala.collection.immutable.HashMap[A,B]]">ImmutableMapTemplate</a>[A, B, HashMap[A, B]] <span class="keyword">with</span> mutable.<a href="../mutable/HashTable.scala.html#7845" title="scala.collection.mutable.HashTable[A]">HashTable</a>[A] {

  <span class="keyword">type</span> <a title="scala.collection.mutable.DefaultEntry[A,Any]" id="43303">Entry</a> = collection.mutable.<a href="../mutable/DefaultEntry.scala.html#7608" title="scala.collection.mutable.DefaultEntry[A,Any]">DefaultEntry</a>[A, Any]

  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="scala.collection.immutable.HashMap[A,B]" id="43305">later</a>: <a href="#9090" title="scala.collection.immutable.HashMap[A,B @scala.annotation.unchecked.uncheckedVariance]">HashMap</a>[A, B @uncheckedVariance] = <span title="Null(null)" class="keyword">null</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="A" id="43308">oldKey</a>: <a href="#14306" title="A">A</a> = _
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="Option[B]" id="43311">oldValue</a>: <a href="../../Option.scala.html#777" title="Option[B @scala.annotation.unchecked.uncheckedVariance]">Option</a>[B @uncheckedVariance] = _
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="Int" id="43314">deltaSize</a>: <span title="Int">Int</span> = _
  
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.HashMap[A,B]" id="43316">empty</a> = <a href="#9091" title="object scala.collection.immutable.HashMap">HashMap</a>.<a href="#143022" title="[A, B]scala.collection.immutable.HashMap[A,B]">empty</a><span title="scala.collection.immutable.HashMap[A,B]">[</span><a href="#14306" title="A">A</a>, <a href="#14307" title="B">B</a>]

  <span class="keyword">def</span> <a title="(key: A)Option[B]" id="43317">get</a>(<a title="A" id="143029">key</a>: <a href="#14306" title="A">A</a>): <a href="../../Option.scala.html#777" title="Option[B]">Option</a>[B] = <a href="#9090" title="(x$1: Option[B])Option[B]">synchronized</a> {
    <span class="keyword">var</span> <a title="scala.collection.immutable.HashMap[A, _ &gt;: B]" id="143034">m</a>: <a href="#9090" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">HashMap</a>[A, _ &gt;: B] = <a href="#9090" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a>
    <span class="keyword">var</span> <a title="Int" id="143035">cnt</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> (<a href="#143034" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43305" title="(x$1: AnyRef)Boolean">later</a> != <span title="Null(null)" class="keyword">null</span>) <a href="#143037" title="()Unit">{</a>
      <span title="Unit" class="keyword">if</span> (<a href="#143029" title="(x$1: Any)Boolean" id="3610">key</a> == <a href="#143034" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43308" title="=&gt; A">oldKey</a>) <span title="Nothing" class="keyword">return</span> <a href="#143034" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43311" title="=&gt; Option[_$1]">oldValue</a>.<span title="[T0]T0">asInstanceOf</span><span title="Option[B]">[</span><a href="../../Option.scala.html#777" title="Option[B]">Option</a>[B]]
      <a href="#143035" title="Int">cnt</a> += <span title="Int(1)" class="int">1</span>
      <a href="#143034" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a> = <a href="#143034" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43305" title="=&gt; scala.collection.immutable.HashMap[A,_$1]">later</a>
    }
    <span title="Unit" class="keyword">if</span> (<a href="#143035" title="(x$1: Int)Boolean">cnt</a> &gt; <a href="#43331" title="=&gt; Int">logLimit</a>) <a href="#43333" title="(last: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit">makeCopy</a>(<a href="#143034" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>)
    <span class="keyword">val</span> <a title="scala.collection.mutable.DefaultEntry[A,Any]" id="143036">e</a> = <a href="#143034" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="../mutable/HashTable.scala.html#43354" title="(key: A)scala.collection.mutable.DefaultEntry[A,Any]">findEntry</a>(<a href="#143029" title="A">key</a>)
    <span title="Option[B]" class="keyword">if</span> (<a href="#143036" title="(x$1: AnyRef)Boolean">e</a> == <span title="Null(null)" class="keyword">null</span>) <a href="../../Option.scala.html#463" title="object None">None</a>
    <span class="keyword">else</span> <a href="../../Option.scala.html#19800" title="(x: B)Some[B]">Some</a>(<a href="#43330" title="(e: HashMap.this.Entry)B">getValue</a>(<a href="#143036" title="scala.collection.mutable.DefaultEntry[A,Any]">e</a>))
  }

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B1 &gt;: B](key: A,value: B1)scala.collection.immutable.HashMap[A,B1]" id="43318">updated</a> [<a title="&gt;: B &lt;: Any" id="43320">B1</a> &gt;: B] (<a title="A" id="143141">key</a>: <a href="#14306" title="A">A</a>, <a title="B1" id="143142">value</a>: <a href="#43320" title="B1">B1</a>): <a href="#9090" title="scala.collection.immutable.HashMap[A,B1]">HashMap</a>[A, B1] = <a href="#9090" title="(x$1: scala.collection.immutable.HashMap[A,B1])scala.collection.immutable.HashMap[A,B1]">synchronized</a> {
    <a href="#43334" title="()Unit">makeCopyIfUpdated</a>()
    <span class="keyword">val</span> <a title="HashMap.this.Entry" id="143196">e</a> = <a href="../mutable/HashTable.scala.html#43354" title="(key: A)HashMap.this.Entry">findEntry</a>(<a href="#143141" title="A">key</a>)
    <span title="Unit" class="keyword">if</span> (<a href="#143196" title="(x$1: AnyRef)Boolean">e</a> == <span title="Null(null)" class="keyword">null</span>) { 
      <a href="#43332" title="(key: A,ov: Option[B],delta: Int)Unit">markUpdated</a>(<a href="#143141" title="A">key</a>, <a href="../../Option.scala.html#463" title="object None">None</a>, <span title="Int(1)" class="int">1</span>)
      <a href="#43305" title="=&gt; scala.collection.immutable.HashMap[A,B]">later</a>.<a href="../mutable/HashTable.scala.html#43355" title="(e: scala.collection.mutable.DefaultEntry[A,Any])Unit">addEntry</a>(<span title="scala.collection.mutable.DefaultEntry[A,Any]" class="keyword">new</span> <a href="#43303" title="scala.collection.mutable.DefaultEntry[A,Any]">Entry</a>(<a href="#143141" title="A">key</a>, <a href="#143142" title="B1">value</a>))
    } <span class="keyword">else</span> {
      <a href="#43332" title="(key: A,ov: Option[B],delta: Int)Unit">markUpdated</a>(<a href="#143141" title="A">key</a>, <a href="../../Option.scala.html#19800" title="(x: B)Some[B]">Some</a>(<a href="#43330" title="(e: HashMap.this.Entry)B">getValue</a>(<a href="#143196" title="HashMap.this.Entry">e</a>)), <span title="Int(0)" class="int">0</span>)
      <a href="#143196" title="HashMap.this.Entry">e</a>.<a href="../mutable/DefaultEntry.scala.html#143010" title="(x$1: Any)Unit">value</a> = <a href="#143142" title="B1">value</a>
    }
    <a href="#43305" title="=&gt; scala.collection.immutable.HashMap[A,B]">later</a>.<span title="[T0]T0">asInstanceOf</span><span title="scala.collection.immutable.HashMap[A,B1]">[</span><a href="#9090" title="scala.collection.immutable.HashMap[A,B1]">HashMap</a>[A, B1]]
  }

  /** Add a key/value pair to this map. 
   *  @param    kv the key/value pair
   *  @return   A new map with the new binding added to this map
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B1 &gt;: B](kv: (A, B1))scala.collection.immutable.HashMap[A,B1]" id="43321">+</a> [<a title="&gt;: B &lt;: Any" id="43323">B1</a> &gt;: B] (<a title="(A, B1)" id="43374">kv</a>: <a href="../../Tuple2.scala.html#1152" title="(A, B1)">(</a>A, B1)): <a href="#9090" title="scala.collection.immutable.HashMap[A,B1]">HashMap</a>[A, B1] = <a href="#43318" title="(key: A,value: B1)scala.collection.immutable.HashMap[A,B1]">updated</a>(<a href="#43374" title="(A, B1)">kv</a>.<a href="../../Tuple2.scala.html#20472" title="=&gt; A">_1</a>, <a href="#43374" title="(A, B1)">kv</a>.<a href="../../Tuple2.scala.html#20474" title="=&gt; B1">_2</a>)

  /** Adds two or more elements to this collection and returns
   *  either the collection itself (if it is mutable), or a new collection
   *  with the added elements.
   *
   *  @param elem1 the first element to add.
   *  @param elem2 the second element to add.
   *  @param elems the remaining elements to add.
   */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B1 &gt;: B](elem1: (A, B1),elem2: (A, B1),elems: (A, B1)*)scala.collection.immutable.HashMap[A,B1]" id="43324">+</a> [<a title="&gt;: B &lt;: Any" id="43326">B1</a> &gt;: B] (<a title="(A, B1)" id="43498">elem1</a>: <a href="../../Tuple2.scala.html#1152" title="(A, B1)">(</a>A, B1), <a title="(A, B1)" id="43499">elem2</a>: <a href="../../Tuple2.scala.html#1152" title="(A, B1)">(</a>A, B1), <a title="(A, B1)*" id="43500">elems</a>: <a title="(A, B1)*" id="4176">(</a>A, B1) *): <a href="#9090" title="scala.collection.immutable.HashMap[A,B1]">HashMap</a>[A, B1] =
    <a href="#43321" title="(kv: (A, B1))scala.collection.immutable.HashMap[A,B1]" class="keyword">this</a> <a href="#43321" title="(kv: (A, B1))scala.collection.immutable.HashMap[A,B1]">+</a> <a href="#43498" title="(A, B1)">elem1</a> <a href="../generic/TraversableTemplate.scala.html#17151" title="(that: Traversable[(A, B1)])(implicit bf: scala.collection.generic.BuilderFactory[(A, B1),scala.collection.immutable.HashMap[A,B1],scala.collection.immutable.HashMap[A,B1]])scala.collection.immutable.HashMap[A,B1]">+</a> <a href="#43499" title="(A, B1)">elem2</a> <a href="#143017" title="scala.collection.generic.BuilderFactory[(A, B1),scala.collection.immutable.HashMap[A,B1],scala.collection.immutable.HashMap#Coll]">++</a> <a href="#43500" title="(A, B1)*">elems</a>

  <span class="keyword">def</span> <a title="(key: A)scala.collection.immutable.HashMap[A,B]" id="43327">-</a> (<a title="A" id="143741">key</a>: <a href="#14306" title="A">A</a>): <a href="#9090" title="scala.collection.immutable.HashMap[A,B]">HashMap</a>[A, B] = <a href="#9090" title="(x$1: scala.collection.immutable.HashMap[A,B])scala.collection.immutable.HashMap[A,B]">synchronized</a> {
    <a href="#43334" title="()Unit">makeCopyIfUpdated</a>()
    <span class="keyword">val</span> <a title="HashMap.this.Entry" id="143760">e</a> = <a href="../mutable/HashTable.scala.html#43354" title="(key: A)HashMap.this.Entry">findEntry</a>(<a href="#143741" title="A">key</a>)
    <span title="scala.collection.immutable.HashMap[A,B]" class="keyword">if</span> (<a href="#143760" title="(x$1: AnyRef)Boolean">e</a> == <span title="Null(null)" class="keyword">null</span>) <a href="#9090" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a> 
    <span class="keyword">else</span> {
      <a href="#43332" title="(key: A,ov: Option[B],delta: Int)Unit">markUpdated</a>(<a href="#143741" title="A">key</a>, <a href="../../Option.scala.html#19800" title="(x: B)Some[B]">Some</a>(<a href="#43330" title="(e: HashMap.this.Entry)B">getValue</a>(<a href="#143760" title="HashMap.this.Entry">e</a>)), <span title="Int(-1)">-</span><span class="int">1</span>)
      <a href="../mutable/HashTable.scala.html#43356" title="(key: A)scala.collection.mutable.DefaultEntry[A,Any]">later</a> removeEntry <a href="#143741" title="A">key</a>
      <a href="#43305" title="=&gt; scala.collection.immutable.HashMap[A,B]">later</a>.<span title="[T0]T0">asInstanceOf</span><span title="scala.collection.immutable.HashMap[A,B]">[</span><a href="#9090" title="scala.collection.immutable.HashMap[A,B]">HashMap</a>[A, B]]
    } 
  }

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="43328">size</a>: <span title="Int">Int</span> = <a href="#9090" title="(x$1: Int)Int">synchronized</a> {
    <span class="keyword">var</span> <a title="scala.collection.immutable.HashMap[A, _ &gt;: B]" id="143798">m</a>: <a href="#9090" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">HashMap</a>[A, _ &gt;: B] = <a href="#9090" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a>
    <span class="keyword">var</span> <a title="Int" id="143799">cnt</a> = <span title="Int(0)" class="int">0</span>
    <span class="keyword">var</span> <a title="Int" id="143800">s</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> (<a href="#143798" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43305" title="(x$1: AnyRef)Boolean">later</a> != <span title="Null(null)" class="keyword">null</span>) <a href="#143801" title="()Unit">{</a>
      <a href="#143800" title="Int" id="2964">s</a> -= <a href="#143798" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43314" title="=&gt; Int">deltaSize</a>
      <a href="#143799" title="Int">cnt</a> += <span title="Int(1)" class="int">1</span>
      <a href="#143798" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a> = <a href="#143798" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43305" title="=&gt; scala.collection.immutable.HashMap[A,_$2]">later</a>
    }
    <a href="#143800" title="Int">s</a> += <a href="#143798" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="../mutable/HashTable.scala.html#43347" title="=&gt; Int">tableSize</a>
    <span title="Unit" class="keyword">if</span> (<a href="#143799" title="(x$1: Int)Boolean">cnt</a> &gt; <a href="#43331" title="=&gt; Int">logLimit</a>) <a href="#43333" title="(last: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit">makeCopy</a>(<a href="#143798" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>)  
    <a href="#143800" title="Int">s</a>
  }

  <span class="keyword">def</span> <a title="=&gt; Iterator[(A, B)]" id="43329">iterator</a> = <a href="#9090" title="(x$1: Iterator[(A, B)])Iterator[(A, B)]">synchronized</a> {
    <a href="#43334" title="()Unit">makeCopyIfUpdated</a>()
    <a href="../Iterator.scala.html#19189" title="(f: (HashMap.this.Entry) =&gt; (A, B))Iterator[(A, B)]">entriesIterator</a> map {<a title="HashMap.this.Entry" id="143941">e</a> =&gt; <a href="../../Tuple2.scala.html#20670" title="(_1: A,_2: B)(A, B)">(</a><a href="#143941" title="HashMap.this.Entry">e</a>.<a href="../mutable/DefaultEntry.scala.html#143007" title="=&gt; A">key</a>, <a href="#43330" title="(e: HashMap.this.Entry)B">getValue</a>(<a href="#143941" title="HashMap.this.Entry">e</a>))}
  }
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(e: HashMap.this.Entry)B" id="43330">getValue</a>(<a title="HashMap.this.Entry" id="143130">e</a>: <a href="../mutable/DefaultEntry.scala.html#7608" title="HashMap.this.Entry">Entry</a>) = 
    <a href="#143130" title="HashMap.this.Entry">e</a>.<a href="../mutable/DefaultEntry.scala.html#143009" title="=&gt; Any">value</a>.<span title="[T0]T0">asInstanceOf</span><span title="B">[</span><a href="#14307" title="B">B</a>]

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Int" id="43331">logLimit</a>: <span title="Int">Int</span> = <a href="../../Math.scala.html#526" title="object Math">Math</a>.<a href="../../Math.scala.html#22717" title="(x: Double)Double">sqrt</a>(<a href="../mutable/HashTable.scala.html#43344" title="=&gt; Array[scala.collection.mutable.HashEntry[A,HashMap.this.Entry]]">table</a>.<a href="../../Predef.scala.html#16387" title="implicit scala.Predef.int2double : (x: Int)Double">length</a>).<a title="=&gt; Int" id="3426">toInt</a>

  <span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">def</span> <a title="(key: A,ov: Option[B],delta: Int)Unit" id="43332">markUpdated</a>(<a title="A" id="143209">key</a>: <a href="#14306" title="A">A</a>, <a title="Option[B]" id="143210">ov</a>: <a href="../../Option.scala.html#777" title="Option[B]">Option</a>[B], <a title="Int" id="143211">delta</a>: <span title="Int">Int</span>) { 
    <span class="keyword">val</span> <a title="Int" id="143967">lv</a> = <a href="../mutable/HashTable.scala.html#43339" title="=&gt; Int">loadFactor</a>
    <a href="#43305" title="(x$1: scala.collection.immutable.HashMap[A,B])Unit">later</a> = <a href="#143971" title="scala.collection.immutable.HashMap[A,B]{ ... }" class="keyword">new</a> <a title="anonymous class $anon extends scala.collection.immutable.HashMap[A,B]" id="143971">HashMap</a>[A, B] {
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="143973">initialSize</a> = <span title="Int(0)" class="int">0</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="143974">loadFactor</a> = <a href="#143967" title="Int">lv</a>        
      <a href="../mutable/HashTable.scala.html#43345" title="(x$1: Array[scala.collection.mutable.HashEntry[A,this.Entry]])Unit">table</a>     = <a href="#9090" title="HashMap.this.type">HashMap</a>.<span class="keyword">this</span>.<a href="../mutable/HashTable.scala.html#43344" title="=&gt; Array[scala.collection.mutable.HashEntry[A,HashMap.this.Entry]]">table</a>
      <a href="../mutable/HashTable.scala.html#43348" title="(x$1: Int)Unit">tableSize</a> = <a href="#9090" title="HashMap.this.type">HashMap</a>.<span class="keyword">this</span>.<a href="../mutable/HashTable.scala.html#43347" title="=&gt; Int">tableSize</a>
      <a href="../mutable/HashTable.scala.html#43351" title="(x$1: Int)Unit">threshold</a> = <a href="#9090" title="HashMap.this.type">HashMap</a>.<span class="keyword">this</span>.<a href="../mutable/HashTable.scala.html#43350" title="=&gt; Int">threshold</a>
    }
    <a href="#43308" title="(x$1: A)Unit">oldKey</a> = <a href="#143209" title="A">key</a>
    <a href="#43311" title="(x$1: Option[B])Unit">oldValue</a> = <a href="#143210" title="Option[B]">ov</a>
    <a href="#43314" title="(x$1: Int)Unit">deltaSize</a> = <a href="#143211" title="Int">delta</a>
  }

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(last: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit" id="43333">makeCopy</a>(<a title="scala.collection.immutable.HashMap[A, _ &gt;: B]" id="143101">last</a>: <a href="#9090" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">HashMap</a>[A, _ &gt;: B]) {
    <span class="keyword">def</span> <a title="(m: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit" id="144005">undo</a>(<a title="scala.collection.immutable.HashMap[A, _ &gt;: B]" id="144011">m</a>: <a href="#9090" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">HashMap</a>[A, _ &gt;: B]) {
      <span title="Unit" class="keyword">if</span> (<a href="#144011" title="(x$1: AnyRef)Boolean">m</a> ne <a href="#143101" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">last</a>) {
        <a href="#144005" title="(m: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit">undo</a>(<a href="#144011" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43305" title="=&gt; scala.collection.immutable.HashMap[A,Any]">later</a>)
        <span title="Unit" class="keyword">if</span> (<a href="#144011" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43314" title="(x$1: Int)Boolean">deltaSize</a> == <span title="Int(1)" class="int">1</span>) <a href="../mutable/HashTable.scala.html#43356" title="(key: A)HashMap.this.Entry">removeEntry</a><span title="Unit">(</span><a href="#144011" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43308" title="=&gt; A">oldKey</a>)
        <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> (<a href="#144011" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43314" title="(x$1: Int)Boolean">deltaSize</a> == <span title="Int(0)" class="int">0</span>) <a href="../mutable/HashTable.scala.html#43354" title="(key: A)HashMap.this.Entry">findEntry</a>(<a href="#144011" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43308" title="=&gt; A">oldKey</a>).<a href="../mutable/DefaultEntry.scala.html#143010" title="(x$1: Any)Unit">value</a> = <a href="#144011" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43311" title="=&gt; Option[Any]">oldValue</a>.<a href="../../Option.scala.html#19759" title="=&gt; Any">get</a>
        <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> (<a href="#144011" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43314" title="(x$1: Int)Boolean">deltaSize</a> == <span title="Int(-1)">-</span><span class="int">1</span>) <a href="../mutable/HashTable.scala.html#43355" title="(e: HashMap.this.Entry)Unit">addEntry</a>(<span title="scala.collection.mutable.DefaultEntry[A,Any]" class="keyword">new</span> <a href="#43303" title="scala.collection.mutable.DefaultEntry[A,Any]">Entry</a>(<a href="#144011" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43308" title="=&gt; A">oldKey</a>, <a href="#144011" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43311" title="=&gt; Option[Any]">oldValue</a>.<a href="../../Option.scala.html#19759" title="=&gt; Any">get</a>))
      }
    }
    <span class="keyword">def</span> <a title="(e: HashMap.this.Entry)HashMap.this.Entry" id="144006">copy</a>(<a title="HashMap.this.Entry" id="144073">e</a>: <a href="../mutable/DefaultEntry.scala.html#7608" title="HashMap.this.Entry">Entry</a>): <a href="../mutable/DefaultEntry.scala.html#7608" title="HashMap.this.Entry">Entry</a> = 
      <span title="HashMap.this.Entry" class="keyword">if</span> (<a href="#144073" title="(x$1: AnyRef)Boolean">e</a> == <span title="Null(null)" class="keyword">null</span>) <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">else</span> {
        <span class="keyword">val</span> <a title="HashMap.this.Entry" id="144080">rest</a> = <a href="#144006" title="(e: HashMap.this.Entry)HashMap.this.Entry">copy</a>(<a href="#144073" title="HashMap.this.Entry">e</a>.<a href="../mutable/HashEntry.scala.html#50399" title="=&gt; scala.collection.mutable.DefaultEntry[A,Any]">next</a>)
        <span class="keyword">val</span> <a title="scala.collection.mutable.DefaultEntry[A,Any]" id="144081">result</a> = <span title="scala.collection.mutable.DefaultEntry[A,Any]" class="keyword">new</span> <a href="#43303" title="scala.collection.mutable.DefaultEntry[A,Any]">Entry</a>(<a href="#144073" title="HashMap.this.Entry">e</a>.<a href="../mutable/DefaultEntry.scala.html#143007" title="=&gt; A">key</a>, <a href="#144073" title="HashMap.this.Entry">e</a>.<a href="../mutable/DefaultEntry.scala.html#143009" title="=&gt; Any">value</a>)
        <a href="#144081" title="scala.collection.mutable.DefaultEntry[A,Any]">result</a>.<a href="../mutable/HashEntry.scala.html#50400" title="(x$1: scala.collection.mutable.DefaultEntry[A,Any])Unit">next</a> = <a href="#144080" title="HashMap.this.Entry">rest</a>
        <a href="#144081" title="scala.collection.mutable.DefaultEntry[A,Any]">result</a>
      }
    <span class="keyword">val</span> <a title="Array[scala.collection.mutable.HashEntry[A,last.Entry]]" id="144007">ltable</a> = <a href="#143101" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">last</a>.<a href="../mutable/HashTable.scala.html#43344" title="=&gt; Array[scala.collection.mutable.HashEntry[A,last.Entry]]">table</a>
    <span class="keyword">val</span> <a title="Int" id="144008">s</a> = <a href="#144007" title="Array[scala.collection.mutable.HashEntry[A,last.Entry]]">ltable</a>.<a href="../../Array.scala.html#17715" title="=&gt; Int">length</a>
    <a href="../mutable/HashTable.scala.html#43345" title="(x$1: Array[scala.collection.mutable.HashEntry[A,HashMap.this.Entry]])Unit">table</a> = <span title="Array[scala.collection.mutable.HashEntry[A,HashMap.this.Entry]]" class="keyword">new</span> scala.<a href="../../Array.scala.html#885" title="Array[scala.collection.mutable.HashEntry[A,HashMap.this.Entry]]">Array</a>[collection.mutable.HashEntry[A, Entry]](<a href="#144008" title="Int">s</a>)
    <span class="keyword">var</span> <a title="Int" id="144009">i</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> (<a href="#144009" title="(x$1: Int)Boolean" id="2954">i</a> &lt; <a href="#144008" title="Int">s</a>) <a href="#144010" title="()Unit">{</a>
      <a href="../../Array.scala.html#17717" title="(i: Int,x: scala.collection.mutable.HashEntry[A,HashMap.this.Entry])Unit">table</a>(<a href="#144009" title="Int">i</a>) = <a href="#144006" title="(e: HashMap.this.Entry)HashMap.this.Entry">copy</a>(<a href="../../Array.scala.html#17716" title="(i: Int)scala.collection.mutable.HashEntry[A,last.Entry]">ltable</a>(<a href="#144009" title="Int">i</a>).<span title="[T0]T0">asInstanceOf</span><span title="HashMap.this.Entry">[</span><a href="../mutable/DefaultEntry.scala.html#7608" title="HashMap.this.Entry">Entry</a>])
      <a href="#144009" title="Int">i</a> += <span title="Int(1)" class="int">1</span>
    }
    <a href="../mutable/HashTable.scala.html#43348" title="(x$1: Int)Unit">tableSize</a> = <a href="#143101" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">last</a>.<a href="../mutable/HashTable.scala.html#43347" title="=&gt; Int">tableSize</a>
    <a href="../mutable/HashTable.scala.html#43351" title="(x$1: Int)Unit">threshold</a> = <a href="#143101" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">last</a>.<a href="../mutable/HashTable.scala.html#43350" title="=&gt; Int">threshold</a>
    <a href="#144005" title="(m: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit">undo</a>(<a href="#9090" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a>)
    <a href="#43305" title="(x$1: scala.collection.immutable.HashMap[A,B])Unit">later</a> = <span title="Null(null)" class="keyword">null</span>
  }

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="43334">makeCopyIfUpdated</a>() {
    <span class="keyword">var</span> <a title="scala.collection.immutable.HashMap[A, _ &gt;: B]" id="144174">m</a>: <a href="#9090" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">HashMap</a>[A, _ &gt;: B] = <a href="#9090" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a>
    <span title="Unit" class="keyword">while</span> (<a href="#144174" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43305" title="(x$1: AnyRef)Boolean">later</a> != <span title="Null(null)" class="keyword">null</span>) <a href="#144174" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a> = <a href="#144174" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>.<a href="#43305" title="=&gt; scala.collection.immutable.HashMap[A,_$5]">later</a>
    <span title="Unit" class="keyword">if</span> (<a href="#144174" title="(x$1: AnyRef)Boolean">m</a> ne <a href="#9090" title="scala.collection.immutable.HashMap[A,B]" class="keyword">this</a>) <a href="#43333" title="(last: scala.collection.immutable.HashMap[A, _ &gt;: B])Unit">makeCopy</a>(<a href="#144174" title="scala.collection.immutable.HashMap[A, _ &gt;: B]">m</a>)
  }
}

/** A factory object for immutable HashMaps.
 *
 *  @author  Martin Odersky
 *  @version 2.8
 */
<span class="keyword">object</span> <a title="object scala.collection.immutable.HashMap" id="9091">HashMap</a> <a href="../../ScalaObject.scala.html#957" title="ScalaObject" class="keyword">extends</a> <a href="../generic/ImmutableMapFactory.scala.html#10385" title="scala.collection.generic.ImmutableMapFactory[scala.collection.immutable.HashMap]">ImmutableMapFactory</a>[HashMap] {
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A, B]scala.collection.generic.BuilderFactory[(A, B),scala.collection.immutable.HashMap[A,B],scala.collection.immutable.HashMap.Coll]" id="143017">builderFactory</a>[<a title="&gt;: Nothing &lt;: Any" id="143020">A</a>, <a title="&gt;: Nothing &lt;: Any" id="143021">B</a>]: <a href="../generic/BuilderFactory.scala.html#10817" title="scala.collection.generic.BuilderFactory[(A, B),scala.collection.immutable.HashMap[A,B],scala.collection.immutable.HashMap.Coll]">BuilderFactory</a>[(A, B), HashMap[A, B], Coll] = <span title="scala.collection.immutable.HashMap.MapBuilderFactory[A,B]" class="keyword">new</span> <a href="../generic/MapFactory.scala.html#35186" title="scala.collection.immutable.HashMap.MapBuilderFactory[A,B]">MapBuilderFactory</a>[A, B]
  <span class="keyword">def</span> <a title="[A, B]scala.collection.immutable.HashMap[A,B]" id="143022">empty</a>[<a title="&gt;: Nothing &lt;: Any" id="143025">A</a>, <a title="&gt;: Nothing &lt;: Any" id="143026">B</a>]: <a href="#9090" title="scala.collection.immutable.HashMap[A,B]">HashMap</a>[A, B] = <span title="scala.collection.immutable.HashMap[A,Nothing]" class="keyword">new</span> <a href="#9090" title="scala.collection.immutable.HashMap[A,Nothing]">HashMap</a>
}


        </pre>
    </body>
</html>