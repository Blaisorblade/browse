<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>scala/collection/immutable/Tree.scala</title>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style">
    </head>
    <body onload="initializeLinked()">
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2009, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="comment">// $Id: Tree.scala 16893 2009-01-13 13:09:22Z cunei $</span>

<span class="comment">/* General Balanced Trees - highly efficient functional dictionaries.
**
** This is a scala version of gb_trees.erl which is
** copyrighted (C) 1999-2001 by Sven-Olof Nystrom, and Richard Carlsson
**
** An efficient implementation of Prof. Arne Andersson's General
** Balanced Trees. These have no storage overhead compared to plain
** unbalanced binary trees, and their performance is in general better
** than AVL trees.
**
** NOTE: This code was until 2007-04-01 under a GPL license. The author has
** given permission to remove that license, so that now this code is under
** the general license for the Scala libraries. 
*/</span>

<span class="keyword">package</span> scala.collection.immutable


<span class="comment">//import Predef.NoSuchElementException</span>

<span class="comment">/** &lt;p&gt;
 *    General Balanced Trees - highly efficient functional dictionaries.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    An efficient implementation of Prof. Arne Andersson's
 *    &lt;a href=&quot;http://citeseer.ist.psu.edu/andersson99general.html&quot;
 *    target=&quot;_top&quot;&gt;General Balanced Trees&lt;/a&gt;. These have no storage overhead
 *    compared to plain unbalanced binary trees, and their performance is in
 *    general better than AVL trees.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    This implementation does not balance the trees after deletions.
 *    Since deletions don't increase the height of a tree, this should
 *    be OK in most applications. A balance method is provided for those
 *    cases where rebalancing is needed.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    The tree consists of entries conatining a key with an order.
 *  &lt;/p&gt;
 *  &lt;p&gt;
 *    When instanciating the tree an order for the keys has to be
 *    supplied.
 *  &lt;/p&gt;
 *
 *  @author  Erik Stenman, Michel Schinz
 *  @version 1.1, 2005-01-20
 */</span>

@<span class="typed"><span class="type">serializable</span><a href="../../serializable.scala.html#647">serializable</a></span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class Tree[A, B] extends java.lang.Object with ScalaObject</span><span id="9257"><span id="112232"><a id="112249">Tree</a></span></span></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="16347">A</a></span> &lt;% Ordered[A], <span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="16348">B</a></span>]() <span class="keyword">extends</span> <span class="typed"><span class="type">java.lang.Object</span><a id="2163">AnyRef</a></span> {
  <span class="comment">/* Data structure:
  ** - size:Int - the number of elements in the tree.
  ** - tree:T, which is composed of nodes of the form:
  **   - GBNode(key: A, entry:B, smaller:T, bigger:T),
  **   - and the &quot;empty tree&quot; node GBLeaf.
  **
  ** Original balance condition h(T) &lt;= ceil(c * log(|T|)) has been
  ** changed to the similar (but not quite equivalent) condition
  ** 2 ^ h(T) &lt;= |T| ^ c.
  **
  */</span>

  <span class="comment">/** The type returned when creating a new tree.
   *  This type should be defined by concrete implementations
   *  e.g. &lt;pre&gt;
   *  class C[T](...) extends Tree[A,B](...) {
   *    type This = C[T];
   *  &lt;/pre&gt;
   */</span>
  <span class="keyword">protected</span> <span class="keyword">type</span> <span class="typed"><span class="type">&gt;: Nothing &lt;: scala.collection.immutable.Tree[A,B]</span><a id="112234">This</a></span> &lt;: Tree[A,B]
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Tree.this.This</span><a id="112235">getThis</a></span>: <span class="typed"><span class="type">Tree.this.This</span><a href="#112234">This</a></span>

  <span class="comment">/**
   *  The type of nodes that the tree is build from.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">type</span> <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112236">aNode</a></span> = <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]

  <span class="comment">/** The nodes in the tree.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Tree.this.aNode</span><a id="112237">tree</a></span>: <span class="typed"><span class="type">Tree.this.aNode</span><a href="#9287">aNode</a></span> = <span class="typed"><span class="type">()(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBLeaf[A,B]</span><a href="#112270">GBLeaf</a></span>[<span class="typed"><span class="type">A</span><a href="#16347">A</a></span>,<span class="typed"><span class="type">B</span><a href="#16348">B</a></span>]()

  <span class="comment">/** &lt;p&gt;
   *    This abstract method should be defined by a concrete implementation
   *    &lt;code&gt;C[T]&lt;/code&gt; as something like:
   *  &lt;/p&gt;
   *  &lt;pre&gt;
   *    &lt;b&gt;override def&lt;/b&gt; New(sz: Int, t: aNode): This {
   *      &lt;b&gt;new&lt;/b&gt; C[T](order) {
   *        &lt;b&gt;override def&lt;/b&gt; size = sz
   *        &lt;b&gt;override protected def&lt;/b&gt; tree: aNode = t
   *    }
   *  &lt;/pre&gt;
   *  &lt;p&gt;
   *     The concrete implementation should also override the def of This
   *     &lt;code&gt;override type This = C[T];&lt;/code&gt;
   *  &lt;/p&gt;
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(Int,Tree.this.aNode)Tree.this.This</span><a id="112238">New</a></span>(<span class="typed"><span class="type">Int</span><a id="112301">sz</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>, <span class="typed"><span class="type">Tree.this.aNode</span><a id="112302">t</a></span>: <span class="typed"><span class="type">Tree.this.aNode</span><a href="#9287">aNode</a></span>): <span class="typed"><span class="type">Tree.this.This</span><a href="#112234">This</a></span>

  <span class="comment">/** The size of the tree, returns 0 (zero) if the tree is empty.
   *
   *  @return The number of nodes in the tree as an integer.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Int</span><a id="112239">size</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span> = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>

  <span class="comment">/** A new tree with the entry added is returned,
   *  assuming that key is &lt;em&gt;not&lt;/em&gt; in the tree.
   *
   *  @param key   ...
   *  @param entry ...
   *  @return      ...
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(A,B)Tree.this.This</span><a id="112240">add</a></span>(<span class="typed"><span class="type">A</span><a id="112304">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16347">A</a></span>, <span class="typed"><span class="type">B</span><a id="112305">entry</a></span>: <span class="typed"><span class="type">B</span><a href="#16348">B</a></span>): <span class="typed"><span class="type">Tree.this.This</span><a href="#112234">This</a></span> = {
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="112306">newSize</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#112239">size</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">(Int,Tree.this.aNode)Tree.this.This</span><a href="#112238">New</a></span>(<span class="typed"><span class="type">Int</span><a href="#112306">newSize</a></span>, <span class="typed"><span class="type">=&gt; Tree.this.aNode</span><a href="#112237">tree</a></span>.<span class="typed"><span class="type">(A,B,Int)scala.collection.immutable.GBTree[A,B]#anInsertTree</span><a href="#112261">insert</a></span>(<span class="typed"><span class="type">A</span><a href="#112304">key</a></span>, <span class="typed"><span class="type">B</span><a href="#112305">entry</a></span>, <span class="typed"><span class="type">Int</span><a href="#112306">newSize</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">*</a></span> <span class="typed"><span class="type">Int</span><a href="#112306">newSize</a></span>).<span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112316">node</a></span>)
  }

  <span class="comment">/** A new tree with the entry added is returned,
   *  if key is &lt;em&gt;not&lt;/em&gt; in the tree, otherwise
   *  the key is updated with the new entry.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(A,B)Tree.this.This</span><a id="112241">updateOrAdd</a></span>(<span class="typed"><span class="type">A</span><a id="112334">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16347">A</a></span>, <span class="typed"><span class="type">B</span><a id="112335">entry</a></span>: <span class="typed"><span class="type">B</span><a href="#16348">B</a></span>): <span class="typed"><span class="type">Tree.this.This</span><a href="#112234">This</a></span> =
    <span class="typed"><span class="type">Tree.this.This</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Tree.this.aNode</span><a href="#112237">tree</a></span>.<span class="typed"><span class="type">(A)Boolean</span><a href="#112257">isDefinedAt</a></span>(<span class="typed"><span class="type">A</span><a href="#112334">key</a></span>))
      <span class="typed"><span class="type">(Int,Tree.this.aNode)Tree.this.This</span><a href="#112238">New</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#112239">size</a></span>,<span class="typed"><span class="type">=&gt; Tree.this.aNode</span><a href="#112237">tree</a></span>.<span class="typed"><span class="type">(A,B)scala.collection.immutable.GBTree[A,B]#aNode</span><a href="#112260">update</a></span>(<span class="typed"><span class="type">A</span><a href="#112334">key</a></span>,<span class="typed"><span class="type">B</span><a href="#112335">entry</a></span>))
    <span class="keyword">else</span>
      <span class="typed"><span class="type">(A,B)Tree.this.This</span><a href="#112240">add</a></span>(<span class="typed"><span class="type">A</span><a href="#112334">key</a></span>,<span class="typed"><span class="type">B</span><a href="#112335">entry</a></span>)

  <span class="comment">/** Removes the key from the tree.
   *
   *  @param key ...
   *  @return    ...
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(A)Tree.this.This</span><a id="112242">deleteAny</a></span>(<span class="typed"><span class="type">A</span><a id="112341">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16347">A</a></span>): <span class="typed"><span class="type">Tree.this.This</span><a href="#112234">This</a></span> =
    <span class="typed"><span class="type">Tree.this.This</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">=&gt; Tree.this.aNode</span><a href="#112237">tree</a></span>.<span class="typed"><span class="type">(A)Boolean</span><a href="#112257">isDefinedAt</a></span>(<span class="typed"><span class="type">A</span><a href="#112341">key</a></span>))
      <span class="typed"><span class="type">(A)Tree.this.This</span><a href="#112243">delete</a></span>(<span class="typed"><span class="type">A</span><a href="#112341">key</a></span>)
    <span class="keyword">else</span>
      <span class="typed"><span class="type">=&gt; Tree.this.This</span><a href="#112235">getThis</a></span>

  <span class="comment">/** Removes the key from the tree, assumimg that key is present.
   *
   *  @param key ...
   *  @return    ...
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <span class="typed"><span class="type">(A)Tree.this.This</span><a id="112243">delete</a></span>(<span class="typed"><span class="type">A</span><a id="112342">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16347">A</a></span>): <span class="typed"><span class="type">Tree.this.This</span><a href="#112234">This</a></span> =
    <span class="typed"><span class="type">(Int,Tree.this.aNode)Tree.this.This</span><a href="#112238">New</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#112239">size</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>, <span class="typed"><span class="type">=&gt; Tree.this.aNode</span><a href="#112237">tree</a></span>.<span class="typed"><span class="type">(A)scala.collection.immutable.GBTree[A,B]#aNode</span><a href="#112264">delete</a></span>(<span class="typed"><span class="type">A</span><a href="#112342">key</a></span>))

  <span class="comment">/** Check if this map maps &lt;code&gt;key&lt;/code&gt; to a value and return the
   *  value if it exists.
   *
   *  @param  key the key of the mapping of interest
   *  @return     the value of the mapping, if it exists
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(A)Option[B]</span><a id="112244">findValue</a></span>(<span class="typed"><span class="type">A</span><a id="112360">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16347">A</a></span>): <span class="typed"><span class="type">Option[B]</span><a href="../../Option.scala.html#932">Option</a></span>[B] =
    <span class="typed"><span class="type">=&gt; Tree.this.aNode</span><a href="#112237">tree</a></span>.<span class="typed"><span class="type">(A)Option[B]</span><a href="#112258">get</a></span>(<span class="typed"><span class="type">A</span><a href="#112360">key</a></span>)

  <span class="comment">/** Gives you an iterator over all elements in the tree.
   *  The iterator structure corresponds to
   *  the call stack of an in-order traversal.
   *
   *  Note: The iterator itself has a state, i.e., it is not functional.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Iterator[B]</span><a id="112245">entries</a></span>: <span class="typed"><span class="type">Iterator[B]</span><a href="../../Iterator.scala.html#1337">Iterator</a></span>[B] =
    <span class="typed"><span class="type">template $anon extends java.lang.Object with Iterator[B]</span><a id="112363" class="keyword">new</a></span> <span class="typed"><span class="type">Iterator[B]</span><a href="../../Iterator.scala.html#1337">Iterator</a></span>[B] {
      <span class="keyword">var</span> <span class="typed"><span class="type">List[scala.collection.immutable.GBTree[A,B]]</span><span id="112367"><span id="112365"><span id="112366"><a id="112376">iter</a></span></span></span></span> = <span class="typed"><span class="type">=&gt; Tree.this.aNode</span><a href="#112237">tree</a></span>.<span class="typed"><span class="type">((List[_169.aNode])List[_169.aNode]) forSome { val _169: scala.collection.immutable.GBTree[A,B] }</span><a href="#112263">mk_iter</a></span>(scala.<span class="typed"><span class="type">object Nil</span><a href="../../List.scala.html#333">Nil</a></span>)
      <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Boolean</span><a id="112368">hasNext</a></span> = <span class="typed"><span class="type">=&gt; Boolean</span><a id="2745">!</a></span><span class="typed"><span class="type">=&gt; List[scala.collection.immutable.GBTree[A,B]]</span><a href="#112365">iter</a></span>.<span class="typed"><span class="type">=&gt; Boolean</span><a href="../../Seq.scala.html#17149">isEmpty</a></span>
      <span class="keyword">def</span> <span class="typed"><span class="type">()B</span><a id="112369">next</a></span> = <span class="typed"><span class="type">=&gt; List[scala.collection.immutable.GBTree[A,B]]</span><a href="#112365">iter</a></span> <span class="typed"><span class="type">B</span><span class="keyword">match</span></span> {
        <span class="typed"><span class="type">B</span><span class="keyword">case</span></span> <a id="1">GBNode</a>(_,<span class="typed"><span class="type">B</span><a id="112434">v</a></span>,_,<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112435">t</a></span>)<a id="1">::</a><span class="typed"><span class="type">List[scala.collection.immutable.GBTree[A,B]]</span><a id="112436">iter_tail</a></span> =&gt;
          <span class="typed"><span class="type">(List[scala.collection.immutable.GBTree[A,B]])Unit</span><a href="#112366">iter</a></span> = <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112435">t</a></span>.<span class="typed"><span class="type">(List[t.aNode])List[t.aNode]</span><a href="#112263">mk_iter</a></span>(<span class="typed"><span class="type">List[scala.collection.immutable.GBTree[A,B]]</span><a href="#112436">iter_tail</a></span>)
          <span class="typed"><span class="type">B</span><a href="#112434">v</a></span>
        <span class="typed"><span class="type">Nothing</span><span class="keyword">case</span></span> scala.<span class="typed"><span class="type">object Nil</span><a href="../../List.scala.html#333">Nil</a></span> =&gt;
          <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(java.lang.String)java.util.NoSuchElementException</span><a id="25317" class="keyword">new</a></span> <span class="typed"><span class="type">java.util.NoSuchElementException</span><a href="../../Predef.scala.html#13342">NoSuchElementException</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;next on empty iterator&quot;)</span><span class="string">&quot;next on empty iterator&quot;</span></span>)
      }
    }

  <span class="comment">/** Create a new balanced tree from the tree. Might be useful to call
   *  after many deletions, since deletion does not rebalance the tree.
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; Tree.this.This</span><a id="112246">balance</a></span>: <span class="typed"><span class="type">Tree.this.This</span><a href="#112234">This</a></span> =
    <span class="typed"><span class="type">(Int,Tree.this.aNode)Tree.this.This</span><a href="#112238">New</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#112239">size</a></span>, <span class="typed"><span class="type">=&gt; Tree.this.aNode</span><a href="#112237">tree</a></span>.<span class="typed"><span class="type">(Int)scala.collection.immutable.GBTree[A,B]</span><a href="#112267">balance</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#112239">size</a></span>))
}

<span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class InsertTree[A, B] extends java.lang.Object with ScalaObject</span><span id="9413"><span id="112312"><a id="112442">InsertTree</a></span></span></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="16349">A</a></span> &lt;% Ordered[A],<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="16350">B</a></span>]() <span class="keyword">extends</span> <span class="typed"><span class="type">java.lang.Object</span><a id="2163">AnyRef</a></span> {
  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B])scala.collection.immutable.InsertTree[A,B]</span><a id="112314">insertLeft</a></span>(<span class="typed"><span class="type">A</span><a id="112443">k</a></span>: <span class="typed"><span class="type">A</span><a href="#16349">A</a></span>, <span class="typed"><span class="type">B</span><a id="112444">v</a></span>: <span class="typed"><span class="type">B</span><a href="#16350">B</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112445">t</a></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]): <span class="typed"><span class="type">scala.collection.immutable.InsertTree[A,B]</span><a href="#9413">InsertTree</a></span>[A,B]
  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B])scala.collection.immutable.InsertTree[A,B]</span><a id="112315">insertRight</a></span>(<span class="typed"><span class="type">A</span><a id="112446">k</a></span>: <span class="typed"><span class="type">A</span><a href="#16349">A</a></span>, <span class="typed"><span class="type">B</span><a id="112447">v</a></span>: <span class="typed"><span class="type">B</span><a href="#16350">B</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112448">t</a></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]): <span class="typed"><span class="type">scala.collection.immutable.InsertTree[A,B]</span><a href="#9413">InsertTree</a></span>[A,B]
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a id="112316">node</a></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]
}

<span class="comment">/**
 *  &lt;code&gt;ITree&lt;/code&gt; is an internal class used by
 *  &lt;a href=&quot;Tree.html&quot; target=&quot;contentFrame&quot;&gt;&lt;code&gt;Tree&lt;/code&gt;&lt;/a&gt;.
 */</span>
<span class="keyword">private</span> <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class ITree[A, B] extends scala.collection.immutable.InsertTree[A,B] with ScalaObject with Product</span><span id="112525"><span id="112453"><span id="112517"><span id="112526"><span id="2749"><span id="2748"><span id="9609"><span id="9608"><span id="112515"><span id="112522"><span id="112476"><span id="5792"><span id="19891"><span id="112516"><span id="3507"><span id="112471"><span id="112462"><span id="112527"><span id="112482"><span id="3499"><span id="112519"><span id="112524"><span id="112518"><a href="../../runtime/ScalaRunTime.scala.html#19785" id="3498">ITree</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><span id="16351"><span id="112479"><a id="112474">A</a></span></span></span> &lt;% Ordered[A],<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><span id="16352"><span id="112480"><a id="112475">B</a></span></span></span>](<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><span id="112452"><span id="112451"><span id="112461"><a id="112481">t</a></span></span></span></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B])
             <span class="keyword">extends</span> <span class="typed"><span class="type">scala.collection.immutable.InsertTree[A,B]</span><a href="#9413">InsertTree</a></span>[A,B] {
  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B])scala.collection.immutable.ITree[A,B]</span><a id="112455">insertLeft</a></span>(<span class="typed"><span class="type">A</span><a id="112466">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16351">A</a></span>, <span class="typed"><span class="type">B</span><a id="112467">value</a></span>: <span class="typed"><span class="type">B</span><a href="#16352">B</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112468">bigger</a></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]) =
    <span class="typed"><span class="type">(scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.ITree[A,B]</span><a href="#112471">ITree</a></span>(<span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">A</span><a href="#112466">key</a></span>, <span class="typed"><span class="type">B</span><a href="#112467">value</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112451">t</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112468">bigger</a></span>))
  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B])scala.collection.immutable.ITree[A,B]</span><a id="112456">insertRight</a></span>(<span class="typed"><span class="type">A</span><a id="112499">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16351">A</a></span>, <span class="typed"><span class="type">B</span><a id="112500">value</a></span>: <span class="typed"><span class="type">B</span><a href="#16352">B</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112501">smaller</a></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]) =
    <span class="typed"><span class="type">(scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.ITree[A,B]</span><a href="#112471">ITree</a></span>(<span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">A</span><a href="#112499">key</a></span>, <span class="typed"><span class="type">B</span><a href="#112500">value</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112501">smaller</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112451">t</a></span>))
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a id="112457">node</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112451">t</a></span>
}

<span class="comment">/**
 *  &lt;code&gt;INode&lt;/code&gt; is an internal class used by
 *  &lt;a href=&quot;Tree.html&quot; target=&quot;contentFrame&quot;&gt;&lt;code&gt;Tree&lt;/code&gt;&lt;/a&gt;.
 */</span>
<span class="keyword">private</span> <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class INode[A, B] extends scala.collection.immutable.InsertTree[A,B] with ScalaObject with Product</span><span id="112539"><span id="112631"><span id="112622"><span id="112639"><span id="112553"><span id="2748"><span id="2749"><span id="5792"><span id="112640"><span id="9621"><span id="19891"><span id="112600"><span id="3139"><span id="3507"><span id="112613"><span id="112632"><span id="112638"><span id="112621"><span id="112625"><span id="9620"><span id="112624"><span id="3499"><span id="112605"><span id="112637"><span id="112633"><span id="3498"><a href="../../runtime/ScalaRunTime.scala.html#19785" id="112623">INode</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><span id="16353"><span id="112608"><a id="112603">A</a></span></span></span> &lt;% Ordered[A],<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><span id="16354"><span id="112609"><a id="112604">B</a></span></span></span>](<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><span id="112534"><span id="112533"><span id="112550"><a id="112610">t1</a></span></span></span></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B],
                                            <span class="typed"><span class="type">Int</span><span id="112536"><span id="112535"><span id="112551"><a id="112611">height</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>,
                                            <span class="typed"><span class="type">Int</span><span id="112538"><span id="112537"><span id="112552"><a id="112612">size</a></span></span></span></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>)
             <span class="keyword">extends</span> <span class="typed"><span class="type">scala.collection.immutable.InsertTree[A,B]</span><a href="#9413">InsertTree</a></span>[A,B] {
  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B])scala.collection.immutable.InsertTree[A,B]</span><a id="112541">insertLeft</a></span>(<span class="typed"><span class="type">A</span><a id="112557">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16353">A</a></span>, <span class="typed"><span class="type">B</span><a id="112558">value</a></span>: <span class="typed"><span class="type">B</span><a href="#16354">B</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112559">bigger</a></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]) =
    <span class="typed"><span class="type">(scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])scala.collection.immutable.InsertTree[A,B]</span><a href="#112543">balance_p</a></span>(<span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">A</span><a href="#112557">key</a></span>, <span class="typed"><span class="type">B</span><a href="#112558">value</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112533">t1</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112559">bigger</a></span>), <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112559">bigger</a></span>);
  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B])scala.collection.immutable.InsertTree[A,B]</span><a id="112542">insertRight</a></span>(<span class="typed"><span class="type">A</span><a id="112568">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16353">A</a></span>, <span class="typed"><span class="type">B</span><a id="112569">value</a></span>: <span class="typed"><span class="type">B</span><a href="#16354">B</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112570">smaller</a></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]) =
    <span class="typed"><span class="type">(scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])scala.collection.immutable.InsertTree[A,B]</span><a href="#112543">balance_p</a></span>(<span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">A</span><a href="#112568">key</a></span>, <span class="typed"><span class="type">B</span><a href="#112569">value</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112570">smaller</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112533">t1</a></span>),<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112570">smaller</a></span>);
  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])scala.collection.immutable.InsertTree[A,B]</span><a id="112543">balance_p</a></span>(<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112561">t</a></span>:<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B],<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112562">subtree</a></span>:<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]):<span class="typed"><span class="type">scala.collection.immutable.InsertTree[A,B]</span><a href="#9413">InsertTree</a></span>[A,B] = {
    <span class="keyword">val</span> <span class="typed"><span class="type">(Int, Int)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">Int</span><span id="112584"><a href="../../Tuple2.scala.html#19161" id="112578">subHeight</a></span></span>, <span class="typed"><span class="type">Int</span><span id="112585"><a href="../../Tuple2.scala.html#19163" id="112579">subSize</a></span></span>) = <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112562">subtree</a></span>.<span class="typed"><span class="type">=&gt; (Int, Int)</span><a href="#112256">count</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="112580">totalHeight</a></span> = <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">*</a></span> <span class="typed"><span class="type">object Math</span><a href="../../Math.scala.html#606">Math</a></span>.<span class="typed"><span class="type">(Int,Int)Int</span><a href="../../Math.scala.html#25146">max</a></span>(<span class="typed"><span class="type">=&gt; Int</span><a href="#112535">height</a></span>, <span class="typed"><span class="type">Int</span><a href="#112578">subHeight</a></span>)
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="112581">totalSize</a></span> = <span class="typed"><span class="type">=&gt; Int</span><a href="#112537">size</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int</span><a href="#112579">subSize</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="112582">BalanceHeight</a></span> = <span class="typed"><span class="type">Int</span><a href="#112581">totalSize</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">*</a></span> <span class="typed"><span class="type">Int</span><a href="#112581">totalSize</a></span>
    <span class="typed"><span class="type">scala.collection.immutable.InsertTree[A,B]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#112580">totalHeight</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int</span><a href="#112582">BalanceHeight</a></span>) <span class="typed"><span class="type">(scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.ITree[A,B]</span><a href="#112471">ITree</a></span>(<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112561">t</a></span>.<span class="typed"><span class="type">(Int)scala.collection.immutable.GBTree[A,B]</span><a href="#112267">balance</a></span>(<span class="typed"><span class="type">Int</span><a href="#112581">totalSize</a></span>))
    <span class="keyword">else</span> <span class="typed"><span class="type">(scala.collection.immutable.GBTree[A,B],Int,Int)(implicit (A) =&gt; Ordered[A])scala.collection.immutable.INode[A,B]</span><a href="#112600">INode</a></span>(<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112561">t</a></span>, <span class="typed"><span class="type">Int</span><a href="#112580">totalHeight</a></span>, <span class="typed"><span class="type">Int</span><a href="#112581">totalSize</a></span>)
  }
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a id="112544">node</a></span> = <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112533">t1</a></span>
}

<span class="comment">/**
 *  &lt;code&gt;GBTree&lt;/code&gt; is an internal class used by
 *  &lt;a href=&quot;Tree.html&quot; target=&quot;contentFrame&quot;&gt;&lt;code&gt;Tree&lt;/code&gt;&lt;/a&gt;.
 *
 *  @author  Erik Stenman
 *  @version 1.0, 2005-01-20
 */</span>
@<span class="typed"><span class="type">serializable</span><a href="../../serializable.scala.html#647">serializable</a></span>
<span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="typed"><span class="type">class GBTree[A, B] extends java.lang.Object with ScalaObject</span><span id="9287"><span id="112252"><a id="112644">GBTree</a></span></span></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="16355">A</a></span> &lt;% Ordered[A],<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><a id="16356">B</a></span>] <span class="keyword">extends</span> <span class="typed"><span class="type">java.lang.Object</span><a id="2163">AnyRef</a></span> {
  <span class="keyword">type</span> <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112254">aNode</a></span> = <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]
  <span class="keyword">type</span> <span class="typed"><span class="type">scala.collection.immutable.InsertTree[A,B]</span><a id="112255">anInsertTree</a></span> = <span class="typed"><span class="type">scala.collection.immutable.InsertTree[A,B]</span><a href="#9413">InsertTree</a></span>[A,B]

  <span class="comment">/** Calculates 2^h, and size, where h is the height of the tree
  *   and size is the number of nodes in the tree.
  */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; (Int, Int)</span><a id="112256">count</a></span>: <span class="typed"><span class="type">(Int, Int)</span><a href="../../Tuple2.scala.html#1376">(</a></span>Int,Int)
  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Boolean</span><a id="112257">isDefinedAt</a></span>(<span class="typed"><span class="type">A</span><a id="112336">Key</a></span>: <span class="typed"><span class="type">A</span><a href="#16355">A</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Option[B]</span><a id="112258">get</a></span>(<span class="typed"><span class="type">A</span><a id="112361">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16355">A</a></span>): <span class="typed"><span class="type">Option[B]</span><a href="../../Option.scala.html#932">Option</a></span>[B]
  <span class="keyword">def</span> <span class="typed"><span class="type">(A)B</span><a id="112259">apply</a></span>(<span class="typed"><span class="type">A</span><a id="112645">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16355">A</a></span>): <span class="typed"><span class="type">B</span><a href="#16356">B</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B)GBTree.this.aNode</span><a id="112260">update</a></span>(<span class="typed"><span class="type">A</span><a id="112337">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16355">A</a></span>, <span class="typed"><span class="type">B</span><a id="112338">value</a></span>: <span class="typed"><span class="type">B</span><a href="#16356">B</a></span>): <span class="typed"><span class="type">GBTree.this.aNode</span><a href="#9287">aNode</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B,Int)GBTree.this.anInsertTree</span><a id="112261">insert</a></span>(<span class="typed"><span class="type">A</span><a id="112308">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16355">A</a></span>, <span class="typed"><span class="type">B</span><a id="112309">value</a></span>: <span class="typed"><span class="type">B</span><a href="#16356">B</a></span>, <span class="typed"><span class="type">Int</span><a id="112310">size</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>): <span class="typed"><span class="type">GBTree.this.anInsertTree</span><a href="#9413">anInsertTree</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(List[(A, B)])List[(A, B)]</span><a id="112262">toList</a></span>(<span class="typed"><span class="type">List[(A, B)]</span><a id="112646">acc</a></span>: <span class="typed"><span class="type">List[(A, B)]</span><a href="../../List.scala.html#524">List</a></span>[(A,B)]): <span class="typed"><span class="type">List[(A, B)]</span><a href="../../List.scala.html#524">List</a></span>[(A,B)]
  <span class="keyword">def</span> <span class="typed"><span class="type">(List[GBTree.this.aNode])List[GBTree.this.aNode]</span><a id="112263">mk_iter</a></span>(<span class="typed"><span class="type">List[GBTree.this.aNode]</span><a id="112372">iter_tail</a></span>: <span class="typed"><span class="type">List[GBTree.this.aNode]</span><a href="../../List.scala.html#524">List</a></span>[aNode]): <span class="typed"><span class="type">List[GBTree.this.aNode]</span><a href="../../List.scala.html#524">List</a></span>[aNode]
  <span class="keyword">def</span> <span class="typed"><span class="type">(A)GBTree.this.aNode</span><a id="112264">delete</a></span>(<span class="typed"><span class="type">A</span><a id="112357">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16355">A</a></span>): <span class="typed"><span class="type">GBTree.this.aNode</span><a href="#9287">aNode</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(GBTree.this.aNode)GBTree.this.aNode</span><a id="112265">merge</a></span>(<span class="typed"><span class="type">GBTree.this.aNode</span><a id="112647">t</a></span>: <span class="typed"><span class="type">GBTree.this.aNode</span><a href="#9287">aNode</a></span>): <span class="typed"><span class="type">GBTree.this.aNode</span><a href="#9287">aNode</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; (A, B, GBTree.this.aNode)</span><a id="112266">takeSmallest</a></span>: <span class="typed"><span class="type">(A, B, GBTree.this.aNode)</span><a href="../../Tuple3.scala.html#446">(</a></span>A,B,aNode)
  <span class="keyword">def</span> <span class="typed"><span class="type">(Int)scala.collection.immutable.GBTree[A,B]</span><a id="112267">balance</a></span>(<span class="typed"><span class="type">Int</span><a id="112439">s</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>): <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]
}

<span class="keyword">private</span> <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class GBLeaf[A, B] extends scala.collection.immutable.GBTree[A,B] with ScalaObject with Product</span><span id="112710"><span id="112270"><span id="2749"><span id="112296"><span id="2748"><span id="112712"><span id="112709"><span id="5792"><span id="19891"><span id="9198"><span id="112715"><span id="112651"><span id="112707"><span id="9197"><span id="112708"><span id="112714"><span id="112291"><span id="3499"><span id="112713"><span id="112276"><a href="../../runtime/ScalaRunTime.scala.html#19784" id="3498">GBLeaf</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><span id="16357"><span id="112294"><a id="112273">A</a></span></span></span> &lt;% Ordered[A],<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><span id="16358"><span id="112295"><a id="112274">B</a></span></span></span>]() <span class="keyword">extends</span> <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B] {
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; (Int, Int)</span><a id="112278">count</a></span> = <span class="typed"><span class="type">(Int,Int)(Int, Int)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>, <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Boolean</span><a id="112279">isDefinedAt</a></span>(<span class="typed"><span class="type">A</span><a id="112659">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16357">A</a></span>) = <span class="typed"><span class="type">Boolean(false)</span><span class="keyword">false</span></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(A)object None</span><a id="112280">get</a></span>(<span class="typed"><span class="type">A</span><a id="112661">_key</a></span>: <span class="typed"><span class="type">A</span><a href="#16357">A</a></span>) = <span class="typed"><span class="type">object None</span><a href="../../Option.scala.html#534">None</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Nothing</span><a id="112281">apply</a></span>(<span class="typed"><span class="type">A</span><a id="112663">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16357">A</a></span>) = <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(java.lang.String)java.util.NoSuchElementException</span><a id="25317" class="keyword">new</a></span> <span class="typed"><span class="type">java.util.NoSuchElementException</span><a href="../../Predef.scala.html#13342">NoSuchElementException</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;key &quot;)</span><span class="string">&quot;key &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">A</span><a href="#112663">key</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; not found&quot;)</span><span class="string">&quot; not found&quot;</span></span>)
  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B)Nothing</span><a id="112282">update</a></span>(<span class="typed"><span class="type">A</span><a id="112666">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16357">A</a></span>, <span class="typed"><span class="type">B</span><a id="112667">value</a></span>: <span class="typed"><span class="type">B</span><a href="#16358">B</a></span>) = <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(java.lang.String)java.util.NoSuchElementException</span><a id="25317" class="keyword">new</a></span> <span class="typed"><span class="type">java.util.NoSuchElementException</span><a href="../../Predef.scala.html#13342">NoSuchElementException</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;key &quot;)</span><span class="string">&quot;key &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">A</span><a href="#112666">key</a></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">java.lang.String(&quot; not found&quot;)</span><span class="string">&quot; not found&quot;</span></span>)
  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B,Int)GBLeaf.this.anInsertTree</span><a id="112283">insert</a></span>(<span class="typed"><span class="type">A</span><a id="112670">key</a></span>: <span class="typed"><span class="type">A</span><a href="#16357">A</a></span>, <span class="typed"><span class="type">B</span><a id="112671">value</a></span>: <span class="typed"><span class="type">B</span><a href="#16358">B</a></span>, <span class="typed"><span class="type">Int</span><a id="112672">s</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>): <span class="typed"><span class="type">GBLeaf.this.anInsertTree</span><a href="#9413">anInsertTree</a></span> = {
    <span class="typed"><span class="type">GBLeaf.this.anInsertTree</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#112672">s</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>)
      <span class="typed"><span class="type">(scala.collection.immutable.GBTree[A,B],Int,Int)(implicit (A) =&gt; Ordered[A])scala.collection.immutable.INode[A,B]</span><a href="#112600">INode</a></span>(<span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">A</span><a href="#112670">key</a></span>, <span class="typed"><span class="type">B</span><a href="#112671">value</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBLeaf[A,B]</span><a href="#9197" class="keyword">this</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBLeaf[A,B]</span><a href="#9197" class="keyword">this</a></span>), <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>, <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
    <span class="keyword">else</span>
      <span class="typed"><span class="type">(scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.ITree[A,B]</span><a href="#112471">ITree</a></span>(<span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">A</span><a href="#112670">key</a></span>, <span class="typed"><span class="type">B</span><a href="#112671">value</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBLeaf[A,B]</span><a href="#9197" class="keyword">this</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBLeaf[A,B]</span><a href="#9197" class="keyword">this</a></span>))
  }
  <span class="keyword">def</span> <span class="typed"><span class="type">(List[(A, B)])List[(A, B)]</span><a id="112284">toList</a></span>(<span class="typed"><span class="type">List[(A, B)]</span><a id="112694">acc</a></span>: <span class="typed"><span class="type">List[(A, B)]</span><a href="../../List.scala.html#524">List</a></span>[(A,B)]): <span class="typed"><span class="type">List[(A, B)]</span><a href="../../List.scala.html#524">List</a></span>[(A,B)] = <span class="typed"><span class="type">List[(A, B)]</span><a href="#112694">acc</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(List[scala.collection.immutable.GBTree[A,B]])List[scala.collection.immutable.GBTree[A,B]]</span><a id="112285">mk_iter</a></span>(<span class="typed"><span class="type">List[scala.collection.immutable.GBTree[A,B]]</span><a id="112695">iter_tail</a></span>: <span class="typed"><span class="type">List[scala.collection.immutable.GBTree[A,B]]</span><a href="../../List.scala.html#524">List</a></span>[GBTree[A,B]]) = <span class="typed"><span class="type">List[scala.collection.immutable.GBTree[A,B]]</span><a href="#112695">iter_tail</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(scala.collection.immutable.GBTree[A,B])scala.collection.immutable.GBTree[A,B]</span><a id="112286">merge</a></span>(<span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a id="112697">larger</a></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B]) = <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#112697">larger</a></span>
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; (A, B, scala.collection.immutable.GBTree[A,B])</span><a id="112287">takeSmallest</a></span>: <span class="typed"><span class="type">(A, B, scala.collection.immutable.GBTree[A,B])</span><a href="../../Tuple3.scala.html#446">(</a></span>A,B, GBTree[A,B]) =
    <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(java.lang.String)java.util.NoSuchElementException</span><a id="25317" class="keyword">new</a></span> <span class="typed"><span class="type">java.util.NoSuchElementException</span><a href="../../Predef.scala.html#13342">NoSuchElementException</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;takeSmallest on empty tree&quot;)</span><span class="string">&quot;takeSmallest on empty tree&quot;</span></span>)
  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Nothing</span><a id="112288">delete</a></span>(<span class="typed"><span class="type">A</span><a id="112701">_key</a></span>: <span class="typed"><span class="type">A</span><a href="#16357">A</a></span>) = <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(java.lang.String)java.util.NoSuchElementException</span><a id="25317" class="keyword">new</a></span> <span class="typed"><span class="type">java.util.NoSuchElementException</span><a href="../../Predef.scala.html#13342">NoSuchElementException</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Delete on empty tree.&quot;)</span><span class="string">&quot;Delete on empty tree.&quot;</span></span>)
  <span class="keyword">def</span> <span class="typed"><span class="type">(Int)scala.collection.immutable.GBLeaf[A,B]</span><a id="112289">balance</a></span>(<span class="typed"><span class="type">Int</span><a id="112704">s</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>) = <span class="typed"><span class="type">scala.collection.immutable.GBLeaf[A,B]</span><a href="#9197" class="keyword">this</a></span>
  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Int</span><a id="112290">hashCode</a></span>() = <span class="typed"><span class="type">Int(0)</span><span class="int">0</span></span>
}

<span class="keyword">private</span> <span class="keyword">case</span> <span class="keyword">class</span> <span class="typed"><span class="type">class GBNode[A, B] extends scala.collection.immutable.GBTree[A,B] with ScalaObject with Product</span><span id="113013"><span id="2748"><span id="113015"><span id="112489"><span id="113016"><span id="2749"><span id="113021"><span id="113022"><span id="5792"><span id="113014"><span id="112422"><span id="3494"><span id="19891"><span id="113012"><span id="113020"><span id="3507"><span id="113011"><span id="9200"><span id="9201"><span id="112383"><span id="113010"><span id="112433"><span id="3499"><span id="112401"><span id="112417"><span id="3498"><a href="../../runtime/ScalaRunTime.scala.html#19784" id="113019">GBNode</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>[<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><span id="16359"><span id="112420"><a id="112386">A</a></span></span></span> &lt;% Ordered[A],<span class="typed"><span class="type">&gt;: Nothing &lt;: Any</span><span id="16360"><span id="112421"><a id="112387">B</a></span></span></span>](<span class="typed"><span class="type">A</span><span id="112394"><span id="112393"><span id="112429"><a id="112485">key</a></span></span></span></span>: <span class="typed"><span class="type">A</span><a href="#16359">A</a></span>,
                                             <span class="typed"><span class="type">B</span><span id="112396"><span id="112395"><span id="112430"><a id="112486">value</a></span></span></span></span>: <span class="typed"><span class="type">B</span><a href="#16360">B</a></span>,
                                             <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><span id="112398"><span id="112397"><span id="112431"><a id="112487">smaller</a></span></span></span></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B],
                                             <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><span id="112400"><span id="112399"><span id="112432"><a id="112488">bigger</a></span></span></span></span>: <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B])
             <span class="keyword">extends</span> <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B] {
  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; (Int, Int)</span><a id="112403">count</a></span>: <span class="typed"><span class="type">(Int, Int)</span><a href="../../Tuple2.scala.html#1376">(</a></span>Int,Int) = {
    <span class="keyword">val</span> <span class="typed"><span class="type">(Int, Int)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">Int</span><span id="112734"><a href="../../Tuple2.scala.html#19161" id="112728">sHeight</a></span></span>, <span class="typed"><span class="type">Int</span><span id="112735"><a href="../../Tuple2.scala.html#19163" id="112729">sSize</a></span></span>) = <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">=&gt; (Int, Int)</span><a href="#112256">count</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">(Int, Int)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">Int</span><span id="112738"><a href="../../Tuple2.scala.html#19161" id="112731">bHeight</a></span></span>, <span class="typed"><span class="type">Int</span><span id="112739"><a href="../../Tuple2.scala.html#19163" id="112732">bSize</a></span></span>) = <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>.<span class="typed"><span class="type">=&gt; (Int, Int)</span><a href="#112256">count</a></span>
    <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="112733">mySize</a></span> = <span class="typed"><span class="type">Int</span><a href="#112729">sSize</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int</span><a href="#112732">bSize</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
    <span class="typed"><span class="type">(Int, Int)</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#112733">mySize</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>)
      <span class="typed"><span class="type">(Int,Int)(Int, Int)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>, <span class="typed"><span class="type">Int</span><a href="#112733">mySize</a></span>)
    <span class="keyword">else</span>
      <span class="typed"><span class="type">(Int,Int)(Int, Int)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span> <span class="typed"><span class="type">(Int)Int</span><a id="3147">*</a></span> <span class="typed"><span class="type">object Math</span><a href="../../Math.scala.html#606">Math</a></span>.<span class="typed"><span class="type">(Int,Int)Int</span><a href="../../Math.scala.html#25146">max</a></span>(<span class="typed"><span class="type">Int</span><a href="#112728">sHeight</a></span>, <span class="typed"><span class="type">Int</span><a href="#112731">bHeight</a></span>), <span class="typed"><span class="type">Int</span><a href="#112733">mySize</a></span>)
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Boolean</span><a id="112404">isDefinedAt</a></span>(<span class="typed"><span class="type">A</span><a id="112764">sKey</a></span>: <span class="typed"><span class="type">A</span><a href="#16359">A</a></span>): <span class="typed"><span class="type">Boolean</span><a id="2168">Boolean</a></span> =
    <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">sKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18904">&lt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>) <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">(A)Boolean</span><a href="#112257">isDefinedAt</a></span>(<span class="typed"><span class="type">A</span><a href="#112764">sKey</a></span>)
    <span class="keyword">else</span> <span class="typed"><span class="type">Boolean</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">sKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18905">&gt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>) <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>.<span class="typed"><span class="type">(A)Boolean</span><a href="#112257">isDefinedAt</a></span>(<span class="typed"><span class="type">A</span><a href="#112764">sKey</a></span>)
    <span class="keyword">else</span> <span class="typed"><span class="type">Boolean(true)</span><span class="keyword">true</span></span>

  <span class="keyword">def</span> <span class="typed"><span class="type">(A)Option[B]</span><a id="112405">get</a></span>(<span class="typed"><span class="type">A</span><a id="112773">sKey</a></span>: <span class="typed"><span class="type">A</span><a href="#16359">A</a></span>): <span class="typed"><span class="type">Option[B]</span><a href="../../Option.scala.html#932">Option</a></span>[B] =
    <span class="typed"><span class="type">Option[B]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">sKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18904">&lt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>) <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">(A)Option[B]</span><a href="#112258">get</a></span>(<span class="typed"><span class="type">A</span><a href="#112773">sKey</a></span>)
    <span class="keyword">else</span> <span class="typed"><span class="type">Option[B]</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">sKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18905">&gt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>) <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>.<span class="typed"><span class="type">(A)Option[B]</span><a href="#112258">get</a></span>(<span class="typed"><span class="type">A</span><a href="#112773">sKey</a></span>)
    <span class="keyword">else</span> <span class="typed"><span class="type">(B)Some[B]</span><a href="../../Option.scala.html#19455">Some</a></span>(<span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>)

  <span class="keyword">def</span> <span class="typed"><span class="type">(A)B</span><a id="112406">apply</a></span>(<span class="typed"><span class="type">A</span><a id="112783">sKey</a></span>: <span class="typed"><span class="type">A</span><a href="#16359">A</a></span>): <span class="typed"><span class="type">B</span><a href="#16360">B</a></span> =
    <span class="typed"><span class="type">B</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">sKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18904">&lt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>) <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">(A)B</span><a href="#112259">apply</a></span>(<span class="typed"><span class="type">A</span><a href="#112783">sKey</a></span>)
    <span class="keyword">else</span> <span class="typed"><span class="type">B</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">sKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18905">&gt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>) <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>.<span class="typed"><span class="type">(A)B</span><a href="#112259">apply</a></span>(<span class="typed"><span class="type">A</span><a href="#112783">sKey</a></span>)
    <span class="keyword">else</span> <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>

  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B)GBNode.this.aNode</span><a id="112407">update</a></span>(<span class="typed"><span class="type">A</span><a id="112792">newKey</a></span>: <span class="typed"><span class="type">A</span><a href="#16359">A</a></span>, <span class="typed"><span class="type">B</span><a id="112793">newValue</a></span>: <span class="typed"><span class="type">B</span><a href="#16360">B</a></span>): <span class="typed"><span class="type">GBNode.this.aNode</span><a href="#9287">aNode</a></span> =
    <span class="typed"><span class="type">GBNode.this.aNode</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">newKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18904">&lt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>)
      <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>, <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">(A,B)GBNode.this.smaller.aNode</span><a href="#112260">update</a></span>(<span class="typed"><span class="type">A</span><a href="#112792">newKey</a></span>,<span class="typed"><span class="type">B</span><a href="#112793">newValue</a></span>), <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>)
    <span class="keyword">else</span> <span class="typed"><span class="type">GBNode.this.aNode</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">newKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18905">&gt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>)
      <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>, <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>.<span class="typed"><span class="type">(A,B)GBNode.this.bigger.aNode</span><a href="#112260">update</a></span>(<span class="typed"><span class="type">A</span><a href="#112792">newKey</a></span>,<span class="typed"><span class="type">B</span><a href="#112793">newValue</a></span>))
    <span class="keyword">else</span>
      <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">A</span><a href="#112792">newKey</a></span>, <span class="typed"><span class="type">B</span><a href="#112793">newValue</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>)

  <span class="keyword">def</span> <span class="typed"><span class="type">(A,B,Int)GBNode.this.anInsertTree</span><a id="112408">insert</a></span>(<span class="typed"><span class="type">A</span><a id="112817">newKey</a></span>: <span class="typed"><span class="type">A</span><a href="#16359">A</a></span>, <span class="typed"><span class="type">B</span><a id="112818">newValue</a></span>: <span class="typed"><span class="type">B</span><a href="#16360">B</a></span>, <span class="typed"><span class="type">Int</span><a id="112819">s</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>): <span class="typed"><span class="type">GBNode.this.anInsertTree</span><a href="#9413">anInsertTree</a></span> = {
    <span class="typed"><span class="type">GBNode.this.anInsertTree</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">newKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18904">&lt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>)
      <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">(A,B,Int)GBNode.this.smaller.anInsertTree</span><a href="#112261">insert</a></span>(<span class="typed"><span class="type">A</span><a href="#112817">newKey</a></span>, <span class="typed"><span class="type">B</span><a href="#112818">newValue</a></span>, <span class="typed"><span class="type">Int</span><a href="#112819">s</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">/</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>).<span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B])scala.collection.immutable.InsertTree[A,B]</span><a href="#112314">insertLeft</a></span>(<span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>, <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>)
    <span class="keyword">else</span> <span class="typed"><span class="type">GBNode.this.anInsertTree</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">newKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18905">&gt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>)
      <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>.<span class="typed"><span class="type">(A,B,Int)GBNode.this.bigger.anInsertTree</span><a href="#112261">insert</a></span>(<span class="typed"><span class="type">A</span><a href="#112817">newKey</a></span>, <span class="typed"><span class="type">B</span><a href="#112818">newValue</a></span>, <span class="typed"><span class="type">Int</span><a href="#112819">s</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">/</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>).<span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B])scala.collection.immutable.InsertTree[A,B]</span><a href="#112315">insertRight</a></span>(<span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>, <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>)
    <span class="keyword">else</span>
      <span class="typed"><span class="type">Nothing</span><span class="keyword">throw</span></span> <span class="typed"><span class="type">(java.lang.String)java.util.NoSuchElementException</span><a id="25317" class="keyword">new</a></span> <span class="typed"><span class="type">java.util.NoSuchElementException</span><a href="../../Predef.scala.html#13342">NoSuchElementException</a></span>(<span class="typed"><span class="type">java.lang.String(&quot;Key exists: &quot;)</span><span class="string">&quot;Key exists: &quot;</span></span> <span class="typed"><span class="type">(Any)java.lang.String</span><a id="5800">+</a></span> <span class="typed"><span class="type">A</span><a href="#112817">newKey</a></span>)
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(List[(A, B)])List[(A, B)]</span><a id="112409">toList</a></span>(<span class="typed"><span class="type">List[(A, B)]</span><a id="112857">acc</a></span>: <span class="typed"><span class="type">List[(A, B)]</span><a href="../../List.scala.html#524">List</a></span>[(A,B)]): <span class="typed"><span class="type">List[(A, B)]</span><a href="../../List.scala.html#524">List</a></span>[(A,B)] =
    <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">(List[(A, B)])List[(A, B)]</span><a href="#112262">toList</a></span>(<span class="typed"><span class="type">(A,B)(A, B)</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>, <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>) <span class="typed"><span class="type">((A, B))List[(A, B)]</span><a href="../../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>.<span class="typed"><span class="type">(List[(A, B)])List[(A, B)]</span><a href="#112262">toList</a></span>(<span class="typed"><span class="type">List[(A, B)]</span><a href="#112857">acc</a></span>))

  <span class="keyword">def</span> <span class="typed"><span class="type">(List[GBNode.this.aNode])List[GBNode.this.aNode]</span><a id="112410">mk_iter</a></span>(<span class="typed"><span class="type">List[GBNode.this.aNode]</span><a id="112863">iter_tail</a></span>:<span class="typed"><span class="type">List[GBNode.this.aNode]</span><a href="../../List.scala.html#524">List</a></span>[aNode]):<span class="typed"><span class="type">List[GBNode.this.aNode]</span><a href="../../List.scala.html#524">List</a></span>[aNode] =
    <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">(List[GBNode.this.smaller.aNode])List[GBNode.this.smaller.aNode]</span><a href="#112263">mk_iter</a></span>(<span class="typed"><span class="type">scala.collection.immutable.GBNode[A,B]</span><a href="#9200" class="keyword">this</a></span> <span class="typed"><span class="type">(GBNode.this.aNode)List[GBNode.this.aNode]</span><a href="../../List.scala.html#20872">::</a></span> <span class="typed"><span class="type">List[GBNode.this.aNode]</span><a href="#112863">iter_tail</a></span>)

  <span class="keyword">def</span> <span class="typed"><span class="type">(A)GBNode.this.aNode</span><a id="112411">delete</a></span>(<span class="typed"><span class="type">A</span><a id="112867">sKey</a></span>:<span class="typed"><span class="type">A</span><a href="#16359">A</a></span>):<span class="typed"><span class="type">GBNode.this.aNode</span><a href="#9287">aNode</a></span> = {
    <span class="typed"><span class="type">GBNode.this.aNode</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">sKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18904">&lt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>)
      <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>, <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">(A)GBNode.this.smaller.aNode</span><a href="#112264">delete</a></span>(<span class="typed"><span class="type">A</span><a href="#112867">sKey</a></span>), <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>)
    <span class="keyword">else</span> <span class="typed"><span class="type">GBNode.this.aNode</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">(A)Ordered[A]</span><a href="../../Function1.scala.html#17300">sKey</a></span> <span class="typed"><span class="type">(A)Boolean</span><a href="../../Ordered.scala.html#18905">&gt;</a></span> <span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>)
      <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>, <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>.<span class="typed"><span class="type">(A)GBNode.this.bigger.aNode</span><a href="#112264">delete</a></span>(<span class="typed"><span class="type">A</span><a href="#112867">sKey</a></span>))
    <span class="keyword">else</span>
      <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">(GBNode.this.smaller.aNode)GBNode.this.smaller.aNode</span><a href="#112265">merge</a></span>(<span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>)
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">(GBNode.this.aNode)scala.collection.immutable.GBTree[A,B]</span><a id="112412">merge</a></span>(<span class="typed"><span class="type">GBNode.this.aNode</span><a id="112886">larger</a></span>: <span class="typed"><span class="type">GBNode.this.aNode</span><a href="#9287">aNode</a></span>): <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B] = <span class="typed"><span class="type">GBNode.this.aNode</span><a href="#112886">larger</a></span> <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><span class="keyword">match</span></span> {
    <span class="typed"><span class="type">scala.collection.immutable.GBNode[A,B]</span><span class="keyword">case</span></span> <a id="1">GBLeaf</a>() =&gt;
      <span class="typed"><span class="type">scala.collection.immutable.GBNode[A,B]</span><a href="#9200" class="keyword">this</a></span>
    <span class="typed"><span class="type">scala.collection.immutable.GBNode[A,B]</span><span class="keyword">case</span></span> _ =&gt;
      <span class="keyword">val</span> <span class="typed"><span class="type">(A, B, larger.aNode)</span><a href="../../Tuple3.scala.html#21271">(</a></span><span class="typed"><span class="type">A</span><span id="112891"><a href="../../Tuple3.scala.html#19143" id="112888">key1</a></span></span>, <span class="typed"><span class="type">B</span><span id="112892"><a href="../../Tuple3.scala.html#19145" id="112889">value1</a></span></span>, <span class="typed"><span class="type">larger.aNode</span><span id="112893"><a href="../../Tuple3.scala.html#19147" id="112890">larger1</a></span></span>) = <span class="typed"><span class="type">GBNode.this.aNode</span><a href="#112886">larger</a></span>.<span class="typed"><span class="type">=&gt; (A, B, larger.aNode)</span><a href="#112266">takeSmallest</a></span>
      <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">A</span><a href="#112888">key1</a></span>, <span class="typed"><span class="type">B</span><a href="#112889">value1</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBNode[A,B]</span><a href="#9200" class="keyword">this</a></span>, <span class="typed"><span class="type">larger.aNode</span><a href="#112890">larger1</a></span>)
  }

  <span class="keyword">def</span> <span class="typed"><span class="type">=&gt; (A, B, GBNode.this.aNode)</span><a id="112413">takeSmallest</a></span>: <span class="typed"><span class="type">(A, B, GBNode.this.aNode)</span><a href="../../Tuple3.scala.html#446">(</a></span>A, B, aNode) = <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span> <span class="typed"><span class="type">(A, B, GBNode.this.aNode)</span><span class="keyword">match</span></span> {
    <span class="typed"><span class="type">(A, B, scala.collection.immutable.GBTree[A,B])</span><span class="keyword">case</span></span> <a id="1">GBLeaf</a>() =&gt;
      <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B])(A, B, scala.collection.immutable.GBTree[A,B])</span><a href="../../Tuple3.scala.html#21271">(</a></span><span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>, <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>)
    <span class="typed"><span class="type">(A, B, scala.collection.immutable.GBNode[A,B])</span><span class="keyword">case</span></span> _ =&gt;
      <span class="keyword">val</span> <span class="typed"><span class="type">(A, B, GBNode.this.smaller.aNode)</span><a href="../../Tuple3.scala.html#21271">(</a></span><span class="typed"><span class="type">A</span><span id="112910"><a href="../../Tuple3.scala.html#19143" id="112907">key1</a></span></span>, <span class="typed"><span class="type">B</span><span id="112911"><a href="../../Tuple3.scala.html#19145" id="112908">value1</a></span></span>, <span class="typed"><span class="type">GBNode.this.smaller.aNode</span><span id="112912"><a href="../../Tuple3.scala.html#19147" id="112909">smaller1</a></span></span>) = <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">=&gt; (A, B, GBNode.this.smaller.aNode)</span><a href="#112266">takeSmallest</a></span>
      <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBNode[A,B])(A, B, scala.collection.immutable.GBNode[A,B])</span><a href="../../Tuple3.scala.html#21271">(</a></span><span class="typed"><span class="type">A</span><a href="#112907">key1</a></span>, <span class="typed"><span class="type">B</span><a href="#112908">value1</a></span>, <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">=&gt; A</span><a href="#112393">key</a></span>, <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>, <span class="typed"><span class="type">GBNode.this.smaller.aNode</span><a href="#112909">smaller1</a></span>, <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>))
  }

  <span class="comment">/**
   *  @param s ...
   *  @return  ...
   */</span>
  <span class="keyword">def</span> <span class="typed"><span class="type">(Int)scala.collection.immutable.GBTree[A,B]</span><a id="112414">balance</a></span>(<span class="typed"><span class="type">Int</span><a id="112924">s</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>): <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B] =
    <span class="typed"><span class="type">(List[(A, B)],Int)scala.collection.immutable.GBTree[A,B]</span><a href="#112415">balance_list</a></span>(<span class="typed"><span class="type">(List[(A, B)])List[(A, B)]</span><a href="#112409">toList</a></span>(scala.<span class="typed"><span class="type">object Nil</span><a href="../../List.scala.html#333">Nil</a></span>), <span class="typed"><span class="type">Int</span><a href="#112924">s</a></span>)

  <span class="keyword">protected</span> <span class="keyword">def</span> <span class="typed"><span class="type">(List[(A, B)],Int)scala.collection.immutable.GBTree[A,B]</span><a id="112415">balance_list</a></span>(<span class="typed"><span class="type">List[(A, B)]</span><a id="112925">list</a></span>: <span class="typed"><span class="type">List[(A, B)]</span><a href="../../List.scala.html#524">List</a></span>[(A,B)], <span class="typed"><span class="type">Int</span><a id="112926">s</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>): <span class="typed"><span class="type">scala.collection.immutable.GBTree[A,B]</span><a href="#9287">GBTree</a></span>[A,B] = {
    <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.immutable.GBLeaf[A,B]</span><a id="112927">empty</a></span> = <span class="typed"><span class="type">()(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBLeaf[A,B]</span><a href="#112270">GBLeaf</a></span>[<span class="typed"><span class="type">A</span><a href="#16359">A</a></span>,<span class="typed"><span class="type">B</span><a href="#16360">B</a></span>]();
    <span class="keyword">def</span> <span class="typed"><span class="type">(List[(A, B)],Int)(GBNode.this.aNode, List[(A, B)])</span><a id="112928">bal</a></span>(<span class="typed"><span class="type">List[(A, B)]</span><a id="112932">list</a></span>: <span class="typed"><span class="type">List[(A, B)]</span><a href="../../List.scala.html#524">List</a></span>[(A,B)], <span class="typed"><span class="type">Int</span><a id="112933">s</a></span>: <span class="typed"><span class="type">Int</span><a id="2392">Int</a></span>): <span class="typed"><span class="type">(GBNode.this.aNode, List[(A, B)])</span><a href="../../Tuple2.scala.html#1376">(</a></span>aNode, List[(A,B)]) = {
      <span class="typed"><span class="type">(GBNode.this.aNode, List[(A, B)])</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#112933">s</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3143">&gt;</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) {
        <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="112935">sm</a></span> = <span class="typed"><span class="type">Int</span><a href="#112933">s</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>
        <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="112936">s2</a></span> = <span class="typed"><span class="type">Int</span><a href="#112935">sm</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3148">/</a></span> <span class="typed"><span class="type">Int(2)</span><span class="int">2</span></span>
        <span class="keyword">val</span> <span class="typed"><span class="type">Int</span><a id="112937">s1</a></span> = <span class="typed"><span class="type">Int</span><a href="#112935">sm</a></span> <span class="typed"><span class="type">(Int)Int</span><a id="3146">-</a></span> <span class="typed"><span class="type">Int</span><a href="#112936">s2</a></span>
        <span class="keyword">val</span> <span class="typed"><span class="type">(GBNode.this.aNode, A, B, List[(A, B)])</span><a href="../../Tuple4.scala.html#21017">(</a></span><span class="typed"><span class="type">GBNode.this.aNode</span><span id="112950"><a href="../../Tuple4.scala.html#19120" id="112939">t1</a></span></span>, <a id="1">(</a><span class="typed"><span class="type">A</span><span id="112951"><a href="../../Tuple4.scala.html#19122" id="112940">k</a></span></span>, <span class="typed"><span class="type">B</span><span id="112952"><a href="../../Tuple4.scala.html#19124" id="112941">v</a></span></span>) <a id="1">::</a> <span class="typed"><span class="type">List[(A, B)]</span><span id="112953"><a href="../../Tuple4.scala.html#19126" id="112942">l1</a></span></span>) = <span class="typed"><span class="type">(List[(A, B)],Int)(GBNode.this.aNode, List[(A, B)])</span><a href="#112928">bal</a></span>(<span class="typed"><span class="type">List[(A, B)]</span><a href="#112932">list</a></span>, <span class="typed"><span class="type">Int</span><a href="#112937">s1</a></span>)
        <span class="keyword">val</span> <span class="typed"><span class="type">(GBNode.this.aNode, List[(A, B)])</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">GBNode.this.aNode</span><span id="112958"><a href="../../Tuple2.scala.html#19161" id="112944">t2</a></span></span>, <span class="typed"><span class="type">List[(A, B)]</span><span id="112959"><a href="../../Tuple2.scala.html#19163" id="112945">l2</a></span></span>) = <span class="typed"><span class="type">(List[(A, B)],Int)(GBNode.this.aNode, List[(A, B)])</span><a href="#112928">bal</a></span>(<span class="typed"><span class="type">List[(A, B)]</span><a href="#112942">l1</a></span>, <span class="typed"><span class="type">Int</span><a href="#112936">s2</a></span>)
        <span class="keyword">val</span> <span class="typed"><span class="type">scala.collection.immutable.GBNode[A,B]</span><a id="112946">t</a></span> = <span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">A</span><a href="#112940">k</a></span>, <span class="typed"><span class="type">B</span><a href="#112941">v</a></span>, <span class="typed"><span class="type">GBNode.this.aNode</span><a href="#112939">t1</a></span>, <span class="typed"><span class="type">GBNode.this.aNode</span><a href="#112944">t2</a></span>)
        <span class="typed"><span class="type">(scala.collection.immutable.GBNode[A,B],List[(A, B)])(scala.collection.immutable.GBNode[A,B], List[(A, B)])</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">scala.collection.immutable.GBNode[A,B]</span><a href="#112946">t</a></span>, <span class="typed"><span class="type">List[(A, B)]</span><a href="#112945">l2</a></span>)
      } <span class="keyword">else</span> <span class="typed"><span class="type">(GBNode.this.aNode, List[(A, B)])</span><span class="keyword">if</span></span> (<span class="typed"><span class="type">Int</span><a href="#112933">s</a></span> <span class="typed"><span class="type">(Int)Boolean</span><a id="3139">==</a></span> <span class="typed"><span class="type">Int(1)</span><span class="int">1</span></span>) {
        <span class="keyword">val</span> <a id="1">(</a><span class="typed"><span class="type">A</span><span id="112974"><a href="../../Tuple3.scala.html#19143" id="112971">k</a></span></span>,<span class="typed"><span class="type">B</span><span id="112975"><a href="../../Tuple3.scala.html#19145" id="112972">v</a></span></span>) <span class="typed"><span class="type">(A, B, List[(A, B)])</span><a href="../../Tuple3.scala.html#21271">::</a></span> <span class="typed"><span class="type">List[(A, B)]</span><span id="112976"><a href="../../Tuple3.scala.html#19147" id="112973">rest</a></span></span> = <span class="typed"><span class="type">List[(A, B)]</span><a href="#112932">list</a></span>
        <span class="typed"><span class="type">(scala.collection.immutable.GBNode[A,B],List[(A, B)])(scala.collection.immutable.GBNode[A,B], List[(A, B)])</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">(A,B,scala.collection.immutable.GBTree[A,B],scala.collection.immutable.GBTree[A,B])(implicit (A) =&gt; Ordered[A])scala.collection.immutable.GBNode[A,B]</span><a href="#112383">GBNode</a></span>(<span class="typed"><span class="type">A</span><a href="#112971">k</a></span>, <span class="typed"><span class="type">B</span><a href="#112972">v</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBLeaf[A,B]</span><a href="#112927">empty</a></span>, <span class="typed"><span class="type">scala.collection.immutable.GBLeaf[A,B]</span><a href="#112927">empty</a></span>), <span class="typed"><span class="type">List[(A, B)]</span><a href="#112973">rest</a></span>)
      } <span class="keyword">else</span>
        <span class="typed"><span class="type">(scala.collection.immutable.GBLeaf[A,B],List[(A, B)])(scala.collection.immutable.GBLeaf[A,B], List[(A, B)])</span><a href="../../Tuple2.scala.html#20366">(</a></span><span class="typed"><span class="type">scala.collection.immutable.GBLeaf[A,B]</span><a href="#112927">empty</a></span>, <span class="typed"><span class="type">List[(A, B)]</span><a href="#112932">list</a></span>)
    }
    <span class="typed"><span class="type">(List[(A, B)],Int)(GBNode.this.aNode, List[(A, B)])</span><a href="#112928">bal</a></span>(<span class="typed"><span class="type">List[(A, B)]</span><a href="#112925">list</a></span>, <span class="typed"><span class="type">Int</span><a href="#112926">s</a></span>).<span class="typed"><span class="type">=&gt; GBNode.this.aNode</span><a href="../../Tuple2.scala.html#19161">_1</a></span>
  }

  <span class="keyword">override</span> <span class="keyword">def</span> <span class="typed"><span class="type">()Int</span><a id="112416">hashCode</a></span>() =
    <span class="typed"><span class="type">=&gt; B</span><a href="#112395">value</a></span>.<span class="typed"><span class="type">()Int</span><a id="3497">hashCode</a></span>() <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112397">smaller</a></span>.<span class="typed"><span class="type">()Int</span><a id="5780">hashCode</a></span>() <span class="typed"><span class="type">(Int)Int</span><a id="3145">+</a></span> <span class="typed"><span class="type">=&gt; scala.collection.immutable.GBTree[A,B]</span><a href="#112399">bigger</a></span>.<span class="typed"><span class="type">()Int</span><a id="5780">hashCode</a></span>()
}

<span class="comment">/* Here is the e-mail where the Author agreed to the change in license.

from	Erik Stenman &lt;happi.stenman@gmail.com&gt;
to	martin odersky &lt;martin.odersky@epfl.ch&gt;,
date	Tue, Apr 29, 2008 at 3:31 PM
subject	Re: test
mailed-by	chara.epfl.ch
signed-by	gmail.com
	
Hi Martin,

I am fine with that change, and since I don't have a scala distribution handy,
I am also fine with you doing the change yourself. Is that OK?

Sorry for my dead home address, I'll add an English response to it at some time.

I am doing fine, and my family is also doing fine.
Hope all is well with you too.

Cheers,
Erik
- Hide quoted text -

On Tue, Apr 29, 2008 at 3:13 PM, martin odersky &lt;martin.odersky@epfl.ch&gt; wrote:

    Hi Erik,

    I tried to send mail to happi@home.se, but got a response n swedish. I
    was sort of guessing from the response that it contained an
    alternative e-mail address and tried to send it there.

    Anyway,  I hope things are going well with you!

    There was some discussion recently about the license of Tree.scala in
    package collection.immutable. It's GPL, whereas the rest of the Scala
    library is BSD. It seems this poses problems with Scala being packaged
    with Fedora. Would it be OK with you to change the license to the
    general one of Scala libraries? You could simply remove the references
    to the GPL
    license in the code and send it back to me if that's OK with you. On
    the other hand, if there's a problem we'll try something else instead.

    All the best

     -- Martin
*/</span>

        </pre>
    </body>
</html>